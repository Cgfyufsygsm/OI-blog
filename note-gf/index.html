<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="前言 准备退役了还不会生成函数打算来胡扯一点东西。
应该 safe for beginners.
References 《具体数学》退役后还是想抽空后慢慢看看。 command_block：多项式计数杂谈 yyc 您真的强 胡小兔：趣谈生成函数 =v= 讲的非常生动！ x义x：【x义x讲坛】生成函数入门 Elegia：旧文补档 2018.7.31——浅谈生成函数 (Generating Function) x义x：【x义x讲坛】生成函数再入门 x义x：组合结构符号化学习笔记 silverxz：生成函数exp的组合意义&amp;amp;小球放盒子的问题 感谢他们
记号约定 考虑到这篇文章的受众可能既包含 OIer 也包含一些文化课同学，故在此处列出一部分前置记号说明。
使用 \(\langle a_0, a_1, a_2,\cdots\rangle\) 表示数列，用 \(a_i\) 表示其的第 \(i\) 项（注意我们从 \(0\) 开始标号）。 定义正整数 \(n\) 的阶乘 \(n! = n\times(n-1)\times(n-2)\times\cdots \times 1\)。 定义正整数 \(n\) 的双阶乘 \(n!! = n\times (n-2)\times (n-4)\times\cdots = \prod\limits_{n-2i\ge 1}(n-2i)\)，即不超过这个正整数且与它有相同奇偶性的所有正整数乘积。 定义下降阶乘幂 \(x^{\underline{k}} = x\times (x-1)\times (x-2)\times\cdots\times (x-k+1)\)，读作“\(x\) 的 \(k\) 次下降幂”，定义上升阶乘幂 \(x^{\overline k}= x\times (x+1)\times (x+2)\times\cdots(x+k + 1)\)，读法类似。 定义组合数（二项式系数） \(\dbinom n m\)（或记作 \(\mathrm C_n^m\)）为从包含 \(n\) 个互异元素的集合中选出大小为 \(m\) 的子集的方案数，其中 \(n,m\in\mathbb N\)（后文会给出广义二项式系数的定义），计算方式为 \(\dbinom n m = \dfrac{n!" name="description"/><title>生成函数胡扯</title>
<link href="https://oi.imyangty.com/note-gf/" rel="canonical"/>
<link href="/scss/style.min.a5821f3d3ab84ce5a0ac21477e347a2e0ca00292e398d16c5e8e36ded6e35a23.css" rel="stylesheet"/><meta content="生成函数胡扯" property="og:title"/>
<meta content="前言 准备退役了还不会生成函数打算来胡扯一点东西。
应该 safe for beginners.
References 《具体数学》退役后还是想抽空后慢慢看看。 command_block：多项式计数杂谈 yyc 您真的强 胡小兔：趣谈生成函数 =v= 讲的非常生动！ x义x：【x义x讲坛】生成函数入门 Elegia：旧文补档 2018.7.31——浅谈生成函数 (Generating Function) x义x：【x义x讲坛】生成函数再入门 x义x：组合结构符号化学习笔记 silverxz：生成函数exp的组合意义&amp;amp;小球放盒子的问题 感谢他们
记号约定 考虑到这篇文章的受众可能既包含 OIer 也包含一些文化课同学，故在此处列出一部分前置记号说明。
使用 \(\langle a_0, a_1, a_2,\cdots\rangle\) 表示数列，用 \(a_i\) 表示其的第 \(i\) 项（注意我们从 \(0\) 开始标号）。 定义正整数 \(n\) 的阶乘 \(n! = n\times(n-1)\times(n-2)\times\cdots \times 1\)。 定义正整数 \(n\) 的双阶乘 \(n!! = n\times (n-2)\times (n-4)\times\cdots = \prod\limits_{n-2i\ge 1}(n-2i)\)，即不超过这个正整数且与它有相同奇偶性的所有正整数乘积。 定义下降阶乘幂 \(x^{\underline{k}} = x\times (x-1)\times (x-2)\times\cdots\times (x-k+1)\)，读作“\(x\) 的 \(k\) 次下降幂”，定义上升阶乘幂 \(x^{\overline k}= x\times (x+1)\times (x+2)\times\cdots(x+k + 1)\)，读法类似。 定义组合数（二项式系数） \(\dbinom n m\)（或记作 \(\mathrm C_n^m\)）为从包含 \(n\) 个互异元素的集合中选出大小为 \(m\) 的子集的方案数，其中 \(n,m\in\mathbb N\)（后文会给出广义二项式系数的定义），计算方式为 \(\dbinom n m = \dfrac{n!" property="og:description"/>
<meta content="https://oi.imyangty.com/note-gf/" property="og:url"/>
<meta content="清烛的博客" property="og:site_name"/>
<meta content="article" property="og:type"/><meta content="Post" property="article:section"/><meta content="OI" property="article:tag"/><meta content="笔记" property="article:tag"/><meta content="生成函数" property="article:tag"/><meta content="2022-06-29T17:20:09+08:00" property="article:published_time"/><meta content="2022-06-29T17:20:09+08:00" property="article:modified_time"/><meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" property="og:image"/>
<meta content="生成函数胡扯" name="twitter:title"/>
<meta content="前言 准备退役了还不会生成函数打算来胡扯一点东西。
应该 safe for beginners.
References 《具体数学》退役后还是想抽空后慢慢看看。 command_block：多项式计数杂谈 yyc 您真的强 胡小兔：趣谈生成函数 =v= 讲的非常生动！ x义x：【x义x讲坛】生成函数入门 Elegia：旧文补档 2018.7.31——浅谈生成函数 (Generating Function) x义x：【x义x讲坛】生成函数再入门 x义x：组合结构符号化学习笔记 silverxz：生成函数exp的组合意义&amp;amp;小球放盒子的问题 感谢他们
记号约定 考虑到这篇文章的受众可能既包含 OIer 也包含一些文化课同学，故在此处列出一部分前置记号说明。
使用 \(\langle a_0, a_1, a_2,\cdots\rangle\) 表示数列，用 \(a_i\) 表示其的第 \(i\) 项（注意我们从 \(0\) 开始标号）。 定义正整数 \(n\) 的阶乘 \(n! = n\times(n-1)\times(n-2)\times\cdots \times 1\)。 定义正整数 \(n\) 的双阶乘 \(n!! = n\times (n-2)\times (n-4)\times\cdots = \prod\limits_{n-2i\ge 1}(n-2i)\)，即不超过这个正整数且与它有相同奇偶性的所有正整数乘积。 定义下降阶乘幂 \(x^{\underline{k}} = x\times (x-1)\times (x-2)\times\cdots\times (x-k+1)\)，读作“\(x\) 的 \(k\) 次下降幂”，定义上升阶乘幂 \(x^{\overline k}= x\times (x+1)\times (x+2)\times\cdots(x+k + 1)\)，读法类似。 定义组合数（二项式系数） \(\dbinom n m\)（或记作 \(\mathrm C_n^m\)）为从包含 \(n\) 个互异元素的集合中选出大小为 \(m\) 的子集的方案数，其中 \(n,m\in\mathbb N\)（后文会给出广义二项式系数的定义），计算方式为 \(\dbinom n m = \dfrac{n!" name="twitter:description"/><meta content="summary_large_image" name="twitter:card"/>
<meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" name="twitter:image"/>
<link href="https://q1.qlogo.cn/g?b=qq&amp;nk=375836877&amp;s=5" rel="shortcut icon"/>
<link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/github-dark-dimmed.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="article-page">
<script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button aria-label="切换菜单" class="hamburger hamburger--spin" id="toggle-menu" type="button">
<span class="hamburger-box">
<span class="hamburger-inner"></span>
</span>
</button>
<header>
<figure class="site-avatar">
<a href="/">
<img alt="Avatar" class="site-logo" height="300" loading="lazy" src="/img/avatar_huea3ce2119467b51fdd2a81393644a76d_51594_300x0_resize_q75_box.jpg" width="300"/>
</a>
<span class="emoji">😅</span>
</figure>
<div class="site-meta">
<h1 class="site-name"><a href="/">清烛的博客</a></h1>
<h2 class="site-description">烟火已谢，笙歌未停</h2>
</div>
</header><ol class="social-menu">
<li>
<a href="mailto:i@imyangty.com" target="_blank" title="email">
<svg class="icon icon-tabler icon-tabler-mail" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<rect height="14" rx="2" width="18" x="3" y="5"></rect>
<polyline points="3 7 12 13 21 7"></polyline>
</svg>
</a>
</li>
<li>
<a href="https://github.com/Cgfyufsygsm" target="_blank" title="GitHub">
<svg class="icon icon-tabler icon-tabler-brand-github" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
</a>
</li>
<li>
<a href="https://t.me/Cgfyufsygsm" target="_blank" title="Telegram">
<svg class="icon icon-tabler icon-tabler-brand-telegram" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"></path>
</svg>
</a>
</li>
<li>
<a href="https://twitter.com/Cgfyufsygsm" target="_blank" title="Twitter">
<svg class="icon icon-tabler icon-tabler-brand-twitter" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
</svg>
</a>
</li>
</ol><ol class="menu" id="main-menu">
<li>
<a href="/">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>主页</span>
</a>
</li>
<li>
<a href="/about/">
<svg class="icon icon-tabler icon-tabler-user" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="7" r="4"></circle>
<path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
</svg>
<span>关于</span>
</a>
</li>
<li>
<a href="/idx/">
<svg class="icon icon-tabler icon-tabler-hash" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<line x1="5" x2="19" y1="9" y2="9"></line>
<line x1="5" x2="19" y1="15" y2="15"></line>
<line x1="11" x2="7" y1="4" y2="20"></line>
<line x1="17" x2="13" y1="4" y2="20"></line>
</svg>
<span>导航</span>
</a>
</li>
<li>
<a href="/archives/">
<svg class="icon icon-tabler icon-tabler-archive" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<rect height="4" rx="2" width="18" x="3" y="4"></rect>
<path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10"></path>
<line x1="10" x2="14" y1="12" y2="12"></line>
</svg>
<span>归档</span>
</a>
</li>
<li>
<a href="/search/">
<svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="10" cy="10" r="7"></circle>
<line x1="21" x2="15" y1="21" y2="15"></line>
</svg>
<span>搜索</span>
</a>
</li>
<li>
<a href="/friends/">
<svg class="icon icon-tabler icon-tabler-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path>
<path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path>
</svg>
<span>友链</span>
</a>
</li>
<li>
<a href="https://blog.imyangty.com" target="_blank">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>主博客</span>
</a>
</li>
<div class="menu-bottom-section">
<li id="dark-mode-toggle">
<svg class="icon icon-tabler icon-tabler-toggle-left" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="8" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="16" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<span>暗色模式</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class="has-image main-article">
<header class="article-header">
<div class="article-image">
<a href="/note-gf/">
<img alt="Featured image of post 生成函数胡扯" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</a>
</div>
<div class="article-details">
<header class="article-category">
<a href="/categories/oi/">
                OI
            </a>
<a href="/categories/note/">
                笔记
            </a>
</header>
<div class="article-title-wrapper">
<h2 class="article-title">
<a href="/note-gf/">生成函数胡扯</a>
</h2>
</div>
<footer class="article-time">
<div>
<svg class="icon icon-tabler icon-tabler-calendar-time" fill="none" height="56" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="56" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4"></path>
<circle cx="18" cy="18" r="4"></circle>
<path d="M15 3v4"></path>
<path d="M7 3v4"></path>
<path d="M3 11h16"></path>
<path d="M18 16.496v1.504l1 1"></path>
</svg>
<time class="article-time--published">Jun 29, 2022</time>
</div>
<div>
<svg class="icon icon-tabler icon-tabler-clock" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<polyline points="12 7 12 12 15 15"></polyline>
</svg>
<time class="article-time--reading">
                    阅读时长: 16 分钟
                </time>
</div>
</footer>
</div>
</header>
<section class="article-content">
<h2 id="前言">前言</h2>
<p>准备退役了还不会生成函数打算来胡扯一点东西。</p>
<p>应该 safe for beginners.</p>
<h2 id="references">References</h2>
<ul>
<li>《具体数学》退役后还是想抽空后慢慢看看。</li>
<li><a href="https://www.luogu.com.cn/blog/command-block/sheng-cheng-han-shuo-za-tan">command_block：多项式计数杂谈</a> yyc 您真的强 <img src="https://啧.tk/ll"/></li>
<li><a href="https://www.cnblogs.com/RabbitHu/p/9178645.html">胡小兔：趣谈生成函数 =v=</a> 讲的非常生动！</li>
<li><a href="https://www.luogu.com.cn/blog/zyxxs/x-yi-x-jiang-tan-sheng-cheng-han-shuo-ru-men">x义x：【x义x讲坛】生成函数入门</a></li>
<li><a href="https://www.luogu.com.cn/blog/EntropyIncreaser/jiu-wen-bu-dang-2018731-post">Elegia：旧文补档 2018.7.31——浅谈生成函数 (Generating Function)</a></li>
<li><a href="https://www.luogu.com.cn/blog/zyxxs/x-yi-x-jiang-tan-sheng-cheng-han-shuo-zai-ru-men">x义x：【x义x讲坛】生成函数再入门</a></li>
<li><a href="https://xyix.github.io/posts/?postname=combinatorics">x义x：组合结构符号化学习笔记</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/433578651">silverxz：生成函数exp的组合意义&amp;小球放盒子的问题</a></li>
</ul>
<p>感谢他们<img src="https://啧.tk/qq"/></p>
<h2 id="记号约定">记号约定</h2>
<p>考虑到这篇文章的受众可能既包含 OIer 也包含一些文化课同学，故在此处列出一部分前置记号说明。</p>
<ul>
<li>使用 <span class="math inline">\(\langle a_0, a_1, a_2,\cdots\rangle\)</span> 表示数列，用 <span class="math inline">\(a_i\)</span> 表示其的第 <span class="math inline">\(i\)</span> 项（注意我们从 <span class="math inline">\(0\)</span> 开始标号）。</li>
<li>定义正整数 <span class="math inline">\(n\)</span> 的阶乘 <span class="math inline">\(n! = n\times(n-1)\times(n-2)\times\cdots \times 1\)</span>。</li>
<li>定义正整数 <span class="math inline">\(n\)</span> 的双阶乘 <span class="math inline">\(n!! = n\times (n-2)\times (n-4)\times\cdots = \prod\limits_{n-2i\ge 1}(n-2i)\)</span>，即不超过这个正整数且与它有<strong>相同奇偶性</strong>的所有正整数乘积。</li>
<li>定义下降阶乘幂 <span class="math inline">\(x^{\underline{k}} = x\times (x-1)\times (x-2)\times\cdots\times (x-k+1)\)</span>，读作“<span class="math inline">\(x\)</span> 的 <span class="math inline">\(k\)</span> 次下降幂”，定义上升阶乘幂 <span class="math inline">\(x^{\overline k}= x\times (x+1)\times (x+2)\times\cdots(x+k + 1)\)</span>，读法类似。</li>
<li>定义组合数（二项式系数） <span class="math inline">\(\dbinom n m\)</span>（或记作 <span class="math inline">\(\mathrm C_n^m\)</span>）为从包含 <span class="math inline">\(n\)</span> 个互异元素的集合中选出大小为 <span class="math inline">\(m\)</span> 的子集的方案数，其中 <span class="math inline">\(n,m\in\mathbb N\)</span>（后文会给出广义二项式系数的定义），计算方式为 <span class="math inline">\(\dbinom n m = \dfrac{n!}{m!(n-m)!} = \dfrac{n^{\underline m}}{m^{\underline m}}\)</span>。</li>
<li>对于形式幂级数（可以暂时理解为多项式函数）<span class="math inline">\(F(x) = c_0 + c_1x + c_2x^2 + \cdots\)</span> 的第 <span class="math inline">\(n\)</span> 项系数 <span class="math inline">\(c_n\)</span> 下文记作 <span class="math inline">\([x^n]F(x)\)</span>。</li>
<li>求和符号 <span class="math inline">\(\sum\limits_{x=1}^nf(x) = f(1) + f(2) + \cdots + f(n)\)</span>，求积符号 <span class="math inline">\(\prod\limits_{x=1}^nf(x) = f(1)\times f(2)\times\cdots f(n)\)</span>。</li>
<li>记指数函数 <span class="math inline">\(\exp(x)\)</span> 表示 <span class="math inline">\(e^x\)</span>。</li>
<li><span class="math inline">\([P]\)</span>（艾弗森括号）指：若命题 <span class="math inline">\(P\)</span> 为真，则 <span class="math inline">\([P] = 1\)</span>，否则为 <span class="math inline">\(0\)</span>，即 <span class="math inline">\([P] = \begin{cases}1&amp;P\\0&amp;\neg P\end{cases}\)</span>。</li>
<li>为了方便，<span class="math inline">\(0^0= 1\)</span>。</li>
<li><span class="math inline">\(\{x:P(x)\}\)</span> 表示所有 <span class="math inline">\(P(x)\)</span> 为真的元素 <span class="math inline">\(x\)</span> 构成的集合，<del>好像在文化课数学里面我们一般写作 <span class="math inline">\(\{x\mid P(x)\}\)</span></del>。</li>
</ul>
<p>同时读懂本文需要一定的分析基础（可能高中知识差不多了）和（约等于没有的）抽代基础，以及一些必要的组合数学常识。</p>
<p>笔者的分析和抽代约等于没学，所以可能不是特别的严谨，如有谬误请指出，不胜感谢！</p>
<h2 id="生成函数的引入">生成函数的引入</h2>
<h3 id="lead-in">Lead-in</h3>
<p>本段内容如果看不懂，可以先读完后面的两个小问题后再回来读，<del>应该就能看懂了</del>。</p>
<p>首先大家在文化课课堂上（或者在小学奥数课堂上）学过这个东西（二项式定理）： <span class="math display">\[
(1+x)^n = \sum_{i=0}^n\binom n i x^i
\]</span> 现在当我们需要求 <span class="math display">\[
\binom n 0 + \binom n 1 + \binom n  2+ \cdots +\binom n n
\]</span> 时，我们知道可以代入 <span class="math inline">\(x=1\)</span> 然后直接得到答案为 <span class="math inline">\(2^n\)</span>。</p>
<p>相当于我们可以拿一个“函数”来描述一个数列，然后将对于这个数列的操作变成对这个函数的代数运算（积分，求导，加，乘，etc.）。于是可以将定义在<strong>代数对象</strong> <span class="math inline">\(x\)</span> 上的一批<strong>核函数</strong> <span class="math inline">\(k_n(x)\)</span> 附在数列 <span class="math inline">\(\langle a_0,a_1,a_2,\cdots\rangle\)</span>（可以无穷）的每一项上。对于 <span class="math inline">\(a_0,a_1,\cdots\)</span> 定义其<strong>生成函数</strong>为形式幂级数 <span class="math display">\[
\begin{aligned}
F(x) &amp;= a_0k_0(x) + a_1k_1(x) + \cdots \\
&amp;= \sum_{i\ge 0}a_ik_i(x)
\end{aligned}
\]</span> 若我们将 <span class="math inline">\(k_n(x)\)</span> 定义为 <span class="math inline">\(x^n\)</span>，则定义数列 <span class="math inline">\(\langle a_0,a_1,\cdots\rangle\)</span> 的<strong>普通生成函数（OGF, ordinary generating function）</strong>为 <span class="math display">\[
\begin{aligned}
F(x) &amp;= a_0 + a_1x + a_2x^2 + a_3x^3 + \cdots \\
&amp;= \sum_{i\ge 0}a_ix^i
\end{aligned}
\]</span> 所以我们将数列的第 <span class="math inline">\(i\)</span> 项附上代数对象 <span class="math inline">\(x\)</span> 的 <span class="math inline">\(i\)</span> 次幂，得到了这样一个幂级数（可暂时理解为多项式）。</p>
<p>注意到，这里的 <span class="math inline">\(x\)</span> 我没有使用“未知数”这一词汇，而这个像多项式一样的东西我是使用的“形式幂级数”。</p>
<p>是因为幂级数实际上为一个很宽泛的概念，只要 <span class="math inline">\(x\)</span> 有定义乘法运算，我们就可以拿 <span class="math inline">\(x^k\)</span> 来表示“幂次”，得到一个幂级数。<span class="math inline">\(x\)</span> 不一定需要是数字，阿猫阿狗也可以，在生成函数里面我们可以把它只当作一个“占坑”的，所以其具体的“值”没有意义，“函数 <span class="math inline">\(F(x)\)</span> 的函数值”也没有意义。所以在分析生成函数的时候不需要纠结其收敛性。</p>
<p>上面的东西可能有点抽象，但是问题不大，可以接着先往下看。</p>
<h3 id="几何级数定理">几何级数定理</h3>
<p>考虑一个最简单的数列：<span class="math inline">\(\langle 1,1,1,\cdots\rangle\)</span>，这个数列的生成函数显然为 <span class="math inline">\(F(x) = 1 + x + x^2 + x^3 + \cdots\)</span>。</p>
<p>做一下平移变形：<span class="math inline">\(xF(x) = x + x^2 + x^3 + \cdots\)</span>，然后上下两式相减，发现 <span class="math inline">\(x+x^2+x^3+\cdots\)</span> 都消去了，只剩下 <span class="math display">\[
F(x) = \frac{1}{1-x}
\]</span> 这个东西看着比较的逆天（？）因为你会发现 <span class="math inline">\(F(x)\)</span> 在 <span class="math inline">\(x\notin(-1,1)\)</span> 的时候根本不是收敛的，但是由于我们只是在分析生成函数，<span class="math inline">\(x\)</span> 只是一个代数对象，我们没有必要在乎其收敛性。（另，上面的式子也同时可以使用等比数列求和公式来思考）</p>
<p>所以有<strong>几何级数定理</strong>成立： <span class="math display">\[
1+x+x^2+x^3+\cdots = \sum_{i\ge 0}x^i = \frac{1}{1-x}
\]</span> 同时你注意到，<span class="math inline">\(F(x) = 1 + x + x^2 + x^3 + \cdots\)</span> 是一个含有无穷求和的表达式，有些时候是不易于分析的，而 <span class="math inline">\(\dfrac{1}{1-x}\)</span> 这种有限的形式非常的简洁优美，下文我们称其为<strong>封闭形式</strong>。下文中我们会进行更深的阐述。</p>
<h3 id="多米诺骨牌问题">多米诺骨牌问题</h3>
<p>《具体数学》上利用这道例题较自然地引入了生成函数。我们再次强调：<span class="math inline">\(x\)</span> 只是一个代数对象，而不是“未知数”，这里我们将使用一些更具象的符号来表达。</p>
<blockquote>
<p>例题 <span class="math inline">\(1\)</span>：使用 <span class="math inline">\(1\times 2\)</span> 的骨牌覆盖 <span class="math inline">\(2\times n\)</span> 的棋盘，有多少种方案？</p>
</blockquote>
<p>不妨先设方案数为 <span class="math inline">\(F_n\)</span>，然后约定 <span class="math inline">\(F_0 = 1\)</span>（什么都不放）。</p>
<p>如果你熟悉基本的组合数学，那么不难发现这东西就是斐波那契数列（平移一位的结果），那么接下来我们看看这个东西能用生成函数以什么方式解决。</p>
<p>记 <span class="math inline">\(\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\)</span> 为一个竖骨牌，<span class="math inline">\(\tiny\begin{array}{|c c|}\hline&amp;&amp;\hline\end{array}\)</span> 为一个横骨牌，则我们显然知道 <span class="math inline">\(2\times 3\)</span> 可以这样来摆： <span class="math display">\[
\def\boxA{\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\normalsize}
\def\boxB{\tiny\begin{array}{|c c|}\hline\\&amp;&amp;\hline\\\hline\end{array}\normalsize}
\def\boxb{\tiny\begin{array}{|c c|}\hline&amp;&amp;\hline\end{array}\normalsize}
\boxA\boxA\boxA, \boxA\boxB, \boxB\boxA
\]</span> 一共三种方案。</p>
<p>对摆放方案定义“加法”，表示摆放方案的<strong>并列</strong>，则用<strong>无穷求和</strong>罗列出所有的摆放方案如下： <span class="math display">\[
\def\boxA{\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\normalsize}
\def\boxB{\tiny\begin{array}{|c c|}\hline\\&amp;&amp;\hline\\\hline\end{array}\normalsize}
T = \vline + \boxA + \boxB + \boxA\boxA +\boxA\boxA\boxA + \boxA\boxB + \boxB\boxA + \cdots
\]</span> 其中 <span class="math inline">\(\vline\)</span> 表示 <span class="math inline">\(2\times 0\)</span> 的空摆放。</p>
<p>若我们再对摆放方案定义“乘法”，表示顺次拼接，如 <span class="math inline">\(\def\boxA{\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\normalsize}\def\boxB{\tiny\begin{array}{|c c|}\hline\\&amp;&amp;\hline\\\hline\end{array}\normalsize}\boxA\boxB = \boxA\times\boxB\)</span>。<em>注意其没有交换律</em>，但是满足对加法的分配律：<span class="math inline">\(S_1\times (S_2+S_3) = S_1\times S_2 + S_1\times S_3\)</span>。意义即为先摆 <span class="math inline">\(S_1\)</span> 然后再摆 <span class="math inline">\(S_2\)</span> 或 <span class="math inline">\(S_3\)</span> 和先摆 <span class="math inline">\(S_2\)</span> 或 <span class="math inline">\(S_3\)</span> 再在左边加 <span class="math inline">\(S_1\)</span>。</p>
<p>注意到此时乘法有<strong>单位元</strong> <span class="math inline">\(\vline\)</span>，<span class="math inline">\(S\times\vline= S\)</span>，且 <span class="math inline">\(\vline\times S = S\)</span>。</p>
<p>下面我们就可以将 <span class="math inline">\(T\)</span> 进行强力化简——注意到除了 <span class="math inline">\(\vline\)</span> 之外所有的方案都可以表述为 <span class="math inline">\(\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\)</span> 或 <span class="math inline">\(\tiny\begin{array}{|c c|}\hline&amp;&amp;\hline\end{array}\)</span> 乘上个什么，因为他们的开头要么是 <span class="math inline">\(\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\)</span> 要么是 <span class="math inline">\(\tiny\begin{array}{|c c|}\hline&amp;&amp;\hline\end{array}\)</span>。</p>
<p>于是 <span class="math display">\[
\def\boxA{\tiny\begin{array}{|c|}\hline ~~\\\\\hline\end{array}\normalsize}
\def\boxB{\tiny\begin{array}{|c c|}\hline\\&amp;&amp;\hline\\\hline\end{array}\normalsize}
\begin{aligned}
T =&amp; \vline + \boxA + \boxB + \boxA\boxA +\boxA\boxA\boxA + \boxA\boxB + \boxB\boxA + \cdots\\
=&amp; \vline + \boxA(\vline + \boxA + \boxB + \boxA\boxA +\boxA\boxA\boxA + \boxA\boxB + \boxB\boxA + \cdots)\\
&amp;+\boxB(\vline + \boxA + \boxB + \boxA\boxA +\boxA\boxA\boxA + \boxA\boxB + \boxB\boxA + \cdots)\\
=&amp;\vline + \boxA T+\boxB T\\
(\vline-\boxA-\boxB)T=&amp;\vline
\end{aligned}
\]</span> 注意到 <span class="math inline">\(\vline\)</span> 为单位元，与任何元素都满足乘法的交换律，所以此处无需在意左除法/右除法（严格的来说，我们这里的乘法是不具有交换律的），最终我们有 <span class="math display">\[
T = \frac{\vline}{\vline - \boxA - \boxB}
\]</span> 利用几何级数定理，将 <span class="math inline">\(\vline\)</span> 视作 <span class="math inline">\(1\)</span>（注意到 <span class="math inline">\(1\)</span> 就是实数乘法幺半群的单位元，所以我们拿此处的单位元 <span class="math inline">\(\vline\)</span> 带进去是良定义的），将 <span class="math inline">\(\boxA + \boxB\)</span> 视作整体，故 <span class="math display">\[
\begin{aligned}
T &amp;= \vline + \left(\boxA + \boxB\right) + \left(\boxA + \boxB\right)^2 + \cdots\\
&amp;= \vline + \boxA + \boxB + \boxA\boxA + \boxA\boxB + \boxB\boxA + \cdots
\end{aligned}
\]</span> 将其展开不难发现其就是原来的 <span class="math inline">\(T\)</span>。</p>
<p>现在我们不妨略去更多无效的信息——我们不关心骨牌具体是怎么摆的，只记录横和竖的多米诺骨牌分别用了多少种，则我们可以这样简写：将形如 <span class="math inline">\(\boxA\boxB\)</span> 这样的记为 <span class="math inline">\(\boxA\boxb^2\)</span>，而形如 <span class="math inline">\(\boxA\boxB + \boxB\boxA\)</span> 就记为 <span class="math inline">\(2\boxA\boxb^2\)</span>，即用 <span class="math inline">\(1\)</span> 个 <span class="math inline">\(\boxA\)</span> 和两个 <span class="math inline">\(\boxb\)</span> 是存在两种摆法的。</p>
<p>那么实际上， <span class="math display">\[
\begin{aligned}
T &amp;= \vline + \left(\boxA + \boxb^2\right) + \left(\boxA + \boxb^2\right)^2 + \left(\boxA + \boxb^2\right)^3 + \cdots\\
&amp;= \sum_{i\ge 0}\left(\boxA + \boxb^2\right)^i\\
&amp;= \sum_{i\ge 0}\sum_{j\ge 0}\binom ij\boxA^j\boxb^{2(i - j)}\\
&amp;= \sum_{j, k\ge 0}\binom{j + k}{j}\boxA^j\boxb^{2k}&amp;k=i-j
\end{aligned}
\]</span> 第三步是使用二项式定理将 <span class="math inline">\(\left(\boxA + \boxb^2\right)^i\)</span> 展开（注意到 <span class="math inline">\(\forall j &gt; i\)</span> 有 <span class="math inline">\(\dbinom i j = 0\)</span> 所以 <span class="math inline">\(j\)</span> 的上界无关紧要），第四步就是使用 <span class="math inline">\(k\)</span> 替换掉 <span class="math inline">\(i - j\)</span>，合法性不言而喻。</p>
<p>这告诉了我们什么呢？根据我们缩写的意义，用 <span class="math inline">\(j\)</span> 个 <span class="math inline">\(\boxA\)</span> 和 <span class="math inline">\(2k\)</span> 个 <span class="math inline">\(\boxb\)</span> 来拼凑出 <span class="math inline">\(2\times (j + 2k)\)</span> 矩形的方案有 <span class="math inline">\(\dbinom{j+k}{j}\)</span> 种。</p>
<p>进一步略去水平和竖直的区别，用 <span class="math inline">\(z\)</span> 代替之（注意 <span class="math inline">\(z\)</span> 只是个符号！），同时用 <span class="math inline">\(1\)</span> 代替单位元 <span class="math inline">\(\vline\)</span>，可以得到 <span class="math display">\[
T(z) = \frac{1}{1 - z-z^2}
\]</span> 而这个东西和斐波那契的 OGF <span class="math inline">\(F(z) = \dfrac{z}{1 - z - z^2}\)</span>（后文会提到）只在分母上相差一个 <span class="math inline">\(x\)</span>，所以在这里，我们的答案是斐波那契的第 <span class="math inline">\(n + 1\)</span> 项。</p>
<p>这就是所谓“生成函数”，我们发现我们把多米诺骨牌本身当作了某种<strong>代数对象</strong>进行处理，这是一种极其强力且通用的方法，接下来可以看一下另一道例题加深一下理解。</p>
<h3 id="找零问题">找零问题</h3>
<blockquote>
<p>例题 <span class="math inline">\(2\)</span>：有 <span class="math inline">\(1\)</span> 元，<span class="math inline">\(2\)</span> 元和 <span class="math inline">\(5\)</span> 元的硬币，每种面值都有无限枚，问支付 <span class="math inline">\(n\)</span> 元有多少方案？</p>
</blockquote>
<p>一样，设答案为 <span class="math inline">\(f_n\)</span>，注意 <span class="math inline">\(f_0 = 1\)</span>（啥都不选）。</p>
<p>这里我们使用代数对象 <span class="math inline">\(a\)</span>，<span class="math inline">\(b\)</span> 和 <span class="math inline">\(c\)</span> 分别表示这三种面值的硬币。然后考虑定义一种支付方案为一组硬币，设分别有 <span class="math inline">\(x,y,z\)</span> 枚，则记作 <span class="math inline">\(S = a^xb^yc^z\)</span>。</p>
<p>定义面值函数 <span class="math inline">\(\operatorname{val}(S) = x + 2y + 5z\)</span>。定义两种支付方案的“乘法”为将两种支付方案的硬币合并在一起，即 <span class="math display">\[
a^{x_1}b^{y_1}c^{z_1}\times a^{x_2}b^{y_2}c^{z_2} = a^{x_1 + x_2}b^{y_1+y_2}c^{z_1+z_2}
\]</span> 这很符合我们熟知的“幂”的定义，而不难发现面值函数满足如下性质：<span class="math inline">\(\operatorname{val}(S_1\times S_2) = \operatorname{val}(S_1) + \operatorname{val}(S_2)\)</span>。</p>
<p>注意：我们使用加法表示方案的并列，所以“拼接”使用乘法。</p>
<p>乘法分配律显然，注意到有单位元 <span class="math inline">\(\varnothing\)</span>，所以我们考虑用无穷求和罗列出用 <span class="math inline">\(1\)</span> 元硬币的支付方案： <span class="math display">\[
\begin{aligned}
P_{1} &amp;= \varnothing + a + aa + aaa + aaaa + \cdots\\
&amp;= \varnothing + a + a^2 + a^3 + a^4 + \cdots
\end{aligned}
\]</span> 第 <span class="math inline">\(i\)</span> 项（<span class="math inline">\(a^i\)</span>）表示用 <span class="math inline">\(i\)</span> 个 <span class="math inline">\(1\)</span> 元硬币。那么如果我们将 <span class="math inline">\(2\)</span> 元硬币考虑进去，会发现所有的方案都可以被表示为 <span class="math display">\[
P_{1,2} = P_1 + bP_1 + b^2P_1 + b^3P_1 + \cdots
\]</span> 因为每种支付方式都要选择若干 <span class="math inline">\(1\)</span> 元硬币和若干 <span class="math inline">\(2\)</span> 元硬币。</p>
<p>再考虑 <span class="math inline">\(5\)</span> 元硬币，发现就是 <span class="math display">\[
P_{1,2,5} = P_{1,2} + cP_{1,2} + c^2P_{1,2} + \cdots
\]</span> 所以我们拆开来看，可以得到 <span class="math display">\[
\begin{aligned}
P_{1,2,5} &amp;= (\varnothing + a + a^2 + \cdots)\\
&amp;\times(\varnothing + b + b^2  + \cdots)\\
&amp;\times(\varnothing + c + c^2 + \cdots)
\end{aligned}
\]</span> 根据几何级数定理， <span class="math display">\[
P_{1,2,5} = \frac{1}{1-a}\frac{1}{1-b}\frac{1}{1-c}
\]</span> 而我们只关心总价值，根据上面幂的形式，我们可以用 <span class="math inline">\(z\)</span>、<span class="math inline">\(z^2\)</span> 和 <span class="math inline">\(z^5\)</span> 来分别表示那三种面值（这样既能满足上面的定义，又能去掉面值之间的区别），所以答案的生成函数为 <span class="math display">\[
F(z) = \frac{1}{1-z}\frac{1}{1-z^2}\frac{1}{1-z^5}
\]</span> <span class="math inline">\([z^n]F(z)\)</span> 就是我们想要的答案，虽然我们现在而言不能很好地把展开式的系数提取出来。</p>
<p>注意到此时 <span class="math inline">\(P_{1,2,5}\)</span> 不为 <span class="math inline">\(\varnothing + \sum\limits_{k&gt;0} (a + b + c)^k\)</span>，因为 <span class="math inline">\((a+b+c)^k\)</span> 展开后，用不同顺序支付的硬币会被重复计数（注意到这里我们只关心硬币集合）。</p>
<p>OGF 可以拿来很好地刻画<strong>组合类计数问题</strong>，并且表示两个组合类的 OGF 乘起来表示了他们的<strong>笛卡尔积</strong>，下文会进行更详细的阐述。</p>
<p>同时你如果对基本 dp 比较熟悉，则会发现将若干个 OGF 乘起来的过程和做背包的本质是相同的。</p>
<h2 id="常用数列推导">常用数列推导</h2>
<p>通过对数列的生成函数进行一些代数变形，可以得到一些意想不到的结果。</p>
<h3 id="基本运算">基本运算</h3>
<p>下面若未经说明，则假设 <span class="math inline">\(F(z)\)</span> 和 <span class="math inline">\(G(z)\)</span> 分别为数列 <span class="math inline">\(\langle f_n\rangle\)</span> 和 <span class="math inline">\(\langle g_n\rangle\)</span> 的生成函数，并且假设对于 <span class="math inline">\(n&lt;0\)</span>，<span class="math inline">\(f_n = g_n = 0\)</span>。</p>
<p>那么加减法的运算是简单的： <span class="math display">\[
F(z)\pm G(z) = \sum_nf_nz^n\pm \sum_ng_nz^n = \sum_n(f_n \pm g_n)z^n
\]</span> 所以我们得到了数列 <span class="math inline">\(\langle f_n\pm g_n \rangle\)</span> 的生成函数。</p>
<p>而对生成函数乘上一个常数 <span class="math inline">\(c\)</span> 也是简单的： <span class="math display">\[
cF(z) = c\sum_nf_nz^n = \sum_ncf_nz^n
\]</span> 其为数列 <span class="math inline">\(\langle cf_n\rangle\)</span> 的生成函数。</p>
<p>对于平移运算，假设我们需要将 <span class="math inline">\(F(z)\)</span> 向右平移 <span class="math inline">\(m\)</span> 位（假设 <span class="math inline">\(m\ge 0\)</span>），即在数列 <span class="math inline">\(\langle f_1, f_2,\cdots\rangle\)</span> 前面添 <span class="math inline">\(m\)</span> 个 <span class="math inline">\(0\)</span> 变成 <span class="math inline">\(\langle 0,\cdots,0,f_1,f_2,\cdots\rangle = \langle f_{n-m}\rangle\)</span>，那么就直接乘上 <span class="math inline">\(z^m\)</span> 就好了： <span class="math display">\[
z^mF(z) = z^m\sum_n f_nz^n = \sum_n f_nz^{n+m} = \sum_{n}f_{n-m}z^n
\]</span> 而左平移也是类似的——<strong>减去最左边的 <span class="math inline">\(m\)</span> 项</strong>再除以 <span class="math inline">\(z^m\)</span> 即可： <span class="math display">\[
\frac{F(z) - f_0 - f_1z- \cdots f_{m-1}z^{m-1}}{z^m} = \sum_{n\ge m}f_nz^{n-m}=\sum_{n\ge 0}g_{n+m}z^n
\]</span> （注意这里的下界不可忽略）</p>
<p>在括号里面乘上常数也是常见技巧： <span class="math display">\[
F(cz) = \sum_nf_n(cz)^n = \sum_nf_nc^nz^n
\]</span> 其对应 <span class="math inline">\(\langle c^nf_n\rangle\)</span> 的生成函数，<span class="math inline">\(c=-1\)</span> 时会很好用。</p>
<p>参考分析中对多项式的导数的定义，对形式幂级数定义形式导数： <span class="math display">\[
F'(z) = f_1 + 2f_2z + 3f_3z^2 + \cdots = \sum_n(n+1)f_{n+1}z^n
\]</span> 不妨右移一位使得下标对齐： <span class="math display">\[
zF'(z) = \sum_nnf_nz^n
\]</span> 于是我们得到了数列 <span class="math inline">\(\langle nf_n\rangle\)</span> 的生成函数，这可以把指数下放到系数，继续求导可以让 <span class="math inline">\(n\)</span> 的更多次下放到系数来。</p>
<p>类似地定义形式积分： <span class="math display">\[
\int F(z) = f_0z + \frac12f_1z^2 + \frac13f_2z^3 + \cdots = \sum_{n\ge 1}\frac1nf_{n-1}z^n
\]</span> 需要注意常数项是 <span class="math inline">\(0\)</span>，可得到 <span class="math inline">\(\langle f_{n-1}/n\rangle\)</span> 的生成函数。</p>
<p>两个生成函数的乘积可以表示两个数列的<strong>卷积（convolution，这里特指加法卷积）</strong>，即 <span class="math display">\[
\begin{aligned}
F(z)G(z) &amp;= (f_0+f_1z+f_2z^2+\cdots)(g_0 +g_1z+g_2z^2+\cdots)\\
&amp;= (f_0g_0) + (f_0g_1 + f_1g_0)z + (f_0g_2 + f_1g_1 + f_2g_0)z^2 + \cdots\\
&amp;= \sum_{n}\left(\sum_kf_kg_{n-k}\right)z^n
\end{aligned}
\]</span> 这是数列 <span class="math inline">\(\left\langle \sum\limits_{k}f_kg_{n-k}\right\rangle\)</span> 的生成函数。卷积相对而言，比较复杂，但他非常的重要，下文会进一步详细阐述。</p>
<p>另外，根据 <span class="math inline">\(\exp(x)\)</span> 和 <span class="math inline">\(\ln(1 + x)\)</span> 的麦克劳林级数 <span class="math display">\[
\begin{aligned}
\exp(x) &amp;= e^x = \sum_{n\ge 0}\frac{x^n}{n!}\\
\ln(1 + x) &amp;= \sum_{n\ge 0}\frac{(-1)^{n+1}}{n}x^n\\
\ln(1 - x) &amp;= -\sum_{n\ge 0}\frac{x^n}{n}
\end{aligned}
\]</span> 我们对生成函数定义其 <span class="math inline">\(\exp\)</span> 和 <span class="math inline">\(\ln\)</span> 为 <span class="math display">\[
\begin{aligned}
\exp(F(z)) &amp;= \sum_{n\ge 0}\frac{F(z)^n}{n!}\\
\ln(1 - F(z)) &amp;= -\sum_{n\ge 0}\frac{F(z)^n}{n}
\end{aligned}
\]</span> 类似地根据 <span class="math inline">\(\sin\)</span> 和 <span class="math inline">\(\cos\)</span> 的展开我们也可以对形式幂级数定义其三角函数，OI 中考察较少，在此略过。</p>
<p>以上运算的合法性可参见开头引用资料部分（orz _rqy）由于不是本文重点所以不进行展开证明。</p>
<h3 id="简单数列的生成函数">简单数列的生成函数</h3>
<p>先来看几个最简单的，用几何级数定理与整体代入法可以很方便的得到：</p>
<div class="table-wrapper"><table>
<colgroup>
<col style="width: 46%"/>
<col style="width: 33%"/>
<col style="width: 19%"/>
</colgroup>
<thead>
<tr class="header">
<th>数列</th>
<th>OGF</th>
<th>封闭形式</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\langle 1,0,0,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}[n=0]z^n\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\langle 0,\cdots,0, 1,0,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}[n=m]z^n\)</span></td>
<td><span class="math inline">\(z^m\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\langle 1,1,1,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}z^n\)</span></td>
<td><span class="math inline">\(\dfrac{1}{1-x}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\langle 1,-1,1,-1,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}(-1)^nz^n\)</span></td>
<td><span class="math inline">\(\dfrac{1}{1+z}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\langle1,0,1,0,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}z^{2n}\)</span></td>
<td><span class="math inline">\(\dfrac{1}{1-z^2}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\langle1,0,0,0,\cdots,1,0,0,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}z^{mn}\)</span></td>
<td><span class="math inline">\(\dfrac{1}{1-z^m}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\langle1,2,4,8,16,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}2^nz^n\)</span></td>
<td><span class="math inline">\(\dfrac{1}{1-2z}\)</span></td>
</tr>
</tbody>
</table></div>
<p>在封闭形式中我们能更好洞察系数的奥秘，而且也方便进行代数运算，这是生成函数的一大作用。</p>
<p>而关于二项式系数，我们也有一些生成函数（可以用二项式定理说明）：</p>
<table style="width:100%;">
<colgroup>
<col style="width: 50%"/>
<col style="width: 33%"/>
<col style="width: 16%"/>
</colgroup>
<thead>
<tr class="header">
<th>数列</th>
<th>OGF</th>
<th>封闭形式</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\langle 1,c,\binom c2,\binom c3,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}\binom cnz^n\)</span></td>
<td><span class="math inline">\((1+z)^c\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\langle 1,-c,\binom c2,-\binom c3,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}(-1)^n\binom cnz^n\)</span></td>
<td><span class="math inline">\((1-z)^c\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\langle \binom c0,\binom{c+1}{1},\binom{c+2}{2},\cdots\rangle\)</span></td>
<td><span class="math inline">\(\sum\limits_{n\ge 0}\binom{n+c}{n}\)</span></td>
<td><span class="math inline">\(\dfrac{1}{(1-z)^c}\)</span></td>
</tr>
</tbody>
</table>
<p>并且注意到，若我们需要提取一个生成函数的标号为偶数的项，那么就可以将 <span class="math inline">\(F(z)\)</span> 加上 <span class="math inline">\(F(-z)\)</span>，所以 <span class="math display">\[
\frac{F(z) + F(-z)}{2} = \sum_nf_{2n}z^{2n}
\]</span> 类似地，提取奇数项： <span class="math display">\[
\frac{F(z) - F(-z)}{2}= \sum_nf_{2n+1}z^{2n+1}
\]</span></p>
<p><del>如果要提取 <span class="math inline">\(k\)</span> 的倍数次的项则可以使用单位根反演，在此不表</del>。</p>
<h3 id="斐波那契数列">斐波那契数列</h3>
<p>这可能是很多人的生成函数入门题，但我将其放在了一个相对靠中间的位置，因为它其实也并没有那么的人畜无害。</p>
<blockquote>
<p>例题 <span class="math inline">\(3\)</span>：求斐波那契数列 <span class="math inline">\(\langle\mathrm{fib}_n\rangle\)</span> 的通项公式。 <span class="math display">\[
\mathrm{fib}_n = \begin{cases}
0&amp;n=0\\
1&amp;n=1\\
\mathrm{fib}_{n-1}+\mathrm{fib}_{n-2}&amp;n\ge 2
\end{cases}
\]</span></p>
</blockquote>
<p>将其写成生成函数的形式 <span class="math display">\[
F(z) = \mathrm{fib}_1z + \mathrm{fib}_2z^2 + \mathrm{fib}_3z^3 + \mathrm{fib}_4z^4+\cdots
\]</span> 注意到 <span class="math inline">\(\mathrm{fib}_n = \mathrm{fib}_{n-1} + \mathrm{fib}_{n-2}\)</span>，考虑将 <span class="math inline">\(F(z)\)</span> 进行一些平移操作以让 <span class="math inline">\(F(z)\)</span> <strong>自己表示自己</strong>（很像文化课的错位相减）： <span class="math display">\[
\begin{alignedat}{2}
F(z) &amp;= \mathrm{fib}_0 &amp;+ \mathrm{fib}_1z &amp;+ \mathrm{fib}_2z^2 + \mathrm{fib}_3z^3 + \cdots\\
zF(z) &amp;= &amp;\mathrm{fib}_0z &amp;+ \mathrm{fib}_1z^2 + \mathrm{fib}_2z^3+\cdots\\
z^2F(z) &amp;= &amp;&amp;+\mathrm{fib}_0z^2 + \mathrm{fib}_1z^3 +\cdots
\end{alignedat}
\]</span></p>
<p>于是不考虑第 <span class="math inline">\(0\)</span> 项和第 <span class="math inline">\(1\)</span> 项的话，后面都构成了美好的递推形式，考虑将后面两个式子相加： <span class="math display">\[
\begin{aligned}
(z+z^2)F(z) &amp;=\mathrm{fib}_0 + \mathrm{fib}_2z^2 + \mathrm{fib}_3z^3+ \cdots\\
&amp;= F(z) - \mathrm{fib}_1z\\
&amp;= F(z) - z\\
F(z) &amp;= \frac{z}{1-z-z^2}
\end{aligned}
\]</span> 最后一步是解一个关于 <span class="math inline">\(F(z)\)</span> 的方程，所以 <span class="math inline">\(F(z)\)</span> 的封闭形式得解，现在考虑将其展开。</p>
<p>根据骨牌密铺的方法，我们可以进行如下的展开： <span class="math display">\[
\begin{aligned}
F(z) &amp;= z\sum_{n\ge 0}(z + z^2)^n\\
&amp;= z\sum_{n\ge 0}\sum_{i\ge 0}\binom niz^iz^{2(n-i)}\\
&amp;= z\sum_{n\ge 0}\sum_{j}\binom{i+j}{j}z^iz^{2j}\\
&amp;= \sum_{n\ge 0}z^{n+1}\sum_{0\le i\le n}\binom{n-i}{i}
\end{aligned}
\]</span> 所以我们得到了一个关于斐波那契数列与二项式系数的恒等式： <span class="math display">\[
\mathrm{fib}_{n+1} = \sum_{i=0}^{n}\binom{n-i}{i}
\]</span> 但这并不是一个我们想要的简单结果，或者说跟我们熟知的“黄金分割”的形式不太一样。</p>
<p>回顾一下，我们注意到形如 <span class="math inline">\(\dfrac{A}{1-az}\)</span> 这样的式子是比较好展开来提取每一项的系数的——展开来就是 <span class="math inline">\(A + A(az) + A(az)^2 + \cdots = A\sum\limits_{n\ge 0}a^nz^n\)</span>。而 <span class="math inline">\(\dfrac{z}{1-z-z^2}\)</span> 下面是二次的，似乎可以表示为两个这样的一次分式之和，即 <span class="math display">\[
\dfrac{z}{1-z-z^2} = \frac{A}{1-az} + \frac{B}{1-bz}
\]</span> 于是 <span class="math display">\[
\begin{cases}
A(1-bz) + B(1-az) = z\\
1-z-z^2 = (1-az)(1-bz)
\end{cases}
\]</span> 先把下面那个式子处理一下得到 <span class="math inline">\(\left(z-\dfrac 1a\right)\left(z - \dfrac1b\right) = 1-z-z^2\)</span>，明显为两个根的形式，解等号右边的二次方程得到 <span class="math inline">\(\dfrac{-1\pm \sqrt 5}{2}\)</span>，所以 <span class="math inline">\(a = \dfrac{1+\sqrt 5}{2}\)</span>，<span class="math inline">\(b = \dfrac{1-\sqrt 5}{2}\)</span>。</p>
<p>这两个数有非常美妙的性质，在此不再加以说明，下文中令 <span class="math inline">\(\phi = \dfrac{1+\sqrt 5}{2}\)</span>，<span class="math inline">\(\hat\phi = \dfrac{1-\sqrt 5}{2}\)</span>。</p>
<p>把上面的方程拆开来，得到 <span class="math display">\[
\begin{cases}
A + B = 0\\
-A\hat\phi-B\phi = 1
\end{cases}
\]</span> 解得 <span class="math inline">\(A = \dfrac{1}{\sqrt 5}\)</span>，<span class="math inline">\(B = -\dfrac{1}{\sqrt 5}\)</span>。于是我们将 <span class="math inline">\(F(z)\)</span> 展开： <span class="math display">\[
\begin{aligned}
F(z) &amp;= \frac{A}{1-\phi z} + \frac{B}{1-\hat\phi z}\\
&amp;= A\left(1+\sum_{n\ge 0}\phi^n z^n\right) + B\left(1+\sum_{n\ge 0}\hat\phi^n z^n\right)\\
&amp;= \frac{1}{\sqrt 5}\sum_{n\ge 0}z^n(\phi^n - \hat\phi^n)
\end{aligned}
\]</span> 所以我们得到了其通项公式： <span class="math display">\[
\mathrm{fib}_n = \frac{1}{\sqrt 5}\left(\left(\frac{1 +\sqrt 5}{2}\right)^n - \left(\frac{1 -\sqrt 5}{2}\right)^n\right)
\]</span> （虽然有很多 <span class="math inline">\(\sqrt 5\)</span>，但神奇的是其在最后一定会得到一个整数）</p>
<blockquote>
<p>番外：特征根法解递推数列</p>
<p>隔壁数竞生最喜欢了（大雾）。</p>
<p>文化课课堂上，老师教过我们如何解一阶齐次线性递推数列（形如 <span class="math inline">\(f_n = pf_{n-1} + q\)</span>，<span class="math inline">\(f_1\)</span> 给定）的通项公式——将 <span class="math inline">\(q\)</span> 拆成两半移到左边来构造等比数列 <span class="math inline">\(\langle f_n - af_{n-1}\rangle\)</span>。</p>
<p>对于二阶的线性递推数列，我们可以采用类似的方法。对于 <span class="math inline">\(f_{n+1} = pf_{n} + qf_{n-1}\)</span>（<span class="math inline">\(f_1\)</span> 和 <span class="math inline">\(f_2\)</span> 给定），不妨尝试构造等比数列，即假设存在 <span class="math inline">\(a,b\)</span> 使得 <span class="math inline">\(f_{n+1} - af_n = b(f_{n}-af_{n-1})\)</span>。展开可以得到 <span class="math inline">\(\begin{cases}a+b = p\\ab=-q\end{cases}\)</span>。根据韦达定理，<span class="math inline">\(a,b\)</span> 是方程 <span class="math inline">\(x^2-px-q=0\)</span> 的两根，所以 <span class="math inline">\(\langle f_n - af_{n-1}\rangle\)</span> 是以 <span class="math inline">\(b\)</span> 为公比的等比数列，同理 <span class="math inline">\(\langle f_n - bf_{n-1}\rangle\)</span> 是以 <span class="math inline">\(a\)</span> 为公比的等比数列，那么。 <span class="math display">\[
\begin{cases}
f_n - af_{n-1} = b^{n-1}(f_2 - af_1)\\
f_n - bf_{n-1} = a^{n-1}(f_2 - bf_1)
\end{cases}
\]</span> 若 <span class="math inline">\(a\ne b\)</span>，上减下可以得到 <span class="math display">\[
f_n = \frac{1}{a-b}\left(a^{n-1}(f_2 - bf_1) - b^{n-1}(f_2 - af_1)\right)
\]</span> 发现其为两个等比数列相加的形式，而对于 <span class="math inline">\(a=b\)</span>， <span class="math display">\[
f_n = f_1b^{n-1}+(f_2 - bf_1)(n-1)b^{n-2}
\]</span> 本质上来看，我们称 <span class="math inline">\(x^2 = px + q\)</span> 为上面那个数列的特征方程，两个根称为其特征根。若无重根，则数列的通项可以表示为特征根的 <span class="math inline">\(n\)</span> 次方的线性组合。更多内容涉及到线性代数相关知识，这里略过不提。</p>
<p>对于斐波那契数列，其特征方程即为 <span class="math inline">\(z^2 = z + 1\)</span>，两根分别为 <span class="math inline">\(\phi\)</span> 和 <span class="math inline">\(\hat\phi\)</span>，发现能和上面的式子对应。</p>
</blockquote>
<h3 id="广义二项式定理">广义二项式定理</h3>
<p>事实表明，若我们将二项式系数 $n m $ 的定义扩展如下，则将是非常有用的！ <span class="math display">\[
\binom rk = \begin{cases}
\dfrac{r(r-1)\cdots (r-k+1)}{k(k-1)\cdots 1} = \dfrac{r^{\underline k}}{k!}&amp;k\ge 0,k\in\mathbb Z\\
0&amp;k&lt;0,k\in\mathbb Z
\end{cases}
\]</span> <span class="math inline">\(r\in\mathbb C\)</span>，注意到上面我使用了 <span class="math inline">\(r\)</span> 这个字母，意在强调 <span class="math inline">\(r\)</span> 不一定非要是非负整数了。然而 <span class="math inline">\(k\)</span> 还是最好要是整数——虽然也能给出一个合理的定义但是我们这里不加以阐释。</p>
<p>那么有广义二项式定理 <span class="math display">\[
(x+y)^{\alpha} = \sum_{n}\binom{\alpha}{n}x^ny^{\alpha - n}
\]</span> 其中 <span class="math inline">\(x,y,\alpha\in \mathbb R\)</span>，且 <span class="math inline">\(\left|\dfrac{x}{y}\right|&lt;1\)</span>（以让其收敛）。证明需要一定的分析基础，在此不加以说明（实际上是我不会）。</p>
<p>所以我们可以将形如 <span class="math inline">\((1-x)^{1/2}\)</span> 的形式幂级数加以展开，下文会具体说明。</p>
<p>另外，需要注意的是 <span class="math display">\[
\binom{r}{k} = (-1)^k\binom{k-r-1}{k}
\]</span> 这个技巧叫做上指标反转，可以通过观察杨辉三角在 <span class="math inline">\(n&lt;0\)</span> 时的形态得到。可以用于化简一些 <span class="math inline">\(r\)</span> 为负数的情况，非常好用。</p>
<h3 id="卡特兰数">卡特兰数</h3>
<p>卡特兰数的组合意义比较精彩有趣，但我们这里只研究如何使用生成函数得到其通项公式。</p>
<blockquote>
<p>例题 <span class="math inline">\(4\)</span>：求卡特兰数 <span class="math inline">\(\langle C_n\rangle\)</span> 的通项公式，其定义为 <span class="math display">\[
C_n = 
\begin{cases}
1&amp;n=0\\
\displaystyle\sum_{i=0}^{n-1}C_iC_{n-1-i} &amp;n\ge 1
\end{cases}
\]</span></p>
</blockquote>
<p><span class="math inline">\(\sum\limits_{i=0}^{n-1}C_iC_{n-1-i}\)</span> 非常像一个卷积的形式，我们试一下弄出其生成函数 <span class="math inline">\(F(z)\)</span> 然后乘上自己试试： <span class="math display">\[
\begin{aligned}
F(z)^2 &amp;= (C_0 + C_1z + C_2z^2 + \cdots)(C_0 + C_1z + C_2z^2 + \cdots)\\
&amp;= C_0^2 + (C_0C_1 + C_1C_0)z + (C_0C_2 + C_1C_1 + C_2C_0)z^2 + \cdots\\
&amp;= \sum_{n\ge 0}z^n\sum_{i=0}^nC_iC_{n-i}
\end{aligned}
\]</span> 发现其为 <span class="math inline">\(\langle C_{n+1}\rangle\)</span> 的生成函数，根据上文的平移运算法则我们得到 <span class="math display">\[
F(z)^2 = \frac{F(z)-C_0}{z}
\]</span> 所以 <span class="math display">\[
zF(z)^2 = F(z) - 1
\]</span> 解之， <span class="math display">\[
F(z) = \frac{1\pm\sqrt{1-4z}}{2z}
\]</span> 两个根取哪一个呢？按理来说 <span class="math inline">\(z\to 0\)</span> 时应该得到 <span class="math inline">\(F(z)\)</span> 的常数项，先将其分子有理化： <span class="math display">\[
F(z) = \frac{2}{1\mp\sqrt{1-4z}}
\]</span> 发现负号不太行，不收敛，所以 <span class="math display">\[
F(z) = \frac{1-\sqrt{1-4z}}{2z}
\]</span> 这就是卡特兰数的生成函数的封闭形式，现在考虑如何将其展开。发现分母不是像斐波那契数列那样的多项式形式，不方便分解分式后使用几何级数定理展开，但分子中有一个 <span class="math inline">\((1-4z)^{1/2}\)</span>，考虑使用广义二项式定理： <span class="math display">\[
\begin{aligned}
(1-4z)^{1/2} &amp;= \sum_{n\ge 0}\binom{1/2}{n}(-4z)^n\\
&amp;= 1 + \sum_{n\ge 1}\frac{\left(\frac12\right)^{\underline n}}{n!}(-4z)^n
\end{aligned}
\]</span> 把 <span class="math inline">\(\left(\dfrac{1}{2}\right)^{\underline n}\)</span> 化简： <span class="math display">\[
\begin{aligned}
\left(\dfrac{1}{2}\right)^{\underline n} &amp;= \frac{1}{2}\frac{-1}{2}\frac{-3}{2}\cdots\frac{-(2n-3)}{2}\\
&amp;= \frac{(-1)^{n+1}(2n-3)!!}{2^n}\\
&amp;= \frac{(-1)^{n+1}(2n-2)!}{2^n(2n-2)!!}\\
&amp;= \frac{(-1)^{n+1}(2n-2)!}{2^{2n-1}(n-1)!}
\end{aligned}
\]</span> 上面用到了双阶乘的化简技巧，即考虑将 <span class="math inline">\((2n-3)!!\)</span> 化成 <span class="math inline">\(\dfrac{(2n-2)!}{(2n-2)!!}\)</span>，下面可以变成 <span class="math inline">\(2^{n-1}(2n-2)!\)</span>。</p>
<p>那么回代一下，就 <span class="math display">\[
\begin{aligned}
(1-4z)^{1/2} &amp;= 1 + \sum_{n\ge 1}\frac{(-1)^{n+1}(2n-2)!}{2^{2n-1}(n-1)!n!}(-4)^nz^n\\
&amp;= 1 - \sum_{n\ge 1}\frac{(2n-1)!}{(n-1)!n!(2n-1)}2z^n\\
&amp;= 1 - \sum_{n\ge 1}\binom{2n-1}{n}\frac{2}{(2n-1)}z^n
\end{aligned}
\]</span> 所以 <span class="math display">\[
\begin{aligned}
F(z) &amp;= \frac{1-\sqrt{1-4z}}{2z}\\
&amp;= \frac{1}{2z}\sum_{n\ge 1}\binom{2n-1}{n}\frac{2}{(2n-1)}z^n\\
&amp;= \sum_{n\ge 1}\binom{2n-1}{n}\frac{1}{2n-1}z^{n-1}\\
&amp;= \sum_{n\ge 0}\binom{2n+1}{n+1}\frac{1}{2n+1}z^{n}\\
&amp;= \sum_{n\ge 0}\binom{2n}{n}\frac{1}{n+1}z^n
\end{aligned}
\]</span> 所以我们得到了卡特兰数的通项公式 <span class="math display">\[
C_n = \frac{1}{n+1}\binom{2n}{n}
\]</span></p>
<h2 id="无标号计数初步">无标号计数初步</h2>
<p>东拼西凑拉扯一点东西，orz 解析组合。</p>
<p>下文中的 OI 题目有些时候需要一些科技来处理生成函数的运算（如使用 NTT 进行卷积，牛顿迭代来做 <span class="math inline">\(\exp\)</span> 啥的，还有拉格朗日反演之类的），<del>其实道理就是你不会处理生成函数的话你写出来生成函数也屌用没有</del>。</p>
<p>但本文并不会讲具体的处理形式幂级数的科技<del>（不然就太他妈多了）</del>，可以去别的博客学习。</p>
<h3 id="组合对象与笛卡尔积">组合对象与笛卡尔积</h3>
<p>我们定义<strong>组合对象</strong>指满足某一性质的数，图，串等等可数对象（可以理解为同一类元素）。组合对象构成的集合称为<strong>组合类</strong>。</p>
<p>对于组合类 <span class="math inline">\(\mathcal A\)</span>，定义<strong>大小函数</strong> <span class="math inline">\(f:\mathcal A\to\mathbb N\)</span>，例如串长，图的节点数啥的就是大小函数，一般可以记作 <span class="math inline">\(f(x) = |x|\)</span>。</p>
<p>对于自然数 <span class="math inline">\(n\)</span>，定义<strong>计数序列</strong> <span class="math inline">\(A_n = |\{x\in\mathcal A: |x| = n\}|\)</span>，即大小为 <span class="math inline">\(n\)</span> 的元素有多少个，一般我们要求的就是 <span class="math inline">\(A_n\)</span> 的值。</p>
<p>记 <span class="math inline">\(\{(a_1,a_2,\cdots a_n):\forall 1\le i\le n,a_i\in\mathcal A_i\}\)</span> 为集合 <span class="math inline">\(\mathcal A_1,\mathcal A_2,\cdots \mathcal A_n\)</span> 的<strong>笛卡尔积</strong>，记作 <span class="math inline">\(\mathcal A_1\times\mathcal A_2\times\cdots\times\mathcal A_n\)</span>。也就是从每个组合类中取一个元素构成<strong>有序</strong>多元组的集合。相当于我们拿若干个组合类<strong>构造</strong>出了一个新的组合类。</p>
<p>例如对于 <span class="math inline">\(\mathcal A = \{a,b,c\},\mathcal B = \{1,2\}\)</span>，则 <span class="math inline">\(\mathcal A\times\mathcal B = \{(a,1),(a,2),(b,1),(b,2),(c,1),(c,2) \}\)</span>。不难发现 <span class="math inline">\(|\mathcal A\times\mathcal B| = |\mathcal A|\times |\mathcal B|\)</span>（这不就是乘法原理吗）。然后我们不妨为新的组合对象定义大小函数 <span class="math inline">\(|(a,b)| = |a| + |b|\)</span>，这是非常自然的，考虑一张 <span class="math inline">\(a\)</span> 个节点的图和一张 <span class="math inline">\(b\)</span> 个节点的图拼一起得到一张 <span class="math inline">\(a+b\)</span> 个节点的图。</p>
<p>更多关于组合结构符号化的东西可以参见<del>可能会有的后文</del>和别的博客，这里只是为了方便下文讲解才引入如上方法。</p>
<h3 id="ogf-是什么">OGF 是什么</h3>
<p>Ordinary generating function，普通生成函数，上文已给出其定义，可以发现其就是给数列的第 <span class="math inline">\(i\)</span> 项附上 <span class="math inline">\(z\)</span> 的 <span class="math inline">\(i\)</span> 次幂。</p>
<p>一个集合的普通生成函数可以理解为定义在其计数序列上的 OGF。</p>
<p>下面阐述其组合意义：</p>
<ul>
<li><p>加法代表<strong>不交集合的并</strong></p>
<p>设有组合类 <span class="math inline">\(\mathcal A,\mathcal B\)</span>，且 <span class="math inline">\(\mathcal A\cap \mathcal B = \varnothing\)</span>，则我们令 <span class="math inline">\(\mathcal C = \mathcal A + \mathcal B\)</span>，即不交集合的并。</p>
<p>那么根据加法原理，<span class="math inline">\(C_n = A_n + B_n\)</span>，所以 <span class="math inline">\(C(z) = A(z) + B(z)\)</span>。</p></li>
<li><p>乘法代表<strong>笛卡尔积</strong></p>
<p>其实上文在找零问题的时候有提到。</p>
<p>令组合类 <span class="math inline">\(\mathcal D = \mathcal A\times\mathcal B\)</span>。对于其计数序列 <span class="math inline">\(D_n\)</span>，我们可以这样考虑。实际上就是大小为 <span class="math inline">\(i\)</span> 的 <span class="math inline">\(\mathcal A\)</span> 中元素与大小为 <span class="math inline">\(j\)</span> 的 <span class="math inline">\(\mathcal B\)</span> 中元素打包形成了大小为 <span class="math inline">\(i + j\)</span> 的元素，我们枚举这个 <span class="math inline">\(i\)</span> 和 <span class="math inline">\(j\)</span> 能很容易得到 <span class="math display">\[
D_n = \sum_{i+j = n}A_iB_j
\]</span> 这正是加法卷积的定义，所以我们有 <span class="math display">\[
\mathcal D = \mathcal A\times\mathcal B \iff D(z) = A(z)B(z)
\]</span> 注意到其本质就是背包。</p></li>
</ul>
<p>坐稳，我们要加速了！</p>
<h3 id="ogf-的简单应用">OGF 的简单应用</h3>
<blockquote>
<p>例题 <span class="math inline">\(5\)</span>：有 <span class="math inline">\(m\)</span> 种不同物品，每种物品只有一个，问取 <span class="math inline">\(n\)</span> 件物品有多少种方法？</p>
<p>请从生成函数的角度来思考。</p>
</blockquote>
<p>每种物品都可以看作一个组合类，而本题相当于是将这 <span class="math inline">\(m\)</span> 件物品组合起来后，大小为 <span class="math inline">\(n\)</span> 的元素有多少种，不难发现其就是笛卡尔积。而注意到一件物品可以选/不选，即可以在 <span class="math inline">\(m\)</span> 元组中产生 <span class="math inline">\(0\)</span> 或 <span class="math inline">\(1\)</span> 的大小贡献。</p>
<p>所以对于单个物品，其生成函数为 <span class="math inline">\(1+z\)</span>，意味着第 <span class="math inline">\(i\)</span> 个组合类中，有“空”和“选一个”的两个元素，答案的生成函数即为这 <span class="math inline">\(m\)</span> 个 <span class="math inline">\(1+z\)</span> 的乘积。</p>
<p>所以最终的答案为 <span class="math inline">\([z^n](1+z)^m\)</span>，由二项式定理得答案为 <span class="math inline">\(\dbinom m n\)</span>。你可能看到这里会说，为什么不直接考虑组合数的定义就得到 <span class="math inline">\(\dbinom{m}{n}\)</span> 呢？我们拿着上面的思想来看看下面的题。</p>
<blockquote>
<p>例题 <span class="math inline">\(6\)</span>：有 <span class="math inline">\(m\)</span> 种不同物品，每种物品只有一个，第 <span class="math inline">\(i\)</span> 个物品的体积为 <span class="math inline">\(V_i\)</span>，问恰好装满体积为 <span class="math inline">\(n\)</span> 的背包的方案数。（0-1 背包）</p>
</blockquote>
<p>直接组合数？肯定没戏。</p>
<p>发现我们这里最好定义大小函数为物品的体积，那么第 <span class="math inline">\(i\)</span> 个物品的生成函数即为 <span class="math inline">\(1 + z^{V_i}\)</span>，所以答案为 <span class="math inline">\([z^n]\prod\limits_{i=1}^m(1+z^{V_i})\)</span>。</p>
<blockquote>
<p>例题 <span class="math inline">\(7\)</span>：有 <span class="math inline">\(m\)</span> 种不同物品，每种物品都有无限个，问取 <span class="math inline">\(n\)</span> 件物品有多少种方法？</p>
</blockquote>
<p>这个时候你会发现，每个组合类内都有无限个组合对象——“取 <span class="math inline">\(0\)</span> 个”、“取 <span class="math inline">\(1\)</span> 个”、……那么一个物品的生成函数则为 <span class="math inline">\(1+z+z^2+\cdots = \dfrac{1}{1-z}\)</span>（再次强调，计数序列的第 <span class="math inline">\(n\)</span> 项表示大小为 <span class="math inline">\(n\)</span> 的组合对象有多少个，生成函数在其之上定义）。</p>
<p>所以答案为 <span class="math inline">\([z^n]\dfrac{1}{(1-z)^m}\)</span>，这个东西可以使用广义二项式定理展开，这里就不展开了。</p>
<blockquote>
<p>例题 <span class="math inline">\(7\)</span>（砝码称重）：给定 <span class="math inline">\(1\)</span> 克，<span class="math inline">\(2\)</span> 克，<span class="math inline">\(3\)</span> 克和 <span class="math inline">\(4\)</span> 克砝码各一枚，问称出 <span class="math inline">\(1\sim 10\)</span> 克的方案分别有多少种？</p>
</blockquote>
<p>按照上面的分析方法，每个克数的砝码都是一个组合类，里面的对象只有两个（选和不选），所以其生成函数分别是 <span class="math inline">\(1+z\)</span>，<span class="math inline">\(1+z^2\)</span>，<span class="math inline">\(1+z^3\)</span>，<span class="math inline">\(1+z^4\)</span>。“选砝码称重”实际上也是笛卡尔积，其对应的生成函数为 <span class="math display">\[
\begin{aligned}
&amp;(1+z)(1+z^2)(1+z^3)(1+z^4)\\
=&amp;1+z+z^2+2z^3+2z^4+2z^5+2z^6+2z^7+z^8+z^9+z^{10}
\end{aligned}
\]</span> 系数对应答案。</p>
<blockquote>
<p>例题 <span class="math inline">\(8\)</span>：<a href="https://www.luogu.com.cn/problem/P2000">P2000 拯救世界</a></p>
<p>为了拯救世界，小 a 和 uim 决定召唤出 kkksc03 大神和 lzn 大神。根据古籍记载，召唤出任何一位大神，都需要使用金木水火土五种五行神石来摆一个特定的大阵。而在古籍中，记载是这样的：</p>
<p>kkksc03 大神召唤方法：</p>
<ul>
<li>金神石的块数必须是 <span class="math inline">\(6\)</span> 的倍数。</li>
<li>木神石最多用 <span class="math inline">\(9\)</span> 块。</li>
<li>水神石最多用 <span class="math inline">\(5\)</span> 块。</li>
<li>火神石的块数必须是 <span class="math inline">\(4\)</span> 的倍数。</li>
<li>土神石最多用 <span class="math inline">\(7\)</span> 块。</li>
</ul>
<p>lzn 大神召唤方法:</p>
<ul>
<li>金神石的块数必须是 <span class="math inline">\(2\)</span> 的倍数。</li>
<li>木神石最多用 <span class="math inline">\(1\)</span> 块。</li>
<li>水神石的块数必须是 <span class="math inline">\(8\)</span> 的倍数。</li>
<li>火神石的块数必须是 <span class="math inline">\(10\)</span> 的倍数。</li>
<li>土神石最多用 <span class="math inline">\(3\)</span> 块。</li>
</ul>
<p>现在是公元 1999 年 12 月 31 日，小 a 和 uim 从 00:00:00 开始找，一直找到 23:00:00，终于，还是没找到神石。不过，他们在回到家后在自家地窖里发现了一些奇怪的东西，一查古籍，哎呦妈呀，怎么不早点来呢？这里有一些混沌之石，可以通过敲击而衰变成五行神石。于是，他们拼命地敲，终于敲出了 <span class="math inline">\(n\)</span> 块神石，在 23:59:59 完成了两座大阵。然而，kkksc03 大神和 lzn 大神确实出现了，但是由于能量不够，无法发挥神力。只有把所有用 <span class="math inline">\(n\)</span> 块神石可能摆出的大阵都摆出来，才能给他们充满能量。这下小 a 和 uim 傻了眼了，赶快联系上了你，让你帮忙算一下，一共有多少种大阵。</p>
<p><span class="math inline">\(10^{99999}\leq n\lt 10^{100000}\)</span>，<span class="math inline">\(0.5\)</span> 秒。</p>
</blockquote>
<p>注意本题的题意似乎是用 <span class="math inline">\(n\)</span> 块混沌之石摆两个大阵，所以将拿来召唤 3k 和 lzn 的五行石分成 <span class="math inline">\(10\)</span> 个组合类，大小函数定义为选的个数，于是这十种生成函数即为 <span class="math display">\[
\begin{aligned}
1 + z^6 + z^{12} + \cdots &amp;= \frac{1}{1-z^6}\\
1+z^1 + \cdots + z^9 &amp;= \frac{1 - z^{10}}{1-z}\\
1 + z + \cdots + z^5 &amp;= \frac{1 - z^6}{1-z}\\
1 + z^4 + z^8 + \cdots &amp;= \frac{1}{1-z^4}\\
1 + z^1 + \cdots + z^7 &amp;= \frac{1-z^8}{1-z}\\
1+z^2+z^4 + \cdots &amp;= \frac{1}{1-z^2}\\
1+z&amp;=\frac{1-z^2}{1-z}\\
1 + z^8 + z^{16} + \cdots &amp;= \frac{1}{1-z^8}\\
1 + z^{10} + z^{20} + \cdots &amp;= \frac{1}{1-z^{10}}\\
1 + z + z^2 + z^3 &amp;= \frac{1-z^4}{1-z}
\end{aligned}
\]</span> 全部乘起来发现可以消消乐，最后得到 <span class="math inline">\(\dfrac{1}{(1-z)^5}\)</span>，即 <span class="math inline">\((1-z)^{-5}\)</span>，上广义二项式定理得 <span class="math display">\[
\sum_{n\ge 0}z^n(-1)^n\binom{-5}{n} =\sum_{n\ge 0}z^n\binom{n+4}{n} = \sum_{n\ge 0}z^n\frac{(n+1)(n+2)(n+3)(n+4)}{24}
\]</span> 需要 NTT 来高精乘法，好麻烦。</p>
<blockquote>
<p>例题 <span class="math inline">\(9\)</span>：<a href="https://www.luogu.com.cn/problem/CF438E">CF438E The Child and Binary Tree</a></p>
<p>现有一长度为 <span class="math inline">\(n\)</span> 的互异正整数序列 <span class="math inline">\(\{c_1, c_2, \cdots, c_n\}\)</span>。令二叉树的权值都从该序列中产生。对任意 <span class="math inline">\(1\le s\le m\)</span>，求出权值和恰好为 <span class="math inline">\(s\)</span> 的不同二叉树的个数，答案对 <span class="math inline">\(998244353\)</span> 取模。</p>
</blockquote>
<p>明示我们要将权值放在指数位上。设 <span class="math inline">\(f_x\)</span> 为权值为 <span class="math inline">\(x\)</span> 的二叉树个数，为了方便令 <span class="math inline">\(f_0 = 1\)</span>，则我们能设计出如下 dp： <span class="math display">\[
f_n = \begin{cases}
1&amp;n=0\\
\displaystyle\sum_{i=1}^{n-1}[i\in C]\sum_{j=1}^{n-i}f_jf_{n-i-j}&amp;n\ge 1
\end{cases}
\]</span> 意义：考虑枚举根的权值 <span class="math inline">\(i\)</span>，然后枚举分配给左右子树的权值。</p>
<p>发现这很像卷积的形式，我们不妨令 <span class="math inline">\(g_i = [i\in C]\)</span>，则 <span class="math display">\[
f_n = \sum_{i+j+k=n}g_if_jf_k
\]</span> 写成生成函数的形式就是 <span class="math display">\[
F(x) = 1 + G(x)F^2(x)
\]</span> （那个 <span class="math inline">\(1\)</span> 是为了修正 <span class="math inline">\(n=0\)</span> 的情况）。</p>
<p>所以 <span class="math display">\[
F(x) = \frac{1\pm\sqrt{1 - 4G(x)}}{2G(x)}
\]</span> 按上面卡特兰数的处理方法（分子有理化）舍去一根后，得到 <span class="math display">\[
\begin{aligned}
F(x) &amp;= \frac{1 - \sqrt{1 - 4G(x)}}{2G(x)}\\
&amp;= \frac{2}{1 + \sqrt{1 - 4G(x)}}
\end{aligned}
\]</span> 套一个开根和求逆的板子就做完了。</p>
<blockquote>
<p>例题 <span class="math inline">\(10\)</span>： <a href="https://www.luogu.com.cn/problem/P4451">P4451 [国家集训队]整数的lqp拆分</a></p>
<p>设斐波那契数列为 <span class="math inline">\(\langle \mathrm{fib}_n\rangle\)</span>，求 <span class="math display">\[
g(n) = \sum_{m&gt;0,a_i &gt; 0,\sum a_i = n}\prod_{i = 1}^m\mathrm{fib}_{a_i}
\]</span> 对 <span class="math inline">\(10^9 + 7\)</span> 取模的结果，<span class="math inline">\(n\le 10^{10000}\)</span>。</p>
</blockquote>
<p>式子的形式让我们考虑将斐波那契数列的下标放在指数位上，枚举一下 <span class="math inline">\(m\)</span> 不难发现其应该为 <span class="math display">\[
G(z) = \sum_m(\mathrm{fib}_1z + \mathrm{fib}_2z^2 + \cdots)^m
\]</span> 展开式中 <span class="math inline">\(z^n\)</span> 的系数。</p>
<p>所以这东西的生成函数就是 <span class="math inline">\(\dfrac{1}{1-F(z)}\)</span>，其中 <span class="math inline">\(F(z) = \dfrac{z}{1-z-z^2}\)</span>。虽然已经可以用多项式科技了，但是你发现 <span class="math inline">\(n\le 10^{10000}\)</span>，而且模数也不能 NTT，有点难绷。</p>
<p>考虑进行化简： <span class="math display">\[
\begin{aligned}
G(z) &amp;= \frac{1}{1-\dfrac{z}{1-z-z^2}}\\
&amp;= \frac{1-z-z^2}{1-2z-z^2}\\
&amp;= 1 + \frac{z}{1-2z-z^2}
\end{aligned}
\]</span> 像展开斐波那契的那样对右边那坨施以展开。<span class="math inline">\(1-2z-z^2\)</span> 的两根 <span class="math inline">\(a,b\)</span> 分别为 <span class="math inline">\(-1\pm\sqrt 2\)</span>，代入一下就发现 <span class="math display">\[
\begin{aligned}
\frac{z}{1-2z-z^2} &amp;= \frac{z}{(a-z)(b-z)}\\
&amp;= \frac{z}{b - a}\left(\frac{1}{a - z} - \frac{1}{b - z}\right)\\
&amp;= \frac{z}{b - a}\left(\frac{1}{a}\frac{1}{1 - \frac 1az} - \frac{1}{b}\frac{1}{1-\frac1bz}\right)\\
&amp;= \frac{z}{b - a}\left(\frac1a\sum_{k\ge 0}\frac{z^k}{a^k}- \frac1b\sum_{k\ge 0}\frac{z^k}{b^k}\right)\\
&amp;= \frac{1}{b-a}\left(\sum_{k\ge 1}\frac{z^k}{a^k} - \sum_{k\ge 1}\frac{z^k}{b^k}\right)
\end{aligned}
\]</span> 所以代入 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 的值， <span class="math display">\[
g(n) = \begin{cases}
1&amp;n=0\\
\displaystyle \frac{\sqrt2}{4}\left[(1 + \sqrt2)^n - (1 - \sqrt2)^n\right] &amp;n\ge 1
\end{cases}
\]</span> 取 <span class="math inline">\(\sqrt2\equiv 59713600\pmod{10^9+7}\)</span> 直接计算即可，<span class="math inline">\(n\)</span> 很大用欧拉定理降幂。</p>
<blockquote>
<p>例题 <span class="math inline">\(11\)</span>：<a href="https://www.luogu.com.cn/problem/CF917D">CF917D Stranger Trees</a></p>
<p>给定 <span class="math inline">\(n\)</span> 个节点的无根树 <span class="math inline">\(T\)</span>。对 <span class="math inline">\(0\le i\le n\)</span> 询问 <span class="math inline">\(K_n\)</span> 的生成树中有多少棵与 <span class="math inline">\(T\)</span> 恰有 <span class="math inline">\(n\)</span> 条边相同，<span class="math inline">\(n\le 100\)</span>，答案模 <span class="math inline">\(10^9 = 7\)</span>。</p>
</blockquote>
<p>发现“相同的边”这个满足背包计数，而矩阵树定理处理的是所有生成树的边权乘积之和，那么若我们将 <span class="math inline">\(T\)</span> 中边赋权 <span class="math inline">\(x\)</span>，其他边赋权 <span class="math inline">\(1\)</span>，那么矩阵树就可以跑出一个多项式来，这个多项式的每项系数就是答案。</p>
<p>虽然但是我们不是很好直接求出这个多项式，但是由于 <span class="math inline">\(n\)</span> 比较小所以我们可以代 <span class="math inline">\(0\sim n\)</span> 进去然后搞出 <span class="math inline">\(n+1\)</span> 个点值，高斯消元插值回来即可。</p>
<p>时间复杂度 <span class="math inline">\(O(n^4)\)</span>。</p>
<blockquote>
<p><a href="https://www.luogu.com.cn/discuss/304884">正确性保证 by Itst</a>：最后的系数矩阵为范德蒙矩阵，行列式在点值不同时一定不为 <span class="math inline">\(0\)</span>，故其总是满秩的。所以消元能将全部的系数插出来。</p>
</blockquote>
<blockquote>
<p>例题 <span class="math inline">\(12\)</span>：<a href="https://www.luogu.com.cn/problem/P4389">P4389 付公主的背包</a></p>
<p><span class="math inline">\(n\)</span> 种物品，每种物品有无限个，第 <span class="math inline">\(i\)</span> 种物品体积 <span class="math inline">\(v_i\)</span>，求对于所有 <span class="math inline">\(s\in[1,m]\)</span>，恰好装 <span class="math inline">\(s\)</span> 体积的方案数，<span class="math inline">\(m\le 10^5\)</span>，模 <span class="math inline">\(998244353\)</span>。</p>
</blockquote>
<p>完全背包问题，但是 <span class="math inline">\(10^5\)</span> 必然背不动。不难发现答案的生成函数为 <span class="math display">\[
\prod_{i=1}^n\frac{1}{1-x^{v_i}}
\]</span> 直接乘就暴毙了，遇到这种乘积式考虑取 <span class="math inline">\(\ln\)</span>，加起来再 <span class="math inline">\(\exp\)</span> 回去： <span class="math display">\[
\exp\left(\sum_{i=1}^n\ln\frac{1}{1-x^{v_i}}\right)
\]</span> 考虑如何求出 <span class="math inline">\(\ln\dfrac{1}{1-x}\)</span>。首先我们知道 <span class="math inline">\(\ln F(x) = \displaystyle\int \frac{F'(x)}{F(x)}\)</span>，而 <span class="math inline">\(\left(\dfrac{1}{1-x}\right)' = \dfrac{1}{(1-x)^2}\)</span>，除以 <span class="math inline">\(\dfrac{1}{1-x}\)</span> 又变回来了 <span class="math inline">\(\dfrac{1}{1-x}\)</span>，即 <span class="math inline">\(1+x+x^2+\cdots\)</span>，积分后变成 <span class="math inline">\(x+\dfrac12x^2+\dfrac13x^3 + \cdots\)</span>。所以 <span class="math display">\[
\ln\frac{1}{1-x} = \sum_{n\ge 1}\frac1nx^n
\]</span> 用 <span class="math inline">\(x^{v_i}\)</span> 替换 <span class="math inline">\(x\)</span> 得到 <span class="math display">\[
\ln\frac{1}{1-x^{v_i}} = \sum_{n\ge 1}\frac{1}{n}x^{nv_i}
\]</span> 只考虑 <span class="math inline">\(\bmod x^m\)</span> 意义下的话也就 <span class="math inline">\(m / v_i\)</span> 个有效项，所以处理出 <span class="math inline">\(\sum\ln\dfrac{1}{1-x^{v_i}}\)</span> 是调和 <span class="math inline">\(O(m\log m)\)</span> 的，最后 <span class="math inline">\(\exp\)</span> 回去即可。</p>
<h2 id="有标号计数初步">有标号计数初步</h2>
<h3 id="egf-的引入">EGF 的引入</h3>
<p>注意到，前面我们使用 OGF 解决的一般都为<strong>组合</strong>问题。</p>
<p>即我们在考虑两个拼接起来的组合对象的时候，我们没有考虑其<strong>标号</strong>问题。</p>
<p>而相应的，有组合问题就有<strong>排列</strong>问题，这意味着我们需要将元素的标号纳入考虑范畴。现在来看一道简单例题：</p>
<blockquote>
<p>例题 <span class="math inline">\(13\)</span>：有 <span class="math inline">\(n\)</span> 种物品，每件物品有 <span class="math inline">\(c_i\)</span> 个，问取出 <span class="math inline">\(m\)</span> 个物品排成一排的方案数，注意形如 <span class="math inline">\(\langle 1,1,2,3\rangle\)</span> 和 <span class="math inline">\(\langle 2,3,1,1\rangle\)</span> 是算作两种方案的。</p>
</blockquote>
<p>不妨按照我们刚开始学生成函数时的思路——考虑用 <span class="math inline">\(x_i\)</span> 来表示第 <span class="math inline">\(i\)</span> 个物品。</p>
<p>那么此处不妨假设 <span class="math inline">\(n = 3\)</span>，<span class="math inline">\(\langle c_1,c_2,c_3\rangle = \langle3,2,3\rangle\)</span>。为了方便我们考虑 <span class="math inline">\(m=4\)</span> 的情况。根据上面的思路，我们选不同的物品就是将其用乘法的形式表示，然后个数附到幂上面—— <span class="math display">\[
x_1^3x_2 + x_1^3x_3 + x_1^2x_2^2 + x_1^2x_3^2 + x_1x_3^3\\ + x_1^2x_2x_3 + x_1x_2^2x_3 + x_1x_2x_3^2 + x_2x_3^3+x_2^2x_3^2
\]</span> 如果我们不考虑排列方案，那么 <span class="math inline">\(x_1,x_2\)</span> 和 <span class="math inline">\(x_3\)</span> 是没有必要进行区分的，直接合并成若干倍的 <span class="math inline">\(z^4\)</span> 即可。但是这里要区分的原因就是不同的组合方案对应的排列数是不一样的。</p>
<p>回顾多重组合数 <span class="math inline">\(\dbinom{n}{n_1,n_2,\cdots}\)</span>，不难发现此处 <span class="math inline">\(x_1^3x_2\)</span> 对应的排列数即为 <span class="math inline">\(\dbinom{4}{3,1}\)</span>，<span class="math inline">\(x_1^2x_2x_3\)</span> 对应的排列数为 <span class="math inline">\(\dbinom{4}{2,1,1}\)</span>，等等……</p>
<p>而多重组合数的计算就是用 <span class="math inline">\(n!\)</span> 除以每一个 <span class="math inline">\(n_i!\)</span>。</p>
<p>那么上面的式子中，每一项对应的排列数，分子都是 <span class="math inline">\(4!\)</span>，分母都是对应数量的阶乘之积。那么若我们将 <span class="math inline">\(4!\)</span> 除到左边来，则会发现这个东西似乎是一个很好的形式……</p>
<p>那么对组合类 <span class="math inline">\(\mathcal A\)</span> 和其计数序列 <span class="math inline">\(\langle A_n\rangle\)</span>，定义其<strong>指数生成函数（EGF，exponential GF）</strong>为 <span class="math display">\[
\hat F(z) = \sum_{n\ge 0}A_n\frac{z^n}{n!}
\]</span> 此时其核函数为 <span class="math inline">\(k_n(z) = \dfrac{z^n}{n!}\)</span>。这个时候我们考虑上面那个问题的三个 EGF： <span class="math display">\[
\begin{aligned}
\hat F_1(z) &amp;= 1 + z + \frac{z^2}{2!} + \frac{z^3}{3!}\\
\hat F_2(z) &amp;= 1 + z + \frac{z^2}{2!}\\
\hat F_3(z) &amp;= 1 + z + \frac{z^2}{2!} + \frac{z^3}{3!}\\
\end{aligned}
\]</span> 乘在一起，不难发现选的个数对应的阶乘会出现在分母上，刚好能与上面我们的多重集组合数良好定义，下面我们扯一点 EGF 的性质。</p>
<h3 id="egf-的简单性质">EGF 的简单性质</h3>
<p>先解释一下这玩意为什么叫“指数”生成函数，我们考虑 <span class="math inline">\(\langle 1,1,\cdots\rangle\)</span> 的 EGF： <span class="math display">\[
\hat F(z) = 1 + z + \frac{z^2}{2!} + \frac{z^3}{3!} + \cdots = \sum_{n\ge0}\frac{z^n}{n!} = e^z
\]</span> （考虑 <span class="math inline">\(e^z\)</span> 的麦克劳林展开），所以这就是其名字来源。</p>
<p>对于 EGF 的组合意义，其加法依然是不相交集合的并，但是乘法对应的就是<strong>有标号对象的笛卡尔积</strong>。</p>
<p>给定两个组合对象 <span class="math inline">\(a,b\)</span>，各自内有着 <span class="math inline">\(1,2,\cdots,|a|\)</span> 和 <span class="math inline">\(1,2,\cdots,|b|\)</span> 的标号（可以理解为里面的 <span class="math inline">\(|a|\)</span> 个元素都是互异而需要加以区分的）。而拼接后得到的 <span class="math inline">\(c = (a,b)\)</span> 需要分配 <span class="math inline">\(1\sim c\)</span> 的标号，约定标号分配的时候 <span class="math inline">\(a,b\)</span> 内部顺序不变（以构成双射），那么给 <span class="math inline">\(c\)</span> 标号的方案数显然为 <span class="math inline">\(\dbinom{|a| + |b|}{|a|}\)</span>。</p>
<p>组合意义可以理解为，从里面选出 <span class="math inline">\(|a|\)</span> 个标号分配给 <span class="math inline">\(a\)</span>，或者考虑将两个部分进行归并。</p>
<p>所以你注意到，EGF 的乘法实际上是对应数列的<strong>二项加法卷积</strong>，即 <span class="math display">\[
\left[\frac{z^n}{n!}\right]\left(\hat F(z)\hat G(z)\right) = \sum_{x+y = n}\binom n x\left[\frac{z^x}{x!}\right]\hat F(z)\left[\frac{z^y}{y!}\right]\hat G(z)
\]</span> 设 <span class="math inline">\(\hat F(z)\hat G(z) = \hat H(z)\)</span> 的话，写清楚些就是 <span class="math display">\[
h_n = \sum_{x+y =n}\binom nx f_xg_y
\]</span> 即加法卷积的时候带了个二项式系数，证明则考虑把 EGF 里面的 <span class="math inline">\(n!\)</span> 提取出来然后当作普通 OGF 的乘法： <span class="math display">\[
\begin{aligned}
\frac{h_n}{n!} &amp;= \sum_{x+y=n}\frac{f_x}{x!}\frac{g_y}{y!}\\
h_n &amp;= \sum_{x+y=n}\frac{n!}{x!y!}f_xg_y\\
&amp;= \sum_{x+y = n}\binom n xf_xg_y
\end{aligned}
\]</span> 事实上这个所谓的二项式系数就是我们对于标号归并的一个方案数，如上文所述。</p>
<p>此外，我们有常见的若干 EGF：</p>
<div class="table-wrapper"><table>
<thead>
<tr class="header">
<th>数列</th>
<th>EGF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\langle 1,1,\cdots\rangle\)</span></td>
<td><span class="math inline">\(e^z\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\langle1,-1,1,-1,\cdots\rangle\)</span></td>
<td><span class="math inline">\(e^{-z}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\langle 1,c,c^2,c^3,\cdots\rangle\)</span></td>
<td><span class="math inline">\(e^{cz}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\langle 1,0,1,0,\cdots\rangle\)</span></td>
<td><span class="math inline">\(\dfrac{e^x + e^{-x}}{2}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\langle 1,a,a^{\underline 2},a^{\underline 3},\cdots\rangle\)</span></td>
<td><span class="math inline">\((1+x)^a\)</span></td>
</tr>
</tbody>
</table></div>
<p>第四个是和之前差不多的方法——将 <span class="math inline">\(e^x\)</span> 和 <span class="math inline">\(e^{-x}\)</span> 相加再除以二以只保留偶数次项，奇数次项其实是类似的。最后一个可以考虑组合数的定义：<span class="math inline">\(\dbinom r k = \dfrac{r^{\underline k}}{k!}\)</span>，<span class="math inline">\(k!\)</span> 提进 EGF 的核函数里面即可。</p>
<p>在使用 EGF 时，将其看作 OGF 来操作是完全没有问题的（事实上我们也是这么做的），但是<strong>一定要在算完之后乘上 <span class="math inline">\(n!\)</span> 以还原系数</strong>，很容易漏掉。</p>
<h3 id="egf-的简单应用">EGF 的简单应用</h3>
<blockquote>
<p>例题 <span class="math inline">\(14\)</span>：<a href="http://poj.org/problem?id=3734">POJ3734 Blocks</a></p>
<p>红黄蓝绿四种颜色填 <span class="math inline">\(n\)</span> 个有标号格子，要求红色和绿色的格子数为偶数，问有多少种涂色的方案。<span class="math inline">\(T\le 100\)</span>，<span class="math inline">\(n\le 10^9\)</span>。模 <span class="math inline">\(10007\)</span>。</p>
</blockquote>
<p>首先这是一个有标号问题，考虑将四种颜色的 EGF 乘起来然后找 <span class="math inline">\(\left[\dfrac{z^n}{n!}\right]\)</span>。</p>
<p>对于偶数个的限制，发现其就是 <span class="math inline">\(1 + \dfrac{z^2}{2!}+\dfrac{z^4}{4!} + \cdots = \dfrac{e^x + e^{-x}}{2}\)</span>。那么答案就是 <span class="math display">\[
\begin{aligned}
=&amp;\left[\dfrac{z^n}{n!}\right]\left(\frac{e^z + e^{-z}}{2}\right)^2(e^z)^2\\
=&amp;\left[\dfrac{z^n}{n!}\right]\dfrac{e^{4z} + 2e^{2z} + 1}{4}\\
=&amp;\frac{1}{4}(4^n + 2^{n+1})
\end{aligned}
\]</span></p>
<blockquote>
<p>例题 <span class="math inline">\(15\)</span>：<a href="https://www.luogu.com.cn/problem/P5219">P5219 无聊的水题 I</a></p>
<p>求 <span class="math inline">\(n\)</span> 个点的且度数最大为 <span class="math inline">\(m\)</span> 的有标号无根树的个数，<span class="math inline">\(2\le n,m\le 5\times 10^4\)</span>。</p>
</blockquote>
<p>计树类问题可以考虑 Prufer 序列，其将所有 <span class="math inline">\(n\)</span> 个节点的有标号无根树与长度为 <span class="math inline">\(n-2\)</span> 的序列建立了双射。</p>
<p>注意到 Prufer 序列中，度数为 <span class="math inline">\(m\)</span> 的点恰好出现了 <span class="math inline">\(m - 1\)</span> 次。所以我们要求的就是出现次数最多的数恰好出现了 <span class="math inline">\(m\)</span> 次的序列个数。</p>
<p>恰好出现不是很好处理，考虑用 <span class="math inline">\(\le m - 1\)</span> 的减去 <span class="math inline">\(\le m - 2\)</span> 的以得到答案。此时相当于变成上面的填颜色问题，注意我们这里有了限制，每种颜色的 EGF 是 <span class="math inline">\(\hat F(z) = \displaystyle\sum_{i=0}^m\dfrac{z^i}{i!}\)</span>，<span class="math inline">\(n\)</span> 种颜色的乘起来取 <span class="math inline">\(\left[\dfrac{z^{n-2}}{(n-2)!}\right]\hat F(z)^n\)</span> 即可。</p>
<p>多项式快速幂一下就行，<del>虽然我不知道为啥我的 exp 快速幂寄了</del>。</p>
<blockquote>
<p>例题 <span class="math inline">\(16\)</span>：<a href="https://www.luogu.com.cn/problem/P5339">P5339 [TJOI2019]唱、跳、rap和篮球</a></p>
<p>四种颜色染排列，<span class="math inline">\(1,2,3,4\)</span> 颜色分别有 <span class="math inline">\(a,b,c,d\)</span> 种，问有多少种染色方案，使得不存在位置 <span class="math inline">\(k\)</span> 满足 <span class="math inline">\(k,k+1,k+2,k+3\)</span> 上的颜色分别为 <span class="math inline">\(1,2,3,4\)</span>。（实在不想让鸡你太美污染文章）<span class="math inline">\(n\le1000;a,b,c,d\le 500\)</span>，一般通过 NTT 模数。</p>
</blockquote>
<p>不存在就很容斥。</p>
<p>考虑设至少有 <span class="math inline">\(k\)</span> 个鸡你太美的方案为 <span class="math inline">\(f_k\)</span>，恰好有 <span class="math inline">\(k\)</span> 个的为 <span class="math inline">\(g_k\)</span>，那么我们要求的就是 <span class="math inline">\(g_0\)</span>，进行二项式反的一个演得到 <span class="math display">\[
g_0 = \sum_{i\ge 0}(-1)^if_i
\]</span> 压力给到 <span class="math inline">\(f_i\)</span> 这边。发现设 <span class="math inline">\(S(a,b,c,d,n)\)</span> 表示四种颜色分别有 <span class="math inline">\(a,b,c,d\)</span> 个，随便摆 <span class="math inline">\(n\)</span> 个的方案数的话， <span class="math display">\[
f_k = \binom{n - 3k}{k}S(a - k, b - k, c - k, d - k, n - 4k)
\]</span> <span class="math inline">\(\dbinom{n-3k}{k}\)</span> 的意思是将 <span class="math inline">\(k\)</span> 个鸡你太美视作一个点，然后选 <span class="math inline">\(k\)</span> 个点来放鸡你太美。</p>
<p>后面那个东西，考虑设 <span class="math inline">\(\hat F_{n}(z) = \displaystyle\sum_{i=0}^n\dfrac{z^i}{i!}\)</span>，则根据 EGF 的排列计数得到 <span class="math display">\[
S(a,b,c,d,n) = \left[\frac{z^n}{n!}\right]\hat F_a(z)\hat F_b(z)\hat F_c(z)\hat F_d(z)
\]</span> 直接算复杂度 <span class="math inline">\(O(n^2\log n)\)</span>，可以通过某些手段做到 <span class="math inline">\(O(n^2)\)</span>。</p>
<blockquote>
<p>例题 <span class="math inline">\(17\)</span>：<a href="https://www.luogu.com.cn/problem/P5296">P5296 [北京省选集训2019]生成树计数</a></p>
<p>给定一个 <span class="math inline">\(n\)</span> 个点的带权无向完全图，求所有生成树的权值的 <span class="math inline">\(k\)</span> 次方之和，生成树的权值定义为边权之和。<span class="math inline">\(1\le n\le 30\)</span>，<span class="math inline">\(0\le k\le 30\)</span>，模 NTT。</p>
</blockquote>
<p>注意到矩阵树定理只能处理生成树权值定义为边权之积的情况，这里我们考虑进行一些转化。</p>
<p>而这里若 <span class="math inline">\(k = 0\)</span> 我们是可以简单矩阵树定理的，考虑 <span class="math inline">\(k = 1\)</span> 的情况：类似联合省选 20 AD2T3 的做法可以将边权变为若干一次函数相乘之积。</p>
<p>考虑寻找一个矩阵树里面能用乘积来进行的转移：假设当前这棵生成树权值为 <span class="math inline">\(w\)</span>，现要加 <span class="math inline">\(w_e\)</span> 的边： <span class="math display">\[
(w+w_e)^k = \sum_{j=0}^k\binom kjw^jw_e^{k-j}
\]</span> 二项卷积！弄成 EGF 的形式 <span class="math display">\[
e^{(w+w_e)z} = e^{wz}e^{w_ez}
\]</span> 于是将权值为 <span class="math inline">\(w_i\)</span> 的边重定义权值为 <span class="math inline">\(e^{w_ix}\)</span>，那么一棵生成树的权值就是所有 EGF 乘积中的 <span class="math inline">\([z^k/k!]\)</span>，然后就上矩阵树即可。也许在这里 <span class="math inline">\(O(n^2)\)</span> 暴力乘法和求逆会更快些。</p>
<h3 id="exp-的组合意义">exp 的组合意义</h3>
<p>考虑运算 <span class="math inline">\(\exp(F(z)) = \displaystyle\sum\limits_{n\ge 0}\dfrac{F(z)^n}{n!}\)</span>。乍一看平平无奇，实际上其有着非常妙的组合意义：生成集合。</p>
<blockquote>
<p>例题 <span class="math inline">\(18\)</span>：考虑若干有标号的小球，可以选若干放进盒子里。<strong>将 <span class="math inline">\(i\)</span> 个小球放进某个盒子里的方案数为 <span class="math inline">\(f_i\)</span>，特别地不能空放，即 <span class="math inline">\(f_0 = 0\)</span>。</strong></p>
<ul>
<li>问将 <span class="math inline">\(n\)</span> 个小球放入 <span class="math inline">\(k\)</span> 个无标号盒子的方案数？</li>
<li>问将 <span class="math inline">\(n\)</span> 个小球放入任意个无标号盒子的方案数？</li>
</ul>
</blockquote>
<p>考虑第一个问题，我们考虑其生成函数 <span class="math inline">\(G_k(z)\)</span>，很明显地 <span class="math display">\[
[z^n]G_k(z) = \frac{n!}{k!}\sum_{a_1 + a_2 + \cdots + a_k = n}\frac{f_{a_1}f_{a_2}\cdots f_{a_k}}{a_1!a_2!\cdots a_k!}
\]</span> 所以不妨令 EGF <span class="math inline">\(F(z) = \displaystyle\sum_{n\ge 0}\frac{f_nz^n}{n!}\)</span>，则 <span class="math display">\[
G_k(z) = \frac{1}{k!}F^k(z)
\]</span> 所以第二问的生成函数就是 <span class="math display">\[
G(z) = \sum_{k\ge 0}G_k(z) = \exp(F(z))
\]</span> 即我们拿有标号元素构成的集合来生成集族。有标号小球 -&gt; 包含小球的盒子 -&gt; 若干个盒子 就是一个很好的例子；有标号的点 -&gt; 有标号无向连通图 -&gt; 有标号无向一般图，有标号点 -&gt; 有标号无根树 -&gt; 有标号森林 也是类似的思路。</p>
<p>展开式的意义直观理解就是枚举有多少个元素，然后多次拼接（卷积），除以 <span class="math inline">\(k!\)</span> 是因为元素间无序。</p>
<blockquote>
<p>例题 <span class="math inline">\(19\)</span>：<a href="https://www.luogu.com.cn/problem/P4841">P4841 [集训队作业2013]城市规划</a></p>
<p>问 <span class="math inline">\(n\)</span> 个点的有标号无向连通图的个数，一般 NTT 范围。</p>
</blockquote>
<p>根据上文的思路，一般图的个数的生成函数 为 连通图的生成函数 的 exp，而一般图个数的 EGF 又是很好求的：<span class="math inline">\(g_n = 2^{\binom n 2}\)</span>，所以取个 <span class="math inline">\(\ln\)</span> 即可。（不要忘记乘 <span class="math inline">\(n!\)</span>，他是 EGF）</p>
<blockquote>
<p>例题 <span class="math inline">\(20\)</span>：<a href="https://www.luogu.com.cn/problem/P5162">P5162 WD与积木</a></p>
<p>将 <span class="math inline">\(1\sim n\)</span> 划分为若干<strong>有序</strong>集合，问所有不同分割方法中，集合个数的期望。<span class="math inline">\(n\le 10^5\)</span>，模 <span class="math inline">\(998244353\)</span>。</p>
</blockquote>
<p>如果先考虑分割方案的总数，则对于一个集合，EGF 应该为 <span class="math inline">\(F(z) = e^z - 1\)</span>。但是是若干个有序集合，所以下面就不除掉阶乘了，于是根据几何级数定理得到 <span class="math inline">\(\dfrac{1}{2 - e^z}\)</span>。</p>
<p>而我们要求的是集合个数的期望，所以需要求出每种方案中集合个数的总和，发现是 <span class="math inline">\(\sum\limits_{n\ge 0}nF^n(z)\)</span>。</p>
<p>对于 <span class="math inline">\(\sum\limits_{n\ge 0}nz^n\)</span>，可以对其施扰动法：<span class="math inline">\((1-z)\sum\limits_{n\ge 0} nz^n = \sum\limits_{n\ge 0} nz^n - \sum\limits_{n\ge 1} (n-1)z^n = \dfrac{z}{1-z}\)</span>。所以答案是 <span class="math inline">\(\dfrac{F(z)}{(1-F(z))^2} = \dfrac{e^z - 1}{(2-e^z)^2}\)</span>。</p>
<p>当然伟大的 Asd_Okuu 队长提出了可以使用求导证明： <span class="math display">\[
\begin{aligned}
\left(\frac{1}{1-z}\right)'&amp;=\sum_{n\ge 0}(n+1)z^n\\
\frac{1}{(1-z)^2}&amp;=\sum_{n\ge 0}nz^n + \frac{1}{1-z}\\
\sum_{n\ge 0}nz^n &amp;= \frac{z}{(1-z)^2}
\end{aligned}
\]</span> 所以直接写个求逆就完事了。</p>
<p>对于无标号的情况即 Euler 变换，下文可能会讲吧。</p>
<h2 id="二项式系数的补充">二项式系数的补充</h2>
<h2 id="特殊数列">特殊数列</h2>
</section>
<footer class="article-footer">
<section class="article-tags">
<a href="/tags/OI/">OI</a>
<a href="/tags/note/">笔记</a>
<a href="/tags/gf/">生成函数</a>
</section>
<section class="article-copyright">
<svg class="icon icon-tabler icon-tabler-copyright" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M14.5 9a3.5 4 0 1 0 0 6"></path>
</svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js">
</script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
</article>
<aside class="related-contents--wrapper">
<h2 class="section-title">相关文章</h2>
<div class="related-contents">
<div class="flex article-list--tile">
<article class="has-image">
<a href="/note-poly/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg23.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg23.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">多项式全家桶笔记</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-set-power-series/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">集合幂级数胡扯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-linear-basis/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">线性基学习笔记</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-wqs/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">wqs 二分学习笔记</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-builtin/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">__builtin 系列函数总结</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class="site-footer">
<section class="copyright">
        © 
        
            2019 - 
        
        2024 清烛的博客
    </section>
<section class="powerby">
        Built with <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a> <br/>
        主题 <b><a data-version="3.11.0" href="https://github.com/CaiJimmy/hugo-theme-stack" rel="noopener" target="_blank">Stack</a></b> 由 <a href="https://jimmycai.com" rel="noopener" target="_blank">Jimmy</a> 设计
    </section>
</footer>
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">
<div class="pswp__bg"></div>
<div class="pswp__scroll-wrap">
<div class="pswp__container">
<div class="pswp__item"></div>
<div class="pswp__item"></div>
<div class="pswp__item"></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class="pswp__top-bar">
<div class="pswp__counter"></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class="pswp__preloader">
<div class="pswp__preloader__icn">
<div class="pswp__preloader__cut">
<div class="pswp__preloader__donut"></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class="pswp__share-tooltip"></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class="pswp__caption">
<div class="pswp__caption__center"></div>
</div>
</div>
</div>
</div><script crossorigin="anonymous" defer="" integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js">
</script><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" rel="stylesheet"/><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" rel="stylesheet"/>
</main>
</div>
<script crossorigin="anonymous" integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js">
</script><script defer="" src="/ts/main.js" type="text/javascript"></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
</body>
</html>

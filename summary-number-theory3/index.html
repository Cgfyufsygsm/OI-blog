<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="è«æ¯”ä¹Œæ–¯åæ¼”ç›¸å…³ è­¦å‘Šï¼šæœ¬èŠ‚å¯¹æ¨å¼å­èƒ½åŠ›è¦æ±‚è¾ƒé«˜ã€‚
è¿™ä¸€éƒ¨åˆ†å†…å®¹åœ¨ OI ä¸­çš„è€ƒå¯Ÿä»¥å¼å­çš„åŒ–ç®€æ±‚å€¼ä¸ºä¸»ã€‚
æ•´é™¤åˆ†å— æ˜¯å­¦ä¹ è«æ¯”ä¹Œæ–¯åæ¼”å‰çš„å¾ˆé‡è¦çš„å‰ç½®çŸ¥è¯†ã€‚
æ˜¯åŸºäº \(\lfloor n / i\rfloor\) æœ€å¤šåªæœ‰ \(\sqrt n\) ç§å–å€¼çš„ã€‚å¯ä»¥åŠ å¿«è¿ç®—ã€‚å°†ç›¸åŒçš„ \(\lfloor n / i\rfloor\) åˆåœ¨ä¸€èµ·ï¼Œä½“ç°äº†åˆ†å—æ€æƒ³ã€‚
åŸºæœ¬å½¢å¼ ä¾‹é¢˜ï¼šUVA11526 H(n)
\(T\) ç»„è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®š \(n&amp;lt; 2^{31}\)ï¼Œæ±‚ \(\displaystyle\sum_{i=1}^n\left\lfloor\frac{n}{i}\right\rfloor\)ã€‚
é¦–å…ˆ \(O(n)\) åšæ³•è‚¯å®šæ˜¯å¯„äº†çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚æ‰“ä¸ªè¡¨å‘ç°å¾ˆå¤šæ®µ \(\lfloor n / i\rfloor\) çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸‹é¢è¯´æ˜è¿™äº›ä¸åŒçš„å€¼åªæœ‰ \(O(\sqrt n)\) ç§ã€‚
è¯æ˜ï¼šå¯¹äº \(i\le \sqrt n\)ï¼Œ\(\lfloor\frac n i\rfloor\) è‡³å¤šæœ‰ \(\sqrt n\) ä¸ªå–å€¼ï¼Œç„¶åå¯¹äº \(i\gt \sqrt n\)ï¼Œ\(\lfloor \frac n i\rfloor\lt \sqrt n\)ï¼Œæ‰€ä»¥ \(\lfloor \frac n i\rfloor\) ä¹Ÿè‡³å¤šæœ‰ \(\sqrt n\) ç§å–å€¼ã€‚æ‰€ä»¥ \(\lfloor\frac n i\rfloor\) è‡³å¤šæœ‰ \(2\sqrt n\) ç§å–å€¼ã€‚" name="description"/><title>æ•°è®ºå¤ä¹  3ï¼ˆåæ¼”ä¸ç­›æ³•ï¼‰</title>
<link href="https://oi.imyangty.com/summary-number-theory3/" rel="canonical"/>
<link href="/scss/style.min.a5821f3d3ab84ce5a0ac21477e347a2e0ca00292e398d16c5e8e36ded6e35a23.css" rel="stylesheet"/><meta content="æ•°è®ºå¤ä¹  3ï¼ˆåæ¼”ä¸ç­›æ³•ï¼‰" property="og:title"/>
<meta content="è«æ¯”ä¹Œæ–¯åæ¼”ç›¸å…³ è­¦å‘Šï¼šæœ¬èŠ‚å¯¹æ¨å¼å­èƒ½åŠ›è¦æ±‚è¾ƒé«˜ã€‚
è¿™ä¸€éƒ¨åˆ†å†…å®¹åœ¨ OI ä¸­çš„è€ƒå¯Ÿä»¥å¼å­çš„åŒ–ç®€æ±‚å€¼ä¸ºä¸»ã€‚
æ•´é™¤åˆ†å— æ˜¯å­¦ä¹ è«æ¯”ä¹Œæ–¯åæ¼”å‰çš„å¾ˆé‡è¦çš„å‰ç½®çŸ¥è¯†ã€‚
æ˜¯åŸºäº \(\lfloor n / i\rfloor\) æœ€å¤šåªæœ‰ \(\sqrt n\) ç§å–å€¼çš„ã€‚å¯ä»¥åŠ å¿«è¿ç®—ã€‚å°†ç›¸åŒçš„ \(\lfloor n / i\rfloor\) åˆåœ¨ä¸€èµ·ï¼Œä½“ç°äº†åˆ†å—æ€æƒ³ã€‚
åŸºæœ¬å½¢å¼ ä¾‹é¢˜ï¼šUVA11526 H(n)
\(T\) ç»„è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®š \(n&amp;lt; 2^{31}\)ï¼Œæ±‚ \(\displaystyle\sum_{i=1}^n\left\lfloor\frac{n}{i}\right\rfloor\)ã€‚
é¦–å…ˆ \(O(n)\) åšæ³•è‚¯å®šæ˜¯å¯„äº†çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚æ‰“ä¸ªè¡¨å‘ç°å¾ˆå¤šæ®µ \(\lfloor n / i\rfloor\) çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸‹é¢è¯´æ˜è¿™äº›ä¸åŒçš„å€¼åªæœ‰ \(O(\sqrt n)\) ç§ã€‚
è¯æ˜ï¼šå¯¹äº \(i\le \sqrt n\)ï¼Œ\(\lfloor\frac n i\rfloor\) è‡³å¤šæœ‰ \(\sqrt n\) ä¸ªå–å€¼ï¼Œç„¶åå¯¹äº \(i\gt \sqrt n\)ï¼Œ\(\lfloor \frac n i\rfloor\lt \sqrt n\)ï¼Œæ‰€ä»¥ \(\lfloor \frac n i\rfloor\) ä¹Ÿè‡³å¤šæœ‰ \(\sqrt n\) ç§å–å€¼ã€‚æ‰€ä»¥ \(\lfloor\frac n i\rfloor\) è‡³å¤šæœ‰ \(2\sqrt n\) ç§å–å€¼ã€‚" property="og:description"/>
<meta content="https://oi.imyangty.com/summary-number-theory3/" property="og:url"/>
<meta content="æ¸…çƒ›çš„åšå®¢" property="og:site_name"/>
<meta content="article" property="og:type"/><meta content="Post" property="article:section"/><meta content="OI" property="article:tag"/><meta content="ç¬”è®°" property="article:tag"/><meta content="2021-08-12T14:49:34+08:00" property="article:published_time"/><meta content="2021-08-12T14:49:34+08:00" property="article:modified_time"/><meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg16.webp" property="og:image"/>
<meta content="æ•°è®ºå¤ä¹  3ï¼ˆåæ¼”ä¸ç­›æ³•ï¼‰" name="twitter:title"/>
<meta content="è«æ¯”ä¹Œæ–¯åæ¼”ç›¸å…³ è­¦å‘Šï¼šæœ¬èŠ‚å¯¹æ¨å¼å­èƒ½åŠ›è¦æ±‚è¾ƒé«˜ã€‚
è¿™ä¸€éƒ¨åˆ†å†…å®¹åœ¨ OI ä¸­çš„è€ƒå¯Ÿä»¥å¼å­çš„åŒ–ç®€æ±‚å€¼ä¸ºä¸»ã€‚
æ•´é™¤åˆ†å— æ˜¯å­¦ä¹ è«æ¯”ä¹Œæ–¯åæ¼”å‰çš„å¾ˆé‡è¦çš„å‰ç½®çŸ¥è¯†ã€‚
æ˜¯åŸºäº \(\lfloor n / i\rfloor\) æœ€å¤šåªæœ‰ \(\sqrt n\) ç§å–å€¼çš„ã€‚å¯ä»¥åŠ å¿«è¿ç®—ã€‚å°†ç›¸åŒçš„ \(\lfloor n / i\rfloor\) åˆåœ¨ä¸€èµ·ï¼Œä½“ç°äº†åˆ†å—æ€æƒ³ã€‚
åŸºæœ¬å½¢å¼ ä¾‹é¢˜ï¼šUVA11526 H(n)
\(T\) ç»„è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®š \(n&amp;lt; 2^{31}\)ï¼Œæ±‚ \(\displaystyle\sum_{i=1}^n\left\lfloor\frac{n}{i}\right\rfloor\)ã€‚
é¦–å…ˆ \(O(n)\) åšæ³•è‚¯å®šæ˜¯å¯„äº†çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚æ‰“ä¸ªè¡¨å‘ç°å¾ˆå¤šæ®µ \(\lfloor n / i\rfloor\) çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸‹é¢è¯´æ˜è¿™äº›ä¸åŒçš„å€¼åªæœ‰ \(O(\sqrt n)\) ç§ã€‚
è¯æ˜ï¼šå¯¹äº \(i\le \sqrt n\)ï¼Œ\(\lfloor\frac n i\rfloor\) è‡³å¤šæœ‰ \(\sqrt n\) ä¸ªå–å€¼ï¼Œç„¶åå¯¹äº \(i\gt \sqrt n\)ï¼Œ\(\lfloor \frac n i\rfloor\lt \sqrt n\)ï¼Œæ‰€ä»¥ \(\lfloor \frac n i\rfloor\) ä¹Ÿè‡³å¤šæœ‰ \(\sqrt n\) ç§å–å€¼ã€‚æ‰€ä»¥ \(\lfloor\frac n i\rfloor\) è‡³å¤šæœ‰ \(2\sqrt n\) ç§å–å€¼ã€‚" name="twitter:description"/><meta content="summary_large_image" name="twitter:card"/>
<meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg16.webp" name="twitter:image"/>
<link href="https://q1.qlogo.cn/g?b=qq&amp;nk=375836877&amp;s=5" rel="shortcut icon"/>
<link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/github-dark-dimmed.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="article-page">
<script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button aria-label="åˆ‡æ¢èœå•" class="hamburger hamburger--spin" id="toggle-menu" type="button">
<span class="hamburger-box">
<span class="hamburger-inner"></span>
</span>
</button>
<header>
<figure class="site-avatar">
<a href="/">
<img alt="Avatar" class="site-logo" height="300" loading="lazy" src="/img/avatar_huea3ce2119467b51fdd2a81393644a76d_51594_300x0_resize_q75_box.jpg" width="300"/>
</a>
<span class="emoji">ğŸ˜…</span>
</figure>
<div class="site-meta">
<h1 class="site-name"><a href="/">æ¸…çƒ›çš„åšå®¢</a></h1>
<h2 class="site-description">çƒŸç«å·²è°¢ï¼Œç¬™æ­Œæœªåœ</h2>
</div>
</header><ol class="social-menu">
<li>
<a href="mailto:i@imyangty.com" target="_blank" title="email">
<svg class="icon icon-tabler icon-tabler-mail" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<rect height="14" rx="2" width="18" x="3" y="5"></rect>
<polyline points="3 7 12 13 21 7"></polyline>
</svg>
</a>
</li>
<li>
<a href="https://github.com/Cgfyufsygsm" target="_blank" title="GitHub">
<svg class="icon icon-tabler icon-tabler-brand-github" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
</a>
</li>
<li>
<a href="https://t.me/Cgfyufsygsm" target="_blank" title="Telegram">
<svg class="icon icon-tabler icon-tabler-brand-telegram" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"></path>
</svg>
</a>
</li>
<li>
<a href="https://twitter.com/Cgfyufsygsm" target="_blank" title="Twitter">
<svg class="icon icon-tabler icon-tabler-brand-twitter" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
</svg>
</a>
</li>
</ol><ol class="menu" id="main-menu">
<li>
<a href="/">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»é¡µ</span>
</a>
</li>
<li>
<a href="/about/">
<svg class="icon icon-tabler icon-tabler-user" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="7" r="4"></circle>
<path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
</svg>
<span>å…³äº</span>
</a>
</li>
<li>
<a href="/idx/">
<svg class="icon icon-tabler icon-tabler-hash" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<line x1="5" x2="19" y1="9" y2="9"></line>
<line x1="5" x2="19" y1="15" y2="15"></line>
<line x1="11" x2="7" y1="4" y2="20"></line>
<line x1="17" x2="13" y1="4" y2="20"></line>
</svg>
<span>å¯¼èˆª</span>
</a>
</li>
<li>
<a href="/archives/">
<svg class="icon icon-tabler icon-tabler-archive" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<rect height="4" rx="2" width="18" x="3" y="4"></rect>
<path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10"></path>
<line x1="10" x2="14" y1="12" y2="12"></line>
</svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href="/search/">
<svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="10" cy="10" r="7"></circle>
<line x1="21" x2="15" y1="21" y2="15"></line>
</svg>
<span>æœç´¢</span>
</a>
</li>
<li>
<a href="/friends/">
<svg class="icon icon-tabler icon-tabler-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path>
<path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path>
</svg>
<span>å‹é“¾</span>
</a>
</li>
<li>
<a href="https://blog.imyangty.com" target="_blank">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»åšå®¢</span>
</a>
</li>
<div class="menu-bottom-section">
<li id="dark-mode-toggle">
<svg class="icon icon-tabler icon-tabler-toggle-left" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="8" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="16" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<span>æš—è‰²æ¨¡å¼</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class="has-image main-article">
<header class="article-header">
<div class="article-image">
<a href="/summary-number-theory3/">
<img alt="Featured image of post æ•°è®ºå¤ä¹  3ï¼ˆåæ¼”ä¸ç­›æ³•ï¼‰" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg16.webp"/>
</a>
</div>
<div class="article-details">
<header class="article-category">
<a href="/categories/oi/">
                OI
            </a>
<a href="/categories/summary/">
                æ€»ç»“
            </a>
</header>
<div class="article-title-wrapper">
<h2 class="article-title">
<a href="/summary-number-theory3/">æ•°è®ºå¤ä¹  3ï¼ˆåæ¼”ä¸ç­›æ³•ï¼‰</a>
</h2>
</div>
<footer class="article-time">
<div>
<svg class="icon icon-tabler icon-tabler-calendar-time" fill="none" height="56" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="56" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4"></path>
<circle cx="18" cy="18" r="4"></circle>
<path d="M15 3v4"></path>
<path d="M7 3v4"></path>
<path d="M3 11h16"></path>
<path d="M18 16.496v1.504l1 1"></path>
</svg>
<time class="article-time--published">Aug 12, 2021</time>
</div>
<div>
<svg class="icon icon-tabler icon-tabler-clock" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<polyline points="12 7 12 12 15 15"></polyline>
</svg>
<time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 17 åˆ†é’Ÿ
                </time>
</div>
</footer>
</div>
</header>
<section class="article-content">
<h2 id="è«æ¯”ä¹Œæ–¯åæ¼”ç›¸å…³">è«æ¯”ä¹Œæ–¯åæ¼”ç›¸å…³</h2>
<p>è­¦å‘Šï¼šæœ¬èŠ‚å¯¹æ¨å¼å­èƒ½åŠ›è¦æ±‚è¾ƒé«˜ã€‚</p>
<p>è¿™ä¸€éƒ¨åˆ†å†…å®¹åœ¨ OI ä¸­çš„è€ƒå¯Ÿä»¥å¼å­çš„åŒ–ç®€æ±‚å€¼ä¸ºä¸»ã€‚</p>
<h3 id="æ•´é™¤åˆ†å—">æ•´é™¤åˆ†å—</h3>
<p>æ˜¯å­¦ä¹ è«æ¯”ä¹Œæ–¯åæ¼”å‰çš„å¾ˆé‡è¦çš„å‰ç½®çŸ¥è¯†ã€‚</p>
<p>æ˜¯åŸºäº <span class="math inline">\(\lfloor n / i\rfloor\)</span> æœ€å¤šåªæœ‰ <span class="math inline">\(\sqrt n\)</span> ç§å–å€¼çš„ã€‚å¯ä»¥åŠ å¿«è¿ç®—ã€‚å°†ç›¸åŒçš„ <span class="math inline">\(\lfloor n / i\rfloor\)</span> åˆåœ¨ä¸€èµ·ï¼Œä½“ç°äº†åˆ†å—æ€æƒ³ã€‚</p>
<h4 id="åŸºæœ¬å½¢å¼">åŸºæœ¬å½¢å¼</h4>
<blockquote>
<p>ä¾‹é¢˜ï¼š<a href="https://www.luogu.com.cn/problem/UVA11526">UVA11526 H(n)</a></p>
<p><span class="math inline">\(T\)</span> ç»„è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®š <span class="math inline">\(n&lt; 2^{31}\)</span>ï¼Œæ±‚ <span class="math inline">\(\displaystyle\sum_{i=1}^n\left\lfloor\frac{n}{i}\right\rfloor\)</span>ã€‚</p>
</blockquote>
<p>é¦–å…ˆ <span class="math inline">\(O(n)\)</span> åšæ³•è‚¯å®šæ˜¯å¯„äº†çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚æ‰“ä¸ªè¡¨å‘ç°å¾ˆå¤šæ®µ <span class="math inline">\(\lfloor n / i\rfloor\)</span> çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸‹é¢è¯´æ˜è¿™äº›ä¸åŒçš„å€¼åªæœ‰ <span class="math inline">\(O(\sqrt n)\)</span> ç§ã€‚</p>
<p>è¯æ˜ï¼šå¯¹äº <span class="math inline">\(i\le \sqrt n\)</span>ï¼Œ<span class="math inline">\(\lfloor\frac n i\rfloor\)</span> è‡³å¤šæœ‰ <span class="math inline">\(\sqrt n\)</span> ä¸ªå–å€¼ï¼Œç„¶åå¯¹äº <span class="math inline">\(i\gt \sqrt n\)</span>ï¼Œ<span class="math inline">\(\lfloor \frac n i\rfloor\lt \sqrt n\)</span>ï¼Œæ‰€ä»¥ <span class="math inline">\(\lfloor \frac n i\rfloor\)</span> ä¹Ÿè‡³å¤šæœ‰ <span class="math inline">\(\sqrt n\)</span> ç§å–å€¼ã€‚æ‰€ä»¥ <span class="math inline">\(\lfloor\frac n i\rfloor\)</span> è‡³å¤šæœ‰ <span class="math inline">\(2\sqrt n\)</span> ç§å–å€¼ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨è€ƒè™‘ç»™å®š <span class="math inline">\(l\)</span>ï¼Œè¦æ±‚ç¡®å®šå‡ºåˆ†å—å³ç«¯ç‚¹ <span class="math inline">\(r\)</span> æ»¡è¶³ <span class="math inline">\(\forall i\in[l,r]\)</span> éƒ½æœ‰ <span class="math inline">\(\lfloor n / i\rfloor = \lfloor n / l\rfloor\)</span>ï¼Œä¸” <span class="math inline">\(r\)</span> æœ€å¤§ï¼Œé‚£ä¹ˆå°±æ˜¯å¦‚ä¸‹é™åˆ¶æ¡ä»¶ï¼š <span class="math display">\[
\begin{cases}
k = \lfloor n / l\rfloor\\
r = \displaystyle\max_{ik\le n}\{i\}
\end{cases}
\]</span> é‚£ä¹ˆå°±æœ‰ <span class="math inline">\(\displaystyle r = \left\lfloor\frac nk\right\rfloor = \left\lfloor\frac{n}{\left\lfloor\frac n l\right\rfloor}\right\rfloor\)</span>ã€‚</p>
<p>ä»£ç å®ç°ï¼š</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1"></a>ll calc(ll n) {</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2"></a>    ll ans = <span class="dv">0</span>;</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3"></a>    <span class="cf">for</span> (ll l = <span class="dv">1</span>, r; l &lt;= n; l = r + <span class="dv">1</span>) {</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4"></a>        r = n / (n / l);</span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5"></a>        ans += (r - l + <span class="dv">1</span>) * (n / l);</span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6"></a>    }</span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7"></a>    <span class="cf">return</span> ans;</span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8"></a>}</span></code></pre></div>
<blockquote>
<p>ä¾‹é¢˜ï¼š<a href="https://www.luogu.com.cn/problem/P3935">P3935 Calculating</a></p>
<p>è‹¥ <span class="math inline">\(x\)</span> åˆ†è§£è´¨å› æ•°ç»“æœä¸º <span class="math inline">\(x=p_1^{k_1}p_2^{k_2}\cdots p_n^{k_n}\)</span>ï¼Œä»¤<span class="math inline">\(f(x)=(k_1+1)(k_2+1)\cdots (k_n+1)\)</span>ï¼Œæ±‚ <span class="math inline">\(\sum_{i=l}^rf(i)\)</span> å¯¹ <span class="math inline">\(998\,244\,353\)</span> å–æ¨¡çš„ç»“æœã€‚<span class="math inline">\(1\le l\le 10^{14}\)</span>ï¼Œ<span class="math inline">\(1\le r\le 1.6\times 10^{14}\)</span>ï¼Œ<span class="math inline">\(r-l&gt;10^{14}\)</span>ã€‚</p>
</blockquote>
<p>é¦–å…ˆè®¾ <span class="math inline">\(s(n) = \displaystyle\sum_{i=1}^n f(i)\)</span>ï¼Œç„¶åç­”æ¡ˆå³ä¸º <span class="math inline">\(s(r) - s(l-1)\)</span>ï¼Œç„¶åæ³¨æ„åˆ° <span class="math inline">\(f(x)\)</span> å®é™…å°±æ˜¯çº¦æ•°ä¸ªæ•°å‡½æ•°ï¼Œé‚£ä¹ˆ <span class="math inline">\(s(n)\)</span> å³ä¸º <span class="math display">\[
\sum_{i=1}^n\sum_{d\mid i}1 = \sum_{i=1}^n\left\lfloor\frac{n}{i}\right\rfloor
\]</span> ç›´æ¥æŒ‰ä¸Šé¢æ–¹æ³•åšå³å¯ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <a href="https://www.luogu.com.cn/problem/P2261">P2261 [CQOI2007]ä½™æ•°æ±‚å’Œ</a></p>
<p>ç»™å®š <span class="math inline">\(1\le n,k\le 10^9\)</span>ï¼Œæ±‚ <span class="math inline">\(\displaystyle\sum_{i=1}^nk\bmod i\)</span>ã€‚</p>
</blockquote>
<p>æ³¨æ„åˆ° <span class="math inline">\(k\bmod i\)</span> å¯ä»¥æ‹†æˆ <span class="math inline">\(k - i\lfloor k / i\rfloor\)</span>ï¼Œç„¶åæ•´ä¸ªå¼å­å¯ä»¥åŒ–ä¸º <span class="math display">\[
kn - \sum_{i=1}^ni\left\lfloor \frac k i\right\rfloor
\]</span> æ¯ä¸€å—å†…ç»Ÿè®¡å¹³å‡å€¼å•¥çš„å³å¯ã€‚</p>
<h4 id="å…¶ä»–å˜å½¢">å…¶ä»–å˜å½¢</h4>
<p>ä½¿ç”¨ç±»ä¼¼çš„åˆ†ææ–¹æ³•å¯ä»¥å¤„ç†æ›´å¤šç±»ä¼¼çš„é—®é¢˜ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <a href="https://www.luogu.com.cn/problem/P2260">P2260 [æ¸…åé›†è®­2012]æ¨¡ç§¯å’Œ</a> <span class="math display">\[
\sum_{1\le i\le n} \sum_{1\le j\le m,i\ne j} (n \bmod i) \times (m \bmod j)\bmod19940417
\]</span> <span class="math inline">\(1\le n,m\le 10^9\)</span>ã€‚</p>
</blockquote>
<p>äºŒç»´æ•´é™¤åˆ†å—ã€‚ä¸å¦¨å‡è®¾ <span class="math inline">\(n\le m\)</span>ï¼Œé¦–å…ˆå®¹æ–¥ä¸€æ³¢å°† <span class="math inline">\(i\ne j\)</span> å»æ‰ï¼š <span class="math display">\[
\sum_{i=1}^n(n\bmod i)\sum_{j=1}^m(m\bmod j) - \sum_{i=1}^n(n\bmod i)(m\bmod i)
\]</span> ç„¶åç”¨ä¸Šé¢çš„åŒ–ç®€æ–¹æ³•æŠŠå–æ¨¡æ‹†å¼€ï¼š <span class="math display">\[
\left(n^2 - \sum_{i=1}^ni\left\lfloor\frac ni\right\rfloor \right)\times\left(m^2 - \sum_{i=1}^mi\left\lfloor\frac mi\right\rfloor \right) - \sum_{i=1}^n\left(n - i\left\lfloor \frac n i \right\rfloor\right)\left(m - i\left\lfloor \frac m i \right\rfloor\right)
\]</span> å‰é¢çš„ä¸¤å¤§å¨æ˜¯ä¸€èˆ¬é€šè¿‡æ•´é™¤åˆ†å—ï¼Œæˆ‘ä»¬çœ‹åé¢ä¸€éƒ¨åˆ†ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{i=1}^n\left(n - i\left\lfloor \frac n i \right\rfloor\right)\left(m - i\left\lfloor \frac m i \right\rfloor\right)\\
=&amp;\sum_{i=1}^n\left(nm - ni\left\lfloor \frac n i \right\rfloor - mi\left\lfloor \frac m i \right\rfloor + i^2\left\lfloor \frac n i \right\rfloor\left\lfloor \frac m i \right\rfloor\right)\\
=&amp;n^2m - n\sum_{i=1}^n\left\lfloor \frac n i \right\rfloor - m\sum_{i=1}^n\left\lfloor \frac m i \right\rfloor + \sum_{i=1}^ni^2\left\lfloor \frac n i \right\rfloor\left\lfloor \frac m i \right\rfloor
\end{aligned}
\]</span> å‰ä¸‰é¡¹æ¯”è¾ƒå¥½åšï¼Œä¸»è¦é—®é¢˜æ˜¯ç¬¬å››é¡¹ã€‚å®é™…ä¸Šä½ ä¼šå‘ç°ç”±äº <span class="math inline">\(\lfloor n /i\rfloor\)</span> å’Œ <span class="math inline">\(\lfloor m / i\rfloor\)</span> éƒ½æˆå—çŠ¶ï¼Œæ‰€ä»¥è½¬æŠ˜ç‚¹ä¸€å…±ä¹Ÿæ˜¯ <span class="math inline">\(O(\sqrt n)\)</span> çš„ï¼Œä¸€æ ·å¯ä»¥æ•´é™¤åˆ†å—ï¼Œæ¯æ¬¡å¯¹ <span class="math inline">\(\lfloor n / \lfloor n / l\rfloor\rfloor\)</span> å’Œ <span class="math inline">\(\lfloor m / \lfloor m / l\rfloor\rfloor\)</span> å–ä¸ª <span class="math inline">\(\min\)</span> å³å¯ã€‚è€Œå¯¹äº <span class="math inline">\(\sum i^2\)</span> æœ‰å…¬å¼åœ¨å¼€å¤´ç»™å‡ºï¼Œåœ¨æ­¤ä¸è¡¨ã€‚</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2"></a><span class="pp">#define il </span><span class="kw">inline</span></span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3"></a></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll;</span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5"></a></span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6"></a><span class="kw">inline</span> ll min(ll a, ll b){<span class="cf">return</span> a &lt; b ? a : b;}</span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7"></a></span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8"></a><span class="at">const</span> ll mod = <span class="dv">19940417</span>, inv2 = <span class="dv">9970209</span>, inv6 = <span class="dv">3323403</span>;</span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9"></a></span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10"></a>ll n, m, ans;</span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11"></a></span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12"></a>ll calc(ll n, ll k) {</span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13"></a>    ll ret = <span class="dv">0</span>;</span>
<span id="cb2-14"><a aria-hidden="true" href="#cb2-14"></a>    n = min(n, k);</span>
<span id="cb2-15"><a aria-hidden="true" href="#cb2-15"></a>    <span class="cf">for</span> (ll l = <span class="dv">1</span>, r = <span class="dv">1</span>; l &lt;= n; l = r + <span class="dv">1</span>) {</span>
<span id="cb2-16"><a aria-hidden="true" href="#cb2-16"></a>        r = min(n, k / (k / l));</span>
<span id="cb2-17"><a aria-hidden="true" href="#cb2-17"></a>        ret += ((r - l + <span class="dv">1</span>) * (k / l * l) % mod + (r - l + <span class="dv">1</span>) * (r - l) % mod * (k / l) % mod * inv2 % mod) % mod;</span>
<span id="cb2-18"><a aria-hidden="true" href="#cb2-18"></a>        ret %= mod;</span>
<span id="cb2-19"><a aria-hidden="true" href="#cb2-19"></a>    }</span>
<span id="cb2-20"><a aria-hidden="true" href="#cb2-20"></a>    <span class="cf">return</span> ret;</span>
<span id="cb2-21"><a aria-hidden="true" href="#cb2-21"></a>}</span>
<span id="cb2-22"><a aria-hidden="true" href="#cb2-22"></a></span>
<span id="cb2-23"><a aria-hidden="true" href="#cb2-23"></a>il ll summod(ll n) {</span>
<span id="cb2-24"><a aria-hidden="true" href="#cb2-24"></a>    <span class="cf">return</span> (n * n % mod - calc(n, n) + mod) % mod;</span>
<span id="cb2-25"><a aria-hidden="true" href="#cb2-25"></a>}</span>
<span id="cb2-26"><a aria-hidden="true" href="#cb2-26"></a></span>
<span id="cb2-27"><a aria-hidden="true" href="#cb2-27"></a>il ll sum(ll n) {</span>
<span id="cb2-28"><a aria-hidden="true" href="#cb2-28"></a>    <span class="cf">return</span> n * (n + <span class="dv">1</span>) % mod * (<span class="dv">2</span> * n + <span class="dv">1</span>) % mod * inv6 % mod;</span>
<span id="cb2-29"><a aria-hidden="true" href="#cb2-29"></a>}</span>
<span id="cb2-30"><a aria-hidden="true" href="#cb2-30"></a></span>
<span id="cb2-31"><a aria-hidden="true" href="#cb2-31"></a>ll calc2(ll n, ll m) {</span>
<span id="cb2-32"><a aria-hidden="true" href="#cb2-32"></a>    ll top = min(n, m);</span>
<span id="cb2-33"><a aria-hidden="true" href="#cb2-33"></a>    ll ret = n * m % mod * top % mod;</span>
<span id="cb2-34"><a aria-hidden="true" href="#cb2-34"></a>    ret -= m * calc(top, n);</span>
<span id="cb2-35"><a aria-hidden="true" href="#cb2-35"></a>    ret = (ret + mod) % mod;</span>
<span id="cb2-36"><a aria-hidden="true" href="#cb2-36"></a>    ret -= n * calc(top, m);</span>
<span id="cb2-37"><a aria-hidden="true" href="#cb2-37"></a>    ret = (ret + mod) % mod;</span>
<span id="cb2-38"><a aria-hidden="true" href="#cb2-38"></a>    <span class="cf">for</span> (ll l = <span class="dv">1</span>, r; l &lt;= top; l = r + <span class="dv">1</span>) {</span>
<span id="cb2-39"><a aria-hidden="true" href="#cb2-39"></a>        r = min(min(top, n / (n / l)), m / (m / l));<span class="co">//åŒæ—¶å–minï¼Œæ³¨æ„ä¸Šç•Œé—®é¢˜</span></span>
<span id="cb2-40"><a aria-hidden="true" href="#cb2-40"></a>        ll sqri = sum(r) - sum(l - <span class="dv">1</span>);</span>
<span id="cb2-41"><a aria-hidden="true" href="#cb2-41"></a>        ret = (ret + sqri * (n / l) % mod * (m / l) % mod) % mod;</span>
<span id="cb2-42"><a aria-hidden="true" href="#cb2-42"></a>    }</span>
<span id="cb2-43"><a aria-hidden="true" href="#cb2-43"></a>    <span class="cf">return</span> ret;</span>
<span id="cb2-44"><a aria-hidden="true" href="#cb2-44"></a>}</span>
<span id="cb2-45"><a aria-hidden="true" href="#cb2-45"></a></span>
<span id="cb2-46"><a aria-hidden="true" href="#cb2-46"></a><span class="dt">int</span> main() {</span>
<span id="cb2-47"><a aria-hidden="true" href="#cb2-47"></a>    scanf(<span class="st">"</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st">"</span>, &amp;n, &amp;m);</span>
<span id="cb2-48"><a aria-hidden="true" href="#cb2-48"></a>    ans = summod(n) * summod(m) % mod;</span>
<span id="cb2-49"><a aria-hidden="true" href="#cb2-49"></a>    ans = (ans - calc2(n, m) + mod) % mod;</span>
<span id="cb2-50"><a aria-hidden="true" href="#cb2-50"></a>    printf(<span class="st">"</span><span class="sc">%lld\n</span><span class="st">"</span>, ans);</span>
<span id="cb2-51"><a aria-hidden="true" href="#cb2-51"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb2-52"><a aria-hidden="true" href="#cb2-52"></a>}</span></code></pre></div>
<blockquote>
<p>ä¾‹é¢˜ï¼šç»™å®š <span class="math inline">\(n\le 10^{18}\)</span>ï¼Œæ±‚</p>
<p><span class="math display">\[
\sum_{k=1}^n \sum_{d^2 \mid k} d \bmod 998244353
\]</span></p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬ä¸å¦¨æ”¹å˜æšä¸¾é¡ºåºï¼Œå…ˆæšä¸¾ <span class="math inline">\(d\)</span>ï¼š <span class="math display">\[
\sum_{d=1}^{\lfloor\sqrt n\rfloor}d\sum_{k=1}^n[d^2\mid k]
\]</span> å®é™…ä¸Šå°±æ˜¯ <span class="math display">\[
\sum_{d=1}^{\lfloor\sqrt n\rfloor}d\left\lfloor\frac{n}{d^2}\right\rfloor
\]</span> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨æ›´ä¸€èˆ¬åŒ–çš„æ€è·¯ï¼Œä»¤ <span class="math inline">\(d^* = d^2\)</span>ï¼Œç±»ä¼¼ä¸Šé¢ä¸€æ ·æ¨å¯¼ï¼š<span class="math inline">\(\begin{cases}k = \lfloor n / l^2\rfloor\\r^* = \lfloor n / k\rfloor\end{cases}\)</span>ï¼Œé‚£ä¹ˆå°±æœ‰ <span class="math inline">\(r^* = \displaystyle\left\lfloor\frac{n}{\left\lfloor\frac n l^2\right\rfloor}\right\rfloor\)</span>ï¼Œå¼€ä¸ªæ ¹å³å¾—åˆ° <span class="math inline">\(r = \left\lfloor\sqrt{\left\lfloor\frac{n}{\left\lfloor\frac{n}{l^2}\right\rfloor}\right\rfloor}\right\rfloor\)</span>ã€‚äºæ˜¯æœ¬é¢˜ <span class="math inline">\(O(n^{1/4})\)</span> è§£å†³ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ï¼šæ±‚ <span class="math display">\[
\sum_{i=1}^n\left\lceil\frac ni\right\rceil
\]</span></p>
</blockquote>
<p>å‘ä¸Šå–æ•´å•¥çš„ä¸ç®¡ï¼Œæ³¨æ„åˆ° <span class="math inline">\(\displaystyle\left\lceil\frac nm\right\rceil = \left\lfloor\frac{n + m - 1}{m}\right\rfloor\)</span>ï¼Œæ‰€ä»¥åŸå¼å˜ä¸ºå¯¹ <span class="math inline">\(\displaystyle\left\lfloor\frac{n+i-1}{i}\right\rfloor\)</span> æ±‚å’Œã€‚ç±»ä¼¼ä¸Šé¢æ¨å¯¼ï¼š<span class="math inline">\(k=\lfloor(n+l-1)/l\rfloor\)</span>ï¼Œç„¶å <span class="math inline">\(r\)</span> è¦æ»¡è¶³ <span class="math inline">\(\lceil n / r\rceil = k\)</span>ï¼Œå³ <span class="math inline">\(n\le kr\le n + r - 1\)</span>ï¼Œäºæ˜¯ä¹ <span class="math inline">\(r = \displaystyle\left\lfloor\frac{n - 1}{k - 1}\right\rfloor = \left\lfloor\frac{n - 1}{\left\lfloor\frac{n+l-1}{l}\right\rfloor - 1}\right\rfloor\)</span>ï¼Œè®°å¾—æœ€åä¸€æ­¥ç‰¹åˆ¤ï¼Œæ­¤æ—¶ <span class="math inline">\(k - 1 = 0\)</span>ï¼Œå³è¾¹ç•Œä¸º <span class="math inline">\(n\)</span>ã€‚</p>
<h3 id="ç‹„åˆ©å…‹é›·å·ç§¯">ç‹„åˆ©å…‹é›·å·ç§¯</h3>
<p>å®šä¹‰ä¸¤ä¸ªæ•°è®ºå‡½æ•° <span class="math inline">\(f(n),g(n)\)</span> çš„ç‹„åˆ©å…‹é›·å·ç§¯ <span class="math inline">\((f*g)(n)\)</span> ä¸º <span class="math display">\[
(f*g)(n) = \sum_{d\mid n}f(d)g\left(\frac nd\right)
\]</span> ç±»æ¯”ä¸€ä¸‹ä¸€èˆ¬çš„åŠ æ³•å·ç§¯ <span class="math inline">\(c_k = \sum_{i}a_ib_{k - i}\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ç‹„åˆ©å…‹é›·å·ç§¯ä¸º<strong>å…³äºä¹˜æ³•</strong>çš„å·ç§¯ã€‚</p>
<p>å…¶å…·æœ‰å¦‚ä¸‹å¸¸è§æ€§è´¨ï¼š</p>
<ol type="1">
<li><p>äº¤æ¢å¾‹ï¼š<span class="math inline">\(f*g = g*f\)</span>ï¼Œä¹˜æ³•æ»¡è¶³äº¤æ¢å¾‹ï¼Œå¾—è¯ã€‚</p></li>
<li><p>ç»“åˆå¾‹ï¼š<span class="math inline">\((f*g)*h=f*(g*h)\)</span>ï¼š <span class="math display">\[
\sum_{(ij)k = n}(f(i)g(j))h(k)=\sum_{i(jk) = n}f(i)(g(j)h(k))
\]</span></p></li>
<li><p>å¯¹åŠ æ³•çš„åˆ†é…å¾‹ï¼š<span class="math inline">\((f+g)*h = f*h + g*h\)</span>ï¼š <span class="math display">\[
\begin{aligned}
&amp;(f(n) + g(n)) * h(n)\\
=&amp;\sum_{d\mid n}(f(d) + d(d))h\left(\frac nd\right)\\
=&amp;\sum_{d\mid n}f(d)h\left(\frac nd\right) + \sum_{d\in n}g(d)h\left(\frac nd\right)\\
=&amp;f(n)*h(n) + g(n)*h(n)
\end{aligned}
\]</span></p></li>
<li><p>ä¸æ•°ä¹˜çš„ç»“åˆå¾‹ï¼š<span class="math inline">\((cf)*g = c(f*g)\)</span>ã€‚</p></li>
<li><p><strong>å•ä½å…ƒ</strong>ï¼š<span class="math inline">\(\epsilon * f = f\)</span>ï¼Œ<span class="math inline">\(\epsilon(n) = [n = 1]\)</span>ã€‚å³è¿™ä¸ªå•ä½å…ƒå‡½æ•°å½“ <span class="math inline">\(n = 1\)</span> æ—¶è¿”å› <span class="math inline">\(1\)</span>ï¼Œå½“ <span class="math inline">\(n\not=1\)</span> æ—¶è¿”å› <span class="math inline">\(0\)</span>ã€‚ <span class="math display">\[
\begin{aligned}
f * \epsilon &amp;= \sum_{d\mid n} f(d)\epsilon\left(\frac nd\right)
\end{aligned}
\]</span> ä¸éš¾éªŒè¯å…¶æ­£ç¡®æ€§ï¼šåªæœ‰å½“ <span class="math inline">\(d = n\)</span> æ—¶ <span class="math inline">\(\epsilon(n/d)\)</span> æ‰ç­‰äº <span class="math inline">\(1\)</span>ï¼Œåªä¿ç•™äº† <span class="math inline">\(f(n)\)</span> è¿™ä¸€é¡¹ã€‚</p></li>
<li><p>ç‹„åˆ©å…‹é›·é€†å…ƒï¼š<span class="math inline">\(f^{-1}*f=\epsilon\)</span>ã€‚è€ƒè™‘å¦‚ä½•æ±‚è¿™ä¸ªé€†å…ƒï¼š <span class="math display">\[
\begin{aligned}
\epsilon &amp;= f^{-1}*f\\
\epsilon &amp;= \sum_{d\mid n}f^{-1}(d)f\left(\frac nd\right)\\
\epsilon(n) &amp;= f^{-1}(n)f(1) + \sum_{d\mid n\land d &lt; n} f^{-1}(d)f\left(\frac nd\right)\\
f^{-1}(n) &amp;=\frac1{f(1)}\left(\epsilon(n) -  \sum_{d\mid n\land d &lt; n} f^{-1}(d)f\left(\frac nd\right)\right)
\end{aligned}
\]</span> äºæ˜¯è¿™ä¸ªé€†å…ƒå°±è¢«æ±‚å‡ºæ¥äº†ã€‚ä¸éš¾å‘ç°åªè¦ <span class="math inline">\(f\)</span> æ»¡è¶³ <span class="math inline">\(f(1)\not=0\)</span>ï¼Œå…¶å°±ä¼šå…·æœ‰é€†å…ƒã€‚</p></li>
</ol>
<h3 id="è«æ¯”ä¹Œæ–¯å‡½æ•°">è«æ¯”ä¹Œæ–¯å‡½æ•°</h3>
<p>åœ¨è¿™ä¹‹å‰å¯èƒ½éœ€è¦å›é¡¾ä¸€ä¸‹ä¹‹å‰è®²è¿‡çš„å‡ ä¸ªæ•°è®ºå‡½æ•°ï¼Œä¸‹é¢å°†ä¸ä¼šé‡å¤æåŠã€‚</p>
<p>ä¸Šé¢çš„ <span class="math inline">\(\mu(n)\)</span> å°±æ˜¯è«æ¯”ä¹Œæ–¯å‡½æ•°ã€‚å†™å¾—æ›´æ¸…æ¥šçš„å®šä¹‰ä¸ºï¼š <span class="math display">\[
\mu(n) = \begin{cases}
1&amp;n = 1\\
0&amp;n\text{ å«æœ‰å¹³æ–¹å› å­}\\
(-1)^{\omega(n)}&amp;\omega(n)\text{ ä¸º }n\text{ çš„æœ¬è´¨ä¸åŒè´¨å› å­ä¸ªæ•°}
\end{cases}
\]</span> åŒæ—¶å…¶æœ‰ä¸€ä¸ªç­‰ä»·çš„å®šä¹‰ï¼š <span class="math display">\[
\mu(n) = 1^{-1}(n)
\]</span> å³ï¼Œ<span class="math inline">\(\mu(n)\)</span> ä¸ºå¸¸å‡½æ•° <span class="math inline">\(1(n)\)</span> çš„ç‹„åˆ©å…‹é›·é€†å…ƒã€‚è¿™å°±æ„å‘³ç€ <span class="math inline">\(\mu*1 = \epsilon\)</span>ï¼Œæ‰€ä»¥ <span class="math display">\[
\sum_{d\mid n}\mu(d) = \epsilon(n) = [n = 1]
\]</span> æœ‰ä¸€ä¸ªå¸¸è§çš„åæ¼”ç»“è®ºæ˜¯ï¼š <span class="math display">\[
[i\perp j] = [\gcd(i,j) = 1] = \sum_{d\mid\gcd(i,j)}\mu(d)
\]</span> è¿™ä¸ªæ„ä¹‰åº”è¯¥æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œä¸èµ˜è¿°äº†ã€‚</p>
<p>ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå¸¸è§åæ¼”ç»“è®ºï¼ˆæ¬§æ‹‰åæ¼”ï¼‰ï¼š <span class="math display">\[
\varphi * 1= \operatorname{id}
\]</span> è¯æ˜ï¼šç”±äº <span class="math inline">\(\varphi\)</span> ä¸ºç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¯æ˜ <span class="math inline">\(n = p^c\)</span> æ—¶å…¶æˆç«‹å³å¯ã€‚ <span class="math display">\[
\begin{aligned}
\varphi * 1 &amp;= \sum_{d\mid n}\varphi(d)\\
&amp;= \sum_{i = 0}^c\varphi(p^i)\\
&amp;= 1 + p^0(p - 1) + p^1(p -1) + \cdots + p^{c - 1}(p - 1)\\
&amp;= p^c\\
&amp;= \operatorname{id}
\end{aligned}
\]</span> å¦å¤–ï¼Œä¸¤è¾¹åŒæ—¶å· <span class="math inline">\(\mu\)</span> å¯ä»¥å¾—åˆ° <span class="math display">\[
\varphi = \operatorname{id}*\mu = \sum_{d\mid n}d\mu\left(\frac nd\right)
\]</span></p>
<p><span class="math inline">\(\mu\)</span> çš„æ±‚æ³•è§ä¸‹æ–‡çº¿æ€§ç­›éƒ¨åˆ†ã€‚</p>
<h3 id="è«æ¯”ä¹Œæ–¯åæ¼”å…¬å¼">è«æ¯”ä¹Œæ–¯åæ¼”å…¬å¼</h3>
<h4 id="åŸºæœ¬å½¢å¼-1">åŸºæœ¬å½¢å¼</h4>
<p>å†…å®¹æ˜¯ï¼Œå·²çŸ¥ä¸¤æ•°è®ºå‡½æ•° <span class="math inline">\(f(n)\)</span>ï¼Œ<span class="math inline">\(g(n)\)</span>ï¼š <span class="math display">\[
f(n) = \sum_{d\mid n}g(d)\iff g(n) = \sum_{d\mid n}\mu\left(\frac nd\right)f(d)
\]</span> è¿™ä¸ªå…¬å¼è¢«ç§°ä¸ºè«æ¯”ä¹Œæ–¯åæ¼”å…¬å¼ï¼ˆMÃ¶bius inversion formulaï¼‰ï¼Œç”¨ç‹„åˆ©å…‹é›·å·ç§¯è¡¨ç¤ºå°±æ˜¯ <span class="math display">\[
f = g * 1\iff g = f * \mu
\]</span> å†™æˆç‹„åˆ©å…‹é›·å·ç§¯çš„å½¢å¼å°±å¥½è¯æ˜äº†ï¼Œç›´æ¥å·¦è¾¹å·ä¸Š <span class="math inline">\(\mu\)</span> å°±èƒ½å¾—åˆ°å³è¾¹ã€‚</p>
<h4 id="æ‰©å±•å½¢å¼">æ‰©å±•å½¢å¼</h4>
<p>ä¹˜ç§¯å½¢å¼çš„ï¼š <span class="math display">\[
f(n) = \prod_{d\mid n}g(d) \iff g(n) = \prod f(d)^{\mu(\frac nd)},\forall n &gt; 1
\]</span> è¯æ˜ï¼šä¸¤è¾¹åŒæ—¶å–å¯¹æ•°ï¼š <span class="math display">\[
\begin{aligned}
\ln f(n) &amp;= \sum_{d\mid n}\ln g(d)\\
\ln g(n) &amp;= \sum_{d\mid n}\ln f(d)\mu\left(\frac nd\right)\\
g(n) &amp;= \prod_{d\mid n}f(d)^{\mu(\frac nd)}
\end{aligned}
\]</span> å€æ•°å½¢å¼çš„ï¼š <span class="math display">\[
f(n) = \sum_{n\mid d}g(d)\iff g(n) = \sum_{n\mid d}\mu\left(\frac dn\right)f(d)
\]</span> è¯æ˜ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{n\mid d}\mu\left(\frac dn\right)f(d)\\
=&amp;\sum_{k= 1}^\infty\mu(k)f(kn) = \sum_{k = 1}^\infty\mu(k)\sum_{kn\mid d}g(d)\\
=&amp;\sum_{n\mid d}g(d)\sum_{k\mid \frac{d}{n}}\mu(k)= \sum_{n\mid d}g(d)\epsilon\left(\frac dn\right)\\
=&amp;g(n)
\end{aligned}
\]</span> å°† <span class="math inline">\(d\)</span> è¡¨ç¤ºæˆ <span class="math inline">\(kn\)</span> çš„å½¢å¼ï¼Œç„¶åå°†å·¦è¾¹çš„å¼å­ä»£å…¥ã€‚ä¹‹åäº¤æ¢æšä¸¾é¡ºåºå˜ä¸ºæšä¸¾ <span class="math inline">\(n\)</span> çš„å€æ•°ç„¶ååæ±‚ <span class="math inline">\(k\)</span>ï¼Œæœ€åå‘ç°å°±æ˜¯ <span class="math inline">\(\epsilon\)</span>ã€‚</p>
<h3 id="è«æ¯”ä¹Œæ–¯åæ¼”ä¸å®¹æ–¥çš„å…³ç³»">è«æ¯”ä¹Œæ–¯åæ¼”ä¸å®¹æ–¥çš„å…³ç³»</h3>
<p>å‚è€ƒäº†è®ºæ–‡å“¥çš„åšå®¢ã€‚</p>
<p>é¦–å…ˆæ ¹æ®ç®—æœ¯åŸºæœ¬å®šç†ï¼Œå°†ä¸€ä¸ª <span class="math inline">\(n\)</span> åˆ†è§£ä¸º <span class="math inline">\(p_i^{k_i}\)</span> çš„ç»“æ„ï¼Œç„¶åå¯¹äºä¸€ä¸ªæ•°è®ºå‡½æ•° <span class="math inline">\(f\)</span>ï¼Œå®šä¹‰å…¶ zeta å˜æ¢ <span class="math inline">\(f\zeta\)</span>ï¼š <span class="math display">\[
f\zeta(n) = \sum_{d\mid n}f(d)
\]</span> å…¶å®è´¨æ˜¯æšä¸¾äº† <span class="math inline">\(k_i\)</span> è¡¨ç¤ºä¸­çš„æ¯ä¸€ç»´éƒ½ä¸å¤§äºè‡ªå·±çš„æ•°ï¼Œç›¸å½“äºä¸€ä¸ªé«˜ç»´å‰ç¼€å’Œã€‚ï¼ˆå…¶å®è¿™ä¸ªå°±æ˜¯ç‹„åˆ©å…‹é›·å‰ç¼€å’Œï¼Œ<a href="https://www.luogu.com.cn/problem/P5495">P5495 Dirichlet å‰ç¼€å’Œ</a>ï¼‰æ±‚è¿™ä¸ªä¸œè¥¿çš„æ—¶å€™å¯ä»¥åƒ FMT ä¸€æ ·ï¼Œç±»ä¼¼åŸƒç­›çš„ <span class="math inline">\(O(n\log\log n)\)</span>ã€‚</p>
<p>ç„¶åå¦‚ä½•ä»é«˜ç»´å‰ç¼€å’Œè¿˜åŸæˆå•ç‚¹çš„å€¼å‘¢ï¼Ÿè€ƒè™‘ä½¿ç”¨å®¹æ–¥åŸç†ï¼Œå›é¡¾ä¸€ä¸‹é«˜ç»´å‰ç¼€å’Œçš„å¼å­ã€‚éœ€è¦æšä¸¾æ¯ä¸€ç»´ç›¸åŒæˆ–è€…å° <span class="math inline">\(1\)</span> çš„æ•°ï¼Œä»¥æ­¤å†³å®šå®¹æ–¥ç³»æ•°ã€‚å®šä¹‰ <span class="math display">\[
\mu(n) = \prod_{i = 1}^\infty (-1)^{[e_i = 1]}0^{[e_k &gt; 1]}
\]</span> å³ï¼šæŸä¸€ç»´ä¸º <span class="math inline">\(0\)</span> æ—¶ï¼Œå¯¹å‡½æ•°å€¼æ²¡æœ‰å½±å“ï¼ŒæŸä¸€ç»´ä¸º <span class="math inline">\(1\)</span> æ—¶ï¼Œå‡½æ•°å€¼ä¹˜ä¸Š <span class="math inline">\(-1\)</span>ï¼ŒæŸä¸€ç»´å¤§äº <span class="math inline">\(1\)</span> æ—¶ï¼Œå‡½æ•°å€¼ä¸º <span class="math inline">\(0\)</span>ã€‚å¦åˆ™è‹¥ <span class="math inline">\(n\)</span> ä¸º <span class="math inline">\(c\)</span> ä¸ªè´¨æ•°çš„ç§¯ï¼Œåˆ™ <span class="math inline">\(\mu(n) = (-1)^c\)</span>ã€‚</p>
<p>æˆ‘ä»¬æšä¸¾ <span class="math inline">\(d\mid n\)</span>ï¼Œç”¨ <span class="math inline">\(\dfrac nd\)</span> æ‰¾åˆ°æ¯ä¸€ç»´çš„å·®ï¼Œå†ç”¨ <span class="math inline">\(\mu\)</span> æ‰¾åˆ°å¯¹åº”çš„å®¹æ–¥ç³»æ•°ï¼Œå³ï¼š <span class="math display">\[
f(n) = \sum_{d\mid n}\mu\left(\frac nd\right)f\zeta(d)
\]</span> æŠŠè¿™ä¸ªå˜æ¢ç§°ä¸ºè«æ¯”ä¹Œæ–¯å˜æ¢ï¼Œå³ <span class="math display">\[
f\mu(n) = \sum_{d\mid n}\mu\left(\frac nd\right)f(d)
\]</span> è€Œ <span class="math inline">\(f\zeta\mu = f\)</span>ã€‚</p>
<p>æ‰€ä»¥æœ¬è´¨ä¸Šï¼Œè«æ¯”ä¹Œæ–¯åæ¼”æ˜¯ä¸€ä¸ªå®¹æ–¥çš„è¿‡ç¨‹ã€‚<span class="math inline">\(\mu\)</span> å……å½“ç€å®¹æ–¥ç³»æ•°è¿™ä¸€è§’è‰²ã€‚</p>
<h3 id="åº”ç”¨">åº”ç”¨</h3>
<p>ä¸‹é¢æ”¾å‡ ä¸ªè«æ¯”ä¹Œæ–¯åæ¼”çš„ç»å…¸åº”ç”¨ã€‚å‡å®š <span class="math inline">\(n\ge m\)</span>ã€‚</p>
<h4 id="å…¸ä¾‹-0">å…¸ä¾‹ 0</h4>
<p><span class="math display">\[
\sum_{i =1 }^n\gcd(i,n) = \sum_{d\mid n}d\varphi(n/d)
\]</span></p>
<p>å¯¹åº”ä¾‹é¢˜<a href="https://www.luogu.com.cn/problem/P2303">P2303 [SDOI2012] Longge çš„é—®é¢˜</a>ã€‚</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„æŠ€å·§ï¼šæœ‰å¾ˆå¤šçš„ <span class="math inline">\(\gcd(i,n)\)</span> éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æšä¸¾ <span class="math inline">\(\gcd\)</span>ï¼š<span class="math inline">\(\displaystyle\sum_{d\mid n}d\sum_{i= 1}^n[\gcd(i, n)= d]\)</span>ï¼Œç„¶ååŒ–ä¸º <span class="math inline">\(\gcd(i,j) = 1\)</span> çš„å½¢å¼ï¼š<span class="math inline">\(\displaystyle\sum_{d\mid n}d\sum_{i=1}^{n/d}[\gcd(i,n/d)=1]\)</span>ï¼Œæ³¨æ„åˆ°å³è¾¹é‚£ä¸ªä¸œè¥¿å®é™…ä¸Šå°±æ˜¯ <span class="math inline">\(\varphi(n/d)\)</span>ï¼Œæ‰€ä»¥å°±åŒ–ç®€å®Œäº†ã€‚</p>
<h4 id="å…¸ä¾‹-1">å…¸ä¾‹ 1</h4>
<p><span class="math display">\[
\sum_{i = 1}^n\sum_{j = 1}^m[\gcd(i,j) = k] = \sum_{d=1}^{\lfloor \frac nk\rfloor}\mu(d)\left\lfloor\frac{n}{kd}\right\rfloor\left\lfloor\frac{m}{kd}\right\rfloor
\]</span></p>
<p>å¯¹åº”ä¾‹é¢˜<a href="https://www.luogu.com.cn/problem/P3455">P3455 [POI2007]ZAP-Queries</a>ã€‚</p>
<p>ç®€è¦æ¨å¯¼ï¼šé¦–å…ˆ<strong>å°†å…¶åŒ–ä¸º <span class="math inline">\(\gcd(i, j) = 1\)</span> çš„å½¢å¼</strong>ï¼Œå¾—åˆ° <span class="math inline">\(\displaystyle\sum_{i = 1}^{n'}\sum_{j = 1}^{m'}\sum_{d\mid\gcd(i,j)}\mu(d)\)</span>ï¼Œç„¶åå†™æˆæšä¸¾ <span class="math inline">\(d\)</span> çš„å½¢å¼ï¼š<span class="math inline">\(\displaystyle\sum_{i = 1}^{n'}\sum_{j = 1}^{m'}\sum_{d = 1}[d\mid\gcd(i,j)]\mu(d)\)</span>ï¼Œå†è°ƒæ¢ä¸€ä¸‹æ±‚å’Œé¡ºåºï¼š<span class="math inline">\(\displaystyle\sum_{d=1}^{\min(n',m')}\mu(d)\sum_{i = 1}^{n'}\sum_{j = 1}^{m'}[d\mid\gcd(i,j)]\)</span>ã€‚æœ€åçš„å¼å­å³è¦æ±‚ <span class="math inline">\(i,j\)</span> åŒä¸º <span class="math inline">\(d\)</span> çš„å€æ•°ï¼Œæ‰€ä»¥æœ€ç»ˆå¾—åˆ°ç­”æ¡ˆã€‚</p>
<h4 id="å…¸ä¾‹-2">å…¸ä¾‹ 2</h4>
<p><span class="math display">\[
\sum_{i = 1}^n\sum_{j = 1}^m[\gcd(i,j) \in P] = \sum_{T = 1}^n\left\lfloor\frac{n}{T}\right\rfloor\left\lfloor\frac{m}{T}\right\rfloor\sum_{k\mid T\land k\in P}\mu\left(\frac Tk\right)
\]</span> å…¶ä¸­ <span class="math inline">\(P\)</span> ä¸ºè´¨æ•°é›†ã€‚å¯¹åº”ä¾‹é¢˜<a href="https://www.luogu.com.cn/problem/P2257">P2257 YYçš„GCD</a>ã€‚</p>
<p>ç®€è¦æ¨å¯¼ï¼šé¦–å…ˆæšä¸¾è¿™ä¸ªè´¨æ•° <span class="math inline">\(k\)</span>ï¼Œç„¶ååƒä¸Šä¸€é¢˜ä¸€æ ·åŒ–ç®€å¯ä»¥å¾—åˆ° <span class="math inline">\(\displaystyle\sum_{k\in P}\sum_{d=1}^{\lfloor \frac nk\rfloor}\mu(d)\left\lfloor\frac{n}{kd}\right\rfloor\left\lfloor\frac{m}{kd}\right\rfloor\)</span>ã€‚ç°åœ¨ä»ç„¶ä¸å¤Ÿå¿«ï¼Œæ¥ä¸‹æ¥<strong>å·§å¦™æ¢å…ƒä»¤ <span class="math inline">\(T = kd\)</span></strong>ï¼Œç„¶åè°ƒæ¢æšä¸¾é¡ºåºæ”¹ä¸ºæšä¸¾ <span class="math inline">\(T\)</span>ï¼š<span class="math inline">\(\displaystyle\sum_{T= 1}^n\left\lfloor\frac{n}{T}\right\rfloor\left\lfloor\frac{m}{T}\right\rfloor\sum_{k\mid T,k\in P}\mu\left(\frac Tk\right)\)</span>ã€‚åè€…å¯ä»¥é¢„å¤„ç†ï¼Œç„¶åå¥—æ•´é™¤åˆ†å—å³å¯ã€‚</p>
<h4 id="å…¸ä¾‹-3">å…¸ä¾‹ 3</h4>
<p><span class="math display">\[
\sum_{i = 1}^n\sum_{j = 1}^m\operatorname{lcm}(i, j) = \sum_{d = 1}^nd\sum_{k = 1}^{\lfloor\frac nd\rfloor}\mu(k)k^2\sum_{i = 1}^{\lfloor\frac{n}{kd}\rfloor}\sum_{j = 1}^{\lfloor\frac{m}{kd}\rfloor}ij
\]</span></p>
<p>å¯¹åº”ä¾‹é¢˜<a href="https://www.luogu.com.cn/problem/P1829">P1829 [å›½å®¶é›†è®­é˜Ÿ]Crashçš„æ•°å­—è¡¨æ ¼ / JZPTAB</a>ã€‚</p>
<p>ç®€è¦æ¨å¯¼ï¼š<span class="math inline">\(\displaystyle\sum_{i = 1}^n\sum_{j = 1}^m\frac{ij}{\gcd(i, j)}\)</span>ï¼Œç„¶åæšä¸¾ gcdï¼Œå˜æˆ <span class="math inline">\(\displaystyle\sum_{d = 1}^n\sum_{i = 1}^n\sum_{j = 1}^m\frac{ij}{d}[\gcd(i,j) = d]\)</span>ï¼Œç„¶åæ˜¯ç»å…¸åæ¼”ï¼Œå˜æˆ <span class="math inline">\(\displaystyle\sum_{d = 1}^nd\sum_{i = 1}^{\lfloor\frac nd\rfloor}\sum_{j = 1}^{\lfloor\frac md\rfloor}ij\sum_{k\mid \gcd(i,j)}\mu(k)\)</span>ï¼Œå†ç„¶åè°ƒæ¢é¡ºåºæšä¸¾ <span class="math inline">\(k\)</span>ï¼Œ<span class="math inline">\(\displaystyle\sum_{d = 1}^nd\sum_{k = 1}^{\lfloor\frac nd\rfloor}\mu(k)\sum_{i = 1}^{\lfloor\frac nd\rfloor}\sum_{j = 1}^{\lfloor\frac md\rfloor}ij[k\mid i][k\mid j]\)</span>ï¼Œæœ€åå¾—åˆ° <span class="math inline">\(\displaystyle\sum_{d = 1}^nd\sum_{k = 1}^{\lfloor\frac nd\rfloor}\mu(k)k^2\sum_{i = 1}^{\lfloor\frac{n}{kd}\rfloor}\sum_{j = 1}^{\lfloor\frac{m}{kd}\rfloor}ij\)</span>ã€‚è¿™ä¸ªä¸œè¥¿çš„ååŠå¨å¯ä»¥ <span class="math inline">\(O(1)\)</span>ï¼Œç„¶åå°±æ˜¯å¥—ä¸¤å±‚æ•´é™¤åˆ†å—çš„äº‹æƒ…äº†ã€‚</p>
<h4 id="å…¸ä¾‹-4">å…¸ä¾‹ 4</h4>
<p><span class="math display">\[
\sum_{i=1}^n\sum_{j=1}^m\sigma_0(ij) = \sum_{d=1}^n\mu(d)F(\lfloor n / d\rfloor)F(\lfloor m /d \rfloor)
\]</span></p>
<p>å…¶ä¸­ï¼Œ<span class="math inline">\(F(n) = \displaystyle\sum_{i=1}^n\left\lfloor\frac ni\right\rfloor = \sum_{i=1}^n\sigma_0(i)\)</span>ã€‚æ¨å¯¼ï¼šé¦–å…ˆæ˜¯ä¸€ä¸ªç»å…¸ç»“è®ºï¼Œè¯æ˜è§ä¸‹æ–‡ï¼š <span class="math display">\[
\sigma_0(xy) = \sum_{i\mid x}\sum_{j\mid y}[i\perp j]
\]</span> ç„¶åå°±å¯ä»¥å¼€å§‹åæ¼”äº†ï¼š<span class="math inline">\(\displaystyle\sum_{i=1}^n\sum_{j=1}^m\sigma_0(i,j) = \sum_{i=1}^n\sum_{j=1}^m\sum_{x\mid i}\sum_{y\mid j}[\gcd(x,y) = 1]\)</span>ï¼Œç„¶åè°ƒæ¢ä¸€ä¸‹å†…å¤–å±‚æ±‚å’Œé¡ºåºæœ‰ <span class="math inline">\(\displaystyle\sum_{i=1}^n\sum_{j=1}^m[\gcd(i,j) = 1]\left\lfloor\frac ni\right\rfloor\left\lfloor \frac mj\right\rfloor\)</span>ã€‚å°† <span class="math inline">\([\gcd(i,j) = 1]\)</span> ç”¨ <span class="math inline">\(\mu\)</span> æ¥åŒ–å¼€ä¹‹åå˜ä¸º <span class="math inline">\(\displaystyle\sum_{i=1}^n\sum_{j=1}^m\left\lfloor\frac ni\right\rfloor\left\lfloor \frac mj\right\rfloor\sum_{d\mid i,d\mid j}\mu(d)\)</span>ï¼Œå†å°† <span class="math inline">\(d\)</span> æåˆ°æœ€å¤–é¢å°±æœ‰ <span class="math inline">\(\displaystyle\sum_{d=1}^n\mu(d)\left(\sum_{d\mid i, i\le n}\sum_{d\mid j,j\le m}\left\lfloor\frac ni\right\rfloor\left\lfloor \frac mj\right\rfloor\right)\)</span>ï¼Œé‡Œé¢ç›´æ¥å†é™¤ä»¥ä¸ª <span class="math inline">\(d\)</span> å°±æœ‰ä¸Šé¢é‚£ä¸ªå¼å­äº†ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆ <span class="math inline">\(\displaystyle\sum_{i=1}^n\left\lfloor\frac ni\right\rfloor = \sum_{i=1}^n\sigma_0(i)\)</span>ï¼Œåˆ†æä¸€ä¸‹ <span class="math inline">\(\sigma_0\)</span> æ˜¯å¦‚ä½•è¢«è´¡çŒ®å‡ºæ¥çš„å³å¯ã€‚</p>
<h4 id="å…¶ä½™ä¾‹é¢˜">å…¶ä½™ä¾‹é¢˜</h4>
<blockquote>
<p>ä¾‹é¢˜ 1ï¼š<a href="https://www.luogu.com.cn/problem/P1447">P1447 [NOI2010] èƒ½é‡é‡‡é›†</a>ï¼šæ±‚ <span class="math display">\[
\sum_{i=1}^n\sum_{j=1}^m(2\gcd(i,j) - 1)
\]</span></p>
</blockquote>
<p>æ˜¾ç„¶å°†å¼å­åŒ–ç®€å°±å˜æˆ <span class="math inline">\(2\displaystyle\sum_{i=1}^n\sum_{j=1}^m\gcd(i,j)-nm\)</span>ã€‚ç°åœ¨è€ƒè™‘ <span class="math inline">\(\sum_i\sum_j\gcd(i,j)\)</span> æ€ä¹ˆæ±‚ã€‚è€ƒè™‘æšä¸¾ä¹‹ï¼š<span class="math inline">\(\sum_{d}d\sum_i\sum_j[\gcd(i,j)=d]\)</span>ï¼Œå‘ç°åé¢å°±æ˜¯ä¸Šé¢çš„å…¸ä¾‹ <span class="math inline">\(1\)</span>ï¼Œå¯ä»¥ <span class="math inline">\(O(n\sqrt n)\)</span> å¹²æ‰ã€‚ä½†æ˜¯å…¶å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚è€ƒè™‘ç­”æ¡ˆå¼ <span class="math inline">\(\displaystyle\sum_{d=1}^nd\sum_{k=1}^{\lfloor n /d\rfloor}\mu(k)\lfloor n/kd\rfloor\lfloor m/kd\rfloor\)</span>ã€‚ç”¨å…¸ä¾‹ <span class="math inline">\(2\)</span> çš„æ¢å…ƒï¼Œæ¢å¾— <span class="math inline">\(\displaystyle\sum_{T=1}^{n}\sum_{d\mid T}d\mu(T/d)\lfloor n / T\rfloor\lfloor m / T\rfloor\)</span>ï¼Œæ³¨æ„åˆ°å‰é¢çš„ç»å…¸ç»“è®ºï¼š<span class="math inline">\(\phi = \mu*\mathrm{id}\)</span>ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆ <span class="math inline">\(\displaystyle\sum_{T=1}^n\lfloor n / T\rfloor\lfloor m / T\rfloor\phi(T)\)</span>ã€‚è¿™æ ·å°±å˜æˆ <span class="math inline">\(O(n) - O(\sqrt n)\)</span> çš„äº†ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(2\)</span>ï¼šç¦æ­¢æŸ¥çœ‹ã€‚</p>
</blockquote>
<p><del>ç¦æ­¢æŸ¥çœ‹ã€‚</del></p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(3\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P3312">æ´›è°· P3312 [SDOI2014]æ•°è¡¨</a></p>
<p><span class="math inline">\(Q\le 2\times 10^4\)</span> æ¬¡è¯¢é—®ï¼Œç»™å®š <span class="math inline">\(n,m\le 10^5,a\)</span>ï¼Œæ±‚ <span class="math display">\[
\sum_{i = 1}^n\sum_{j = 1}^m\sigma(\gcd(i,j))\times[\sigma(\gcd(i,j)) \le a]\bmod 2^{31}
\]</span></p>
</blockquote>
<p>ä¸å¦¨å…ˆå¿½ç•¥ <span class="math inline">\(\sigma(\gcd(i,j)) \le a\)</span> çš„é™åˆ¶æ¥åŒ–ç®€å¼å­ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{i = 1}^n\sum_{j = 1}^m\sigma(\gcd(i,j))\\
=&amp;\sum_{d = 1}^n\sigma(d)\sum_{i = 1}^{\lfloor n/d\rfloor}\sum_{j = 1}^{\lfloor m / d\rfloor}\sum_{x\mid i\land x \mid j}\mu(x)\\
=&amp;\sum_{d = 1}^n\sigma(d)\sum_{x = 1}^{\lfloor n / d\rfloor}\lfloor n / dx\rfloor\lfloor m/ dx\rfloor\mu(x)\\
=&amp;\sum_{T = 1}^n\lfloor n / T\rfloor\lfloor m / T\rfloor\sum_{d\mid T}\sigma(d)\mu(T/d)
\end{aligned}
\]</span> æœ€åä¸€æ­¥æ¢äº†ä¸ªå…ƒä»¤ <span class="math inline">\(T = dx\)</span>ã€‚è‹¥å†è€ƒè™‘è®© <span class="math inline">\(f(T) = \displaystyle\sum_{d\mid T}\sigma(d)\mu(T/d)\)</span>ï¼Œåˆ™è¦æ±‚çš„ä¸œè¥¿å°±è¢«è½¬åŒ–ä¸ºäº† <span class="math display">\[
\sum_{T = 1}^n\lfloor n / T\rfloor\lfloor m / T\rfloor f(T)
\]</span> ç„¶åæ³¨æ„åˆ°ï¼Œ<span class="math inline">\(\sigma(d)\)</span> èƒ½å¯¹ <span class="math inline">\(f(T)\)</span> äº§ç”Ÿè´¡çŒ®å½“ä¸”ä»…å½“ <span class="math inline">\(\sigma(d)\le a\)</span>ï¼Œé‚£ä¹ˆä¸å¦¨ç¦»çº¿æ‰€æœ‰è¯¢é—®ç„¶åå°†è¯¢é—®æŒ‰ <span class="math inline">\(a\)</span> æ’åºï¼Œå†å°†é¢„å¤„ç†å¥½çš„ <span class="math inline">\(\sigma(d)\)</span> ä»å°åˆ°å¤§æ’åºï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ <span class="math inline">\(f\)</span>ï¼Œæ¯æ¬¡åŠ  <span class="math inline">\(\sigma(d)\mu(T / d)\)</span> éƒ½ä¼šä½¿å¾— <span class="math inline">\(d\)</span> çš„å€æ•°å¯¹åº”çš„ <span class="math inline">\(f(T)\)</span> å¢åŠ ã€‚å¯¹äºæ¯ä¸ªè¯¢é—®ç›´æ¥æ•´é™¤åˆ†å—ã€‚æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(q\sqrt n\log n + n \log^2 n)\)</span>ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(4\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/CF1139D">CF1139D Steps to One</a></p>
<p>ç»™å®šæ­£æ•´æ•° <span class="math inline">\(m\le 10^5\)</span>ï¼Œåˆå§‹ç©ºæ•°åˆ—ï¼Œæ¯æ¬¡éšæœºä¸€ä¸ª <span class="math inline">\(1\sim m\)</span> çš„æ•´æ•°åŠ åœ¨æ•°åˆ—æœ«å°¾ï¼Œæ•°åˆ—çš„ <span class="math inline">\(\gcd = 1\)</span> æ—¶åœæ­¢ã€‚é—®æœŸæœ›é•¿åº¦ï¼Œå¯¹ <span class="math inline">\(10^9 + 7\)</span> å–æ¨¡ã€‚</p>
</blockquote>
<p>ä¸å¦¨è®¾ <span class="math inline">\(f_i\)</span> ä¸ºå½“å‰æ•°åˆ— <span class="math inline">\(\gcd\)</span> ä¸º <span class="math inline">\(i\)</span> æ—¶ï¼ŒæœŸæœ›çš„å‰©ä½™æ­¥æ•°ã€‚åˆ™æˆ‘ä»¬æœ‰æœ´ç´ è½¬ç§»ï¼š <span class="math display">\[
f_i = \frac 1m\sum_{j=1}^mf_{\gcd(j, i)} + 1
\]</span> è¾¹ç•Œæ¡ä»¶ä¸º <span class="math inline">\(f_1 = 0\)</span>ï¼Œç­”æ¡ˆå³ä¸º <span class="math inline">\(\dfrac 1m\sum f_i\)</span>ã€‚éœ€è¦æ³¨æ„ç‰¹åˆ¤ <span class="math inline">\(\gcd(i,j) = i\)</span> çš„æƒ…å†µï¼Œè§£ä¸ªæ–¹ç¨‹åå‘ç°å°±æ˜¯ <span class="math display">\[
f_i = \frac{1 + \frac1m\sum_{j=1,i\not\mid j}^m f_{\gcd(i,j)}}{1 - \lfloor\frac{m}{i}\rfloor}
\]</span> <span class="math inline">\(O(m^2\log m)\)</span> æ˜¾ç„¶æœ‰ç‚¹å¯„ï¼Œå¥—è·¯åœ°æšä¸¾ <span class="math inline">\(g = \gcd(i,j)\)</span>ï¼Œä»¤ <span class="math inline">\(c(i,g)\)</span> è¡¨ç¤º <span class="math inline">\(\sum_{x=1}^m[\gcd(x, i) = g]\)</span>ï¼Œåˆ™ <span class="math display">\[
f_i = \frac{1 + \frac1m \sum_{g\mid i,g\ne i}f_gc(i,g)}{1 - \lfloor\frac mi\rfloor}
\]</span> ç°åœ¨æ¨å¯¼ <span class="math inline">\(c\)</span>ï¼š <span class="math display">\[
\begin{aligned}
c(i,g) &amp;= \sum_{x=1}^m[\gcd(x,i) = g]\\
&amp;=\sum_{x' =1}^{\lfloor \frac mg\rfloor}[\gcd(x', i/g) = 1]\\
&amp;=\sum_{x'=1}^{\lfloor\frac mg\rfloor}\sum_{d\mid \gcd(x', i / g)}\mu(d)\\
&amp;=\sum_{d\mid \frac ig}\mu(d)\left\lfloor\frac{m}{gd} \right\rfloor
\end{aligned}
\]</span> äºæ˜¯æ±‚ <span class="math inline">\(c(i,g)\)</span> çš„æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(\sqrt{\frac ig})\)</span>ã€‚è®¾æ€»æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(T(m)\)</span>ï¼Œåˆ™ <span class="math display">\[
T(m) = \sum_{i=2}^m\sum_{g\mid i}O\left(\sqrt{\frac ig}\right) = \sum_{i=2}^m\sum_{j\mid i}O(\sqrt j) \sim m\int_1^mj^{-0.5}\mathrm{d}j = O(m\sqrt m)
\]</span> ä½†æ˜¯è¿™é¢˜è¿˜æœ‰å¦ä¸€ç§åšæ³•ï¼Œå³ç›´æ¥ä»æœŸæœ›å¼€æ¨ï¼š <span class="math display">\[
\begin{aligned}
E(n) &amp;= \sum_{i\ge 1}P(i = n)\times i\\
&amp;= \sum_{i\ge 1}P(i = n)\sum_{j=1}^i 1\\
&amp;=\sum_{j\ge 1}\sum_{i\ge j}P(n = i)\\
&amp;=\sum_{i\ge 1}P(n\ge i)\\
&amp;= 1 + \sum_{i\ge1}P(n&gt;i)
\end{aligned}
\]</span> æ±‚ <span class="math inline">\(P(n &gt; i)\)</span> çš„æ—¶å€™è€ƒè™‘ <span class="math inline">\(\gcd_{j=1}^{n}\{a_j\} = 1\)</span> çš„æ—¶å€™å°±ä¼šç»“æŸï¼Œç®€å•å®¹æ–¥ä¸€ä¸‹å†åæ¼”ï¼š <span class="math display">\[
\begin{aligned}
P(n&gt;i) &amp;= P\left(\gcd_{j=1}^i\{a_i\} &gt;1\right)\\
&amp;= 1 - P\left(\gcd_{j=1}^i\{a_i\} =1\right)\\
&amp;= 1 - \frac{\sum_{d=1}^m\mu(d)\lfloor\frac md\rfloor^i}{m^i}\\
&amp;= -\frac{\sum_{d=2}^m\mu(d)\lfloor\frac md\rfloor^i}{m^i}
\end{aligned}
\]</span> å›ä»£ä¸Šé¢çš„å¼å­ï¼Œæœ‰ <span class="math display">\[
\begin{aligned}
E(n) &amp;= 1 + \sum_{i\ge 1} P(n &gt; i)\\
&amp;= 1 - \sum_{i\ge 1}\frac{\sum_{d=2}^m\mu(d)\lfloor\frac md\rfloor^i}{m^i}\\
&amp;= 1 - \sum_{i\ge 1}\frac{1}{m^i}\sum_{d=2}^m\mu(d)\left\lfloor\frac md\right\rfloor^i\\
&amp;= 1 - \sum_{d=2}^m\mu(d)\sum_{i\ge 1}\left(\frac{\lfloor\frac md\rfloor}{m}\right)^i&amp;\text{recall the formula }x + x^2+\cdots=\frac{x}{1-x}\\
&amp;= 1 - \sum_{d=2}^m\mu(d)\frac{\lfloor\frac md\rfloor}{m - \lfloor\frac md\rfloor}
\end{aligned}
\]</span> å¯ä»¥ <span class="math inline">\(O(m)\)</span>ï¼Œä½†ä¹Ÿå¯ä»¥ä¸Šæœæ•™åšåˆ° <span class="math inline">\(O(m^{2/3})\)</span> ä½†æ²¡å¿…è¦ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(5\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/CF1559E">CF1559E Mocha and Stars</a></p>
<p>æ±‚æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„åºåˆ— <span class="math inline">\((a_1, a_2, \cdots , a_n)\)</span> çš„æ•°é‡ï¼š</p>
<ul>
<li><span class="math inline">\(\forall i\in[1, n], a_i\in[l_i, r_i]\)</span>ï¼›</li>
<li><span class="math inline">\(\sum a_i\le m\)</span>ï¼›</li>
<li><span class="math inline">\(\gcd(a_1, a_2, \cdots, a_n) = 1\)</span></li>
</ul>
<p><span class="math inline">\(2\le n\le 50\)</span>ï¼Œ<span class="math inline">\(1\le m\le 10^5\)</span>ï¼Œç­”æ¡ˆå¯¹ <span class="math inline">\(998244353\)</span> å–æ¨¡ã€‚</p>
</blockquote>
<p>ä¸è€ƒè™‘ <span class="math inline">\(\gcd\)</span> çš„é™åˆ¶ï¼Œå‘ç°å…¶ä¸ºä¸€ä¸ªèƒŒåŒ…ã€‚ä»¤ <span class="math inline">\(f_{i, j}\)</span> ä¸ºå‰ <span class="math inline">\(i\)</span> ä¸ªç‰©å“ï¼ŒèƒŒåŒ…å®¹é‡ä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰è½¬ç§»æ–¹ç¨‹ï¼š <span class="math display">\[
f_{i, j} = \sum_{k = l_i}^{r_i}f_{i - 1, j - k}
\]</span> è¿™æ ·ç›´æ¥å»åšæ˜¯ <span class="math inline">\(O(nm^2)\)</span> çš„ï¼Œå‘ç°è½¬ç§»å¯ä»¥ä½¿ç”¨å‰ç¼€å’Œä¼˜åŒ–ï¼Œå…·ä½“è®¾ <span class="math inline">\(s_{i, j}\)</span> è¡¨ç¤º <span class="math display">\[
s_{i, j} = \sum_{k = 0}^jf_{i, k}
\]</span> ç„¶åå°±æœ‰äº†è½¬ç§»æ–¹ç¨‹ <span class="math display">\[
f_{i, j} = s_{i - 1, j - l_i} - s_{i - 1, j - r_i - 1}
\]</span> èƒŒåŒ…éƒ¨åˆ†çš„å¤æ‚åº¦ä¸º <span class="math inline">\(O(nm)\)</span>ã€‚æ¥ä¸‹æ¥è€ƒè™‘ <span class="math inline">\(\gcd\)</span> çš„é™åˆ¶ï¼Œå¯¹äºè¿™ç§å¤šä¸ªçš„æƒ…å†µä¸€æ ·å¯ä»¥è€ƒè™‘åæ¼”ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{a_1=l_1}^{r_1}\sum_{a_2=l_2}^{r_2}\cdots\sum_{a_n=l_n}^{r_n}[\gcd(a_1,\cdots,a_n)=1]\left[\sum_{i = 1}^na_i\le m\right]\\
=&amp;\sum_{a_1=l_1}^{r_1}\sum_{a_2=l_2}^{r_2}\cdots\sum_{a_n=l_n}^{r_n}\left[\sum_{i = 1}^na_i\le m\right]\sum_{d \mid \gcd(a_1,\cdots,a_n)}\mu(d)\\ =&amp;\sum_{a_1=l_1}^{r_1}\sum_{a_2=l_2}^{r_2}\cdots\sum_{a_n=l_n}^{r_n}\left[\sum_{i = 1}^na_i\le m\right]\sum_{d\mid a_1,\cdots,d \mid a_n}\mu(d)\\
=&amp;\sum_{d=1}^m\mu(d)\sum_{a_1=\lceil\frac{l_1}{d}\rceil}^{\lfloor\frac{r_1}{d}\rfloor}\sum_{a_2=\lceil\frac{l_2}{d}\rceil}^{\lfloor\frac{r_2}{d}\rfloor}\cdots\sum_{a_n=\lceil\frac{l_n}{d}\rceil}^{\lfloor\frac{r_n}{d}\rfloor}\left[\sum_{i = 1}^na_i\le \left\lfloor\frac m d\right\rfloor\right]
\end{aligned}
\]</span> ç„¶åæšä¸¾ <span class="math inline">\(d\in[1, m]\)</span>ï¼Œå‘ç°å…¶å°±æ˜¯ä¸ªå­é—®é¢˜ï¼Œ<span class="math inline">\(O(nm\log m)\)</span> è§£å†³ã€‚å¯¹äº <span class="math inline">\(\mu(d) = 0\)</span> çš„æƒ…å†µè·³è¿‡è¿˜å¯ä»¥åŠ é€Ÿã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(6\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P6271">P6271 [æ¹–åŒ—çœé˜Ÿäº’æµ‹2014]ä¸€ä¸ªäººçš„æ•°è®º</a></p>
<p>å®šä¹‰ <span class="math inline">\(f_m(n)\)</span> ä¸ºæ‰€æœ‰å°äº <span class="math inline">\(n\)</span> ä¸”ä¸ <span class="math inline">\(n\)</span> äº’ç´ çš„æ­£æ•´æ•°çš„ <span class="math inline">\(m\)</span> æ¬¡æ–¹ä¹‹å’Œã€‚ç»™å®š <span class="math inline">\(m\)</span> çš„å€¼å’Œ <span class="math inline">\(n\)</span> çš„è´¨å› æ•°åˆ†è§£å¼ï¼Œæ±‚ <span class="math inline">\(f_m(n)\bmod 10^9 + 7\)</span> çš„å€¼ã€‚</p>
<p>è‹¥ <span class="math display">\[
n = \prod_{i = 1}^{w}p_i^{\alpha_i}
\]</span> æœ‰ <span class="math inline">\(1\le w \le 1000\)</span>ï¼Œ<span class="math inline">\(2\le p_i\le 10^9\)</span>ï¼Œ<span class="math inline">\(1\le \alpha_i\le 10^9\)</span>ï¼Œ<span class="math inline">\(0\le m \le 100\)</span>ã€‚</p>
</blockquote>
<p>ä¸€é“éå¸¸ç‰›é€¼çš„é¢˜ã€‚é¦–å…ˆæ˜ç¡®è¦æ±‚çš„å†…å®¹ä¸º <span class="math display">\[
\sum_{i=1}^{n-1}i^m[\gcd(i, n) = 1]
\]</span> ç„¶åç›´æ¥å¼€å§‹åæ¼”ï¼š <span class="math display">\[
\begin{aligned}
\sum_{i=1}^{n-1}i^m[\gcd(i, n) = 1] &amp;= \sum_{i=1}^{n}i^m[\gcd(i, n) = 1]\\
&amp;=\sum_{i=1}^ni^m\sum_{d\mid \gcd(i,n)}\mu(d)\\
&amp;=\sum_{d\mid n}\mu(d)\sum_{i=1}^{\frac nd}(id)^m\\
&amp;=\sum_{d\mid n}\mu(d)d^m\sum_{i=1}^{\frac nd} i^m
\end{aligned}
\]</span> ç„¶åä¼¼ä¹å°±åŒ–ä¸åŠ¨äº†ã€‚ã€‚ä½†æ˜¯æ³¨æ„åˆ°å¼å­é‡Œæœ‰å½¢å¦‚ <span class="math inline">\(f(n) = \displaystyle\sum_{i=1}^n i^m\)</span>ï¼Œå³è‡ªç„¶æ•°å¹‚ä¹‹å’Œï¼Œå…¶å¿…ç„¶ä¸ºå…³äº <span class="math inline">\(n\)</span> çš„ <span class="math inline">\(m + 1\)</span> æ¬¡å¤šé¡¹å¼ï¼Œå› ä¸º <span class="math inline">\(m\)</span> å¾ˆå°æ‰€ä»¥å¯ä»¥æš´åŠ›å°† <span class="math inline">\(f(x) = \displaystyle\sum_{i=0}^{m+1}f_ix^i\)</span> çš„ç³»æ•°æ¶ˆå…ƒå‡ºæ¥ã€‚ç„¶åå›ä»£ä¸€ä¸‹å¼å­ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{d\mid n}\mu(d)d^m\sum_{i=1}^{\lfloor\frac nd\rfloor} i^m\\
=&amp;\sum_{d\mid n}\mu(d)d^m\sum_{i=1}^{m+1}f_i\left(\frac nd\right)^{i}\\
=&amp;\sum_{i=1}^{m+1}f_i\sum_{d\mid n}\mu(d)d^m\left(\frac nd\right)^{i}
\end{aligned}
\]</span> å‘ç°åé¢é‚£å¨æ˜¯ç§¯æ€§å‡½æ•°çš„å·ç§¯ï¼Œæ‰€ä»¥å¯ä»¥å¯¹äºæ‰€æœ‰çš„ <span class="math inline">\(p_i^{\alpha_i}\)</span> æ±‚ä¸€éç„¶åä¹˜èµ·æ¥ï¼Œç°åœ¨è€ƒè™‘æ€ä¹ˆå¿«é€Ÿæ±‚ä¹‹ã€‚</p>
<p>æ³¨æ„åˆ°æœ‰ä¸ªä¸œè¥¿å« <span class="math inline">\(\mu\)</span>ï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿè´¡çŒ®çš„åªæœ‰ <span class="math inline">\(d = 1\)</span> å’Œ <span class="math inline">\(d = p_i\)</span> çš„æƒ…å†µï¼Œæ‰€ä»¥è¦ç®—çš„å®é™…å°±æ˜¯ <span class="math inline">\(p_i^{\alpha_ii} - p_i^{m + \alpha_ii - i}\)</span>ã€‚é—®é¢˜è§£å†³äº†ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(m^3 + m(m + w))\)</span>ã€‚</p>
<h3 id="å¸¸è§ç»“è®ºæ–¹æ³•">å¸¸è§ç»“è®º/æ–¹æ³•</h3>
<ul>
<li><p><strong>å†™ä»£ç çš„æ—¶å€™æ³¨æ„ <code>long long</code> å’Œå–æ¨¡çš„é—®é¢˜ï¼Œå¾ˆå®¹æ˜“å‡ºå²”å­ã€‚</strong></p></li>
<li><p>åŒ–ç®€å¼å­çš„æ—¶å€™å¯ä»¥å°†æ— å…³å˜é‡æå‰ï¼š <span class="math display">\[
\sum_{i = 1}^nf(n)\sum_{j = 1}^mk\times g(n) = \sum_{i = 1}^nf(n)k\sum_{j = 1}^mg(n)
\]</span></p></li>
<li><p>äº¤æ¢æšä¸¾é¡ºåºï¼š <span class="math display">\[
\sum_{i = 1}^nf(n)\sum_{d\mid i}g(d) = \sum_{d = 1}^ng(d)\sum_{i = 1}^{\lfloor\frac nd\rfloor}f(id)
\]</span></p></li>
<li><p>å°è¯•æ„é€  <span class="math inline">\(\epsilon = [n = 1]\)</span>ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{i = 1}^n\sum_{j = 1}^mf(\gcd(i, j))\\
=&amp;\sum_{d = 1}^n\sum_{i = 1}^n\sum_{j = 1}^mf(d)[\gcd(i,j) = d]\\
=&amp;\sum_{d = 1}^nf(d)\sum_{i = 1}^n\sum_{j = 1}^m[\gcd(i,j) = d]
\end{aligned}
\]</span> ä¹‹åå°±æ‡’å¾—å†™äº†ã€‚</p></li>
<li><p><span class="math inline">\(\operatorname{lcm}(i,j) = \dfrac{ij}{\gcd(i,j)}\)</span></p>
<p>è¿‡äºå¹³å‡¡ï¼Œä¸å†™ã€‚</p></li>
<li><p>å·§å¦™æ¢å…ƒå‡å°‘æšä¸¾æ•°é‡ï¼š <span class="math display">\[
\sum_{P(k)}\sum_{d = 1}^{\lfloor \frac nk\rfloor}\mu(d)\left\lfloor\frac{n}{kd}\right\rfloor\left\lfloor\frac{m}{kd}\right\rfloor = \sum_{T = 1}^n\left\lfloor\frac{n}{T}\right\rfloor\left\lfloor\frac{m}{T}\right\rfloor\sum_{k\mid T, P(k)}\mu\left(\frac Tk\right)
\]</span></p></li>
<li><p>é™¤æ•°å‡½æ•°çš„é‡è¦æ€§è´¨: <span class="math display">\[
d(xy) = \sum_{i\mid x}\sum_{j\mid y}[\gcd(i,j) = 1]
\]</span> è¯æ˜ï¼šè€ƒè™‘ä¸€ä¸€æ˜ å°„æ¯ä¸ªå› å­ã€‚</p>
<p>è®¾ <span class="math inline">\(k\mid xy\)</span>ï¼Œ<span class="math inline">\(k\)</span> ä¸­æœ‰å› å­ <span class="math inline">\(p^c\)</span>ï¼Œæˆ‘ä»¬å¼ºè¡Œè§„å®šå…ˆå– <span class="math inline">\(i\)</span> ä¸­çš„ <span class="math inline">\(p\)</span>ï¼Œé™¤éä¸å¤Ÿï¼Œå†å»å– <span class="math inline">\(j\)</span> ä¸­çš„ <span class="math inline">\(p\)</span>ã€‚è¿™æ ·å­ï¼Œå¦‚è‹¥æˆ‘ä»¬è¦æ±‚ <span class="math inline">\(i\perp j\)</span>ï¼Œåˆ™æ¯ä¸ªå› å­ <span class="math inline">\(k\)</span> éƒ½å”¯ä¸€å¯¹åº”ä¸€ä¸ª <span class="math inline">\((i, j)\)</span>ã€‚å‘½é¢˜å¾—è¯ã€‚</p>
<blockquote>
<p>å¯¹äºä¸€èˆ¬çš„é™¤æ•°å‡½æ•° <span class="math inline">\(\sigma_k\)</span>ï¼Œä¸Šè¿°æ€§è´¨ä»ç„¶å¯ä»¥æ‰©å±•ï¼š <span class="math display">\[
\sigma_k(xy) = \sum_{i\mid x}\sum_{j\mid y}\left(\frac{x}{i}\right)^kj^k[\gcd(i,j) = 1]
\]</span> è¯æ˜ä¾æ—§è€ƒè™‘ä¸Šé¢çš„æ€è·¯ã€‚å¯èƒ½å†™æˆè¿™æ ·ä¼šæ›´å¥½ç†è§£ï¼š <span class="math display">\[
\sigma_k(xy) = \sum_{i\mid x}\sum_{j\mid y}i^kj^k[\gcd(x / i, j) =1]
\]</span> ç„¶åæ¢ä¸€ä¸‹ <span class="math inline">\(i\)</span> å’Œ <span class="math inline">\(x / i\)</span> å°±å¯ä»¥äº†ã€‚</p>
</blockquote></li>
<li><p>æ¬§æ‹‰å‡½æ•°çš„æŸæ€§è´¨ï¼š <span class="math display">\[
\varphi(ab) = \varphi(a)\varphi(b)\frac{\gcd(a,b)}{\varphi(\gcd(a,b))}
\]</span> è¯æ˜ï¼šè€ƒè™‘å”¯ä¸€åˆ†è§£å®šç†ã€‚å¯¹äºæŸè´¨å› æ•° <span class="math inline">\(p\)</span>ï¼Œè‹¥ä»–åœ¨ <span class="math inline">\(a,b\)</span> ä¸­éƒ½å‡ºç°äº†ï¼Œåˆ™ <span class="math inline">\(\varphi(a)\varphi(b)\)</span> æŠŠä¸¤ä¸ª <span class="math inline">\(p\)</span> å˜æˆäº† <span class="math inline">\(p - 1\)</span>ï¼Œä¹˜ä¸Šä¸€ä¸ª <span class="math inline">\(\dfrac{\gcd(a,b)}{\varphi(\gcd(a,b))}\)</span> å¯ä»¥å°†å…¶ä¿®æ­£è¿‡æ¥ã€‚</p></li>
</ul>
<h2 id="ç­›æ³•">ç­›æ³•</h2>
<h3 id="åŸƒç­›">åŸƒç­›</h3>
<p>é€šè¿‡â€œ<span class="math inline">\(x\)</span> æ˜¯åˆæ•°ï¼Œåˆ™ <span class="math inline">\(x\)</span> çš„å€æ•°ä¹Ÿæ˜¯åˆæ•°â€æ¥å‡å°‘æ ‡è®°æ¬¡æ•°ï¼Œå³åªæ ‡è®°æ‰€æœ‰ç´ æ•°çš„å€æ•°ã€‚</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1"></a><span class="dt">void</span> Eratosthenes() {</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2"></a>    isp[<span class="dv">0</span>] = isp[<span class="dv">1</span>] = <span class="dv">1</span>;</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">2</span>; i &lt;= N; ++i) {</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4"></a>        <span class="cf">if</span> (!isp[i]) {</span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5"></a>            prime[++totp] = i;</span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6"></a>            <span class="cf">if</span> (<span class="dv">1</span><span class="bu">ll</span> * i * i &lt;= N)</span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7"></a>                <span class="cf">for</span> (<span class="dt">int</span> j = i * i; j &lt;= N; j += i)</span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8"></a>                    isp[j] = <span class="dv">1</span>;</span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9"></a>        }</span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10"></a>    }</span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11"></a>    <span class="cf">return</span>;</span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12"></a>}</span></code></pre></div>
<p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log\log n)\)</span>ï¼Œæ²¡æœ‰ä»€ä¹ˆå¼”ç”¨ï¼Œå¤æ‚åº¦åˆ†æç•¥ï¼ˆå› ä¸ºä¸ä¼šï¼‰ï¼Œå”¯ä¸€ç”¨å¤„æ˜¯å¯ä»¥æ‹¿æ¥åˆ†æ Dirichlet å‰ç¼€å’Œçš„å¤æ‚åº¦ã€‚</p>
<h3 id="çº¿æ€§ç­›">çº¿æ€§ç­›</h3>
<p>åˆåæ¬§æ‹‰ç­›ï¼Œå¯ä»¥ä»¥çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦ç­›å‡ºç»™å®šå€¼åŸŸå†…çš„ç´ æ•°ã€‚ä¸Šæ–‡å·²ç»æåˆ°äº†å¦‚ä½•ç”¨æ¬§æ‹‰ç­›ç­›ç´ æ•°ï¼Œä½†æ˜¯æ¬§æ‹‰ç­›çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œå…¶åˆ©ç”¨çš„<strong>æ¯ä¸ªåˆæ•°è¢«æœ€å°è´¨å› å­ç­›å»</strong>æ€§è´¨ä½¿å¾—å®ƒå¯ä»¥åŒæ—¶æ±‚å‡ºç§¯æ€§å‡½æ•°çš„å€¼ã€‚</p>
<h4 id="æ¬§æ‹‰å‡½æ•°è«æ¯”ä¹Œæ–¯å‡½æ•°">æ¬§æ‹‰å‡½æ•°/è«æ¯”ä¹Œæ–¯å‡½æ•°</h4>
<p>é¦–å…ˆå†æ¬¡å¼ºè°ƒï¼š<strong>æ¯ä¸ªåˆæ•° <span class="math inline">\(n\)</span> ä¼šè¢«å…¶æœ€å°è´¨å› å­ <span class="math inline">\(p\)</span> ç­›å»</strong>ï¼Œä¸‹é¢ä»¤ <span class="math inline">\(n' = n / p\)</span>ã€‚</p>
<ul>
<li><p>å¯¹äº <span class="math inline">\(p\not\mid n'\)</span> çš„æƒ…å†µï¼Œ<span class="math inline">\(n'\)</span> å’Œ <span class="math inline">\(p\)</span> å¿…ç„¶äº’è´¨ï¼Œæ­¤æ—¶æœ‰ <span class="math inline">\(\varphi(n) = \varphi(n')\times \varphi(p) = (p - 1)\varphi(n')\)</span>ã€‚</p></li>
<li><p>å¦åˆ™å¯¹äº <span class="math inline">\(p\mid n'\)</span> çš„æƒ…å†µï¼Œ<span class="math inline">\(n'\)</span> å¿…ç„¶åŒ…å« <span class="math inline">\(n\)</span> çš„æ‰€æœ‰è´¨å› å­ï¼Œæ‹†å¼€ <span class="math inline">\(\varphi(n)\)</span> çš„è¡¨è¾¾å¼æœ‰ <span class="math display">\[
\begin{aligned}
\varphi(n) &amp;= n\times \prod \frac{p_i - 1}{p_i}\\
&amp;= p\times n'\times \prod\frac{p_i - 1}{p_i}\\
&amp;= p\times \varphi(n')
\end{aligned}
\]</span></p></li>
</ul>
<p>é‚£ä¹ˆäº‹æƒ…å°±å˜å¾—æ˜æœ—äº†ï¼Œå¯¹äºè´¨æ•°ï¼Œ<span class="math inline">\(\varphi(n) = n - 1\)</span>ï¼Œå¯¹äºåˆæ•°ï¼Œåœ¨ç­›çš„è¿‡ç¨‹ä¸­æŒ‰ç…§ä¸Šé¢çš„å…¬å¼æ±‚å°±å¯ä»¥äº†ã€‚æ³¨æ„è¾¹ç•Œ <span class="math inline">\(\varphi(1) = 1\)</span>ã€‚</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1"></a><span class="dt">void</span> sieve() {</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2"></a>    phi[<span class="dv">1</span>] = <span class="dv">1</span>;</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">2</span>; i &lt;= maxn; ++i) {</span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4"></a>        <span class="cf">if</span> (!vis[i]) {</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5"></a>            phi[i] = i - <span class="dv">1</span>;</span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6"></a>            p[++tot] = i;</span>
<span id="cb4-7"><a aria-hidden="true" href="#cb4-7"></a>        }</span>
<span id="cb4-8"><a aria-hidden="true" href="#cb4-8"></a>        <span class="cf">for</span> (<span class="dt">int</span> j = <span class="dv">1</span>; j &lt;= tot &amp;&amp; i * p[j] &lt;= maxn; ++j) {</span>
<span id="cb4-9"><a aria-hidden="true" href="#cb4-9"></a>            vis[i * p[j]] = <span class="dv">1</span>;</span>
<span id="cb4-10"><a aria-hidden="true" href="#cb4-10"></a>            <span class="cf">if</span> (i % p[j] == <span class="dv">0</span>) {</span>
<span id="cb4-11"><a aria-hidden="true" href="#cb4-11"></a>                phi[i * p[j]] = p[j] * phi[i];</span>
<span id="cb4-12"><a aria-hidden="true" href="#cb4-12"></a>                <span class="cf">break</span>;</span>
<span id="cb4-13"><a aria-hidden="true" href="#cb4-13"></a>            }</span>
<span id="cb4-14"><a aria-hidden="true" href="#cb4-14"></a>            phi[i * p[j]] = (p[j] - <span class="dv">1</span>) * phi[i];</span>
<span id="cb4-15"><a aria-hidden="true" href="#cb4-15"></a>        }</span>
<span id="cb4-16"><a aria-hidden="true" href="#cb4-16"></a>    }</span>
<span id="cb4-17"><a aria-hidden="true" href="#cb4-17"></a>    <span class="cf">return</span>;</span>
<span id="cb4-18"><a aria-hidden="true" href="#cb4-18"></a>}</span></code></pre></div>
<hr/>
<p>è€Œäºè«æ¯”ä¹Œæ–¯å‡½æ•°ï¼Œåˆ™ç›¸å¯¹æ›´å¥½è€ƒè™‘ã€‚è¿˜æ˜¯ä»¤ <span class="math inline">\(n' = n / p\)</span>ï¼Œ<span class="math inline">\(p\)</span> ä¸º <span class="math inline">\(n\)</span> çš„æœ€å°è´¨å› å­ã€‚</p>
<p>å¯¹äºè´¨æ•°ï¼Œ<span class="math inline">\(\mu(n) = -1\)</span>ï¼Œå¯¹äºåˆæ•°ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹å¼åˆ†ç±»è®¨è®ºï¼š</p>
<ul>
<li><span class="math inline">\(p\not\mid n'\)</span>ï¼Œåˆ™ <span class="math inline">\(n'\)</span> ä¸ <span class="math inline">\(p\)</span> ä¸€å®šäº’è´¨ï¼Œ<span class="math inline">\(\mu(n) = -\mu(n')\)</span>ã€‚</li>
<li>å¦åˆ™ <span class="math inline">\(p\mid n'\)</span>ï¼Œè¿™è¯´æ˜ <span class="math inline">\(n\)</span> é‡Œé¢è‡³å°‘æœ‰ä¸€ä¸ªå¹³æ–¹å› å­ï¼ˆ<span class="math inline">\(p^2\)</span>ï¼‰ï¼Œæ‰€ä»¥ <span class="math inline">\(\mu(n) = 0\)</span>ã€‚</li>
</ul>
<p>è¿˜æ˜¯æ³¨æ„è¾¹ç•Œï¼Œ<span class="math inline">\(\mu(1) = 1\)</span>ï¼Œè®°ä¸ä½çš„è¯è€ƒè™‘ç§¯æ€§å‡½æ•°çš„æ€§è´¨ã€‚</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1"></a><span class="dt">void</span> sieve() {</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2"></a>    mu[<span class="dv">1</span>] = <span class="dv">1</span>;</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">2</span>; i &lt;= N; ++i) {</span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4"></a>        <span class="cf">if</span> (!vis[i]) {</span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5"></a>            mu[i] = -<span class="dv">1</span>;</span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6"></a>            prime[++tot] = i;</span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7"></a>        }</span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8"></a>        <span class="cf">for</span> (<span class="dt">int</span> j = <span class="dv">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt;= N; ++j) {</span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9"></a>            vis[i * prime[j]] = <span class="dv">1</span>;</span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10"></a>            <span class="cf">if</span> (i % prime[j]) mu[i * prime[j]] = -mu[i];</span>
<span id="cb5-11"><a aria-hidden="true" href="#cb5-11"></a>            <span class="cf">else</span> <span class="cf">break</span>;</span>
<span id="cb5-12"><a aria-hidden="true" href="#cb5-12"></a>        }</span>
<span id="cb5-13"><a aria-hidden="true" href="#cb5-13"></a>    }</span>
<span id="cb5-14"><a aria-hidden="true" href="#cb5-14"></a>    <span class="cf">return</span>;</span>
<span id="cb5-15"><a aria-hidden="true" href="#cb5-15"></a>}</span></code></pre></div>
<p><del>å½“ç„¶ä¸€èˆ¬æ˜¯æœ€åè¦åšå‰ç¼€å’Œçš„ï¼Œè¿™ä¸ªå¦è¯´å§ã€‚</del></p>
<h4 id="é™¤æ•°å‡½æ•°">é™¤æ•°å‡½æ•°</h4>
<p>é¦–å…ˆï¼Œè‹¥å°† <span class="math inline">\(n\)</span> å”¯ä¸€åˆ†è§£ï¼š<span class="math inline">\(\displaystyle n = \prod_{i=1}^sp_i^{\alpha_i}\)</span>ï¼Œåˆ™æœ‰ <span class="math inline">\(d(n) = \displaystyle\prod_{i=1}^s(1 + \alpha_i)\)</span>ã€‚å…¶ç»„åˆæ„ä¹‰ä¸ºï¼šæ¯ä¸ªè´¨å› å­é€‰ä¸å¤§äº <span class="math inline">\(\alpha_i\)</span> ä¸ªå‡ºæ¥ï¼Œå…¶ä¸€å®šä¸º <span class="math inline">\(n\)</span> çš„å› æ•°ã€‚</p>
<p>ç”±äº <span class="math inline">\(n\)</span> ä¼šè¢«æœ€å°è´¨å› å­ <span class="math inline">\(p\)</span> ç­›å»ï¼Œæ‰€ä»¥è¿˜éœ€è¦å¯¹æ¯ä¸ªæ•°é¢å¤–ç»´æŠ¤å…¶æœ€å°è´¨å› å­çš„å¹‚æ¬¡ <span class="math inline">\(f\)</span>ã€‚</p>
<ul>
<li>å¯¹äºè´¨æ•°ï¼Œ<span class="math inline">\(d(n) = 2\)</span>ï¼Œ<span class="math inline">\(f(n) = 1\)</span>ã€‚</li>
<li>å½“ <span class="math inline">\(p\not\mid n'\)</span>ï¼Œæ ¹æ® <span class="math inline">\(d\)</span> çš„ç§¯æ€§ï¼Œæœ‰ <span class="math inline">\(d(n) = 2d(n')\)</span>ï¼Œ<span class="math inline">\(f(n) = 1\)</span>ã€‚</li>
<li>å¦åˆ™ï¼Œæ ¹æ®ä¸Šé¢çš„å…¬å¼æœ‰ <span class="math inline">\(\displaystyle d(n) = \frac{d(n')}{1 + f(n')} \times(2 + f(nâ€™))\)</span>ï¼Œ<span class="math inline">\(f(n) = f(n') + 1\)</span>ã€‚</li>
</ul>
<hr/>
<p>å¯¹äº <span class="math inline">\(\sigma\)</span>ï¼Œæœ‰å¦‚ä¸‹å…¬å¼ï¼š<span class="math inline">\(\sigma(n) = \displaystyle\prod_{i=1}^s\sum_{j=0}^{\alpha_i}p_i^j\)</span>ã€‚ç»„åˆæ„ä¹‰ä¸ºï¼šè€ƒè™‘æ¯ä¸ªè´¨å› å­é‡Œé¢é€‰ä¸åŒçš„æ¬¡æ•°å‡ºæ¥ç»„åˆæˆè¿™ <span class="math inline">\(d(n)\)</span> ä¸ªå› æ•°ã€‚</p>
<p>ç±»ä¼¼çš„ï¼Œéœ€è¦ç»´æŠ¤æœ€å°è´¨å› å­çš„å„æ¬¡å¹‚ä¹‹å’Œ <span class="math inline">\(g\)</span>ï¼š</p>
<ul>
<li>å¯¹äºè´¨æ•°ï¼Œ<span class="math inline">\(\sigma(n) = g(n) = 1 + n\)</span>ã€‚</li>
<li>å½“ <span class="math inline">\(p\not\mid n'\)</span>ï¼Œæ ¹æ® <span class="math inline">\(\sigma\)</span> çš„ç§¯æ€§æœ‰ <span class="math inline">\(\sigma(n) = (p + 1)\sigma(n')\)</span>ï¼Œ<span class="math inline">\(g(n) = 1 + p\)</span>ã€‚</li>
<li>å¦åˆ™ï¼Œæ ¹æ®ä¸Šé¢çš„å…¬å¼æœ‰ <span class="math inline">\(g(n) = pg(n') + 1\)</span>ï¼Œ<span class="math inline">\(\displaystyle \sigma(n) = \frac{\sigma(n')}{g(n')}\times g(n)\)</span>ã€‚</li>
</ul>
<p>ä»£ç å°±ä¸æ”¾äº†ï¼Œæ„Ÿå—äº†ä¸Šé¢çš„è¿‡ç¨‹ä¹‹åé‡åˆ°é¢˜ç›®å¯ä»¥è‡ªå·±æ¨å¯¼ã€‚</p>
<p>è€Œå¯¹äºä¸€èˆ¬çš„ <span class="math inline">\(\sigma_k\)</span>ï¼Œä¸€æ ·æœ‰å…¬å¼ <span class="math inline">\(\sigma_k(n) = \displaystyle\prod_{i=1}^s\sum_{j=0}^{\alpha_i} p_i^{jk}\)</span>ã€‚åŒæ ·ç»´æŠ¤ä¸€ä¸‹ <span class="math inline">\(g\)</span> å³å¯ã€‚</p>
<h4 id="å¹‚å‡½æ•°">å¹‚å‡½æ•°</h4>
<p>å½“ç„¶ï¼Œç›´æ¥ <span class="math inline">\(O(n\log n)\)</span> æ±‚å¹‚å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æŸäº›æ—¶å€™æ—¶é™å¯èƒ½ä¼šå¡çš„å¾ˆç´§ã€‚</p>
<p>æ ¹æ® <span class="math inline">\(\mathrm{id}_k\)</span> çš„å®Œå…¨ç§¯æ€§ï¼Œå¯¹äºè´¨æ•°å¤„çš„ç‚¹å€¼å¿«é€Ÿå¹‚ä¸€ä¸‹ï¼Œå…¶ä»–æƒ…å†µç›´æ¥ä¹˜èµ·æ¥å°±æ²¡é—®é¢˜äº†ã€‚</p>
<h3 id="æœæ•™ç­›">æœæ•™ç­›</h3>
<p>æœæ•™ç­›å¯ä»¥åœ¨<strong>ä½äºçº¿æ€§</strong>çš„æ—¶é—´å¤æ‚åº¦å†…æ±‚å‡ºä¸€ç±»<strong>ç§¯æ€§å‡½æ•°</strong>çš„å‰ç¼€å’Œã€‚</p>
<p>å‰ç½®çŸ¥è¯†ï¼šä¸Šæ–‡è«æ¯”ä¹Œæ–¯åæ¼”éƒ¨åˆ†ï¼Œç§¯æ€§å‡½æ•°éƒ¨åˆ†ã€‚</p>
<h4 id="ç®—æ³•æµç¨‹">ç®—æ³•æµç¨‹</h4>
<p>æ˜¯ä¸€ç§ç±»ä¼¼<em>ç¡¬æ„é€ </em>çš„æ„Ÿè§‰ã€‚ä»¤æˆ‘ä»¬è¦æ±‚çš„ç§¯æ€§å‡½æ•°ä¸º <span class="math inline">\(f(n)\)</span>ï¼Œå…¶å‰ç¼€å’Œä¸º <span class="math inline">\(S(n)\)</span>ã€‚</p>
<p>ç°åœ¨æƒ³åŠæ³•æ„é€ ä¸€ä¸ª <span class="math inline">\(S(n)\)</span> å…³äº <span class="math inline">\(S\left(\left\lfloor\dfrac ni\right\rfloor\right)\)</span> çš„é€’æ¨å¼ï¼Œä¸å¦¨è®© <span class="math inline">\(f\)</span> å·ä¸Šå¦ä¸€ä¸ªç§¯æ€§å‡½æ•° <span class="math inline">\(g\)</span> ç„¶åè€ƒè™‘å…¶å‰ç¼€å’Œï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{i=1}^n (f*g)(i)\\
=&amp;\sum_{i=1}^n\sum_{d\mid i}g(d)f\left(\frac id\right)\\
=&amp;\sum_{d=1}^ng(d)\sum_{i=1}^{\lfloor\frac nd\rfloor}f(i)\\
=&amp;\sum_{d=1}^ng(d)S\left(\left\lfloor\dfrac nd\right\rfloor\right)
\end{aligned}
\]</span> ç¬¬ä¸‰è¡Œæ˜¯äº¤æ¢æšä¸¾é¡ºåºç„¶åæå‡ºäº† <span class="math inline">\(g(d)\)</span>ã€‚</p>
<p>ç„¶åå°† <span class="math inline">\(g(1)S(n)\)</span> ç§»é¡¹ä¸€ä¸‹å°±å¾—åˆ°äº†æœæ•™ç­›çš„æ ¸å¿ƒå¼å­ï¼š <span class="math display">\[
g(1)S(n) = \sum_{i=1}^n(f*g)(i) - \sum_{d=2}^ng(d)S\left(\left\lfloor\dfrac nd\right\rfloor\right)
\]</span> å¦‚æœèƒ½å¿«é€Ÿç®—å‡º <span class="math inline">\((f*g)(n)\)</span> å’Œ <span class="math inline">\(g(n)\)</span> çš„å‰ç¼€å’Œçš„è¯ï¼Œå°±æ„å‘³ç€ä¸Šé¢çš„å¼å­å¯ä»¥å¿«é€Ÿé€’å½’è®¡ç®—ã€‚è§ä¸‹é¢ä¼ªä»£ç ï¼š</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1"></a>ll getSum(<span class="dt">int</span> n) {</span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2"></a>    <span class="cf">if</span> (hash[n]) <span class="cf">return</span> hash[n]; <span class="co">// è®°å¿†åŒ–</span></span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3"></a>    ll ret = f_g_sum(n); <span class="co">// æ±‚ (f*g)(i) çš„å‰ç¼€å’Œ</span></span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4"></a>    <span class="cf">for</span> (ll l = <span class="dv">2</span>, r; l &lt;= n; l = r + <span class="dv">1</span>) { <span class="co">// æ•´é™¤åˆ†å—</span></span>
<span id="cb6-5"><a aria-hidden="true" href="#cb6-5"></a>        r = min(n, n / (n / l));</span>
<span id="cb6-6"><a aria-hidden="true" href="#cb6-6"></a>        ret -= (<span class="va">g_sum</span>(r) - <span class="va">g_sum</span>(l - <span class="dv">1</span>)) * getSum(n / l);</span>
<span id="cb6-7"><a aria-hidden="true" href="#cb6-7"></a>    }</span>
<span id="cb6-8"><a aria-hidden="true" href="#cb6-8"></a>    <span class="cf">return</span> ret;</span>
<span id="cb6-9"><a aria-hidden="true" href="#cb6-9"></a>}</span></code></pre></div>
<p>ç”±äºç½‘ä¸Šå…³äºæœæ•™ç­›å¤æ‚åº¦çš„è¯æ˜æœ‰å„ç§è¯´æ³•ï¼Œæ‰€ä»¥æ­¤å¤„å…ˆå’•ç€ã€‚æ€»ä¹‹ä¸€èˆ¬è€Œè¨€ï¼Œæœæ•™ç­›æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^{0.75})\)</span>ï¼Œè‹¥ç”¨çº¿æ€§ç­›æå‰å¤„ç†å¥½å‰ <span class="math inline">\(n^{2/3}\)</span> é¡¹çš„è¯å¤æ‚åº¦åˆ™é™ä½ä¸º <span class="math inline">\(O(n^{2/3})\)</span>ã€‚</p>
<h4 id="å¸¸è§æ¨¡å‹">å¸¸è§æ¨¡å‹</h4>
<blockquote>
<p>æ¨¡å‹ <span class="math inline">\(1\)</span>ï¼šç­› <span class="math inline">\(\varphi\)</span>ã€‚</p>
</blockquote>
<p>å‘ç° <span class="math inline">\(\varphi * \boldsymbol 1 = \mathrm{id}\)</span>ï¼Œæ‰€ä»¥å– <span class="math inline">\(f = \varphi\)</span>ï¼Œ<span class="math inline">\(g = 1\)</span>ï¼Œç„¶åå°±å¯ä»¥å¾ˆå®¹æ˜“æœæ•™ç­›è¾£ï¼š <span class="math display">\[
S(n) = \frac{n(n+1)}{2} - \sum_{d=2}^n S\left(\left\lfloor\dfrac nd\right\rfloor\right)
\]</span></p>
<blockquote>
<p>æ¨¡å‹ <span class="math inline">\(2\)</span>ï¼šç­› <span class="math inline">\(\mu\)</span>ã€‚</p>
</blockquote>
<p>ä¼šå‘ç° <span class="math inline">\(\mu * \boldsymbol 1 = \varepsilon\)</span>ï¼Œæ‰€ä»¥å– <span class="math inline">\(f = \mu\)</span>ï¼Œ<span class="math inline">\(g = \boldsymbol 1\)</span>ï¼Œç„¶åï¼š <span class="math display">\[
S(n) = 1 - \sum_{d=2}^nS\left(\left\lfloor\dfrac nd\right\rfloor\right)
\]</span></p>
<blockquote>
<p>æ¨¡å‹ <span class="math inline">\(2.5\)</span>ï¼šæ±‚ <span class="math inline">\(\sum\limits_{i=1}^n[2\not\mid i]\mu(i)\)</span>ã€‚</p>
</blockquote>
<p>å³å¥‡æ•°ä½ç½®ä¸Šçš„å’Œã€‚è®¾å…¶ä¸º <span class="math inline">\(T(n)\)</span>ï¼Œ<span class="math inline">\(\mu\)</span> çš„å‰ç¼€å’Œä¸º <span class="math inline">\(S(n)\)</span>ã€‚è€ƒè™‘ç”¨ <span class="math inline">\(S(n)\)</span> å‡å»å¶æ•°ä½ç½®ä¸Š <span class="math inline">\(\mu\)</span> çš„å’Œï¼Œè‡³äºå¶æ•°ä½ç½®ä¸Š <span class="math inline">\(\mu\)</span> çš„å’Œï¼Œè€ƒè™‘è‹¥å…¶åªæœ‰ä¸€ä¸ª <span class="math inline">\(2\)</span> å› å­ï¼Œé‚£ä¹ˆ <span class="math inline">\(/2\)</span> ä¹‹åå…¶å¿…ç„¶æ˜¯å¥‡æ•°ï¼Œè€Œè‹¥æœ‰å¤šä¸ª <span class="math inline">\(2\)</span> çš„å› å­çš„è¯ï¼Œæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ä¸ç®¡ï¼Œäºæ˜¯è¿™éƒ¨åˆ†è´¡çŒ®å°±æ˜¯ <span class="math inline">\(-T(\lfloor n / 2\rfloor)\)</span>ã€‚æ‰€ä»¥ <span class="math display">\[
T(n) = S(n) + T(\lfloor n / 2\rfloor)
\]</span></p>
<blockquote>
<p>æ¨¡å‹ <span class="math inline">\(3\)</span>ï¼šç­› <span class="math inline">\(\sigma_k\)</span>ï¼Œå³é™¤æ•°å‡½æ•°ï¼Œå®šä¹‰è§ä¸Šæ–‡ã€‚</p>
</blockquote>
<p>ç”±äº <span class="math inline">\(\sigma_k = \boldsymbol 1 * \mathrm{id}_k\)</span>ï¼Œæ‰€ä»¥ <span class="math inline">\(\sigma_k * \mu = \mathrm{id}_k\)</span>ï¼Œç„¶åï¼š <span class="math display">\[
S(n) = \sum_{i=1}^n\mathrm{id}_k(i) - \sum_{d=2}^n\mu(d)S\left(\left\lfloor\dfrac nd\right\rfloor\right)
\]</span> é¡ºä¾¿éœ€è¦ç­›å‡º <span class="math inline">\(\mu\)</span>ã€‚</p>
<blockquote>
<p>æ¨¡å‹ <span class="math inline">\(4\)</span>ï¼š<span class="math inline">\(\mu\cdot \mathrm{id}_k\)</span> å’Œ <span class="math inline">\(\varphi\cdot \mathrm{id}_k\)</span>ã€‚ç‚¹ä¹˜å‹ã€‚</p>
</blockquote>
<p>æ„é€  <span class="math inline">\(g\)</span> çš„æ—¶å€™è®© <span class="math inline">\(g\)</span> æ¥ä¸€ä¸ª <span class="math inline">\(\mathrm{id}_k\)</span> å·æ‰å³å¯ã€‚å…·ä½“åœ°ï¼š <span class="math display">\[
\begin{aligned}
(\mu\cdot \mathrm{id}_k)* \mathrm{id}_k &amp;= \sum_{d\mid n}\mu(d)d^k\left(\frac nd\right)^k\\
&amp;= n^k\sum_{d\mid n}\mu(d)\\
&amp;= \varepsilon
\end{aligned}
\]</span> è‡³äºæ¬§æ‹‰ï¼Œåˆ™æœ‰ <span class="math display">\[
\begin{aligned}
(\varphi \cdot \mathrm{id}_k) * \mathrm{id}_k &amp;= \sum_{d\mid n}\varphi(d)d^k\left(\frac nd\right)^k\\
&amp;= n^k\sum_{d\mid n}\varphi(d)\\
&amp;= \mathrm{id}^{k + 1}
\end{aligned}
\]</span> ç„¶åæœæ•™ç­›çš„è¿‡ç¨‹ç•¥ã€‚</p>
<blockquote>
<p>noteï¼šå¸¸è§çš„ <span class="math inline">\(\mathrm{id}_k\)</span> å‰ç¼€å’Œï¼š</p>
<ul>
<li><span class="math inline">\(\displaystyle\sum_{i=1}^n\mathrm{id}(i) = \frac{n(n+1)}{2}\)</span>ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯è¾ƒå¸¸è§„çš„ç­‰å·®æ•°åˆ—æ±‚å’Œã€‚</li>
<li><span class="math inline">\(\displaystyle\sum_{i=1}^n\mathrm{id}_2(i) = \frac{n(n+1)(2n+1)}{6}\)</span>ï¼Œè¯æ˜å¯ä»¥è€ƒè™‘æ•°å½’ã€‚</li>
<li><span class="math inline">\(\displaystyle\sum_{i=1}^n\mathrm{id}_3(i) = \left[\frac{n(n+1)}{2}\right]^2\)</span>ï¼Œè¯æ˜åŒæ ·è€ƒè™‘æ•°å½’ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œç”±äº <span class="math inline">\((\sum \mathrm{id}_k)(n)\)</span> æ˜¯å…³äº <span class="math inline">\(n\)</span> çš„ <span class="math inline">\(k+ 1\)</span> æ¬¡å¤šé¡¹å¼ï¼ˆç»å…¸ç»“è®ºï¼‰ï¼Œæ•…å½“ <span class="math inline">\(k\)</span> ä¸å¤§æ—¶å¯ä»¥è€ƒè™‘å°†ç³»æ•°æ’å‡ºæ¥ç„¶å <span class="math inline">\(O(k)\)</span> å•æ¬¡æ±‚å€¼ã€‚</p>
</blockquote>
<p>ä¸Šé¢çš„å‡ ä¸ªå¼å­å»ºè®®ç‰¢è®°ï¼Œå¯ä»¥çœå»è‡ªå·±æ¨çš„éº»çƒ¦ã€‚</p>
<blockquote>
<p>æ¨¡å‹ <span class="math inline">\(6\)</span>ï¼šç­› <span class="math inline">\(\mu^2\)</span>ã€‚</p>
</blockquote>
<p>åº”è¯¥æ˜¯æ¯”è¾ƒç¥ä»™çš„æ„é€  <span class="math inline">\(g\)</span> å‡½æ•°äº†ã€‚</p>
<p>æ­¤å¤„å– <span class="math inline">\(g(n) = [n = k^2, k\in \mathbb{N}_+]\)</span>ã€‚è™½ç„¶ <span class="math inline">\(g\)</span> çš„å‰ç¼€å’Œçœ‹ä¼¼ä¸å¥½æ±‚ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹äº<strong>è¿™ç§çœŸå€¼è¡¨è¾¾å¼çš„å‡½æ•°ï¼Œå¯ä»¥æ”¹å˜æšä¸¾çš„ç­–ç•¥ä½¿å¾—å…¶æ’æˆç«‹ï¼Œå˜ä¸ºå¸¸æ•°å‡½æ•°</strong>ã€‚</p>
<p><span class="math inline">\((f*g)(n) = \displaystyle\sum_{d\mid n}g(d)f(n / d)\)</span>ï¼Œè§‚å¯Ÿå‘ç° <span class="math inline">\(g(d)f(n / d)\)</span> ä»…åœ¨ <span class="math inline">\(d\)</span> å–åˆ° <span class="math inline">\(n\)</span> çš„æœ€å¤§å¹³æ–¹å› å­æ—¶ä¸º <span class="math inline">\(1\)</span>ï¼Œå¦åˆ™ä¸º <span class="math inline">\(0\)</span>ã€‚å› ä¸ºè‹¥ <span class="math inline">\(d\)</span> ä¸ä¸ºæœ€å¤§å¹³æ–¹å› å­ï¼Œåˆ™ <span class="math inline">\(n / d\)</span> è‚¯å®šå«å¹³æ–¹å› å­ï¼Œ<span class="math inline">\(\mu^2(n / d) = 0\)</span>ã€‚å¦åˆ™ <span class="math inline">\(n / d\)</span> ä¸€å®šä¸å«å¹³æ–¹å› å­ï¼Œ<span class="math inline">\(f(n / d) = g(d) = 1\)</span>ã€‚æ‰€ä»¥ <span class="math inline">\(f*g = \boldsymbol 1\)</span>ã€‚</p>
<p>å¥—å›æœæ•™ç­›çš„å¼å­ï¼š <span class="math display">\[
\begin{aligned}
S(n) &amp;= \sum_{i=1}^n (f*g)(i) - \sum_{d=2}^ng(d)S\left(\left\lfloor\frac nd\right\rfloor \right)\\
&amp;= n - \sum_{d=2}^{\lfloor \sqrt n\rfloor} S\left(\left\lfloor\frac{n}{d^2}\right\rfloor \right)
\end{aligned}
\]</span> æ²¡æ³•æ•´é™¤åˆ†å—ï¼Œæ‰€ä»¥å¯èƒ½å¤æ‚åº¦å±ã€‚</p>
<p>ä½†å…¶å®è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼šæˆ‘ä»¬è€ƒè™‘å®¹æ–¥ã€‚<span class="math inline">\(S(n)\)</span> å¯ä»¥çœ‹ä½œ æ€»æ•° - ä¸€ä¸ªå¹³æ–¹æ•°çš„å€æ•° + ä¸¤ä¸ªå¹³æ–¹æ•°çš„å€æ•° - â€¦..ï¼Œå‘ç°å®¹æ–¥ç³»æ•°å°±æ˜¯ <span class="math inline">\(\mu\)</span>ï¼Œæ‰€ä»¥ <span class="math inline">\(S(n) = \displaystyle\sum_{i=1}^{\lfloor \sqrt n\rfloor}\mu(i)\lfloor n / i^2\rfloor\)</span>ã€‚</p>
<p>å¦æœ‰å°ç»“è®º <span class="math inline">\(\mu^2(n) = \displaystyle\sum_{d^2\mid n}\mu(d)\)</span>ã€‚</p>
<h4 id="åº”ç”¨-1">åº”ç”¨</h4>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(1\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P4213">P4213 ã€æ¨¡æ¿ã€‘æœæ•™ç­›ï¼ˆSumï¼‰</a></p>
<p><span class="math inline">\(T\le 10\)</span> ç»„è¯¢é—®ï¼Œä¸€æ¬¡è¯¢é—®æŸ¥è¯¢ <span class="math inline">\(\varphi\)</span> å’Œ <span class="math inline">\(\mu\)</span> çš„å‰ç¼€å’Œï¼Œ<span class="math inline">\(n&lt; 2^{31}\)</span>ã€‚</p>
</blockquote>
<p>ä¸»è¦çœ‹ä¸‹ä»£ç æ€ä¹ˆå†™çš„ã€‚</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1"></a><span class="kw">using</span> ll = <span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span>;</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">1e7</span> + <span class="dv">15</span>;</span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3"></a><span class="bu">std::</span>unordered_map&lt;ll, ll&gt; Mu, Phi;</span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4"></a>ll mu[maxn], phi[maxn];</span>
<span id="cb7-5"><a aria-hidden="true" href="#cb7-5"></a><span class="dt">int</span> vis[maxn], p[maxn], tot;</span>
<span id="cb7-6"><a aria-hidden="true" href="#cb7-6"></a></span>
<span id="cb7-7"><a aria-hidden="true" href="#cb7-7"></a><span class="dt">void</span> init() {<span class="co">// çº¿æ€§ç­› mu å’Œ phi åœ¨ 1e7 å¤„å‰ç¼€å’Œçš„è¿‡ç¨‹çœç•¥}</span></span>
<span id="cb7-8"><a aria-hidden="true" href="#cb7-8"></a></span>
<span id="cb7-9"><a aria-hidden="true" href="#cb7-9"></a>ll getSumPhi(ll n) {</span>
<span id="cb7-10"><a aria-hidden="true" href="#cb7-10"></a>    <span class="cf">if</span> (n &lt;= maxn)</span>
<span id="cb7-11"><a aria-hidden="true" href="#cb7-11"></a>        <span class="cf">return</span> phi[n];</span>
<span id="cb7-12"><a aria-hidden="true" href="#cb7-12"></a>    <span class="cf">if</span> (Phi[n])</span>
<span id="cb7-13"><a aria-hidden="true" href="#cb7-13"></a>        <span class="cf">return</span> Phi[n];</span>
<span id="cb7-14"><a aria-hidden="true" href="#cb7-14"></a>    ll ans = (ll)(n + <span class="dv">1</span><span class="bu">ll</span>) * (ll)n / <span class="dv">2</span><span class="bu">ll</span>; <span class="co">// id çš„å‰ç¼€å’Œ</span></span>
<span id="cb7-15"><a aria-hidden="true" href="#cb7-15"></a>    <span class="cf">for</span> (ll l = <span class="dv">2</span>, r; l &lt;= n; l = r + <span class="dv">1</span>) {</span>
<span id="cb7-16"><a aria-hidden="true" href="#cb7-16"></a>        r = n / (n / l);</span>
<span id="cb7-17"><a aria-hidden="true" href="#cb7-17"></a>        ans -= (r - l + <span class="dv">1</span><span class="bu">LL</span>) * getSumPhi(n / l);</span>
<span id="cb7-18"><a aria-hidden="true" href="#cb7-18"></a>    }</span>
<span id="cb7-19"><a aria-hidden="true" href="#cb7-19"></a>    <span class="cf">return</span> Phi[n] = ans; <span class="co">// è®°å¿†åŒ–</span></span>
<span id="cb7-20"><a aria-hidden="true" href="#cb7-20"></a>}</span>
<span id="cb7-21"><a aria-hidden="true" href="#cb7-21"></a></span>
<span id="cb7-22"><a aria-hidden="true" href="#cb7-22"></a>ll getSumMu(ll n) {</span>
<span id="cb7-23"><a aria-hidden="true" href="#cb7-23"></a>    <span class="cf">if</span> (n &lt;= maxn)</span>
<span id="cb7-24"><a aria-hidden="true" href="#cb7-24"></a>        <span class="cf">return</span> mu[n];</span>
<span id="cb7-25"><a aria-hidden="true" href="#cb7-25"></a>    <span class="cf">if</span> (Mu[n])</span>
<span id="cb7-26"><a aria-hidden="true" href="#cb7-26"></a>        <span class="cf">return</span> Mu[n];</span>
<span id="cb7-27"><a aria-hidden="true" href="#cb7-27"></a>    ll ans = <span class="dv">1</span>; <span class="co">// epsilon çš„å‰ç¼€å’Œå°±æ˜¯ 1</span></span>
<span id="cb7-28"><a aria-hidden="true" href="#cb7-28"></a>    <span class="cf">for</span> (ll l = <span class="dv">2</span>, r; l &lt;= n; l = r + <span class="dv">1</span>) {</span>
<span id="cb7-29"><a aria-hidden="true" href="#cb7-29"></a>        r = n / (n / l);</span>
<span id="cb7-30"><a aria-hidden="true" href="#cb7-30"></a>        ans -= (r - l + <span class="dv">1</span><span class="bu">LL</span>) * getSumMu(n / l);</span>
<span id="cb7-31"><a aria-hidden="true" href="#cb7-31"></a>    }</span>
<span id="cb7-32"><a aria-hidden="true" href="#cb7-32"></a>    <span class="cf">return</span> Mu[n] = ans; <span class="co">// è®°å¿†åŒ–</span></span>
<span id="cb7-33"><a aria-hidden="true" href="#cb7-33"></a>}</span></code></pre></div>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(2\)</span>ï¼š<a href="https://loj.ac/p/6491">LOJ#6491. ã€ŒXXOI 2018ã€ç®€å•çš„æœ€å¤§å…¬çº¦æ•°</a></p>
<p>ABC162E - Sum of gcd of Tuples (Hard) çš„åŠ å¼ºï¼šç»™å®š <span class="math inline">\(1\le N, K\le 10^{11}\)</span>ï¼Œæ±‚ <span class="math display">\[
\sum_{a_1 = 1}^K\sum_{a_2 = 1}^K\cdots\sum_{a_N = 1}^K\gcd_{i = 1}^N\{a_i\}\bmod {10^9 + 7}
\]</span> ç­”æ¡ˆå¯¹ <span class="math inline">\(2^{64}\)</span> å–æ¨¡ã€‚</p>
</blockquote>
<p>å…ˆè€ƒè™‘åæ¼”ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{a_1 = 1}^K\sum_{a_2 = 1}^K\cdots\sum_{a_N = 1}^K\gcd_{i = 1}^N\{a_i\}\\
=&amp;\sum_{a_1 = 1}^K\cdots\sum_{a_N = 1}^K\sum_{d\mid a_1,\cdots d\mid a_N}\varphi(d)\\
=&amp;\sum_{d = 1}^K\varphi(d)\sum_{a_1 = 1}^K\cdots\sum_{a_N = 1}^K[d\mid \gcd\{a_i\}]\\
=&amp;\sum_{d = 1}^K\varphi(d)\left\lfloor\frac Kd\right\rfloor^N
\end{aligned}
\]</span> ç„¶åå°±å¯ä»¥æ•´é™¤åˆ†å— + æœæ•™ç­›äº†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^{2/3})\)</span>ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(3\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P3768">P3768 ç®€å•çš„æ•°å­¦é¢˜</a></p>
<p>ç»™å®š <span class="math inline">\(n\le 10^{10}\)</span> å’Œ <span class="math inline">\(5\times 10^8\le p\le 1.1\times 10^9\)</span>ï¼Œä¿è¯ <span class="math inline">\(p\)</span> ä¸ºè´¨æ•°ï¼Œæ±‚ <span class="math display">\[
\left(\sum_{i=1}^n\sum_{j=1}^nij\gcd(i,j) \right)\bmod p
\]</span></p>
</blockquote>
<p>é¦–å…ˆæ˜¾ç„¶å…ˆæ¬§æ‹‰åæ¼”ï¼š <span class="math display">\[
\begin{aligned}
\sum_{i=1}^n\sum_{j=1}^nij\gcd(i,j) &amp;= \sum_{i=1}^n\sum_{j=1}^nij\sum_{d\mid \gcd(i,j)}\varphi(d)\\
&amp;= \sum_{d=1}^n\varphi(d)\sum_{i=1}^n[d\mid i]i\sum_{j=1}^n[d\mid j]j\\
&amp;= \sum_{d=1}^n\varphi(d)d^2 \left( \frac{(1 + \lfloor n / d\rfloor)\lfloor n / d\rfloor}{2}\right)^2
\end{aligned}
\]</span> å‘ç°åé¢é‚£å¨å¼å­å¯ä»¥æ•´é™¤åˆ†å—ï¼Œè€Œ <span class="math inline">\(\varphi(d)d^2\)</span> å°±æ˜¯ä¸Šé¢è®²çš„ <span class="math inline">\(\varphi \cdot \mathrm{id}_k\)</span> ç±»å‹ï¼Œç›´æ¥åšå³å¯ã€‚</p>
</section>
<footer class="article-footer">
<section class="article-tags">
<a href="/tags/OI/">OI</a>
<a href="/tags/note/">ç¬”è®°</a>
</section>
<section class="article-copyright">
<svg class="icon icon-tabler icon-tabler-copyright" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M14.5 9a3.5 4 0 1 0 0 6"></path>
</svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js">
</script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
</article>
<aside class="related-contents--wrapper">
<h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
<div class="related-contents">
<div class="flex article-list--tile">
<article class="has-image">
<a href="/note-gf/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">ç”Ÿæˆå‡½æ•°èƒ¡æ‰¯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-set-power-series/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">é›†åˆå¹‚çº§æ•°èƒ¡æ‰¯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-linear-basis/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">çº¿æ€§åŸºå­¦ä¹ ç¬”è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-wqs/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">wqs äºŒåˆ†å­¦ä¹ ç¬”è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-builtin/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">__builtin ç³»åˆ—å‡½æ•°æ€»ç»“</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class="site-footer">
<section class="copyright">
        Â© 
        
            2019 - 
        
        2024 æ¸…çƒ›çš„åšå®¢
    </section>
<section class="powerby">
        Built with <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a> <br/>
        ä¸»é¢˜ <b><a data-version="3.11.0" href="https://github.com/CaiJimmy/hugo-theme-stack" rel="noopener" target="_blank">Stack</a></b> ç”± <a href="https://jimmycai.com" rel="noopener" target="_blank">Jimmy</a> è®¾è®¡
    </section>
</footer>
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">
<div class="pswp__bg"></div>
<div class="pswp__scroll-wrap">
<div class="pswp__container">
<div class="pswp__item"></div>
<div class="pswp__item"></div>
<div class="pswp__item"></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class="pswp__top-bar">
<div class="pswp__counter"></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class="pswp__preloader">
<div class="pswp__preloader__icn">
<div class="pswp__preloader__cut">
<div class="pswp__preloader__donut"></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class="pswp__share-tooltip"></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class="pswp__caption">
<div class="pswp__caption__center"></div>
</div>
</div>
</div>
</div><script crossorigin="anonymous" defer="" integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js">
</script><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" rel="stylesheet"/><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" rel="stylesheet"/>
</main>
</div>
<script crossorigin="anonymous" integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js">
</script><script defer="" src="/ts/main.js" type="text/javascript"></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
</body>
</html>

<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="å‰è¨€ å­—ç¬¦ä¸²ä¸‹æ ‡ä» \(1\) å¼€å§‹ï¼Œé•¿åº¦ä¸€èˆ¬é»˜è®¤ä¸º \(n\)ï¼› ç”¨ \(s[i]\) è¡¨ç¤º \(s\) çš„ç¬¬ \(i\) ä¸ªå­—ç¬¦ï¼› \(s[i..j]\) è¡¨ç¤º \(s\) ä¸­ä» \(s[i]\) å¼€å§‹ï¼Œåˆ° \(s[j]\) ç»“æŸçš„ä¸€æ®µå­ä¸²ï¼› â€œåç¼€ \(i\)â€è¡¨ç¤ºä»¥ \(s[i]\) å¼€å¤´çš„åç¼€ï¼Œå³ \(s[i..n]\)ï¼› â€œå‰ç¼€ \(i\)â€è¡¨ç¤ºä»¥ \(s[i]\) ç»“å°¾çš„å‰ç¼€ï¼Œå³ \(s[1..n]\)ã€‚ å‡ ä¹æ‰€æœ‰çš„å­—ç¬¦ä¸²ç®—æ³•éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§ï¼šåŸºäºæ‰€æ±‚ä¿¡æ¯çš„ç‰¹æ®Šæ€§è´¨ä¸å·²ç»æ±‚å‡ºçš„ä¿¡æ¯ï¼Œä½¿ç”¨å¢é‡æ³•å‡æ‘Šå¤æ‚åº¦æ±‚å¾—æ‰€æœ‰ä¿¡æ¯ã€‚å¯ä»¥ç€é‡ä½“ä¼šæ­¤ç±»æ€æƒ³ã€‚
Hash ç®€ä»‹ ä¸»è¦æ€æƒ³ï¼šå°†å­—ç¬¦ä¸²æ˜ å°„åˆ°ä¸€ä¸ªæ•´æ•°ä¸Šã€‚
è®¡ç®—æ–¹å¼ï¼š \[ f(s) \equiv \sum_{i = 1}^ls[i]\times b^{l - i}\pmod m \] å³å¯¹äºå­—ç¬¦ä¸² \(\texttt{xyz}\)ï¼Œå…¶å“ˆå¸Œå€¼ä¸º \(24b^2 + 25b + 26\)ã€‚å…¶ä¸­ \(m\) ä½¿ç”¨å¤§è´¨æ•°ï¼Œ\(b\) å– \(29\) æˆ– \(31\) ä¹‹ç±»çš„æ•°ã€‚
ä¸ºäº†å‡å°‘å“ˆå¸Œå†²çªè€ƒè™‘å®ç°åŒæ¨¡å“ˆå¸Œã€‚
å¸¸è§å–å­ä¸²é—®é¢˜ï¼šæ±‚ \(f(s[l.. r])\) çš„å“ˆå¸Œå€¼ã€‚ç»´æŠ¤å“ˆå¸Œå€¼çš„å‰ç¼€å’Œå³å¯ã€‚æ³¨æ„åˆ° \[ \begin{aligned} f(s[1.. l - 1]) &amp;amp;\equiv \sum_{i = 1}^{l - 1}s[i]\times b^{l - 1 - i}\\ f(s[1." name="description"/><title>å­—ç¬¦ä¸²å¤ä¹  1ï¼ˆå­—ç¬¦ä¸²åŸºç¡€ç®—æ³•ï¼‰</title>
<link href="https://oi.imyangty.com/summary-string1/" rel="canonical"/>
<link href="/scss/style.min.a5821f3d3ab84ce5a0ac21477e347a2e0ca00292e398d16c5e8e36ded6e35a23.css" rel="stylesheet"/><meta content="å­—ç¬¦ä¸²å¤ä¹  1ï¼ˆå­—ç¬¦ä¸²åŸºç¡€ç®—æ³•ï¼‰" property="og:title"/>
<meta content="å‰è¨€ å­—ç¬¦ä¸²ä¸‹æ ‡ä» \(1\) å¼€å§‹ï¼Œé•¿åº¦ä¸€èˆ¬é»˜è®¤ä¸º \(n\)ï¼› ç”¨ \(s[i]\) è¡¨ç¤º \(s\) çš„ç¬¬ \(i\) ä¸ªå­—ç¬¦ï¼› \(s[i..j]\) è¡¨ç¤º \(s\) ä¸­ä» \(s[i]\) å¼€å§‹ï¼Œåˆ° \(s[j]\) ç»“æŸçš„ä¸€æ®µå­ä¸²ï¼› â€œåç¼€ \(i\)â€è¡¨ç¤ºä»¥ \(s[i]\) å¼€å¤´çš„åç¼€ï¼Œå³ \(s[i..n]\)ï¼› â€œå‰ç¼€ \(i\)â€è¡¨ç¤ºä»¥ \(s[i]\) ç»“å°¾çš„å‰ç¼€ï¼Œå³ \(s[1..n]\)ã€‚ å‡ ä¹æ‰€æœ‰çš„å­—ç¬¦ä¸²ç®—æ³•éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§ï¼šåŸºäºæ‰€æ±‚ä¿¡æ¯çš„ç‰¹æ®Šæ€§è´¨ä¸å·²ç»æ±‚å‡ºçš„ä¿¡æ¯ï¼Œä½¿ç”¨å¢é‡æ³•å‡æ‘Šå¤æ‚åº¦æ±‚å¾—æ‰€æœ‰ä¿¡æ¯ã€‚å¯ä»¥ç€é‡ä½“ä¼šæ­¤ç±»æ€æƒ³ã€‚
Hash ç®€ä»‹ ä¸»è¦æ€æƒ³ï¼šå°†å­—ç¬¦ä¸²æ˜ å°„åˆ°ä¸€ä¸ªæ•´æ•°ä¸Šã€‚
è®¡ç®—æ–¹å¼ï¼š \[ f(s) \equiv \sum_{i = 1}^ls[i]\times b^{l - i}\pmod m \] å³å¯¹äºå­—ç¬¦ä¸² \(\texttt{xyz}\)ï¼Œå…¶å“ˆå¸Œå€¼ä¸º \(24b^2 + 25b + 26\)ã€‚å…¶ä¸­ \(m\) ä½¿ç”¨å¤§è´¨æ•°ï¼Œ\(b\) å– \(29\) æˆ– \(31\) ä¹‹ç±»çš„æ•°ã€‚
ä¸ºäº†å‡å°‘å“ˆå¸Œå†²çªè€ƒè™‘å®ç°åŒæ¨¡å“ˆå¸Œã€‚
å¸¸è§å–å­ä¸²é—®é¢˜ï¼šæ±‚ \(f(s[l.. r])\) çš„å“ˆå¸Œå€¼ã€‚ç»´æŠ¤å“ˆå¸Œå€¼çš„å‰ç¼€å’Œå³å¯ã€‚æ³¨æ„åˆ° \[ \begin{aligned} f(s[1.. l - 1]) &amp;amp;\equiv \sum_{i = 1}^{l - 1}s[i]\times b^{l - 1 - i}\\ f(s[1." property="og:description"/>
<meta content="https://oi.imyangty.com/summary-string1/" property="og:url"/>
<meta content="æ¸…çƒ›çš„åšå®¢" property="og:site_name"/>
<meta content="article" property="og:type"/><meta content="Post" property="article:section"/><meta content="OI" property="article:tag"/><meta content="ç¬”è®°" property="article:tag"/><meta content="2021-09-08T19:55:30+08:00" property="article:published_time"/><meta content="2021-09-08T19:55:30+08:00" property="article:modified_time"/><meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg17.webp" property="og:image"/>
<meta content="å­—ç¬¦ä¸²å¤ä¹  1ï¼ˆå­—ç¬¦ä¸²åŸºç¡€ç®—æ³•ï¼‰" name="twitter:title"/>
<meta content="å‰è¨€ å­—ç¬¦ä¸²ä¸‹æ ‡ä» \(1\) å¼€å§‹ï¼Œé•¿åº¦ä¸€èˆ¬é»˜è®¤ä¸º \(n\)ï¼› ç”¨ \(s[i]\) è¡¨ç¤º \(s\) çš„ç¬¬ \(i\) ä¸ªå­—ç¬¦ï¼› \(s[i..j]\) è¡¨ç¤º \(s\) ä¸­ä» \(s[i]\) å¼€å§‹ï¼Œåˆ° \(s[j]\) ç»“æŸçš„ä¸€æ®µå­ä¸²ï¼› â€œåç¼€ \(i\)â€è¡¨ç¤ºä»¥ \(s[i]\) å¼€å¤´çš„åç¼€ï¼Œå³ \(s[i..n]\)ï¼› â€œå‰ç¼€ \(i\)â€è¡¨ç¤ºä»¥ \(s[i]\) ç»“å°¾çš„å‰ç¼€ï¼Œå³ \(s[1..n]\)ã€‚ å‡ ä¹æ‰€æœ‰çš„å­—ç¬¦ä¸²ç®—æ³•éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§ï¼šåŸºäºæ‰€æ±‚ä¿¡æ¯çš„ç‰¹æ®Šæ€§è´¨ä¸å·²ç»æ±‚å‡ºçš„ä¿¡æ¯ï¼Œä½¿ç”¨å¢é‡æ³•å‡æ‘Šå¤æ‚åº¦æ±‚å¾—æ‰€æœ‰ä¿¡æ¯ã€‚å¯ä»¥ç€é‡ä½“ä¼šæ­¤ç±»æ€æƒ³ã€‚
Hash ç®€ä»‹ ä¸»è¦æ€æƒ³ï¼šå°†å­—ç¬¦ä¸²æ˜ å°„åˆ°ä¸€ä¸ªæ•´æ•°ä¸Šã€‚
è®¡ç®—æ–¹å¼ï¼š \[ f(s) \equiv \sum_{i = 1}^ls[i]\times b^{l - i}\pmod m \] å³å¯¹äºå­—ç¬¦ä¸² \(\texttt{xyz}\)ï¼Œå…¶å“ˆå¸Œå€¼ä¸º \(24b^2 + 25b + 26\)ã€‚å…¶ä¸­ \(m\) ä½¿ç”¨å¤§è´¨æ•°ï¼Œ\(b\) å– \(29\) æˆ– \(31\) ä¹‹ç±»çš„æ•°ã€‚
ä¸ºäº†å‡å°‘å“ˆå¸Œå†²çªè€ƒè™‘å®ç°åŒæ¨¡å“ˆå¸Œã€‚
å¸¸è§å–å­ä¸²é—®é¢˜ï¼šæ±‚ \(f(s[l.. r])\) çš„å“ˆå¸Œå€¼ã€‚ç»´æŠ¤å“ˆå¸Œå€¼çš„å‰ç¼€å’Œå³å¯ã€‚æ³¨æ„åˆ° \[ \begin{aligned} f(s[1.. l - 1]) &amp;amp;\equiv \sum_{i = 1}^{l - 1}s[i]\times b^{l - 1 - i}\\ f(s[1." name="twitter:description"/><meta content="summary_large_image" name="twitter:card"/>
<meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg17.webp" name="twitter:image"/>
<link href="https://q1.qlogo.cn/g?b=qq&amp;nk=375836877&amp;s=5" rel="shortcut icon"/>
<link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/github-dark-dimmed.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="article-page">
<script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button aria-label="åˆ‡æ¢èœå•" class="hamburger hamburger--spin" id="toggle-menu" type="button">
<span class="hamburger-box">
<span class="hamburger-inner"></span>
</span>
</button>
<header>
<figure class="site-avatar">
<a href="/">
<img alt="Avatar" class="site-logo" height="300" loading="lazy" src="/img/avatar_huea3ce2119467b51fdd2a81393644a76d_51594_300x0_resize_q75_box.jpg" width="300"/>
</a>
<span class="emoji">ğŸ˜…</span>
</figure>
<div class="site-meta">
<h1 class="site-name"><a href="/">æ¸…çƒ›çš„åšå®¢</a></h1>
<h2 class="site-description">çƒŸç«å·²è°¢ï¼Œç¬™æ­Œæœªåœ</h2>
</div>
</header><ol class="social-menu">
<li>
<a href="mailto:i@imyangty.com" target="_blank" title="email">
<svg class="icon icon-tabler icon-tabler-mail" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<rect height="14" rx="2" width="18" x="3" y="5"></rect>
<polyline points="3 7 12 13 21 7"></polyline>
</svg>
</a>
</li>
<li>
<a href="https://github.com/Cgfyufsygsm" target="_blank" title="GitHub">
<svg class="icon icon-tabler icon-tabler-brand-github" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
</a>
</li>
<li>
<a href="https://t.me/Cgfyufsygsm" target="_blank" title="Telegram">
<svg class="icon icon-tabler icon-tabler-brand-telegram" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"></path>
</svg>
</a>
</li>
<li>
<a href="https://twitter.com/Cgfyufsygsm" target="_blank" title="Twitter">
<svg class="icon icon-tabler icon-tabler-brand-twitter" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
</svg>
</a>
</li>
</ol><ol class="menu" id="main-menu">
<li>
<a href="/">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»é¡µ</span>
</a>
</li>
<li>
<a href="/about/">
<svg class="icon icon-tabler icon-tabler-user" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="7" r="4"></circle>
<path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
</svg>
<span>å…³äº</span>
</a>
</li>
<li>
<a href="/idx/">
<svg class="icon icon-tabler icon-tabler-hash" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<line x1="5" x2="19" y1="9" y2="9"></line>
<line x1="5" x2="19" y1="15" y2="15"></line>
<line x1="11" x2="7" y1="4" y2="20"></line>
<line x1="17" x2="13" y1="4" y2="20"></line>
</svg>
<span>å¯¼èˆª</span>
</a>
</li>
<li>
<a href="/archives/">
<svg class="icon icon-tabler icon-tabler-archive" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<rect height="4" rx="2" width="18" x="3" y="4"></rect>
<path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10"></path>
<line x1="10" x2="14" y1="12" y2="12"></line>
</svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href="/search/">
<svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="10" cy="10" r="7"></circle>
<line x1="21" x2="15" y1="21" y2="15"></line>
</svg>
<span>æœç´¢</span>
</a>
</li>
<li>
<a href="/friends/">
<svg class="icon icon-tabler icon-tabler-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path>
<path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path>
</svg>
<span>å‹é“¾</span>
</a>
</li>
<li>
<a href="https://blog.imyangty.com" target="_blank">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»åšå®¢</span>
</a>
</li>
<div class="menu-bottom-section">
<li id="dark-mode-toggle">
<svg class="icon icon-tabler icon-tabler-toggle-left" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="8" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="16" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<span>æš—è‰²æ¨¡å¼</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class="has-image main-article">
<header class="article-header">
<div class="article-image">
<a href="/summary-string1/">
<img alt="Featured image of post å­—ç¬¦ä¸²å¤ä¹  1ï¼ˆå­—ç¬¦ä¸²åŸºç¡€ç®—æ³•ï¼‰" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg17.webp"/>
</a>
</div>
<div class="article-details">
<header class="article-category">
<a href="/categories/oi/">
                OI
            </a>
<a href="/categories/summary/">
                æ€»ç»“
            </a>
</header>
<div class="article-title-wrapper">
<h2 class="article-title">
<a href="/summary-string1/">å­—ç¬¦ä¸²å¤ä¹  1ï¼ˆå­—ç¬¦ä¸²åŸºç¡€ç®—æ³•ï¼‰</a>
</h2>
</div>
<footer class="article-time">
<div>
<svg class="icon icon-tabler icon-tabler-calendar-time" fill="none" height="56" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="56" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4"></path>
<circle cx="18" cy="18" r="4"></circle>
<path d="M15 3v4"></path>
<path d="M7 3v4"></path>
<path d="M3 11h16"></path>
<path d="M18 16.496v1.504l1 1"></path>
</svg>
<time class="article-time--published">Sep 08, 2021</time>
</div>
<div>
<svg class="icon icon-tabler icon-tabler-clock" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<polyline points="12 7 12 12 15 15"></polyline>
</svg>
<time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 7 åˆ†é’Ÿ
                </time>
</div>
</footer>
</div>
</header>
<section class="article-content">
<h2 id="å‰è¨€">å‰è¨€</h2>
<ul>
<li>å­—ç¬¦ä¸²ä¸‹æ ‡ä» <span class="math inline">\(1\)</span> å¼€å§‹ï¼Œé•¿åº¦ä¸€èˆ¬é»˜è®¤ä¸º <span class="math inline">\(n\)</span>ï¼›</li>
<li>ç”¨ <span class="math inline">\(s[i]\)</span> è¡¨ç¤º <span class="math inline">\(s\)</span> çš„ç¬¬ <span class="math inline">\(i\)</span> ä¸ªå­—ç¬¦ï¼›</li>
<li><span class="math inline">\(s[i..j]\)</span> è¡¨ç¤º <span class="math inline">\(s\)</span> ä¸­ä» <span class="math inline">\(s[i]\)</span> å¼€å§‹ï¼Œåˆ° <span class="math inline">\(s[j]\)</span> ç»“æŸçš„ä¸€æ®µå­ä¸²ï¼›</li>
<li>â€œåç¼€ <span class="math inline">\(i\)</span>â€è¡¨ç¤ºä»¥ <span class="math inline">\(s[i]\)</span> å¼€å¤´çš„åç¼€ï¼Œå³ <span class="math inline">\(s[i..n]\)</span>ï¼›</li>
<li>â€œå‰ç¼€ <span class="math inline">\(i\)</span>â€è¡¨ç¤ºä»¥ <span class="math inline">\(s[i]\)</span> ç»“å°¾çš„å‰ç¼€ï¼Œå³ <span class="math inline">\(s[1..n]\)</span>ã€‚</li>
</ul>
<p>å‡ ä¹æ‰€æœ‰çš„å­—ç¬¦ä¸²ç®—æ³•éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§ï¼šåŸºäº<strong>æ‰€æ±‚ä¿¡æ¯çš„ç‰¹æ®Šæ€§è´¨</strong>ä¸<strong>å·²ç»æ±‚å‡ºçš„ä¿¡æ¯</strong>ï¼Œä½¿ç”¨<strong>å¢é‡æ³•å‡æ‘Šå¤æ‚åº¦</strong>æ±‚å¾—æ‰€æœ‰ä¿¡æ¯ã€‚å¯ä»¥ç€é‡ä½“ä¼šæ­¤ç±»æ€æƒ³ã€‚</p>
<h2 id="hash">Hash</h2>
<h3 id="ç®€ä»‹">ç®€ä»‹</h3>
<p>ä¸»è¦æ€æƒ³ï¼šå°†å­—ç¬¦ä¸²æ˜ å°„åˆ°ä¸€ä¸ªæ•´æ•°ä¸Šã€‚</p>
<p>è®¡ç®—æ–¹å¼ï¼š <span class="math display">\[
f(s) \equiv \sum_{i = 1}^ls[i]\times b^{l - i}\pmod m
\]</span> å³å¯¹äºå­—ç¬¦ä¸² <span class="math inline">\(\texttt{xyz}\)</span>ï¼Œå…¶å“ˆå¸Œå€¼ä¸º <span class="math inline">\(24b^2 + 25b + 26\)</span>ã€‚å…¶ä¸­ <span class="math inline">\(m\)</span> ä½¿ç”¨å¤§è´¨æ•°ï¼Œ<span class="math inline">\(b\)</span> å– <span class="math inline">\(29\)</span> æˆ– <span class="math inline">\(31\)</span> ä¹‹ç±»çš„æ•°ã€‚</p>
<p>ä¸ºäº†å‡å°‘å“ˆå¸Œå†²çªè€ƒè™‘å®ç°åŒæ¨¡å“ˆå¸Œã€‚</p>
<p>å¸¸è§å–å­ä¸²é—®é¢˜ï¼šæ±‚ <span class="math inline">\(f(s[l.. r])\)</span> çš„å“ˆå¸Œå€¼ã€‚ç»´æŠ¤å“ˆå¸Œå€¼çš„å‰ç¼€å’Œå³å¯ã€‚æ³¨æ„åˆ° <span class="math display">\[
\begin{aligned}
f(s[1.. l - 1]) &amp;\equiv \sum_{i = 1}^{l - 1}s[i]\times b^{l - 1 - i}\\
f(s[1.. r]) &amp;\equiv \sum_{i = 1}^r s[i]\times b^{r - i}\\
f(s[l.. r]) &amp;\equiv \sum_{i = l}^rs[i]\times b^{r - l + 1 - i}
\end{aligned}
\]</span> æ‰€ä»¥æœ‰ <span class="math display">\[
f(s[l.. r]) \equiv f(s[1.. r]) -f(s[1.. l - 1]) \times b^{r - l + 1}
\]</span> å¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸¤å­ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œè¿˜å¯ç»“åˆå‘¨æœŸè¿›è¡Œè€ƒå¯Ÿã€‚</p>
<h3 id="åº”ç”¨">åº”ç”¨</h3>
<ul>
<li><strong>äºŒåˆ† + å“ˆå¸Œæ˜¯å¾ˆæœ‰æ•ˆçš„ä¹±æï¼ï¼</strong></li>
<li><strong>äºŒåˆ† + å“ˆå¸Œæ˜¯å¾ˆæœ‰æ•ˆçš„ä¹±æï¼ï¼</strong></li>
<li><strong>äºŒåˆ† + å“ˆå¸Œæ˜¯å¾ˆæœ‰æ•ˆçš„ä¹±æï¼ï¼</strong></li>
<li><strong>äºŒåˆ† + å“ˆå¸Œæ˜¯å¾ˆæœ‰æ•ˆçš„ä¹±æï¼ï¼</strong></li>
<li><strong>äºŒåˆ† + å“ˆå¸Œæ˜¯å¾ˆæœ‰æ•ˆçš„ä¹±æï¼ï¼</strong></li>
</ul>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(1\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P4503">P4503 [CTSC2014]ä¼é¹…QQ</a></p>
<p>ç»™å®š <span class="math inline">\(n\le 30000\)</span> ä¸ªé•¿åº¦ä¸º <span class="math inline">\(l\le 200\)</span> çš„å­—ç¬¦ä¸²ï¼Œé—®æœ‰å¤šå°‘å¯¹å­—ç¬¦ä¸²æ»¡è¶³åªæœ‰ä¸€ä½ä¸åŒã€‚</p>
</blockquote>
<p>é¦–å…ˆå¤„ç†å‡ºæ‰€æœ‰ä¸²çš„å“ˆå¸Œï¼Œç„¶åè€ƒè™‘æšä¸¾è¿™ä¸åŒçš„ä¸€ä½ï¼Œç„¶åä½¿ç”¨æ±‚å‡ºæ‰€æœ‰ä¸²å»æ‰è¿™ä¸€ä½ä¹‹åæ‰€æœ‰çš„å“ˆå¸Œå€¼ï¼Œæ’ä¸ªåºæ¥æ‰¾ç›¸åŒçš„æ•°é‡ã€‚</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4"></a><span class="pp">#define FOR</span>(i,<span class="pp"> </span>a,<span class="pp"> </span>b)<span class="pp"> </span><span class="cf">for</span><span class="pp"> </span>(<span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span>=<span class="pp"> </span>a;<span class="pp"> </span>i<span class="pp"> </span>&lt;=<span class="pp"> </span>b;<span class="pp"> </span>++i)</span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5"></a></span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> ll;</span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7"></a></span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="dv">30000</span> + <span class="dv">5</span>, maxl = <span class="dv">200</span> + <span class="dv">7</span>;</span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9"></a><span class="at">const</span> ll p = <span class="dv">233</span>;</span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10"></a></span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11"></a><span class="dt">char</span> s[maxn][maxl];</span>
<span id="cb1-12"><a aria-hidden="true" href="#cb1-12"></a>ll hash[maxn][maxl], powp[maxl], tmp[maxn];</span>
<span id="cb1-13"><a aria-hidden="true" href="#cb1-13"></a><span class="dt">int</span> n, l;</span>
<span id="cb1-14"><a aria-hidden="true" href="#cb1-14"></a></span>
<span id="cb1-15"><a aria-hidden="true" href="#cb1-15"></a><span class="dt">int</span> main() {</span>
<span id="cb1-16"><a aria-hidden="true" href="#cb1-16"></a>    scanf(<span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">"</span>, &amp;n, &amp;l, &amp;powp[<span class="dv">0</span>]);</span>
<span id="cb1-17"><a aria-hidden="true" href="#cb1-17"></a>    powp[<span class="dv">0</span>] = <span class="dv">1</span>;</span>
<span id="cb1-18"><a aria-hidden="true" href="#cb1-18"></a>    FOR(i, <span class="dv">1</span>, l)</span>
<span id="cb1-19"><a aria-hidden="true" href="#cb1-19"></a>        powp[i] = powp[i - <span class="dv">1</span>] * p;</span>
<span id="cb1-20"><a aria-hidden="true" href="#cb1-20"></a>    FOR(k, <span class="dv">1</span>, n) {</span>
<span id="cb1-21"><a aria-hidden="true" href="#cb1-21"></a>        scanf(<span class="st">"</span><span class="sc">%s</span><span class="st">"</span>, &amp;s[k][<span class="dv">1</span>]);</span>
<span id="cb1-22"><a aria-hidden="true" href="#cb1-22"></a>        FOR(i, <span class="dv">1</span>, l)</span>
<span id="cb1-23"><a aria-hidden="true" href="#cb1-23"></a>            hash[k][i] = (hash[k][i - <span class="dv">1</span>] * p + s[k][i]);</span>
<span id="cb1-24"><a aria-hidden="true" href="#cb1-24"></a>    }</span>
<span id="cb1-25"><a aria-hidden="true" href="#cb1-25"></a>    <span class="dt">int</span> ans = <span class="dv">0</span>;</span>
<span id="cb1-26"><a aria-hidden="true" href="#cb1-26"></a>    FOR(k, <span class="dv">1</span>, l) {</span>
<span id="cb1-27"><a aria-hidden="true" href="#cb1-27"></a>        FOR(i, <span class="dv">1</span>, n)</span>
<span id="cb1-28"><a aria-hidden="true" href="#cb1-28"></a>            tmp[i] = hash[i][k - <span class="dv">1</span>] * powp[l - k] + hash[i][l] - hash[i][k] * powp[l - k] ;</span>
<span id="cb1-29"><a aria-hidden="true" href="#cb1-29"></a>        <span class="bu">std::</span>sort(tmp + <span class="dv">1</span>, tmp + n + <span class="dv">1</span>);</span>
<span id="cb1-30"><a aria-hidden="true" href="#cb1-30"></a>        <span class="dt">int</span> sum = <span class="dv">1</span>;</span>
<span id="cb1-31"><a aria-hidden="true" href="#cb1-31"></a>        FOR(i, <span class="dv">2</span>, n)</span>
<span id="cb1-32"><a aria-hidden="true" href="#cb1-32"></a>            <span class="cf">if</span> (tmp[i] == tmp[i - <span class="dv">1</span>])</span>
<span id="cb1-33"><a aria-hidden="true" href="#cb1-33"></a>                ans += (sum++);</span>
<span id="cb1-34"><a aria-hidden="true" href="#cb1-34"></a>            <span class="cf">else</span> sum = <span class="dv">1</span>;</span>
<span id="cb1-35"><a aria-hidden="true" href="#cb1-35"></a>    }</span>
<span id="cb1-36"><a aria-hidden="true" href="#cb1-36"></a>    printf(<span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span>, ans);</span>
<span id="cb1-37"><a aria-hidden="true" href="#cb1-37"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb1-38"><a aria-hidden="true" href="#cb1-38"></a>}</span></code></pre></div>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(2\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P3538">P3538 [POI2012]OKR-A Horrible Poem</a></p>
<p>å­—ç¬¦ä¸² <span class="math inline">\(S\)</span>ï¼Œ<span class="math inline">\(|S|\le 5\times 10^5\)</span>ï¼Œ<span class="math inline">\(q\le 2\times 10^6\)</span> æ¬¡è¯¢é—®å­ä¸² <span class="math inline">\(S[a..b]\)</span> çš„æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦ã€‚æ³¨æ„å¾ªç¯èŠ‚ = æ•´å‘¨æœŸã€‚</p>
</blockquote>
<p>hash ä¸å¾ªç¯èŠ‚çš„ç»å…¸åº”ç”¨ã€‚æœ‰è‹¥å¹²ç»å…¸ç»“è®ºï¼š</p>
<ul>
<li>è‹¥ <span class="math inline">\(kl\)</span> ä¸ºå¾ªç¯èŠ‚ï¼Œåˆ™ <span class="math inline">\(l\)</span> ä¹Ÿä¸ºå¾ªç¯èŠ‚ï¼›</li>
<li><span class="math inline">\(S[1..n-l] = S[1+l..n]\)</span> æ˜¯ <span class="math inline">\(l\)</span> ä¸º <span class="math inline">\(S[1..n]\)</span> çš„å¾ªç¯èŠ‚çš„å……è¦æ¡ä»¶ï¼ˆå³æœ‰ä¸€ä¸ª <span class="math inline">\(n-l+1\)</span> é•¿åº¦çš„ Borderï¼‰ã€‚</li>
</ul>
<p>åœ¨æœ¬é¢˜ä¸­ï¼Œæš´åŠ›æšä¸¾ <span class="math inline">\(b - a + 1\)</span> çš„çº¦æ•°ä¸å¯è¡Œï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(q\sqrt{|S|})\)</span>ï¼Œè€ƒè™‘çº¿æ€§ç­›ç´ æ•°å¹¶é¢„å¤„ç†æ¯ä¸ªæ•°æœ€å°è´¨å› å­ï¼Œç„¶åæ¯æ¬¡åˆ¤æ–­å³å¯ã€‚</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1"></a><span class="dt">int</span> work(<span class="dt">int</span> l, <span class="dt">int</span> r) {</span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2"></a>    <span class="dt">int</span> len = r - l + <span class="dv">1</span>, ans = len;</span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3"></a>    <span class="cf">while</span> (len &gt; <span class="dv">1</span>) {</span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4"></a>        <span class="cf">if</span> (gethash(l + ans / minfact[len], r) == gethash(l, r - ans / minfact[len]))</span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5"></a>            ans /= minfact[len];</span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6"></a>        len /= minfact[len];</span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7"></a>    }</span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8"></a>    <span class="cf">return</span> ans;</span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9"></a>}</span></code></pre></div>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(3\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P4036">P4036 [JSOI2008]ç«æ˜Ÿäºº</a></p>
<p>åŠ¨æ€ä¿®æ”¹å­—ç¬¦ä¸²ï¼ˆæ’å…¥å­—ç¬¦ï¼Œä¿®æ”¹å­—ç¬¦ï¼‰ï¼Œæ¯æ¬¡è¯¢é—® <span class="math inline">\(\operatorname{LCP}(x,y)\)</span>ã€‚<span class="math inline">\(m\le 1.5\times 10^5\)</span>ï¼Œ<span class="math inline">\(L\le 10^5\)</span>ã€‚</p>
</blockquote>
<p>å¦‚æœä¸è€ƒè™‘åŠ¨æ€ä¿®æ”¹é‚£ä¹ˆå°±æ˜¯ SA çš„æ¿å­é¢˜ï¼Œè€Œæ³¨æ„åˆ° LCP å¯ä»¥é€šè¿‡äºŒåˆ† + å“ˆå¸Œè§£å†³ï¼Œæ‰€ä»¥è€ƒè™‘ä½¿ç”¨å¹³è¡¡æ ‘æ¥ç»´æŠ¤æ•´ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œæ”¯æŒæŸ¥è¯¢åŒºé—´å“ˆå¸Œå€¼å³å¯ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(4\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P3318">P3318 [SDOI2015]åŒæ—‹è½¬å­—ç¬¦ä¸²</a></p>
<p>ç»™å®šå­—ç¬¦ä¸²é›†åˆ <span class="math inline">\(S\)</span> å’Œ <span class="math inline">\(T\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(S\)</span> å†…å­—ç¬¦ä¸²é•¿åº¦å‡ä¸º <span class="math inline">\(n\)</span>ï¼Œ<span class="math inline">\(T\)</span> å†…å­—ç¬¦ä¸²é•¿åº¦å‡ä¸º <span class="math inline">\(m\)</span>ï¼Œä¸” <span class="math inline">\(n+m\)</span> ä¸ºå¶æ•°ã€‚é—®æœ‰å¤šå°‘å¯¹ <span class="math inline">\((i,j)\)</span> æ»¡è¶³ <span class="math inline">\(s_i + t_j\)</span> ä¸ºâ€œåŒæ—‹è½¬å­—ç¬¦ä¸²â€ã€‚</p>
<p>åŒæ—‹è½¬å­—ç¬¦ä¸²çš„å®šä¹‰æ˜¯ï¼Œå…¶é•¿åº¦ä¸ºå¶æ•°ï¼Œä¸”åä¸€åŠæ˜¯å‰ä¸€åŠçš„å¾ªç¯åŒæ„ã€‚<span class="math inline">\(2\le n\times |S| + m\times |T|\le 4\times 10^6\)</span>ã€‚</p>
</blockquote>
<p>è€ƒè™‘å°† <span class="math inline">\(T\)</span> ä¸­çš„ä¸²å“ˆå¸Œå¥½ï¼Œæ”¾è¿› <code>unordered_map</code> å†…é¢„å¤„ç†ã€‚ç„¶åå¯¹äº <span class="math inline">\(S\)</span> å†…çš„æ¯ä¸ªä¸²ï¼Œå…³äºå‰ <span class="math inline">\((n + m) / 2\)</span> ä½å€é•¿ä¹‹ï¼Œç„¶åçœ‹æ¯ä¸ªå¾ªç¯ç§»ä½çš„å‰ç¼€æ˜¯ä¸æ˜¯ <span class="math inline">\(S_i[(n + m) / 2..n]\)</span>ï¼Œæ˜¯çš„è¯å°±åœ¨å“ˆå¸Œè¡¨é‡Œé¢æŸ¥æœ‰å¤šå°‘ä¸ªå¯¹åº”çš„ <span class="math inline">\(T\)</span>ã€‚</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1"></a><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2"></a><span class="pp">#define FOR</span>(i,<span class="pp"> </span>a,<span class="pp"> </span>b)<span class="pp"> </span><span class="cf">for</span><span class="pp"> </span>(<span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span>=<span class="pp"> </span>(a);<span class="pp"> </span>i<span class="pp"> </span>&lt;=<span class="pp"> </span>(b);<span class="pp"> </span>++i)</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3"></a></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4"></a><span class="kw">using</span> <span class="kw">namespace</span> std;</span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5"></a><span class="kw">using</span> uint64 = <span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span>;</span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6"></a><span class="at">const</span> uint64 base = <span class="dv">1331</span>;</span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">4e6</span> + <span class="dv">5</span>;</span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8"></a><span class="dt">int</span> n, m, totS, totT, ans, len, vis[maxn];</span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9"></a>string s[maxn], t[maxn];</span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10"></a>uint64 pw[maxn], hsh[maxn];</span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11"></a>unordered_map&lt;uint64, <span class="dt">int</span>&gt; hashT;</span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12"></a></span>
<span id="cb3-13"><a aria-hidden="true" href="#cb3-13"></a>uint64 getHash(string s, <span class="dt">int</span> len) {</span>
<span id="cb3-14"><a aria-hidden="true" href="#cb3-14"></a>    uint64 res = <span class="dv">0</span>;</span>
<span id="cb3-15"><a aria-hidden="true" href="#cb3-15"></a>    FOR(i, <span class="dv">0</span>, len - <span class="dv">1</span>) res = base * res + s[i];</span>
<span id="cb3-16"><a aria-hidden="true" href="#cb3-16"></a>    <span class="cf">return</span> res;</span>
<span id="cb3-17"><a aria-hidden="true" href="#cb3-17"></a>}</span>
<span id="cb3-18"><a aria-hidden="true" href="#cb3-18"></a></span>
<span id="cb3-19"><a aria-hidden="true" href="#cb3-19"></a>uint64 getHash(<span class="dt">int</span> l, <span class="dt">int</span> r) {</span>
<span id="cb3-20"><a aria-hidden="true" href="#cb3-20"></a>    <span class="cf">return</span> hsh[r] - hsh[l - <span class="dv">1</span>] * pw[r - l + <span class="dv">1</span>];</span>
<span id="cb3-21"><a aria-hidden="true" href="#cb3-21"></a>}</span>
<span id="cb3-22"><a aria-hidden="true" href="#cb3-22"></a></span>
<span id="cb3-23"><a aria-hidden="true" href="#cb3-23"></a><span class="dt">int</span> solve(string &amp;s, <span class="dt">int</span> id) {</span>
<span id="cb3-24"><a aria-hidden="true" href="#cb3-24"></a>    <span class="dt">int</span> ret = <span class="dv">0</span>;</span>
<span id="cb3-25"><a aria-hidden="true" href="#cb3-25"></a>    string tmp = <span class="st">"?"</span> + s.substr(<span class="dv">0</span>, len) + s.substr(<span class="dv">0</span>, len);</span>
<span id="cb3-26"><a aria-hidden="true" href="#cb3-26"></a>    FOR(i, <span class="dv">1</span>, len &lt;&lt; <span class="dv">1</span>) hsh[i] = hsh[i - <span class="dv">1</span>] * base + tmp[i];</span>
<span id="cb3-27"><a aria-hidden="true" href="#cb3-27"></a>    uint64 hshVal = getHash(s.substr(len, n - len), n - len);</span>
<span id="cb3-28"><a aria-hidden="true" href="#cb3-28"></a>    unordered_set&lt;uint64&gt; vis;</span>
<span id="cb3-29"><a aria-hidden="true" href="#cb3-29"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>, j = len; i &lt;= len; ++i, ++j) {</span>
<span id="cb3-30"><a aria-hidden="true" href="#cb3-30"></a>        uint64 cur = getHash(i, j);</span>
<span id="cb3-31"><a aria-hidden="true" href="#cb3-31"></a>        <span class="cf">if</span> (vis.count(cur)) <span class="cf">continue</span>;</span>
<span id="cb3-32"><a aria-hidden="true" href="#cb3-32"></a>        vis.insert(cur);</span>
<span id="cb3-33"><a aria-hidden="true" href="#cb3-33"></a>        <span class="cf">if</span> (getHash(i, i + n - len - <span class="dv">1</span>) == hshVal)</span>
<span id="cb3-34"><a aria-hidden="true" href="#cb3-34"></a>            ret += hashT[getHash(i + n - len, j)];</span>
<span id="cb3-35"><a aria-hidden="true" href="#cb3-35"></a>    }</span>
<span id="cb3-36"><a aria-hidden="true" href="#cb3-36"></a>    <span class="cf">return</span> ret;</span>
<span id="cb3-37"><a aria-hidden="true" href="#cb3-37"></a>}</span>
<span id="cb3-38"><a aria-hidden="true" href="#cb3-38"></a></span>
<span id="cb3-39"><a aria-hidden="true" href="#cb3-39"></a><span class="dt">int</span> main() {</span>
<span id="cb3-40"><a aria-hidden="true" href="#cb3-40"></a>    ios::sync_with_stdio(<span class="kw">false</span>);</span>
<span id="cb3-41"><a aria-hidden="true" href="#cb3-41"></a>    pw[<span class="dv">0</span>] = <span class="dv">1</span>;</span>
<span id="cb3-42"><a aria-hidden="true" href="#cb3-42"></a>    FOR(i, <span class="dv">1</span>, (<span class="dt">int</span>)<span class="fl">4e6</span>) pw[i] = pw[i - <span class="dv">1</span>] * base;</span>
<span id="cb3-43"><a aria-hidden="true" href="#cb3-43"></a>    cin &gt;&gt; totS &gt;&gt; totT &gt;&gt; n &gt;&gt; m;</span>
<span id="cb3-44"><a aria-hidden="true" href="#cb3-44"></a>    <span class="cf">if</span> (n &lt; m) swap(totS, totT), swap(n, m);</span>
<span id="cb3-45"><a aria-hidden="true" href="#cb3-45"></a>    len = (n + m) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb3-46"><a aria-hidden="true" href="#cb3-46"></a>    FOR(i, <span class="dv">1</span>, totS) cin &gt;&gt; s[i];</span>
<span id="cb3-47"><a aria-hidden="true" href="#cb3-47"></a>    FOR(i, <span class="dv">1</span>, totT) {</span>
<span id="cb3-48"><a aria-hidden="true" href="#cb3-48"></a>        cin &gt;&gt; t[i];</span>
<span id="cb3-49"><a aria-hidden="true" href="#cb3-49"></a>        ++hashT[getHash(t[i], m)];</span>
<span id="cb3-50"><a aria-hidden="true" href="#cb3-50"></a>    }</span>
<span id="cb3-51"><a aria-hidden="true" href="#cb3-51"></a>    FOR(i, <span class="dv">1</span>, totS) ans += solve(s[i], i);</span>
<span id="cb3-52"><a aria-hidden="true" href="#cb3-52"></a>    printf(<span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span>, ans);</span>
<span id="cb3-53"><a aria-hidden="true" href="#cb3-53"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb3-54"><a aria-hidden="true" href="#cb3-54"></a>}</span></code></pre></div>
<h2 id="manacher-ç®—æ³•">Manacher ç®—æ³•</h2>
<h3 id="ç®—æ³•æµç¨‹">ç®—æ³•æµç¨‹</h3>
<p>ç”¨æ¥æ±‚è§£å›æ–‡å­ä¸²ã€‚é¦–å…ˆæˆ‘ä»¬éšä¾¿ä¸¾ä¸¤ç§å›æ–‡ä¸²å‡ºæ¥ï¼š<span class="math inline">\(\texttt{aba}\)</span> å’Œ <span class="math inline">\(\texttt{abba}\)</span>ï¼Œä¼šå‘ç°å‰è€…å’Œåè€…çš„åŒºåˆ«åœ¨äºå›æ–‡ä¸­å¿ƒçš„æœ‰æ— ã€‚ä¸ºäº†é¿å…è¿™ç§éº»çƒ¦çš„åˆ†ç±»è®¨è®ºï¼Œåœ¨çœŸæ­£æ±‚è§£é—®é¢˜çš„æ—¶å€™æå‰å°†<strong>ç›¸åŒçš„</strong>åˆ†éš”ç¬¦åŠ å…¥ï¼Œå¦‚ <span class="math inline">\(\texttt{\&amp;a\#b\#b\#a}\)</span>ï¼Œå¼€å¤´çš„ä¸åŒçš„åˆ†éš”ç¬¦ä¹‹åå†è¯´ã€‚</p>
<p>è®¾ä»¥ <span class="math inline">\(s[i]\)</span> ä¸ºå¯¹ç§°ä¸­å¿ƒçš„æœ€é•¿å›æ–‡åŠå¾„ä¸º <span class="math inline">\(p_i\)</span>ï¼Œå³ <span class="math inline">\(s[i-p_i +1..i+p_i-1]\)</span> æ˜¯å›æ–‡ä¸²ã€‚</p>
<p>è€ƒè™‘ä»å·¦å¾€å³æ‰«ï¼Œä¾æ¬¡æ±‚è§£ <span class="math inline">\(p_{1,\cdots, n}\)</span>ã€‚ç»´æŠ¤ä¸€ä¸‹æœ€å³ä¾§çš„å›æ–‡ä¸²å»¶ä¼¸åˆ°çš„ä½ç½® <span class="math inline">\(r\)</span> ä»¥åŠå¯¹åº”çš„å›æ–‡ä¸­å¿ƒ <span class="math inline">\(d\)</span>ï¼Œç„¶åå½“å‰è¦æ±‚ <span class="math inline">\(p_i\)</span> çš„æ—¶å€™ï¼š</p>
<ul>
<li><p>è‹¥ <span class="math inline">\(i&gt;r\)</span>ï¼Œåˆ™ç›´æ¥æš´åŠ›æ±‚ <span class="math inline">\(p_i\)</span>ï¼ŒåŒæ—¶æ›´æ–° <span class="math inline">\(r\)</span> å’Œ <span class="math inline">\(d\)</span>ã€‚</p></li>
<li><p>è‹¥ <span class="math inline">\(i\le r\)</span>ï¼Œåˆ™å…ˆè®¾ <span class="math inline">\(p_i = \min(r - i + 1, p_{2d-i})\)</span>ï¼Œè€ƒè™‘åˆ° <span class="math inline">\(i\)</span> å’Œ <span class="math inline">\(2d- i\)</span> æ˜¯å¯¹ç§°çš„ï¼Œä¸” <span class="math inline">\([2d-r, r]\)</span> æ˜¯å›æ–‡çš„ï¼Œé‚£ä¹ˆ <span class="math inline">\(2d-i\)</span> å¯¹åº”çš„å›æ–‡çš„éƒ¨åˆ†ä¹Ÿèƒ½å¯¹åº”åˆ° <span class="math inline">\(i\)</span> çš„ä½ç½®ä¸Šé¢ã€‚</p>
<p>è‹¥ <span class="math inline">\(p_{2d-i} &lt; r - i + 1\)</span> è¯´æ˜ <span class="math inline">\(p_i = p_{2d-i}\)</span>ï¼Œä¸€å®šä¸ä¼šå­˜åœ¨æ›´å¤§çš„å›æ–‡åŠå¾„ã€‚</p>
<p>è‹¥ <span class="math inline">\(p_{2d-i}\ge r - i + 1\)</span>ï¼Œé‚£ä¹ˆæŠŠ <span class="math inline">\(p_i\)</span> åˆå§‹åŒ–ä¸º <span class="math inline">\(r - i + 1\)</span> ç„¶åæ…¢æ…¢å¾€å³è¾¹æ‰©å±•ï¼Œæ³¨æ„åˆ°è¿™ä¸ªæ—¶å€™ <span class="math inline">\(r\)</span> æŒ‡é’ˆä¼šè¢«ç§»åŠ¨ã€‚</p>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/manacher1.png"/><figcaption>manacher1</figcaption>
</figure></li>
</ul>
<p>æ—¶é—´å¤æ‚åº¦ï¼šè€ƒè™‘ <span class="math inline">\(r\)</span> æŒ‡é’ˆç§»åŠ¨çš„æ¬¡æ•°æ˜¯çº¿æ€§çš„ã€‚</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">1.1e7</span> + <span class="dv">5</span>;</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2"></a></span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3"></a><span class="dt">char</span> s[maxn &lt;&lt; <span class="dv">1</span>];</span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4"></a><span class="dt">int</span> len[maxn &lt;&lt; <span class="dv">1</span>], cnt, ans;</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5"></a></span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6"></a><span class="kw">inline</span> <span class="dt">int</span> min(<span class="dt">int</span> a, <span class="dt">int</span> b) {<span class="cf">return</span> a &lt; b ? a : b;}</span>
<span id="cb4-7"><a aria-hidden="true" href="#cb4-7"></a></span>
<span id="cb4-8"><a aria-hidden="true" href="#cb4-8"></a><span class="dt">void</span> read() {</span>
<span id="cb4-9"><a aria-hidden="true" href="#cb4-9"></a>    <span class="dt">char</span> c = getchar();</span>
<span id="cb4-10"><a aria-hidden="true" href="#cb4-10"></a>    s[<span class="dv">0</span>] = <span class="ch">'&amp;'</span>, s[cnt = <span class="dv">1</span>] = <span class="ch">'#'</span>;</span>
<span id="cb4-11"><a aria-hidden="true" href="#cb4-11"></a>    <span class="cf">while</span> (!isalpha(c)) c = getchar();</span>
<span id="cb4-12"><a aria-hidden="true" href="#cb4-12"></a>    <span class="cf">while</span> (isalpha(c)) s[++cnt] = c, s[++cnt] = <span class="ch">'#'</span>, c = getchar();</span>
<span id="cb4-13"><a aria-hidden="true" href="#cb4-13"></a>    <span class="cf">return</span>;</span>
<span id="cb4-14"><a aria-hidden="true" href="#cb4-14"></a>}</span>
<span id="cb4-15"><a aria-hidden="true" href="#cb4-15"></a></span>
<span id="cb4-16"><a aria-hidden="true" href="#cb4-16"></a><span class="dt">int</span> main() {</span>
<span id="cb4-17"><a aria-hidden="true" href="#cb4-17"></a>    read();</span>
<span id="cb4-18"><a aria-hidden="true" href="#cb4-18"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>, r = <span class="dv">0</span>, mid = <span class="dv">0</span>; i &lt;= cnt; ++i) {</span>
<span id="cb4-19"><a aria-hidden="true" href="#cb4-19"></a>        <span class="cf">if</span> (i &lt;= r)</span>
<span id="cb4-20"><a aria-hidden="true" href="#cb4-20"></a>            len[i] = min(len[(mid &lt;&lt; <span class="dv">1</span>) - i], r - i + <span class="dv">1</span>);</span>
<span id="cb4-21"><a aria-hidden="true" href="#cb4-21"></a>        <span class="cf">while</span> (s[i - len[i]] == s[i + len[i]]) ++len[i];</span>
<span id="cb4-22"><a aria-hidden="true" href="#cb4-22"></a>        <span class="cf">if</span> (i + len[i] &gt; r) r = i + len[i] - <span class="dv">1</span>, mid = i;</span>
<span id="cb4-23"><a aria-hidden="true" href="#cb4-23"></a>        <span class="cf">if</span> (len[i] &gt; ans) ans = len[i];</span>
<span id="cb4-24"><a aria-hidden="true" href="#cb4-24"></a>    }</span>
<span id="cb4-25"><a aria-hidden="true" href="#cb4-25"></a>    printf(<span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span>, ans - <span class="dv">1</span>);</span>
<span id="cb4-26"><a aria-hidden="true" href="#cb4-26"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb4-27"><a aria-hidden="true" href="#cb4-27"></a>}</span></code></pre></div>
<h3 id="åº”ç”¨-1">åº”ç”¨</h3>
<p>é¦–å…ˆæœ‰ä¸€ä¸ªæŠ€å·§å°±æ˜¯åœ¨ manacher çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥æ±‚å‡ºä»¥ <span class="math inline">\(s[i]\)</span> å¼€å¤´/ç»“å°¾çš„æœ€é•¿å›æ–‡å­ä¸²çš„é•¿åº¦ï¼Œå…·ä½“åœ°åœ¨æ‰©å±• <span class="math inline">\(r\)</span> æŒ‡é’ˆçš„æ—¶å€™è¿›è¡Œå¤„ç†ï¼Œè¯¦è§ä¾‹é¢˜ <span class="math inline">\(1\)</span>ã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(1\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P4555">P4555 [å›½å®¶é›†è®­é˜Ÿ]æœ€é•¿åŒå›æ–‡ä¸²</a></p>
<p>æ±‚ <span class="math inline">\(S\)</span> çš„æœ€é•¿åŒå›æ–‡å­ä¸²ã€‚ä¸€ä¸ªä¸² <span class="math inline">\(T\)</span> åŒå›æ–‡æ˜¯æŒ‡å…¶èƒ½è¡¨ç¤ºä¸ºä¸¤ä¸ªå›æ–‡ä¸²çš„æ‹¼æ¥ã€‚</p>
</blockquote>
<p>ä¼šå‘ç°æ‰¾åˆ° <span class="math inline">\(r_i\)</span> å’Œ <span class="math inline">\(l_i\)</span>ï¼ˆä»¥ <span class="math inline">\(s[i]\)</span> ç»“å°¾/å¼€å¤´çš„æœ€é•¿å›æ–‡å­ä¸²ï¼‰åç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(\max\{l_i+r_i\}\)</span>ã€‚</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3"></a><span class="pp">#define FOR</span>(i,<span class="pp"> </span>a,<span class="pp"> </span>b)<span class="pp"> </span><span class="cf">for</span><span class="pp"> </span>(<span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span>=<span class="pp"> </span>a;<span class="pp"> </span>i<span class="pp"> </span>&lt;=<span class="pp"> </span>b;<span class="pp"> </span>++i)</span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4"></a><span class="pp">#define DEC</span>(i,<span class="pp"> </span>a,<span class="pp"> </span>b)<span class="pp"> </span><span class="cf">for</span><span class="pp"> </span>(<span class="dt">int</span><span class="pp"> </span>i<span class="pp"> </span>=<span class="pp"> </span>a;<span class="pp"> </span>i<span class="pp"> </span>&gt;=<span class="pp"> </span>b;<span class="pp"> </span>--i)</span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5"></a></span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6"></a><span class="kw">inline</span> <span class="dt">int</span> max(<span class="dt">int</span> a, <span class="dt">int</span> b) {<span class="cf">return</span> a &gt; b ? a : b;}</span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7"></a><span class="kw">inline</span> <span class="dt">int</span> min(<span class="dt">int</span> a, <span class="dt">int</span> b) {<span class="cf">return</span> a &lt; b ? a : b;}</span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8"></a></span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">1e5</span> + <span class="dv">5</span>;</span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10"></a></span>
<span id="cb5-11"><a aria-hidden="true" href="#cb5-11"></a><span class="dt">char</span> s[maxn &lt;&lt; <span class="dv">1</span>], real[maxn];</span>
<span id="cb5-12"><a aria-hidden="true" href="#cb5-12"></a><span class="dt">int</span> n, len[maxn &lt;&lt; <span class="dv">1</span>], cnt;</span>
<span id="cb5-13"><a aria-hidden="true" href="#cb5-13"></a><span class="dt">int</span> fl[maxn &lt;&lt; <span class="dv">1</span>], fr[maxn &lt;&lt; <span class="dv">1</span>];</span>
<span id="cb5-14"><a aria-hidden="true" href="#cb5-14"></a></span>
<span id="cb5-15"><a aria-hidden="true" href="#cb5-15"></a><span class="dt">int</span> main() {</span>
<span id="cb5-16"><a aria-hidden="true" href="#cb5-16"></a>    scanf(<span class="st">"</span><span class="sc">%s</span><span class="st">"</span>, real + <span class="dv">1</span>);</span>
<span id="cb5-17"><a aria-hidden="true" href="#cb5-17"></a>    n = strlen(real + <span class="dv">1</span>);</span>
<span id="cb5-18"><a aria-hidden="true" href="#cb5-18"></a>    s[cnt = <span class="dv">0</span>] = <span class="ch">'&amp;'</span>, s[++cnt] = <span class="ch">'#'</span>;</span>
<span id="cb5-19"><a aria-hidden="true" href="#cb5-19"></a>    FOR(i, <span class="dv">1</span>, n) s[++cnt] = real[i], s[++cnt] = <span class="ch">'#'</span>;</span>
<span id="cb5-20"><a aria-hidden="true" href="#cb5-20"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>, r = <span class="dv">0</span>, mid = <span class="dv">0</span>; i &lt;= cnt; ++i) {</span>
<span id="cb5-21"><a aria-hidden="true" href="#cb5-21"></a>        <span class="cf">if</span> (i &lt;= r) len[i] = min(len[(mid &lt;&lt; <span class="dv">1</span>) - i], r - i + <span class="dv">1</span>);</span>
<span id="cb5-22"><a aria-hidden="true" href="#cb5-22"></a>        <span class="cf">while</span> (s[i - len[i]] == s[i + len[i]]) ++len[i];</span>
<span id="cb5-23"><a aria-hidden="true" href="#cb5-23"></a>        <span class="cf">if</span> (i + len[i] &gt; r) r = i + len[i] - <span class="dv">1</span>, mid = i;</span>
<span id="cb5-24"><a aria-hidden="true" href="#cb5-24"></a>        fl[i + len[i] - <span class="dv">1</span>] = max(fl[i + len[i] - <span class="dv">1</span>], len[i] - <span class="dv">1</span>);</span>
<span id="cb5-25"><a aria-hidden="true" href="#cb5-25"></a>        fr[i - len[i] + <span class="dv">1</span>] = max(fr[i - len[i] + <span class="dv">1</span>], len[i] - <span class="dv">1</span>);</span>
<span id="cb5-26"><a aria-hidden="true" href="#cb5-26"></a>    }</span>
<span id="cb5-27"><a aria-hidden="true" href="#cb5-27"></a>    FOR(i, <span class="dv">1</span>, cnt) fr[i] = max(fr[i], fr[i - <span class="dv">2</span>] - <span class="dv">2</span>);</span>
<span id="cb5-28"><a aria-hidden="true" href="#cb5-28"></a>    DEC(i, cnt, <span class="dv">1</span>) fl[i] = max(fl[i], fl[i + <span class="dv">2</span>] - <span class="dv">2</span>);</span>
<span id="cb5-29"><a aria-hidden="true" href="#cb5-29"></a>    <span class="dt">int</span> ans = <span class="dv">0</span>;</span>
<span id="cb5-30"><a aria-hidden="true" href="#cb5-30"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; cnt; i += <span class="dv">2</span>) <span class="cf">if</span> (fl[i] &amp;&amp; fr[i]) ans = max(fl[i] + fr[i], ans);</span>
<span id="cb5-31"><a aria-hidden="true" href="#cb5-31"></a>    printf(<span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span>, ans);</span>
<span id="cb5-32"><a aria-hidden="true" href="#cb5-32"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb5-33"><a aria-hidden="true" href="#cb5-33"></a>}</span></code></pre></div>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(2\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P1659">P1659 [å›½å®¶é›†è®­é˜Ÿ]æ‹‰æ‹‰é˜Ÿæ’ç»ƒ</a></p>
<p>æ±‚å°†æ‰€æœ‰é•¿åº¦ä¸ºå¥‡æ•°çš„å›æ–‡ä¸²æŒ‰ç…§é•¿åº¦é™åºæ’åºåï¼Œå‰ <span class="math inline">\(k\)</span> ä¸ªå›æ–‡ä¸²çš„ä¸²é•¿ä¹‹ç§¯ã€‚</p>
</blockquote>
<p>ä¸ç”¨åŠ åˆ†éš”ç¬¦ï¼Œç›´æ¥è·‘ manacherï¼Œæ³¨æ„åˆ°ä»¥ <span class="math inline">\(i\)</span> ä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²ä»¬çš„é•¿åº¦è¦†ç›–äº† <span class="math inline">\([1,2p_i-1]\)</span>ï¼Œè·‘çš„æ—¶å€™å·®åˆ†ä¸€ä¸‹æœ€ååšå‰ç¼€å’Œï¼Œç„¶åè´¡çŒ®ç”¨å¿«é€Ÿå¹‚å•¥çš„ç®—ä¸€ç®—å°±è¡Œã€‚</p>
<blockquote>
<p>ä¾‹é¢˜ <span class="math inline">\(3\)</span>ï¼š<a href="https://www.luogu.com.cn/problem/P5446">P5446 [THUPC2018]ç»¿ç»¿å’Œä¸²ä¸²</a></p>
<p>å®šä¹‰å¯¹ä¸² <span class="math inline">\(R\)</span> è¿›è¡Œç¿»è½¬æ“ä½œä¸ºå°†å…¶å…³äºæœ€åä¸€ä¸ªå­—ç¬¦è½´å¯¹ç§°ï¼Œå¦‚ <span class="math inline">\(\texttt{aab}\to\texttt{aabaa}\)</span>ã€‚</p>
<p>å·²çŸ¥å°† <span class="math inline">\(R\)</span> ç¿»è½¬è‹¥å¹²æ¬¡åå¾—åˆ°çš„ä¸²çš„ä¸€å‰ç¼€ä¸º <span class="math inline">\(S\)</span>ã€‚æ±‚ä¸è¶…è¿‡ <span class="math inline">\(|S|\)</span> çš„ <span class="math inline">\(|R|\)</span> çš„æ‰€æœ‰å¯èƒ½å€¼ã€‚</p>
</blockquote>
<p>å‘ç°è¿™ä¸ªä¸œè¥¿è·Ÿå›æ–‡è‚¯å®šæ˜¯è„±ä¸å¼€å¹²ç³»çš„ï¼Œè€ƒè™‘è·‘ä¸€é manacherï¼ˆæ³¨æ„åˆ°è¿™é‡Œè€ƒè™‘çš„å›æ–‡ä¸²éƒ½æ˜¯å¥‡å›æ–‡ä¸²æ‰€ä»¥åªéœ€è¦è¡¥å¤´å°¾çš„ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚ç„¶åè€ƒè™‘åªç¿»è½¬ä¸€æ¬¡çš„æƒ…å†µï¼šå‘ç° <span class="math inline">\(p_i = n - i + 1\)</span> çš„æ—¶å€™è¿™ä¸ªä½ç½®å¯ä»¥ä½œä¸ºä¸²é•¿ï¼Œç„¶åè€ƒè™‘ç¿»è½¬å¤šæ¬¡çš„æƒ…å†µï¼šè®¾ <span class="math inline">\(f_i\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> èƒ½å¦ä½œä¸ºç­”æ¡ˆï¼Œåˆ™ä¸éš¾å‘ç°å½“ <span class="math inline">\(i\)</span> å¼€å¤´çš„å›æ–‡ä¸²èƒ½åˆ°è¾¾ä¸²é¦–å¹¶ä¸”ä½ç½® <span class="math inline">\(f_{2i - 1}\)</span> æ»¡è¶³å³å¯ï¼Œå€’ç€ dp ä¸€éå°± OK äº†ã€‚</p>
<h2 id="kmp-ç®—æ³•ä¸-z-algo">KMP ç®—æ³•ä¸ Z-Algo</h2>
<h3 id="kmp-ç®—æ³•">KMP ç®—æ³•</h3>
<p>æœ´ç´ åœ°è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…çš„æ—¶é—´å¤æ‚åº¦ä¸Šç•Œå¯èƒ½è¾¾åˆ° <span class="math inline">\(O(nm)\)</span>ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€ä¸å¸Œæœ›çœ‹åˆ°çš„ã€‚</p>
<p>æœ€å…³é”®çš„é—®é¢˜å°±åœ¨äºå½“å‰ä½ç½®å¤±é…åï¼Œå¦‚æœå†ä»ä¸‹ä¸€ä¸ªä½ç½®ç»§ç»­åŒ¹é…å°±å¤ªè ¢äº†ï¼Œæˆ‘ä»¬æƒ³æ‰¾åˆ°ä¸€ä¸ªæœ€å¾€åçš„èƒ½ä½¿å¾—å…¶å¯èƒ½åŒ¹é…ä¸Šçš„ä½ç½®ã€‚è€ƒè™‘æˆ‘ä»¬æ‹¿ <span class="math inline">\(T\)</span> å»åŒ¹é… <span class="math inline">\(S\)</span>ï¼Œåˆ™æ±‚ <span class="math inline">\(S\)</span> ä¸­å‡ºç°çš„ <span class="math inline">\(T\)</span> çš„ä½ç½®ã€‚</p>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/KMP1.png"/><figcaption>KMP1</figcaption>
</figure>
<p>æ¯”å¦‚è¯´ï¼Œ<span class="math inline">\(T[j]\)</span> åœ¨ <span class="math inline">\(S[i]\)</span> å¤„å¤±é…äº†ï¼Œé‚£ä¹ˆè‹¥æˆ‘ä»¬ç›´æ¥è€ƒè™‘å°† <span class="math inline">\(T\)</span> å³ç§»ä¸€ä½å»åŒ¹é…è‚¯å®šä¹Ÿæ˜¯ä¸ä¼˜çš„ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿè€ƒè™‘æ‰¾åˆ°ä¸€ä¸ªæœ€å¤§çš„ <span class="math inline">\(x\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(T[1..x] = T[j - x + 1..j]\)</span>ï¼Œç„¶åç›´æ¥å°† <span class="math inline">\(T\)</span> å³ç§» <span class="math inline">\(j-x+1\)</span> æ ¼æ¥åŒ¹é…ã€‚</p>
<p>è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿç›¸å½“äºæˆ‘ä»¬é‡å¤åˆ©ç”¨äº† <span class="math inline">\(T[1..x]\)</span> å·²ç»åŒ¹é…å¥½äº†çš„ä¿¡æ¯ï¼Œä¸å†éœ€è¦ä»å¤´æ¥è¿›è¡ŒåŒ¹é…ã€‚è€Œ <span class="math inline">\(x\)</span> æœ€å¤§åˆä½¿å¾—æˆ‘ä»¬ä¸ä¼šæ¼æ‰ä¿¡æ¯ã€‚</p>
<p>å¯¹äºæ¯ä¸ªä½ç½® <span class="math inline">\(j\)</span> éƒ½æ±‚å‡ºå¯¹åº”çš„ <span class="math inline">\(x\)</span>ï¼Œè®°ä½œ <span class="math inline">\(\pi(j)\)</span>ï¼ˆå‰ç¼€å‡½æ•°ï¼Œä¸‹æ–‡ä¼šæåˆ°ï¼‰ï¼Œæ±‚å‡ºæ‰€æœ‰ <span class="math inline">\(\pi(j)\)</span> ä¹‹åå°±å¯ä»¥ä»¥çº¿æ€§çš„å¤æ‚åº¦è¿›è¡ŒåŒ¹é…ï¼Œä¸ä¼šè¯æ˜ã€‚ä½†ç°åœ¨é—®é¢˜åœ¨äºä½ éœ€è¦æ±‚å‡º <span class="math inline">\(\pi(j)\)</span>ã€‚å“å…¶å®é‚£å°±ç›¸å½“äºæ‹¿è‡ªå·±åŒ¹é…è‡ªå·±ï¼š</p>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/KMP2.png"/><figcaption>KMP2</figcaption>
</figure>
<p>å¦‚ä¸‹å›¾ï¼Œè‹¥æ²¡æ³•åŒ¹é…ä¸‹å»ï¼Œåˆ™ä» <span class="math inline">\(\pi(\pi(i))\)</span> è¿™æ ·ä¸‹å»åå¤è·³ <span class="math inline">\(\pi\)</span> æ¥åŒ¹é…ï¼Œè¿™æ ·ä¹Ÿæ˜¯çº¿æ€§çš„ã€‚</p>
<h3 id="z-ç®—æ³•">Z ç®—æ³•</h3>
<p>å¯¹å­—ç¬¦ä¸² <span class="math inline">\(S\)</span>ï¼Œå®šä¹‰ <span class="math inline">\(z\)</span> å‡½æ•° <span class="math inline">\(z(i)\)</span> è¡¨ç¤º <span class="math inline">\(S[i..n]\)</span> ä¸ <span class="math inline">\(S\)</span> çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼ˆLCPï¼‰çš„é•¿åº¦ã€‚ä¸€èˆ¬åœ°ä»¤ <span class="math inline">\(z(1) = n\)</span>ã€‚</p>
<p>è§£æ³•å’Œ Manacher ç®—æ³•å¾ˆç±»ä¼¼ã€‚ä¸å¦¨è®¾ <span class="math inline">\([i,i+z(i) - 1]\)</span> ä¸º <span class="math inline">\(i\)</span> çš„åŒ¹é…æ®µï¼Œä¹Ÿå«åš Z-boxã€‚ç»´æŠ¤æœ€é å³çš„ Z-box <span class="math inline">\([l,r]\)</span>ï¼Œåˆ™æ ¹æ®å®šä¹‰æœ‰ <span class="math inline">\(S[l..r]\)</span> æ˜¯ <span class="math inline">\(S\)</span> çš„å‰ç¼€ï¼Œåˆ†ç±»è®¨è®ºä¸€ä¸‹ï¼š</p>
<ul>
<li>è‹¥ <span class="math inline">\(i&gt;r\)</span>ï¼Œåˆ™ç›´æ¥æš´åŠ›æ‰©å±•ã€‚</li>
<li>è‹¥ <span class="math inline">\(i\le r\)</span>ï¼Œåˆ™æ ¹æ® <span class="math inline">\(S[l..r] = S[1..r-l+1]\)</span>ï¼Œæœ‰ <span class="math inline">\(S[i..r] = S[i-l+1..r-l +1]\)</span>ï¼Œæ‰€ä»¥å°† <span class="math inline">\(z(i)\)</span> åˆå§‹åŒ–ä¸º <span class="math inline">\(\min(r - i + 1, z(i - l + 1))\)</span>ï¼Œç„¶åå†æš´åŠ›æ‰©å±•å³å¯ã€‚åœ¨</li>
</ul>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/Z-func.png"/><figcaption>Z-func</figcaption>
</figure>
<p>æ—¶é—´å¤æ‚åº¦ä»ç„¶æ˜¯ä¼˜ç§€çš„çº¿æ€§ã€‚</p>
<h2 id="border-ç†è®ºåŸºç¡€ä¸-fail-æ ‘">Border ç†è®ºåŸºç¡€ä¸ fail æ ‘</h2>
</section>
<footer class="article-footer">
<section class="article-tags">
<a href="/tags/OI/">OI</a>
<a href="/tags/note/">ç¬”è®°</a>
</section>
<section class="article-copyright">
<svg class="icon icon-tabler icon-tabler-copyright" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M14.5 9a3.5 4 0 1 0 0 6"></path>
</svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js">
</script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
</article>
<aside class="related-contents--wrapper">
<h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
<div class="related-contents">
<div class="flex article-list--tile">
<article class="has-image">
<a href="/note-gf/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">ç”Ÿæˆå‡½æ•°èƒ¡æ‰¯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-set-power-series/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">é›†åˆå¹‚çº§æ•°èƒ¡æ‰¯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-linear-basis/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">çº¿æ€§åŸºå­¦ä¹ ç¬”è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-wqs/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">wqs äºŒåˆ†å­¦ä¹ ç¬”è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-builtin/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">__builtin ç³»åˆ—å‡½æ•°æ€»ç»“</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class="site-footer">
<section class="copyright">
        Â© 
        
            2019 - 
        
        2024 æ¸…çƒ›çš„åšå®¢
    </section>
<section class="powerby">
        Built with <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a> <br/>
        ä¸»é¢˜ <b><a data-version="3.11.0" href="https://github.com/CaiJimmy/hugo-theme-stack" rel="noopener" target="_blank">Stack</a></b> ç”± <a href="https://jimmycai.com" rel="noopener" target="_blank">Jimmy</a> è®¾è®¡
    </section>
</footer>
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">
<div class="pswp__bg"></div>
<div class="pswp__scroll-wrap">
<div class="pswp__container">
<div class="pswp__item"></div>
<div class="pswp__item"></div>
<div class="pswp__item"></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class="pswp__top-bar">
<div class="pswp__counter"></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class="pswp__preloader">
<div class="pswp__preloader__icn">
<div class="pswp__preloader__cut">
<div class="pswp__preloader__donut"></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class="pswp__share-tooltip"></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class="pswp__caption">
<div class="pswp__caption__center"></div>
</div>
</div>
</div>
</div><script crossorigin="anonymous" defer="" integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js">
</script><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" rel="stylesheet"/><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" rel="stylesheet"/>
</main>
</div>
<script crossorigin="anonymous" integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js">
</script><script defer="" src="/ts/main.js" type="text/javascript"></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
</body>
</html>

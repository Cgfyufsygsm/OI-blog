<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="å‰è¨€ ä¸€ç›´å¯¹è¿™æ–¹é¢ä¸æ˜¯å¾ˆç†è§£ï¼Œå¼€ä¸ªå‘è®°å½•ä¸€ä¸‹ã€‚
åŸºæœ¬æ¦‚å¿µ å¯¹äºæœ‰å‘å›¾ï¼š
å¼ºè¿é€šï¼šå¯¹äºä¸€å¼ æœ‰å‘å›¾ï¼Œè‹¥æ¯ä¸ªç‚¹äº’ç›¸å¯è¾¾ï¼Œåˆ™ç§°ä¸ºå¼ºè¿é€šã€‚ å¼ºè¿é€šåˆ†é‡ï¼šæå¤§çš„å¼ºè¿é€šå­å›¾ã€‚ å¯¹äºæ— å‘å›¾ï¼š
ç‚¹å‰²é›†ï¼šè‹¥åˆ æ‰è¯¥é›†åˆçš„ç‚¹åå›¾ä¸è¿é€šï¼Œåˆ™ç§°ä¸ºç‚¹å‰²é›†ã€‚å¤§å°ä¸º \(1\) çš„ç‚¹å‰²é›†å°±æ˜¯å‰²ç‚¹ã€‚ ç‚¹è”é€šåº¦ï¼šè‹¥ \(k + 1\le |V|\) ä¸”ä¸å­˜åœ¨å¤§å°ä¸º \(k - 1\) çš„ç‚¹å‰²é›†ï¼Œåˆ™ç§°è¯¥å›¾ \(k-\) ç‚¹è”é€šã€‚æœ€å¤§çš„ \(k\)ï¼Œå³æœ€å°ç‚¹å‰²é›†åˆçš„å¤§å°ã€‚ è¾¹å‰²é›†/è¾¹è”é€šåº¦ï¼šç±»ä¼¼ã€‚ ç‚¹åŒè¿é€šï¼šæ²¡æœ‰å‰²ç‚¹çš„è¿é€šå›¾æ˜¯ç‚¹åŒè¿é€šçš„ã€‚ è¾¹åŒè¿é€šï¼šæ²¡æœ‰æ¡¥çš„è¿é€šå›¾æ˜¯è¾¹åŒè¿é€šçš„ã€‚ ç‚¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„ç‚¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°ç‚¹åŒï¼‰ã€‚ è¾¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„è¾¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°è¾¹åŒï¼‰ã€‚ å¼ºè¿é€šåˆ†é‡ï¼ˆSCCï¼‰ ä½¿ç”¨ tarjan ç®—æ³•åšåˆ° \(O(n + m)\)ã€‚
dfs ç”Ÿæˆæ ‘ tarjan ç®—æ³•æ˜¯åŸºäº dfs çš„ã€‚è€ƒè™‘åœ¨åŸå›¾ä¸Šç”Ÿæˆä¸€æ£µ dfs ç”Ÿæˆæ ‘ã€‚
é‚£ä¹ˆåŸå›¾çš„è¾¹å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š
æ ‘è¾¹ï¼šå°±æ˜¯åœ¨ dfs ç”Ÿæˆæ ‘çš„è¾¹ï¼Œå½“ä¸€ä¸ªç‚¹æœç´ æ‰¾åˆ°ä¸€ä¸ªæ²¡æœ‰è®¿é—®çš„ç‚¹æ—¶ç”Ÿæˆã€‚ è¿”ç¥–è¾¹ï¼šæŒ‡å‘ç¥–å…ˆèŠ‚ç‚¹çš„è¾¹ã€‚ æ¨ªå‰è¾¹ï¼šæœç´¢æ—¶é‡åˆ°çš„è®¿é—®è¿‡çš„ä½†æ˜¯ä¸æ˜¯è‡ªå·±ç¥–å…ˆçš„ç‚¹ã€‚ å‰å‘è¾¹ï¼šæœç´¢æ—¶é‡åˆ°å­æ ‘èŠ‚ç‚¹æ—¶çš„è¾¹ã€‚ æœ‰å¦‚ä¸‹å¼•ç†ï¼šå‡è®¾ \(u\) æ˜¯æŸä¸ª SCC åœ¨ dfs ç”Ÿæˆæ ‘ä¸­ç¬¬ä¸€ä¸ªé‡åˆ°çš„ç‚¹ï¼Œåˆ™ SCC å‰©ä½™çš„ç‚¹è‚¯å®šåœ¨å­æ ‘å†…ï¼Œ\(u\) ç§°ä¸º SCC çš„æ ¹ã€‚è¯æ˜å¯ç”¨åè¯æ³•ï¼Œä¸å†å±•å¼€ã€‚
Tarjan ç®—æ³• æ„é€  dfs ç”Ÿæˆæ ‘çš„åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œè¡¨ç¤ºè®¿é—®è¿‡çš„è¿˜æœªåŠ å…¥ SCC çš„ç‚¹ã€‚
å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ \(\operatorname{dfn}(u)\) å’Œ \(\operatorname{low}(u)\)ã€‚å«ä¹‰åˆ†åˆ«æ˜¯ï¼š" name="description"/><title>å›¾çš„è¿é€šæ€§ç›¸å…³</title>
<link href="https://oi.imyangty.com/note-connectivity/" rel="canonical"/>
<link href="/scss/style.min.a5821f3d3ab84ce5a0ac21477e347a2e0ca00292e398d16c5e8e36ded6e35a23.css" rel="stylesheet"/><meta content="å›¾çš„è¿é€šæ€§ç›¸å…³" property="og:title"/>
<meta content="å‰è¨€ ä¸€ç›´å¯¹è¿™æ–¹é¢ä¸æ˜¯å¾ˆç†è§£ï¼Œå¼€ä¸ªå‘è®°å½•ä¸€ä¸‹ã€‚
åŸºæœ¬æ¦‚å¿µ å¯¹äºæœ‰å‘å›¾ï¼š
å¼ºè¿é€šï¼šå¯¹äºä¸€å¼ æœ‰å‘å›¾ï¼Œè‹¥æ¯ä¸ªç‚¹äº’ç›¸å¯è¾¾ï¼Œåˆ™ç§°ä¸ºå¼ºè¿é€šã€‚ å¼ºè¿é€šåˆ†é‡ï¼šæå¤§çš„å¼ºè¿é€šå­å›¾ã€‚ å¯¹äºæ— å‘å›¾ï¼š
ç‚¹å‰²é›†ï¼šè‹¥åˆ æ‰è¯¥é›†åˆçš„ç‚¹åå›¾ä¸è¿é€šï¼Œåˆ™ç§°ä¸ºç‚¹å‰²é›†ã€‚å¤§å°ä¸º \(1\) çš„ç‚¹å‰²é›†å°±æ˜¯å‰²ç‚¹ã€‚ ç‚¹è”é€šåº¦ï¼šè‹¥ \(k + 1\le |V|\) ä¸”ä¸å­˜åœ¨å¤§å°ä¸º \(k - 1\) çš„ç‚¹å‰²é›†ï¼Œåˆ™ç§°è¯¥å›¾ \(k-\) ç‚¹è”é€šã€‚æœ€å¤§çš„ \(k\)ï¼Œå³æœ€å°ç‚¹å‰²é›†åˆçš„å¤§å°ã€‚ è¾¹å‰²é›†/è¾¹è”é€šåº¦ï¼šç±»ä¼¼ã€‚ ç‚¹åŒè¿é€šï¼šæ²¡æœ‰å‰²ç‚¹çš„è¿é€šå›¾æ˜¯ç‚¹åŒè¿é€šçš„ã€‚ è¾¹åŒè¿é€šï¼šæ²¡æœ‰æ¡¥çš„è¿é€šå›¾æ˜¯è¾¹åŒè¿é€šçš„ã€‚ ç‚¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„ç‚¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°ç‚¹åŒï¼‰ã€‚ è¾¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„è¾¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°è¾¹åŒï¼‰ã€‚ å¼ºè¿é€šåˆ†é‡ï¼ˆSCCï¼‰ ä½¿ç”¨ tarjan ç®—æ³•åšåˆ° \(O(n + m)\)ã€‚
dfs ç”Ÿæˆæ ‘ tarjan ç®—æ³•æ˜¯åŸºäº dfs çš„ã€‚è€ƒè™‘åœ¨åŸå›¾ä¸Šç”Ÿæˆä¸€æ£µ dfs ç”Ÿæˆæ ‘ã€‚
é‚£ä¹ˆåŸå›¾çš„è¾¹å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š
æ ‘è¾¹ï¼šå°±æ˜¯åœ¨ dfs ç”Ÿæˆæ ‘çš„è¾¹ï¼Œå½“ä¸€ä¸ªç‚¹æœç´ æ‰¾åˆ°ä¸€ä¸ªæ²¡æœ‰è®¿é—®çš„ç‚¹æ—¶ç”Ÿæˆã€‚ è¿”ç¥–è¾¹ï¼šæŒ‡å‘ç¥–å…ˆèŠ‚ç‚¹çš„è¾¹ã€‚ æ¨ªå‰è¾¹ï¼šæœç´¢æ—¶é‡åˆ°çš„è®¿é—®è¿‡çš„ä½†æ˜¯ä¸æ˜¯è‡ªå·±ç¥–å…ˆçš„ç‚¹ã€‚ å‰å‘è¾¹ï¼šæœç´¢æ—¶é‡åˆ°å­æ ‘èŠ‚ç‚¹æ—¶çš„è¾¹ã€‚ æœ‰å¦‚ä¸‹å¼•ç†ï¼šå‡è®¾ \(u\) æ˜¯æŸä¸ª SCC åœ¨ dfs ç”Ÿæˆæ ‘ä¸­ç¬¬ä¸€ä¸ªé‡åˆ°çš„ç‚¹ï¼Œåˆ™ SCC å‰©ä½™çš„ç‚¹è‚¯å®šåœ¨å­æ ‘å†…ï¼Œ\(u\) ç§°ä¸º SCC çš„æ ¹ã€‚è¯æ˜å¯ç”¨åè¯æ³•ï¼Œä¸å†å±•å¼€ã€‚
Tarjan ç®—æ³• æ„é€  dfs ç”Ÿæˆæ ‘çš„åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œè¡¨ç¤ºè®¿é—®è¿‡çš„è¿˜æœªåŠ å…¥ SCC çš„ç‚¹ã€‚
å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ \(\operatorname{dfn}(u)\) å’Œ \(\operatorname{low}(u)\)ã€‚å«ä¹‰åˆ†åˆ«æ˜¯ï¼š" property="og:description"/>
<meta content="https://oi.imyangty.com/note-connectivity/" property="og:url"/>
<meta content="æ¸…çƒ›çš„åšå®¢" property="og:site_name"/>
<meta content="article" property="og:type"/><meta content="Post" property="article:section"/><meta content="OI" property="article:tag"/><meta content="ç¬”è®°" property="article:tag"/><meta content="ç¼©ç‚¹" property="article:tag"/><meta content="2021-09-01T23:32:13+08:00" property="article:published_time"/><meta content="2021-09-01T23:32:13+08:00" property="article:modified_time"/><meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg11.webp" property="og:image"/>
<meta content="å›¾çš„è¿é€šæ€§ç›¸å…³" name="twitter:title"/>
<meta content="å‰è¨€ ä¸€ç›´å¯¹è¿™æ–¹é¢ä¸æ˜¯å¾ˆç†è§£ï¼Œå¼€ä¸ªå‘è®°å½•ä¸€ä¸‹ã€‚
åŸºæœ¬æ¦‚å¿µ å¯¹äºæœ‰å‘å›¾ï¼š
å¼ºè¿é€šï¼šå¯¹äºä¸€å¼ æœ‰å‘å›¾ï¼Œè‹¥æ¯ä¸ªç‚¹äº’ç›¸å¯è¾¾ï¼Œåˆ™ç§°ä¸ºå¼ºè¿é€šã€‚ å¼ºè¿é€šåˆ†é‡ï¼šæå¤§çš„å¼ºè¿é€šå­å›¾ã€‚ å¯¹äºæ— å‘å›¾ï¼š
ç‚¹å‰²é›†ï¼šè‹¥åˆ æ‰è¯¥é›†åˆçš„ç‚¹åå›¾ä¸è¿é€šï¼Œåˆ™ç§°ä¸ºç‚¹å‰²é›†ã€‚å¤§å°ä¸º \(1\) çš„ç‚¹å‰²é›†å°±æ˜¯å‰²ç‚¹ã€‚ ç‚¹è”é€šåº¦ï¼šè‹¥ \(k + 1\le |V|\) ä¸”ä¸å­˜åœ¨å¤§å°ä¸º \(k - 1\) çš„ç‚¹å‰²é›†ï¼Œåˆ™ç§°è¯¥å›¾ \(k-\) ç‚¹è”é€šã€‚æœ€å¤§çš„ \(k\)ï¼Œå³æœ€å°ç‚¹å‰²é›†åˆçš„å¤§å°ã€‚ è¾¹å‰²é›†/è¾¹è”é€šåº¦ï¼šç±»ä¼¼ã€‚ ç‚¹åŒè¿é€šï¼šæ²¡æœ‰å‰²ç‚¹çš„è¿é€šå›¾æ˜¯ç‚¹åŒè¿é€šçš„ã€‚ è¾¹åŒè¿é€šï¼šæ²¡æœ‰æ¡¥çš„è¿é€šå›¾æ˜¯è¾¹åŒè¿é€šçš„ã€‚ ç‚¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„ç‚¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°ç‚¹åŒï¼‰ã€‚ è¾¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„è¾¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°è¾¹åŒï¼‰ã€‚ å¼ºè¿é€šåˆ†é‡ï¼ˆSCCï¼‰ ä½¿ç”¨ tarjan ç®—æ³•åšåˆ° \(O(n + m)\)ã€‚
dfs ç”Ÿæˆæ ‘ tarjan ç®—æ³•æ˜¯åŸºäº dfs çš„ã€‚è€ƒè™‘åœ¨åŸå›¾ä¸Šç”Ÿæˆä¸€æ£µ dfs ç”Ÿæˆæ ‘ã€‚
é‚£ä¹ˆåŸå›¾çš„è¾¹å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š
æ ‘è¾¹ï¼šå°±æ˜¯åœ¨ dfs ç”Ÿæˆæ ‘çš„è¾¹ï¼Œå½“ä¸€ä¸ªç‚¹æœç´ æ‰¾åˆ°ä¸€ä¸ªæ²¡æœ‰è®¿é—®çš„ç‚¹æ—¶ç”Ÿæˆã€‚ è¿”ç¥–è¾¹ï¼šæŒ‡å‘ç¥–å…ˆèŠ‚ç‚¹çš„è¾¹ã€‚ æ¨ªå‰è¾¹ï¼šæœç´¢æ—¶é‡åˆ°çš„è®¿é—®è¿‡çš„ä½†æ˜¯ä¸æ˜¯è‡ªå·±ç¥–å…ˆçš„ç‚¹ã€‚ å‰å‘è¾¹ï¼šæœç´¢æ—¶é‡åˆ°å­æ ‘èŠ‚ç‚¹æ—¶çš„è¾¹ã€‚ æœ‰å¦‚ä¸‹å¼•ç†ï¼šå‡è®¾ \(u\) æ˜¯æŸä¸ª SCC åœ¨ dfs ç”Ÿæˆæ ‘ä¸­ç¬¬ä¸€ä¸ªé‡åˆ°çš„ç‚¹ï¼Œåˆ™ SCC å‰©ä½™çš„ç‚¹è‚¯å®šåœ¨å­æ ‘å†…ï¼Œ\(u\) ç§°ä¸º SCC çš„æ ¹ã€‚è¯æ˜å¯ç”¨åè¯æ³•ï¼Œä¸å†å±•å¼€ã€‚
Tarjan ç®—æ³• æ„é€  dfs ç”Ÿæˆæ ‘çš„åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œè¡¨ç¤ºè®¿é—®è¿‡çš„è¿˜æœªåŠ å…¥ SCC çš„ç‚¹ã€‚
å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ \(\operatorname{dfn}(u)\) å’Œ \(\operatorname{low}(u)\)ã€‚å«ä¹‰åˆ†åˆ«æ˜¯ï¼š" name="twitter:description"/><meta content="summary_large_image" name="twitter:card"/>
<meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg11.webp" name="twitter:image"/>
<link href="https://q1.qlogo.cn/g?b=qq&amp;nk=375836877&amp;s=5" rel="shortcut icon"/>
<link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/github-dark-dimmed.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="article-page">
<script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button aria-label="åˆ‡æ¢èœå•" class="hamburger hamburger--spin" id="toggle-menu" type="button">
<span class="hamburger-box">
<span class="hamburger-inner"></span>
</span>
</button>
<header>
<figure class="site-avatar">
<a href="/">
<img alt="Avatar" class="site-logo" height="300" loading="lazy" src="/img/avatar_huea3ce2119467b51fdd2a81393644a76d_51594_300x0_resize_q75_box.jpg" width="300"/>
</a>
<span class="emoji">ğŸ˜…</span>
</figure>
<div class="site-meta">
<h1 class="site-name"><a href="/">æ¸…çƒ›çš„åšå®¢</a></h1>
<h2 class="site-description">çƒŸç«å·²è°¢ï¼Œç¬™æ­Œæœªåœ</h2>
</div>
</header><ol class="social-menu">
<li>
<a href="mailto:i@imyangty.com" target="_blank" title="email">
<svg class="icon icon-tabler icon-tabler-mail" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<rect height="14" rx="2" width="18" x="3" y="5"></rect>
<polyline points="3 7 12 13 21 7"></polyline>
</svg>
</a>
</li>
<li>
<a href="https://github.com/Cgfyufsygsm" target="_blank" title="GitHub">
<svg class="icon icon-tabler icon-tabler-brand-github" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
</a>
</li>
<li>
<a href="https://t.me/Cgfyufsygsm" target="_blank" title="Telegram">
<svg class="icon icon-tabler icon-tabler-brand-telegram" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"></path>
</svg>
</a>
</li>
<li>
<a href="https://twitter.com/Cgfyufsygsm" target="_blank" title="Twitter">
<svg class="icon icon-tabler icon-tabler-brand-twitter" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
</svg>
</a>
</li>
</ol><ol class="menu" id="main-menu">
<li>
<a href="/">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»é¡µ</span>
</a>
</li>
<li>
<a href="/about/">
<svg class="icon icon-tabler icon-tabler-user" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="7" r="4"></circle>
<path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
</svg>
<span>å…³äº</span>
</a>
</li>
<li>
<a href="/idx/">
<svg class="icon icon-tabler icon-tabler-hash" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<line x1="5" x2="19" y1="9" y2="9"></line>
<line x1="5" x2="19" y1="15" y2="15"></line>
<line x1="11" x2="7" y1="4" y2="20"></line>
<line x1="17" x2="13" y1="4" y2="20"></line>
</svg>
<span>å¯¼èˆª</span>
</a>
</li>
<li>
<a href="/archives/">
<svg class="icon icon-tabler icon-tabler-archive" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<rect height="4" rx="2" width="18" x="3" y="4"></rect>
<path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10"></path>
<line x1="10" x2="14" y1="12" y2="12"></line>
</svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href="/search/">
<svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="10" cy="10" r="7"></circle>
<line x1="21" x2="15" y1="21" y2="15"></line>
</svg>
<span>æœç´¢</span>
</a>
</li>
<li>
<a href="/friends/">
<svg class="icon icon-tabler icon-tabler-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path>
<path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path>
</svg>
<span>å‹é“¾</span>
</a>
</li>
<li>
<a href="https://blog.imyangty.com" target="_blank">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»åšå®¢</span>
</a>
</li>
<div class="menu-bottom-section">
<li id="dark-mode-toggle">
<svg class="icon icon-tabler icon-tabler-toggle-left" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="8" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="16" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<span>æš—è‰²æ¨¡å¼</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class="has-image main-article">
<header class="article-header">
<div class="article-image">
<a href="/note-connectivity/">
<img alt="Featured image of post å›¾çš„è¿é€šæ€§ç›¸å…³" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg11.webp"/>
</a>
</div>
<div class="article-details">
<header class="article-category">
<a href="/categories/oi/">
                OI
            </a>
<a href="/categories/note/">
                ç¬”è®°
            </a>
</header>
<div class="article-title-wrapper">
<h2 class="article-title">
<a href="/note-connectivity/">å›¾çš„è¿é€šæ€§ç›¸å…³</a>
</h2>
</div>
<footer class="article-time">
<div>
<svg class="icon icon-tabler icon-tabler-calendar-time" fill="none" height="56" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="56" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4"></path>
<circle cx="18" cy="18" r="4"></circle>
<path d="M15 3v4"></path>
<path d="M7 3v4"></path>
<path d="M3 11h16"></path>
<path d="M18 16.496v1.504l1 1"></path>
</svg>
<time class="article-time--published">Sep 01, 2021</time>
</div>
<div>
<svg class="icon icon-tabler icon-tabler-clock" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<polyline points="12 7 12 12 15 15"></polyline>
</svg>
<time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 5 åˆ†é’Ÿ
                </time>
</div>
</footer>
</div>
</header>
<section class="article-content">
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ä¸€ç›´å¯¹è¿™æ–¹é¢ä¸æ˜¯å¾ˆç†è§£ï¼Œå¼€ä¸ªå‘è®°å½•ä¸€ä¸‹ã€‚</p>
<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>
<p>å¯¹äºæœ‰å‘å›¾ï¼š</p>
<ul>
<li>å¼ºè¿é€šï¼šå¯¹äºä¸€å¼ æœ‰å‘å›¾ï¼Œè‹¥æ¯ä¸ªç‚¹äº’ç›¸å¯è¾¾ï¼Œåˆ™ç§°ä¸ºå¼ºè¿é€šã€‚</li>
<li>å¼ºè¿é€šåˆ†é‡ï¼šæå¤§çš„å¼ºè¿é€šå­å›¾ã€‚</li>
</ul>
<p>å¯¹äºæ— å‘å›¾ï¼š</p>
<ul>
<li>ç‚¹å‰²é›†ï¼šè‹¥åˆ æ‰è¯¥é›†åˆçš„ç‚¹åå›¾ä¸è¿é€šï¼Œåˆ™ç§°ä¸ºç‚¹å‰²é›†ã€‚<strong>å¤§å°ä¸º <span class="math inline">\(1\)</span> çš„ç‚¹å‰²é›†å°±æ˜¯å‰²ç‚¹</strong>ã€‚</li>
<li>ç‚¹è”é€šåº¦ï¼šè‹¥ <span class="math inline">\(k + 1\le |V|\)</span> ä¸”ä¸å­˜åœ¨å¤§å°ä¸º <span class="math inline">\(k - 1\)</span> çš„ç‚¹å‰²é›†ï¼Œåˆ™ç§°è¯¥å›¾ <span class="math inline">\(k-\)</span> ç‚¹è”é€šã€‚æœ€å¤§çš„ <span class="math inline">\(k\)</span>ï¼Œå³æœ€å°ç‚¹å‰²é›†åˆçš„å¤§å°ã€‚</li>
<li>è¾¹å‰²é›†/è¾¹è”é€šåº¦ï¼šç±»ä¼¼ã€‚</li>
<li>ç‚¹åŒè¿é€šï¼šæ²¡æœ‰å‰²ç‚¹çš„è¿é€šå›¾æ˜¯ç‚¹åŒè¿é€šçš„ã€‚</li>
<li>è¾¹åŒè¿é€šï¼šæ²¡æœ‰æ¡¥çš„è¿é€šå›¾æ˜¯è¾¹åŒè¿é€šçš„ã€‚</li>
<li>ç‚¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„ç‚¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°ç‚¹åŒï¼‰ã€‚</li>
<li>è¾¹åŒè¿é€šåˆ†é‡ï¼šæå¤§çš„è¾¹åŒè¿é€šå­å›¾ï¼ˆç®€ç§°è¾¹åŒï¼‰ã€‚</li>
</ul>
<h2 id="å¼ºè¿é€šåˆ†é‡scc">å¼ºè¿é€šåˆ†é‡ï¼ˆSCCï¼‰</h2>
<p>ä½¿ç”¨ tarjan ç®—æ³•åšåˆ° <span class="math inline">\(O(n + m)\)</span>ã€‚</p>
<h3 id="dfs-ç”Ÿæˆæ ‘">dfs ç”Ÿæˆæ ‘</h3>
<p>tarjan ç®—æ³•æ˜¯åŸºäº dfs çš„ã€‚è€ƒè™‘åœ¨åŸå›¾ä¸Šç”Ÿæˆä¸€æ£µ dfs ç”Ÿæˆæ ‘ã€‚</p>
<p>é‚£ä¹ˆåŸå›¾çš„è¾¹å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š</p>
<ul>
<li>æ ‘è¾¹ï¼šå°±æ˜¯åœ¨ dfs ç”Ÿæˆæ ‘çš„è¾¹ï¼Œå½“ä¸€ä¸ªç‚¹æœç´ æ‰¾åˆ°ä¸€ä¸ªæ²¡æœ‰è®¿é—®çš„ç‚¹æ—¶ç”Ÿæˆã€‚</li>
<li>è¿”ç¥–è¾¹ï¼šæŒ‡å‘ç¥–å…ˆèŠ‚ç‚¹çš„è¾¹ã€‚</li>
<li>æ¨ªå‰è¾¹ï¼šæœç´¢æ—¶é‡åˆ°çš„<strong>è®¿é—®è¿‡çš„ä½†æ˜¯ä¸æ˜¯è‡ªå·±ç¥–å…ˆ</strong>çš„ç‚¹ã€‚</li>
<li>å‰å‘è¾¹ï¼šæœç´¢æ—¶é‡åˆ°å­æ ‘èŠ‚ç‚¹æ—¶çš„è¾¹ã€‚</li>
</ul>
<p>æœ‰å¦‚ä¸‹å¼•ç†ï¼šå‡è®¾ <span class="math inline">\(u\)</span> æ˜¯æŸä¸ª SCC åœ¨ dfs ç”Ÿæˆæ ‘ä¸­ç¬¬ä¸€ä¸ªé‡åˆ°çš„ç‚¹ï¼Œåˆ™ SCC å‰©ä½™çš„ç‚¹è‚¯å®šåœ¨å­æ ‘å†…ï¼Œ<span class="math inline">\(u\)</span> ç§°ä¸º SCC çš„æ ¹ã€‚è¯æ˜å¯ç”¨åè¯æ³•ï¼Œä¸å†å±•å¼€ã€‚</p>
<h3 id="tarjan-ç®—æ³•">Tarjan ç®—æ³•</h3>
<p>æ„é€  dfs ç”Ÿæˆæ ‘çš„åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œè¡¨ç¤ºè®¿é—®è¿‡çš„è¿˜æœªåŠ å…¥ SCC çš„ç‚¹ã€‚</p>
<p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ <span class="math inline">\(\operatorname{dfn}(u)\)</span> å’Œ <span class="math inline">\(\operatorname{low}(u)\)</span>ã€‚å«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li><span class="math inline">\(\operatorname{dfn}(u)\)</span> æ—¶é—´æˆ³ã€‚</li>
<li><span class="math inline">\(\operatorname{low}(u)\)</span>ï¼š<span class="math inline">\(u\)</span> æˆ–å…¶å­æ ‘å†…èŠ‚ç‚¹èƒ½å›æº¯åˆ°çš„<strong>æœ€æ—©çš„è¿˜åœ¨æ ˆä¸­çš„èŠ‚ç‚¹çš„ <span class="math inline">\(\operatorname{dfn}\)</span></strong>ã€‚</li>
</ul>
<p>æ ¹æ®ä»¥ä¸‹å®šä¹‰ï¼Œæœ‰</p>
<pre><code>low[u] = min {
    dfn[u],
    low[v], (u, v) ä¸ºæ ‘è¾¹ï¼Œv ä¸º u å„¿å­
    dfn[v], (u, v) ä¸ºæŒ‡å‘æ ˆä¸­èŠ‚ç‚¹çš„éæ¨ªå‰è¾¹
}</code></pre>
<p>å‘ç°ä¸€ä¸ª SCC ä¸­åªå­˜åœ¨ä¸€ä¸ª <span class="math inline">\(u\)</span> ä½¿å¾— <span class="math inline">\(\operatorname{dfn}(u) = \operatorname{low}(u)\)</span>ï¼Œå›æº¯çš„è¿‡ç¨‹ä¸­åˆ¤å®šï¼Œæ ˆä¸­ <span class="math inline">\(u\)</span> å¾€åçš„èŠ‚ç‚¹æ„æˆ SCCã€‚</p>
<h3 id="å®ç°">å®ç°</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1"></a><span class="dt">int</span> dfn[maxn], low[maxn], ins[maxn], stk[maxn], top;</span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2"></a><span class="dt">int</span> dfnClock, scc[maxn], sccCnt;</span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3"></a></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4"></a><span class="dt">void</span> tarjan(<span class="dt">int</span> u) {</span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5"></a>    dfn[u] = low[u] = ++dfnClock;</span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6"></a>    stk[++top] = u, ins[u] = <span class="dv">1</span>;</span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7"></a>    GO(u, head) {</span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8"></a>        <span class="cf">if</span> (!e[i].w) <span class="cf">continue</span>;</span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9"></a>        <span class="cf">if</span> (!dfn[v])</span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10"></a>            tarjan(v), low[u] = min(low[u], low[v]);</span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11"></a>        <span class="cf">else</span> <span class="cf">if</span> (ins[v])</span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12"></a>            low[u] = min(low[u], dfn[v]);</span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13"></a>    }</span>
<span id="cb2-14"><a aria-hidden="true" href="#cb2-14"></a>    <span class="cf">if</span> (low[u] == dfn[u]) {</span>
<span id="cb2-15"><a aria-hidden="true" href="#cb2-15"></a>        ++sccCnt;</span>
<span id="cb2-16"><a aria-hidden="true" href="#cb2-16"></a>        <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb2-17"><a aria-hidden="true" href="#cb2-17"></a>            <span class="dt">int</span> now = stk[top--];</span>
<span id="cb2-18"><a aria-hidden="true" href="#cb2-18"></a>            ins[now] = <span class="dv">0</span>;</span>
<span id="cb2-19"><a aria-hidden="true" href="#cb2-19"></a>            scc[now] = sccCnt;</span>
<span id="cb2-20"><a aria-hidden="true" href="#cb2-20"></a>            <span class="cf">if</span> (now == u) <span class="cf">break</span>;</span>
<span id="cb2-21"><a aria-hidden="true" href="#cb2-21"></a>        }</span>
<span id="cb2-22"><a aria-hidden="true" href="#cb2-22"></a>    }</span>
<span id="cb2-23"><a aria-hidden="true" href="#cb2-23"></a>    <span class="cf">return</span>;</span>
<span id="cb2-24"><a aria-hidden="true" href="#cb2-24"></a>}</span></code></pre></div>
<h3 id="åº”ç”¨">åº”ç”¨</h3>
<p>å¯ä»¥å°†ä¸€äº›äº’ç›¸å¯è¾¾çš„ç‚¹ç¼©åœ¨ä¸€èµ·ï¼Œä¸€å¼ å›¾ç¼©å®Œåä¼šå˜æˆä¸€å¼  DAGï¼Œæ–¹ä¾¿è¿›è¡Œ dpã€‚</p>
<h2 id="åŒè¿é€šåˆ†é‡bcc">åŒè¿é€šåˆ†é‡ï¼ˆBCCï¼‰</h2>
<p>å¯¹äºæ— å‘å›¾è€Œè¨€çš„ã€‚</p>
<ul>
<li>ç‚¹åŒè¿é€š<strong>ä¸å…·æœ‰</strong>ä¼ é€’æ€§ï¼Œå³ <span class="math inline">\(A\)</span> ä¸ <span class="math inline">\(B\)</span> ç‚¹åŒè¿é€šã€<span class="math inline">\(B\)</span> ä¸ <span class="math inline">\(C\)</span> ç‚¹åŒè¿é€šå¹¶ä¸èƒ½æ¨å‡º <span class="math inline">\(A\)</span> ä¸ <span class="math inline">\(C\)</span> ç‚¹åŒè¿é€šï¼ˆè€ƒè™‘ <span class="math inline">\(B\)</span> ä¸ºå‰²ç‚¹çš„æƒ…å†µï¼‰</li>
<li>ç›¸ååœ°ï¼Œè¾¹åŒè¿é€š<strong>å…·æœ‰</strong>ä¼ é€’æ€§ã€‚</li>
</ul>
<h3 id="è¾¹åŒè¿é€šåˆ†é‡e-bcc">è¾¹åŒè¿é€šåˆ†é‡ï¼ˆe-BCCï¼‰</h3>
<p><span class="math inline">\(\operatorname{dfn}\)</span> å’Œ <span class="math inline">\(\operatorname{low}\)</span> çš„å®šä¹‰ä¸ä¸Šé¢çš„ç±»ä¼¼ã€‚</p>
<p>åˆ™å¯¹äº dfs æ ‘ä¸Šçš„ä¸€æ¡è¾¹ <span class="math inline">\((u, v)\)</span>ï¼Œå…¶ä¼šæ˜¯å‰²è¾¹å½“ä¸”ä»…å½“ <span class="math display">\[
\operatorname{dfn}(u) &lt; \operatorname{low}(v)
\]</span> æ„ä¹‰ä¸ºï¼Œä»å­æ ‘ <span class="math inline">\(v\)</span> å‡ºå‘ï¼Œ åœ¨ä¸ç»è¿‡ <span class="math inline">\((u, v)\)</span> çš„å‰æä¸‹æ— æ³•èµ°åˆ°æ¯” <span class="math inline">\(x\)</span> æ›´æ—©è®¿é—®çš„èŠ‚ç‚¹ã€‚è¿™æ¡è¾¹ <span class="math inline">\((u, v)\)</span> æ˜¾ç„¶å°±åº”è¯¥æ˜¯æ¡¥ã€‚</p>
<p>ç¼©ç‚¹ä¹Ÿä¸è¯´äº†ï¼Œå¥½ç¼©çš„ã€‚å‰²è¾¹ä¼šç¼©æˆè‹¥å¹²ä¸ª e-BCCï¼Œ<strong>æœ€åçš„ç»“æœæ˜¯ä¸€æ£µæ ‘/æ£®æ—</strong>ï¼ˆå› ä¸ºä¸èƒ½æœ‰ç¯ï¼‰ï¼Œ<strong>ä¸€ä¸ªç‚¹ä»…ä¼šå±äºä¸€ä¸ª e-BCCï¼Œæ¡¥ä¸å±äºä»»ä½• e-BCC</strong>ã€‚</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1"></a><span class="dt">void</span> tarjan(<span class="dt">int</span> u, <span class="dt">int</span> last) {<span class="co">//last ä¸ºä¸Šä¸€æ¡è¾¹çš„ç¼–å·ï¼Œåˆ¤çˆ¶äº²ç”¨</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2"></a>    dfn[u] = low[u] = ++dfnClock;</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = head[u]; i; i = nxt[i]) {</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4"></a>        <span class="dt">int</span> v = to[i];</span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5"></a>        <span class="cf">if</span> (!dfn[v]) {</span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6"></a>            tarjan(v, i);</span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7"></a>            <span class="cf">if</span> (low[v] &gt; dfn[u])</span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8"></a>                bridge[i] = bridge[i ^ <span class="dv">1</span>] = <span class="dv">1</span>;<span class="co">//è¿™é‡Œæ˜¯æ ‡è®°æ¡¥</span></span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9"></a>            low[u] = min(low[u], low[v]);</span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10"></a>        }</span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11"></a>        <span class="cf">else</span> <span class="cf">if</span> (i != (last ^ <span class="dv">1</span>))<span class="co">//æ³¨æ„åˆ¤ä¸€ä¸‹æ˜¯ä¸æ˜¯ dfs æ ‘ä¸Šçš„çˆ¶äº²</span></span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12"></a>            low[u] = min(low[u], dfn[v]);</span>
<span id="cb3-13"><a aria-hidden="true" href="#cb3-13"></a>    }</span>
<span id="cb3-14"><a aria-hidden="true" href="#cb3-14"></a>    <span class="cf">return</span>;</span>
<span id="cb3-15"><a aria-hidden="true" href="#cb3-15"></a>}</span></code></pre></div>
<p>ç»å…¸é¢˜ï¼šé—®æœ€å¤šæ·»åŠ å¤šå°‘æ¡è¾¹å¯ä»¥ä½¿å¾—å›¾è¾¹åŒè¿é€šã€‚ç­”æ¡ˆä¸ºç¼©å®Œç‚¹ä¹‹åçš„å¶å­ä¸ªæ•°é™¤ä»¥äºŒå‘ä¸Šå–æ•´ã€‚æ„é€ çš„è¯è€ƒè™‘æ¯æ¬¡è¿ä¸¤ä¸ªå¶å­èµ·æ¥å°±å¯ä»¥å½¢æˆä¸€ä¸ªç¯ï¼Œç¯ä¸Šçš„éƒ½ä¼šè¢«æ¶ˆæ‰ã€‚</p>
<h3 id="ç‚¹åŒè¿é€šåˆ†é‡v-bcc">ç‚¹åŒè¿é€šåˆ†é‡ï¼ˆv-BCCï¼‰</h3>
<p>å®šä¹‰ä¾æ—§ç±»ä¼¼ã€‚åˆ¤æ–­ä¸€ä¸ªç‚¹ <span class="math inline">\(u\)</span> æ˜¯å¦ä¸ºå‰²ç‚¹çš„æ–¹æ³•ï¼š</p>
<ul>
<li>è‹¥ <span class="math inline">\(u\)</span> ä¸º dfs æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œåˆ™å…¶åªè¦æœ‰å¤šäºä¸€ä¸ªå­æ ‘ï¼Œå…¶å°±æ˜¯å‰²ç‚¹ã€‚ï¼ˆè€ƒè™‘å»æ‰æ ¹ä¹‹åä¸¤ä¸ªå­æ ‘ä¸è¿é€šï¼‰</li>
<li>å¦åˆ™ï¼Œè€ƒè™‘ <span class="math inline">\(v\)</span> ä¸º <span class="math inline">\(u\)</span> çš„å­èŠ‚ç‚¹ï¼Œåˆ™ <span class="math inline">\(u\)</span> ä¸ºå‰²ç‚¹å½“ä¸”ä»…å½“ <span class="math inline">\(\operatorname{dfn}(u)\le \operatorname{low}(v)\)</span>ã€‚å³ï¼Œ<span class="math inline">\(v\)</span> å­æ ‘å†…çš„ç‚¹åªèƒ½æœ€å¤šå›åˆ° <span class="math inline">\(u\)</span>ï¼Œä¸èƒ½å†å¾€ä¸Šã€‚</li>
</ul>
<p>æ±‚å‰²ç‚¹çš„ä»£ç ï¼š</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1"></a><span class="dt">void</span> tarjan(<span class="dt">int</span> u) {</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2"></a>    dfn[u] = low[u] = ++cnt;</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3"></a>    <span class="cf">for</span> (<span class="kw">auto</span> v : G[u]) {</span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4"></a>        <span class="cf">if</span> (!dfn[v]) {</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5"></a>            tarjan(v);</span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6"></a>            low[u] = min(low[u], low[v]);</span>
<span id="cb4-7"><a aria-hidden="true" href="#cb4-7"></a>            <span class="cf">if</span> (low[v] &gt;= dfn[u] &amp;&amp; u != root) {</span>
<span id="cb4-8"><a aria-hidden="true" href="#cb4-8"></a>                ans += (!cut[u]);</span>
<span id="cb4-9"><a aria-hidden="true" href="#cb4-9"></a>                cut[u] = <span class="dv">1</span>;</span>
<span id="cb4-10"><a aria-hidden="true" href="#cb4-10"></a>            }</span>
<span id="cb4-11"><a aria-hidden="true" href="#cb4-11"></a>            child += (u == root);</span>
<span id="cb4-12"><a aria-hidden="true" href="#cb4-12"></a>        }</span>
<span id="cb4-13"><a aria-hidden="true" href="#cb4-13"></a>        low[u] = min(low[u], dfn[v]);</span>
<span id="cb4-14"><a aria-hidden="true" href="#cb4-14"></a>    }</span>
<span id="cb4-15"><a aria-hidden="true" href="#cb4-15"></a>    <span class="cf">if</span> (u == root &amp;&amp; child &gt; <span class="dv">1</span>)</span>
<span id="cb4-16"><a aria-hidden="true" href="#cb4-16"></a>        ans++, cut[u] = <span class="dv">1</span>;</span>
<span id="cb4-17"><a aria-hidden="true" href="#cb4-17"></a>}</span></code></pre></div>
<p>ç¼©ç‚¹ç”šä¹ˆçš„ç›´æ¥å»çœ‹åé¢åœ†æ–¹æ ‘å§ã€‚</p>
<h2 id="sat">2-SAT</h2>
<p>å’•ã€‚</p>
<h2 id="åœ†æ–¹æ ‘">åœ†æ–¹æ ‘</h2>
<p>æ¯’ç˜¤æ•°æ®ç»“æ„ã€‚</p>
<h3 id="å¼•å…¥">å¼•å…¥</h3>
<p>ç›´æ¥è®²å¹¿ä¹‰åœ†æ–¹æ ‘å§ã€‚</p>
<p>å®šä¹‰ï¼š<strong>ä»»æ„ä¸€æ¡è¾¹è‡³å¤šåªå‡ºç°åœ¨ä¸€æ¡ç®€å•å›è·¯çš„æ— å‘è¿é€šå›¾ç§°ä¸ºä»™äººæŒ</strong>ã€‚ä»€ä¹ˆæ„æ€ï¼Ÿå°±æ˜¯ä¸€æ¡è¾¹åªèƒ½å‡ºç°åœ¨è‡³å¤šä¸€ä¸ªç¯é‡Œé¢ã€‚è¿™æ ·çš„å›¾é•¿å¾—å°±å¾ˆåƒä»™äººæŒï¼Œæ‰€ä»¥å°±å«åšä»™äººæŒã€‚</p>
<p>æœ€åˆçš„ç‹­ä¹‰åœ†æ–¹æ ‘ä¸€èˆ¬æ‹¿æ¥å¤„ç†ä»™äººæŒä¸Šçš„é—®é¢˜ï¼Œä½†æ˜¯å¹¿ä¹‰åœ†æ–¹æ ‘è¿˜å¯ä»¥å¤„ç†æ— å‘å›¾ä¸Šçš„é—®é¢˜ã€‚å…¶å¯ä»¥å°†ä¸€äº›ä¸€èˆ¬æ— å‘å›¾ä¸Šä¸å¥½åšçš„äº‹æƒ…è½¬åŒ–åˆ°æ ‘ä¸Šï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æ ‘å‰–/LCT/ç‚¹åˆ†ä¹‹ç±»çš„æ–¹æ³•å»ç»´æŠ¤ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰ä¸å­˜åœ¨å‰²ç‚¹çš„å›¾ä¸ºç‚¹åŒè¿é€šå›¾ã€‚åœ¨åœ†æ–¹æ ‘ä¸Šï¼Œæ¯ä¸ªç‚¹åŒè¿é€šåˆ†é‡ï¼ˆä»¥åç®€ç§°ç‚¹åŒï¼‰å¯¹åº”ä¸€ä¸ªæ–¹ç‚¹ï¼ŒåŸæ¥çš„æ¯ä¸ªç‚¹å¯¹åº”åœ†æ–¹æ ‘ä¸Šä¸€ä¸ªåœ†ç‚¹ã€‚å°±åƒè¿™æ ·ï¼ˆå›¾æº WC è¯¾ä»¶ï¼‰ï¼š</p>
<p><img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/blockforest.png"/></p>
<p>ä¸‹é¢æ˜¯åœ†æ–¹æ ‘çš„ä¸€äº›æ€§è´¨ï¼š</p>
<ul>
<li>è®¾ç‚¹åŒæœ‰ <span class="math inline">\(c\)</span> ä¸ªï¼Œåˆ™åœ†æ–¹æ ‘æœ‰ <span class="math inline">\(n + c\)</span> ä¸ªç‚¹ã€‚æ‰€ä»¥<strong>è¦å¼€äºŒå€ç©ºé—´</strong>ã€‚</li>
<li>ä¸€ä¸ªæ¡è¾¹è¿æ¥äº†ä¸€ä¸ªæ–¹ç‚¹å’Œä¸€ä¸ªåœ†ç‚¹ã€‚</li>
<li>è‹¥åŸå›¾ä¸è¿é€šï¼Œåˆ™ä¼šå½¢æˆè‹¥å¹²åœ†æ–¹æ£®æ—ã€‚</li>
<li>åŸå›¾ä¸­ä¸æ˜¯å‰²ç‚¹çš„ç‚¹éƒ½æ˜¯å¶å­ï¼Œä¸€ä¸ªå‰²ç‚¹ä¼šè¿æ¥è‹¥å¹²ä¸ªæ–¹ç‚¹ã€‚</li>
</ul>
<h3 id="æ„å»º">æ„å»º</h3>
<p>è¿™é‡Œçš„æ„å»ºç”¨çš„ tarjan ç®—æ³•å’Œä¸€èˆ¬çš„æ±‚ v-BCC çš„ä¸å¤ªä¸€æ ·ã€‚</p>
<ul>
<li><span class="math inline">\(\operatorname{dfn}(u)\)</span>ï¼š<span class="math inline">\(u\)</span> çš„ dfs åºï¼Œå’Œæ™®é€š tarjan ç›¸åŒã€‚</li>
<li><span class="math inline">\(\operatorname{low}(u)\)</span>ï¼š<span class="math inline">\(u\)</span> çš„å­æ ‘ä¸­çš„æŸä¸ªèŠ‚ç‚¹é€šè¿‡<strong>è‡³å¤šä¸€æ¬¡è¿”ç¥–è¾¹</strong>æˆ–<strong>å‘çˆ¶äº²çš„æ ‘è¾¹</strong>èƒ½è®¿é—®åˆ°çš„ç‚¹çš„æœ€å° dfs åºã€‚</li>
</ul>
<p>åƒä¸‹é¢è¿™å¼ å›¾ï¼ˆå›¾æºå°ç²‰å…”çš„<a href="https://www.cnblogs.com/PinkRabbit/p/Introduction-to-Block-Forest.html">åšå®¢</a>ï¼‰ï¼š</p>
<p><img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/blockforest2.png"/></p>
<p>æ³¨æ„ <span class="math inline">\(9\)</span> çš„ <span class="math inline">\(\mathrm{low}\)</span> æ˜¯ <span class="math inline">\(7\)</span>ï¼Œå› ä¸ºè§„å®šäº†å‘çˆ¶äº²çš„æ ‘è¾¹ä¹Ÿå¯ä»¥ã€‚</p>
<p>å¯¹äº <span class="math inline">\((u, v)\)</span>ï¼Œå‘ç°å¦‚æœ <span class="math inline">\(\operatorname{low}(v) = \operatorname{dfn}(u)\)</span>ï¼Œåˆ™è¯´æ˜ <span class="math inline">\(v\)</span> å­æ ‘å†…çš„ç‚¹æ„æˆä¸€ä¸ªç‚¹åŒï¼Œå°†æ ˆå†…é™¤äº† <span class="math inline">\(u\)</span> çš„ç‚¹é€€æ ˆï¼Œé¡ºä¾¿ä¸æ–°å»ºçš„æ–¹ç‚¹è¿è¾¹ã€‚å½“ç„¶ <span class="math inline">\(u\)</span> ä¹Ÿè¦ä¸æ–¹ç‚¹è¿è¾¹ï¼Œä½†æ˜¯ä¸é€€æ ˆã€‚</p>
<p>ä¸‹é¢æ”¾ä¸€ä¸ªæ„å»ºåœ†æ–¹æ ‘çš„ä»£ç ã€‚</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1"></a><span class="dt">void</span> tarjan(<span class="dt">int</span> u) {</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2"></a>    dfn[u] = low[u] = ++dfnClock;</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3"></a>    stk[++top] = u;</span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = head0[u]; i; i = e0[i].nxt) {</span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5"></a>        <span class="dt">int</span> &amp;v = e0[i].to;</span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6"></a>        <span class="cf">if</span> (!dfn[v]) {=</span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7"></a>            tarjan(v, u);</span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8"></a>            low[u] = min(low[u], low[v]);</span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9"></a>            <span class="cf">if</span> (low[v] == dfn[u]) {</span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10"></a>                ++fang;</span>
<span id="cb5-11"><a aria-hidden="true" href="#cb5-11"></a>                <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb5-12"><a aria-hidden="true" href="#cb5-12"></a>                    <span class="dt">int</span> x = stk[top--];</span>
<span id="cb5-13"><a aria-hidden="true" href="#cb5-13"></a>                    add(fang, x), add(x, fang);</span>
<span id="cb5-14"><a aria-hidden="true" href="#cb5-14"></a>                    <span class="cf">if</span> (x == v) <span class="cf">break</span>;</span>
<span id="cb5-15"><a aria-hidden="true" href="#cb5-15"></a>                }</span>
<span id="cb5-16"><a aria-hidden="true" href="#cb5-16"></a>                add(fang, u), add(u, fang);</span>
<span id="cb5-17"><a aria-hidden="true" href="#cb5-17"></a>            }</span>
<span id="cb5-18"><a aria-hidden="true" href="#cb5-18"></a>        } <span class="cf">else</span> low[u] = min(low[u], dfn[v]);</span>
<span id="cb5-19"><a aria-hidden="true" href="#cb5-19"></a>    }</span>
<span id="cb5-20"><a aria-hidden="true" href="#cb5-20"></a>    <span class="cf">return</span>;</span>
<span id="cb5-21"><a aria-hidden="true" href="#cb5-21"></a>}</span></code></pre></div>
<h3 id="åº”ç”¨-1">åº”ç”¨</h3>
<h4 id="p5236-æ¨¡æ¿é™æ€ä»™äººæŒ">P5236 ã€æ¨¡æ¿ã€‘é™æ€ä»™äººæŒ</h4>
<p><a href="https://www.luogu.com.cn/problem/P5236">ä¼ é€é—¨</a>ã€‚å¤§æ„ï¼šç»™å®šä¸€æ£µä»™äººæŒï¼Œå¤šæ¬¡è¯¢é—®ä¸¤ç‚¹é—´æœ€çŸ­è·¯ã€‚</p>
<p>å¤šæ¬¡è¯¢é—®æœ€çŸ­è·¯ä¸æ˜¯å¾ˆå¥½æï¼Œä½†æ˜¯ä»™äººæŒä¸€æ¡è¾¹æœ€å¤šåœ¨ä¸€ä¸ªç¯ä¸Šçš„æ€§è´¨å¯è¿ªæˆ‘ä»¬å¯ä»¥æŠŠç¯ç¼©èµ·æ¥å¤„ç†ã€‚è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥æ±‚æ ‘ä¸Šæœ€çŸ­è·¯äº†ã€‚</p>
<p>å¦‚ä½•å»ºç«‹ï¼Ÿæˆ‘ä»¬è€ƒè™‘å»ºå‡ºåœ†æ–¹æ ‘ï¼Œç„¶åç»™æ¯æ¡è¾¹å®šæƒå€¼ï¼Œè¿™æ ·å­å°±å¯ä»¥åœ¨æ ‘ä¸Šæ±‚æœ€çŸ­è·¯äº†ï¼Œæ±‚ LCA å³å¯ï¼Œå¯æ˜¯ï¼Œæ€ä¹ˆç»™åœ†æ–¹æ ‘çš„è¾¹å®šæƒï¼Ÿ</p>
<p>æˆ‘ä»¬ä»¤ä¸€ä¸ªç¯ä¸Š dfn æœ€å°çš„ç‚¹ä¸ºè¿™ä¸ªç¯çš„æ ¹ï¼Œåˆ™è¿™ä¸ªç¯çš„æ–¹ç‚¹åˆ°è¿™äº›ç¯ä¸Šçš„åœ†ç‚¹çš„è¾¹æƒå³ä¸ºè¯¥ç‚¹åˆ°æ ¹çš„æœ€çŸ­è·¯ã€‚å¯¹äºåªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹çš„æƒ…å†µï¼Œç±»ä¼¼ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ±‚å‡ºç¯é•¿ï¼Œç”±äºä»™äººæŒçš„ç‰¹æ€§ï¼Œä¸€ä¸ªç‚¹åŒåªæœ‰ä¸€æ¡è¿”ç¥–è¾¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ ˆé¡¶çš„ç‚¹æ‰¾åˆ°å°±å¯ä»¥ç®—äº†ã€‚</p>
<p>ç„¶åç®—æœ€çŸ­è·¯çš„æ—¶å€™ï¼Œå¦‚æœä¸¤ç‚¹çš„ LCA æ˜¯åœ†ç‚¹ï¼Œå°±ç›´æ¥æ— è„‘ç®—å°±è¡Œäº†ï¼Œä½†æ˜¯å¦‚æœæ˜¯æ–¹ç‚¹åˆ™éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ï¼Œ çœ‹è¿™ä¸¤ä¸ªç‚¹åœ¨ç¯ä¸Šçš„æœ€çŸ­è·¯æ˜¯å¤šå°‘ã€‚</p>
<p>å…·ä½“ç»†èŠ‚çœ‹ä»£ç ï¼š</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">2e4</span> + <span class="dv">5</span>, maxm = <span class="fl">4e4</span> + <span class="dv">5</span>;</span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2"></a></span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3"></a><span class="kw">struct</span> edge {</span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4"></a>    <span class="dt">int</span> to, nxt, w;</span>
<span id="cb6-5"><a aria-hidden="true" href="#cb6-5"></a>} e0[maxm], e[maxn &lt;&lt; <span class="dv">1</span>];</span>
<span id="cb6-6"><a aria-hidden="true" href="#cb6-6"></a></span>
<span id="cb6-7"><a aria-hidden="true" href="#cb6-7"></a><span class="dt">int</span> head0[maxn], head[maxn], cnte0, cnte;</span>
<span id="cb6-8"><a aria-hidden="true" href="#cb6-8"></a><span class="dt">int</span> n, m, fang, q;</span>
<span id="cb6-9"><a aria-hidden="true" href="#cb6-9"></a></span>
<span id="cb6-10"><a aria-hidden="true" href="#cb6-10"></a><span class="dt">void</span> add0(<span class="dt">int</span> u, <span class="dt">int</span> v, <span class="dt">int</span> w) {</span>
<span id="cb6-11"><a aria-hidden="true" href="#cb6-11"></a>    e0[++cnte0].to = v;</span>
<span id="cb6-12"><a aria-hidden="true" href="#cb6-12"></a>    e0[cnte0].w = w;</span>
<span id="cb6-13"><a aria-hidden="true" href="#cb6-13"></a>    e0[cnte0].nxt = head0[u];</span>
<span id="cb6-14"><a aria-hidden="true" href="#cb6-14"></a>    head0[u] = cnte0;</span>
<span id="cb6-15"><a aria-hidden="true" href="#cb6-15"></a>    <span class="cf">return</span>;</span>
<span id="cb6-16"><a aria-hidden="true" href="#cb6-16"></a>}</span>
<span id="cb6-17"><a aria-hidden="true" href="#cb6-17"></a></span>
<span id="cb6-18"><a aria-hidden="true" href="#cb6-18"></a><span class="dt">void</span> add(<span class="dt">int</span> u, <span class="dt">int</span> v, <span class="dt">int</span> w) {</span>
<span id="cb6-19"><a aria-hidden="true" href="#cb6-19"></a>    e[++cnte].to = v;</span>
<span id="cb6-20"><a aria-hidden="true" href="#cb6-20"></a>    e[cnte].w = w;</span>
<span id="cb6-21"><a aria-hidden="true" href="#cb6-21"></a>    e[cnte].nxt = head[u];</span>
<span id="cb6-22"><a aria-hidden="true" href="#cb6-22"></a>    head[u] = cnte;</span>
<span id="cb6-23"><a aria-hidden="true" href="#cb6-23"></a>    <span class="cf">return</span>;</span>
<span id="cb6-24"><a aria-hidden="true" href="#cb6-24"></a>}</span>
<span id="cb6-25"><a aria-hidden="true" href="#cb6-25"></a></span>
<span id="cb6-26"><a aria-hidden="true" href="#cb6-26"></a><span class="dt">int</span> dfn[maxn], low[maxn], dfnClock, stk[maxn], top;</span>
<span id="cb6-27"><a aria-hidden="true" href="#cb6-27"></a><span class="dt">int</span> dis0[maxn], val[maxn], r[maxn];</span>
<span id="cb6-28"><a aria-hidden="true" href="#cb6-28"></a></span>
<span id="cb6-29"><a aria-hidden="true" href="#cb6-29"></a><span class="dt">void</span> tarjan(<span class="dt">int</span> u, <span class="dt">int</span> fa) {</span>
<span id="cb6-30"><a aria-hidden="true" href="#cb6-30"></a>    dfn[u] = low[u] = ++dfnClock;</span>
<span id="cb6-31"><a aria-hidden="true" href="#cb6-31"></a>    stk[++top] = u;</span>
<span id="cb6-32"><a aria-hidden="true" href="#cb6-32"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = head0[u]; i; i = e0[i].nxt) {</span>
<span id="cb6-33"><a aria-hidden="true" href="#cb6-33"></a>        <span class="dt">int</span> &amp;v = e0[i].to;</span>
<span id="cb6-34"><a aria-hidden="true" href="#cb6-34"></a>        <span class="cf">if</span> (!dfn[v]) {</span>
<span id="cb6-35"><a aria-hidden="true" href="#cb6-35"></a>            val[v] = e0[i].w;</span>
<span id="cb6-36"><a aria-hidden="true" href="#cb6-36"></a>            dis0[v] = dis0[u] + e0[i].w;</span>
<span id="cb6-37"><a aria-hidden="true" href="#cb6-37"></a>            tarjan(v, u);</span>
<span id="cb6-38"><a aria-hidden="true" href="#cb6-38"></a>            low[u] = min(low[u], low[v]);</span>
<span id="cb6-39"><a aria-hidden="true" href="#cb6-39"></a>            <span class="cf">if</span> (low[v] == dfn[u]) {</span>
<span id="cb6-40"><a aria-hidden="true" href="#cb6-40"></a>                ++fang;</span>
<span id="cb6-41"><a aria-hidden="true" href="#cb6-41"></a>                r[fang] = val[stk[top]] + dis0[stk[top]] - dis0[u];</span>
<span id="cb6-42"><a aria-hidden="true" href="#cb6-42"></a>                <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb6-43"><a aria-hidden="true" href="#cb6-43"></a>                    <span class="dt">int</span> x = stk[top--], tmp = dis0[x] - dis0[u];</span>
<span id="cb6-44"><a aria-hidden="true" href="#cb6-44"></a>                    tmp = min(tmp, r[fang] - tmp);</span>
<span id="cb6-45"><a aria-hidden="true" href="#cb6-45"></a>                    add(fang, x, tmp), add(x, fang, tmp);</span>
<span id="cb6-46"><a aria-hidden="true" href="#cb6-46"></a>                    <span class="cf">if</span> (x == v) <span class="cf">break</span>;</span>
<span id="cb6-47"><a aria-hidden="true" href="#cb6-47"></a>                }</span>
<span id="cb6-48"><a aria-hidden="true" href="#cb6-48"></a>                add(fang, u, <span class="dv">0</span>), add(u, fang, <span class="dv">0</span>);</span>
<span id="cb6-49"><a aria-hidden="true" href="#cb6-49"></a>            }</span>
<span id="cb6-50"><a aria-hidden="true" href="#cb6-50"></a>        } <span class="cf">else</span> {</span>
<span id="cb6-51"><a aria-hidden="true" href="#cb6-51"></a>            low[u] = min(low[u], dfn[v]);</span>
<span id="cb6-52"><a aria-hidden="true" href="#cb6-52"></a>            <span class="cf">if</span> (v != fa &amp;&amp; dfn[v] &lt; dfn[u]) val[u] = e0[i].w;</span>
<span id="cb6-53"><a aria-hidden="true" href="#cb6-53"></a>        }</span>
<span id="cb6-54"><a aria-hidden="true" href="#cb6-54"></a>    }</span>
<span id="cb6-55"><a aria-hidden="true" href="#cb6-55"></a>    <span class="cf">return</span>;</span>
<span id="cb6-56"><a aria-hidden="true" href="#cb6-56"></a>}</span>
<span id="cb6-57"><a aria-hidden="true" href="#cb6-57"></a></span>
<span id="cb6-58"><a aria-hidden="true" href="#cb6-58"></a><span class="dt">int</span> dis[maxn], fa[maxn][<span class="dv">20</span>], dep[maxn];</span>
<span id="cb6-59"><a aria-hidden="true" href="#cb6-59"></a></span>
<span id="cb6-60"><a aria-hidden="true" href="#cb6-60"></a><span class="dt">void</span> dfs(<span class="dt">int</span> u, <span class="dt">int</span> pre) {</span>
<span id="cb6-61"><a aria-hidden="true" href="#cb6-61"></a>    fa[u][<span class="dv">0</span>] = pre;</span>
<span id="cb6-62"><a aria-hidden="true" href="#cb6-62"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; fa[fa[u][i - <span class="dv">1</span>]][i - <span class="dv">1</span>]; ++i) fa[u][i] = fa[fa[u][i - <span class="dv">1</span>]][i - <span class="dv">1</span>];</span>
<span id="cb6-63"><a aria-hidden="true" href="#cb6-63"></a>    </span>
<span id="cb6-64"><a aria-hidden="true" href="#cb6-64"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = head[u]; i; i = e[i].nxt) {</span>
<span id="cb6-65"><a aria-hidden="true" href="#cb6-65"></a>        <span class="dt">int</span> &amp;v = e[i].to;</span>
<span id="cb6-66"><a aria-hidden="true" href="#cb6-66"></a>        <span class="cf">if</span> (v == pre) <span class="cf">continue</span>;</span>
<span id="cb6-67"><a aria-hidden="true" href="#cb6-67"></a>        dis[v] = dis[u] + e[i].w;</span>
<span id="cb6-68"><a aria-hidden="true" href="#cb6-68"></a>        dep[v] = dep[u] + <span class="dv">1</span>;</span>
<span id="cb6-69"><a aria-hidden="true" href="#cb6-69"></a>        dfs(v, u);</span>
<span id="cb6-70"><a aria-hidden="true" href="#cb6-70"></a>    }</span>
<span id="cb6-71"><a aria-hidden="true" href="#cb6-71"></a>    <span class="cf">return</span>;</span>
<span id="cb6-72"><a aria-hidden="true" href="#cb6-72"></a>}</span>
<span id="cb6-73"><a aria-hidden="true" href="#cb6-73"></a></span>
<span id="cb6-74"><a aria-hidden="true" href="#cb6-74"></a><span class="kw">using</span> pii = <span class="bu">std::</span>pair&lt;<span class="dt">int</span>, <span class="dt">int</span>&gt;;</span>
<span id="cb6-75"><a aria-hidden="true" href="#cb6-75"></a></span>
<span id="cb6-76"><a aria-hidden="true" href="#cb6-76"></a>pii LCA(<span class="dt">int</span> u, <span class="dt">int</span> v) {</span>
<span id="cb6-77"><a aria-hidden="true" href="#cb6-77"></a>    <span class="cf">if</span> (dep[u] &lt; dep[v]) <span class="bu">std::</span>swap(u, v);</span>
<span id="cb6-78"><a aria-hidden="true" href="#cb6-78"></a>    <span class="cf">for</span> (<span class="dt">int</span> delta = dep[u] - dep[v], i = <span class="dv">0</span>; delta; delta &gt;&gt;= <span class="dv">1</span>, ++i)</span>
<span id="cb6-79"><a aria-hidden="true" href="#cb6-79"></a>        <span class="cf">if</span> (delta &amp; <span class="dv">1</span>) u = fa[u][i];</span>
<span id="cb6-80"><a aria-hidden="true" href="#cb6-80"></a>    <span class="cf">if</span> (u == v) <span class="cf">return</span> pii(u, -<span class="dv">1</span>);</span>
<span id="cb6-81"><a aria-hidden="true" href="#cb6-81"></a>    DEC(i, <span class="dv">15</span>, <span class="dv">0</span>)</span>
<span id="cb6-82"><a aria-hidden="true" href="#cb6-82"></a>        <span class="cf">if</span> (fa[u][i] != fa[v][i]) u = fa[u][i], v = fa[v][i];</span>
<span id="cb6-83"><a aria-hidden="true" href="#cb6-83"></a>    <span class="cf">if</span> (fa[u][<span class="dv">0</span>] &lt;= n) <span class="cf">return</span> pii(fa[u][<span class="dv">0</span>], -<span class="dv">1</span>);</span>
<span id="cb6-84"><a aria-hidden="true" href="#cb6-84"></a>    <span class="cf">else</span> <span class="cf">return</span> pii(u, v);</span>
<span id="cb6-85"><a aria-hidden="true" href="#cb6-85"></a>}</span>
<span id="cb6-86"><a aria-hidden="true" href="#cb6-86"></a></span>
<span id="cb6-87"><a aria-hidden="true" href="#cb6-87"></a><span class="dt">int</span> main() {</span>
<span id="cb6-88"><a aria-hidden="true" href="#cb6-88"></a>    read(n), read(m), read(q);</span>
<span id="cb6-89"><a aria-hidden="true" href="#cb6-89"></a>    FOR(i, <span class="dv">1</span>, m) {</span>
<span id="cb6-90"><a aria-hidden="true" href="#cb6-90"></a>        <span class="dt">int</span> u, v, w;</span>
<span id="cb6-91"><a aria-hidden="true" href="#cb6-91"></a>        read(u), read(v), read(w);</span>
<span id="cb6-92"><a aria-hidden="true" href="#cb6-92"></a>        add0(u, v, w), add0(v, u, w);</span>
<span id="cb6-93"><a aria-hidden="true" href="#cb6-93"></a>    }</span>
<span id="cb6-94"><a aria-hidden="true" href="#cb6-94"></a>    fang = n, tarjan(<span class="dv">1</span>, <span class="dv">0</span>);</span>
<span id="cb6-95"><a aria-hidden="true" href="#cb6-95"></a>    dfs(<span class="dv">1</span>, <span class="dv">0</span>);</span>
<span id="cb6-96"><a aria-hidden="true" href="#cb6-96"></a>    <span class="cf">while</span> (q--) {</span>
<span id="cb6-97"><a aria-hidden="true" href="#cb6-97"></a>        <span class="dt">int</span> u, v; read(u), read(v);</span>
<span id="cb6-98"><a aria-hidden="true" href="#cb6-98"></a>        <span class="kw">auto</span> p = LCA(u, v);</span>
<span id="cb6-99"><a aria-hidden="true" href="#cb6-99"></a>        <span class="cf">if</span> (~p.second)  {</span>
<span id="cb6-100"><a aria-hidden="true" href="#cb6-100"></a>            <span class="dt">int</span> tmp = myabs(dis0[p.first] - dis0[p.second]);</span>
<span id="cb6-101"><a aria-hidden="true" href="#cb6-101"></a>            tmp = min(tmp, r[fa[p.first][<span class="dv">0</span>]] - tmp);</span>
<span id="cb6-102"><a aria-hidden="true" href="#cb6-102"></a>            print(dis[u] + dis[v] - dis[p.first] - dis[p.second] + tmp, <span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span>);</span>
<span id="cb6-103"><a aria-hidden="true" href="#cb6-103"></a>        } <span class="cf">else</span> print(dis[u] + dis[v] - <span class="dv">2</span> * dis[p.first], <span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span>);</span>
<span id="cb6-104"><a aria-hidden="true" href="#cb6-104"></a>    }</span>
<span id="cb6-105"><a aria-hidden="true" href="#cb6-105"></a>    <span class="cf">return</span> output(), <span class="dv">0</span>;</span>
<span id="cb6-106"><a aria-hidden="true" href="#cb6-106"></a>}</span></code></pre></div>
<h4 id="p5058-zjoi2004å—…æ¢å™¨">P5058 [ZJOI2004]å—…æ¢å™¨</h4>
<p><a href="https://www.luogu.com.cn/problem/P5058">ä¼ é€é—¨</a>ã€‚å»ºå‡ºåœ†æ–¹æ ‘ï¼Œæ‰¾ä¸¤ä¸ªç‚¹ä¸­é—´çš„åœ†ç‚¹å³å¯ï¼Œå…¶ä¸€å®šæ˜¯å‰²ç‚¹ã€‚</p>
<h4 id="p4320-é“è·¯ç›¸é‡">P4320 é“è·¯ç›¸é‡</h4>
<p><a href="https://www.luogu.com.cn/problem/P4320">ä¼ é€é—¨</a>ã€‚è¿™ä¸ªç›¸å½“äºå°±æ˜¯æ±‚åœ†æ–¹æ ‘ä¸¤ç‚¹é—´åœ†ç‚¹çš„ä¸ªæ•°ï¼Œæ ‘å‰–ç»´æŠ¤ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
</section>
<footer class="article-footer">
<section class="article-tags">
<a href="/tags/OI/">OI</a>
<a href="/tags/note/">ç¬”è®°</a>
<a href="/tags/shrink/">ç¼©ç‚¹</a>
</section>
<section class="article-copyright">
<svg class="icon icon-tabler icon-tabler-copyright" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M14.5 9a3.5 4 0 1 0 0 6"></path>
</svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js">
</script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
</article>
<aside class="related-contents--wrapper">
<h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
<div class="related-contents">
<div class="flex article-list--tile">
<article class="has-image">
<a href="/note-gf/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">ç”Ÿæˆå‡½æ•°èƒ¡æ‰¯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-set-power-series/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg39.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">é›†åˆå¹‚çº§æ•°èƒ¡æ‰¯</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-linear-basis/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">çº¿æ€§åŸºå­¦ä¹ ç¬”è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-wqs/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg28.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">wqs äºŒåˆ†å­¦ä¹ ç¬”è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/note-builtin/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg9.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">__builtin ç³»åˆ—å‡½æ•°æ€»ç»“</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class="site-footer">
<section class="copyright">
        Â© 
        
            2019 - 
        
        2024 æ¸…çƒ›çš„åšå®¢
    </section>
<section class="powerby">
        Built with <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a> <br/>
        ä¸»é¢˜ <b><a data-version="3.11.0" href="https://github.com/CaiJimmy/hugo-theme-stack" rel="noopener" target="_blank">Stack</a></b> ç”± <a href="https://jimmycai.com" rel="noopener" target="_blank">Jimmy</a> è®¾è®¡
    </section>
</footer>
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">
<div class="pswp__bg"></div>
<div class="pswp__scroll-wrap">
<div class="pswp__container">
<div class="pswp__item"></div>
<div class="pswp__item"></div>
<div class="pswp__item"></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class="pswp__top-bar">
<div class="pswp__counter"></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class="pswp__preloader">
<div class="pswp__preloader__icn">
<div class="pswp__preloader__cut">
<div class="pswp__preloader__donut"></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class="pswp__share-tooltip"></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class="pswp__caption">
<div class="pswp__caption__center"></div>
</div>
</div>
</div>
</div><script crossorigin="anonymous" defer="" integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js">
</script><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" rel="stylesheet"/><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" rel="stylesheet"/>
</main>
</div>
<script crossorigin="anonymous" integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js">
</script><script defer="" src="/ts/main.js" type="text/javascript"></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
</body>
</html>

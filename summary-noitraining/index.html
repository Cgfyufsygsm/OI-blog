<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/><meta content="å‰è¨€ èœæ­»äº†ã€‚
XJOI D16 A ç»„åˆ é¢˜æ„ï¼šå¯¹äº \(|a|\le 1\)ï¼Œ\(T\le 5000\) æ¬¡è¯¢é—® \[ \sum_{k=r}^n(-1)^k\binom nk^a\binom kr \] å¯¹è´¨æ•° \(p\) å–æ¨¡çš„ç»“æœï¼Œ\(0&amp;lt;r\le 5000, r\le n\le 8\times 10^8\)ï¼Œä¸” \(9\times 10^8\le p\le 10^9 + 7\)ã€‚
é¦–å…ˆå¯¹äº \(a = 1\) çš„æƒ…å†µï¼ŒåŒ–ç®€å¼å­ï¼š \[ \begin{aligned} &amp;amp;\sum_{k=r}^n(-1)^k\binom nk\binom kr\\ =&amp;amp;(-1)^r\binom nr\sum_{k=r}^n(-1)^{k-r}\binom{n-r}{k-r}\\ =&amp;amp;(-1)^r\binom nr\sum_{k=0}^{n-r}(-1)^k\binom{n-r}{k}\\ =&amp;amp;(-1)^r\binom nr[n=r] \end{aligned} \] ç„¶åå°±æœ‰äº† 10ptsã€‚
å¯¹äº \(a = 0\) çš„æƒ…å†µï¼š \[ \begin{aligned} &amp;amp;\sum_{k=r}^n(-1)^k\binom{k}{r}\\ =&amp;amp;\frac{1}{r!}\sum_{k=r}^n(-1)^kk^{\underline r}\\ \end{aligned} \] \(a=-1\) çš„æƒ…å†µï¼šå¤ªéš¾äº†ï¼Œä¸ä¼šã€‚
B äºšç™» \(n\) ä¸ªç‚¹çš„æ ‘ï¼Œ\(m\) ç§é­”æ³•ã€‚ç¬¬ \(i\) ç§é­”æ³• \((a_i, d_i)\) ä¼šä½¿å¾—åˆ° \(a_i\) çš„è·ç¦» \(\le d_i\) çš„è¿é€šå—å†…ç‚¹æƒ \(+1\)ã€‚ä¸€å¼€å§‹é€‰æ‹©ä¸€ä¸ªæ•´æ•° \(t\le [0,m]\)ï¼Œç„¶åé€‰æ‹© \(t\) ç§é­”æ³•ä¾æ¬¡æ–½æ³•ï¼Œä»¤ç‚¹æƒæ°å¥½ä¸º \(t\) çš„ç‚¹æœ‰ \(k\) ä¸ªï¼Œè®¾ \(f_x\) è¡¨ç¤ºé€‰æ‹©æ–½æ³•æ–¹å¼ä½¿å¾— \(k=x\) çš„æ–¹æ¡ˆæ•°ï¼Œå¯¹ \(x\in[0,R]\) æ±‚ \(f_x\bmod 998244353\)ã€‚" name="description"/><title>NOI èµ›å‰è®­ç»ƒæ€»ç»“</title>
<link href="https://oi.imyangty.com/summary-noitraining/" rel="canonical"/>
<link href="/scss/style.min.a5821f3d3ab84ce5a0ac21477e347a2e0ca00292e398d16c5e8e36ded6e35a23.css" rel="stylesheet"/><meta content="NOI èµ›å‰è®­ç»ƒæ€»ç»“" property="og:title"/>
<meta content="å‰è¨€ èœæ­»äº†ã€‚
XJOI D16 A ç»„åˆ é¢˜æ„ï¼šå¯¹äº \(|a|\le 1\)ï¼Œ\(T\le 5000\) æ¬¡è¯¢é—® \[ \sum_{k=r}^n(-1)^k\binom nk^a\binom kr \] å¯¹è´¨æ•° \(p\) å–æ¨¡çš„ç»“æœï¼Œ\(0&amp;lt;r\le 5000, r\le n\le 8\times 10^8\)ï¼Œä¸” \(9\times 10^8\le p\le 10^9 + 7\)ã€‚
é¦–å…ˆå¯¹äº \(a = 1\) çš„æƒ…å†µï¼ŒåŒ–ç®€å¼å­ï¼š \[ \begin{aligned} &amp;amp;\sum_{k=r}^n(-1)^k\binom nk\binom kr\\ =&amp;amp;(-1)^r\binom nr\sum_{k=r}^n(-1)^{k-r}\binom{n-r}{k-r}\\ =&amp;amp;(-1)^r\binom nr\sum_{k=0}^{n-r}(-1)^k\binom{n-r}{k}\\ =&amp;amp;(-1)^r\binom nr[n=r] \end{aligned} \] ç„¶åå°±æœ‰äº† 10ptsã€‚
å¯¹äº \(a = 0\) çš„æƒ…å†µï¼š \[ \begin{aligned} &amp;amp;\sum_{k=r}^n(-1)^k\binom{k}{r}\\ =&amp;amp;\frac{1}{r!}\sum_{k=r}^n(-1)^kk^{\underline r}\\ \end{aligned} \] \(a=-1\) çš„æƒ…å†µï¼šå¤ªéš¾äº†ï¼Œä¸ä¼šã€‚
B äºšç™» \(n\) ä¸ªç‚¹çš„æ ‘ï¼Œ\(m\) ç§é­”æ³•ã€‚ç¬¬ \(i\) ç§é­”æ³• \((a_i, d_i)\) ä¼šä½¿å¾—åˆ° \(a_i\) çš„è·ç¦» \(\le d_i\) çš„è¿é€šå—å†…ç‚¹æƒ \(+1\)ã€‚ä¸€å¼€å§‹é€‰æ‹©ä¸€ä¸ªæ•´æ•° \(t\le [0,m]\)ï¼Œç„¶åé€‰æ‹© \(t\) ç§é­”æ³•ä¾æ¬¡æ–½æ³•ï¼Œä»¤ç‚¹æƒæ°å¥½ä¸º \(t\) çš„ç‚¹æœ‰ \(k\) ä¸ªï¼Œè®¾ \(f_x\) è¡¨ç¤ºé€‰æ‹©æ–½æ³•æ–¹å¼ä½¿å¾— \(k=x\) çš„æ–¹æ¡ˆæ•°ï¼Œå¯¹ \(x\in[0,R]\) æ±‚ \(f_x\bmod 998244353\)ã€‚" property="og:description"/>
<meta content="https://oi.imyangty.com/summary-noitraining/" property="og:url"/>
<meta content="æ¸…çƒ›çš„åšå®¢" property="og:site_name"/>
<meta content="article" property="og:type"/><meta content="Post" property="article:section"/><meta content="OI" property="article:tag"/><meta content="2022-06-13T08:15:49+08:00" property="article:published_time"/><meta content="2022-06-13T08:15:49+08:00" property="article:modified_time"/><meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg29.webp" property="og:image"/>
<meta content="NOI èµ›å‰è®­ç»ƒæ€»ç»“" name="twitter:title"/>
<meta content="å‰è¨€ èœæ­»äº†ã€‚
XJOI D16 A ç»„åˆ é¢˜æ„ï¼šå¯¹äº \(|a|\le 1\)ï¼Œ\(T\le 5000\) æ¬¡è¯¢é—® \[ \sum_{k=r}^n(-1)^k\binom nk^a\binom kr \] å¯¹è´¨æ•° \(p\) å–æ¨¡çš„ç»“æœï¼Œ\(0&amp;lt;r\le 5000, r\le n\le 8\times 10^8\)ï¼Œä¸” \(9\times 10^8\le p\le 10^9 + 7\)ã€‚
é¦–å…ˆå¯¹äº \(a = 1\) çš„æƒ…å†µï¼ŒåŒ–ç®€å¼å­ï¼š \[ \begin{aligned} &amp;amp;\sum_{k=r}^n(-1)^k\binom nk\binom kr\\ =&amp;amp;(-1)^r\binom nr\sum_{k=r}^n(-1)^{k-r}\binom{n-r}{k-r}\\ =&amp;amp;(-1)^r\binom nr\sum_{k=0}^{n-r}(-1)^k\binom{n-r}{k}\\ =&amp;amp;(-1)^r\binom nr[n=r] \end{aligned} \] ç„¶åå°±æœ‰äº† 10ptsã€‚
å¯¹äº \(a = 0\) çš„æƒ…å†µï¼š \[ \begin{aligned} &amp;amp;\sum_{k=r}^n(-1)^k\binom{k}{r}\\ =&amp;amp;\frac{1}{r!}\sum_{k=r}^n(-1)^kk^{\underline r}\\ \end{aligned} \] \(a=-1\) çš„æƒ…å†µï¼šå¤ªéš¾äº†ï¼Œä¸ä¼šã€‚
B äºšç™» \(n\) ä¸ªç‚¹çš„æ ‘ï¼Œ\(m\) ç§é­”æ³•ã€‚ç¬¬ \(i\) ç§é­”æ³• \((a_i, d_i)\) ä¼šä½¿å¾—åˆ° \(a_i\) çš„è·ç¦» \(\le d_i\) çš„è¿é€šå—å†…ç‚¹æƒ \(+1\)ã€‚ä¸€å¼€å§‹é€‰æ‹©ä¸€ä¸ªæ•´æ•° \(t\le [0,m]\)ï¼Œç„¶åé€‰æ‹© \(t\) ç§é­”æ³•ä¾æ¬¡æ–½æ³•ï¼Œä»¤ç‚¹æƒæ°å¥½ä¸º \(t\) çš„ç‚¹æœ‰ \(k\) ä¸ªï¼Œè®¾ \(f_x\) è¡¨ç¤ºé€‰æ‹©æ–½æ³•æ–¹å¼ä½¿å¾— \(k=x\) çš„æ–¹æ¡ˆæ•°ï¼Œå¯¹ \(x\in[0,R]\) æ±‚ \(f_x\bmod 998244353\)ã€‚" name="twitter:description"/><meta content="summary_large_image" name="twitter:card"/>
<meta content="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg29.webp" name="twitter:image"/>
<link href="https://q1.qlogo.cn/g?b=qq&amp;nk=375836877&amp;s=5" rel="shortcut icon"/>
<link href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/github-dark-dimmed.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="article-page">
<script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
<button aria-label="åˆ‡æ¢èœå•" class="hamburger hamburger--spin" id="toggle-menu" type="button">
<span class="hamburger-box">
<span class="hamburger-inner"></span>
</span>
</button>
<header>
<figure class="site-avatar">
<a href="/">
<img alt="Avatar" class="site-logo" height="300" loading="lazy" src="/img/avatar_huea3ce2119467b51fdd2a81393644a76d_51594_300x0_resize_q75_box.jpg" width="300"/>
</a>
<span class="emoji">ğŸ˜…</span>
</figure>
<div class="site-meta">
<h1 class="site-name"><a href="/">æ¸…çƒ›çš„åšå®¢</a></h1>
<h2 class="site-description">çƒŸç«å·²è°¢ï¼Œç¬™æ­Œæœªåœ</h2>
</div>
</header><ol class="social-menu">
<li>
<a href="mailto:i@imyangty.com" target="_blank" title="email">
<svg class="icon icon-tabler icon-tabler-mail" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<rect height="14" rx="2" width="18" x="3" y="5"></rect>
<polyline points="3 7 12 13 21 7"></polyline>
</svg>
</a>
</li>
<li>
<a href="https://github.com/Cgfyufsygsm" target="_blank" title="GitHub">
<svg class="icon icon-tabler icon-tabler-brand-github" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
</a>
</li>
<li>
<a href="https://t.me/Cgfyufsygsm" target="_blank" title="Telegram">
<svg class="icon icon-tabler icon-tabler-brand-telegram" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"></path>
</svg>
</a>
</li>
<li>
<a href="https://twitter.com/Cgfyufsygsm" target="_blank" title="Twitter">
<svg class="icon icon-tabler icon-tabler-brand-twitter" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
</svg>
</a>
</li>
</ol><ol class="menu" id="main-menu">
<li>
<a href="/">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»é¡µ</span>
</a>
</li>
<li>
<a href="/about/">
<svg class="icon icon-tabler icon-tabler-user" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="7" r="4"></circle>
<path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
</svg>
<span>å…³äº</span>
</a>
</li>
<li>
<a href="/idx/">
<svg class="icon icon-tabler icon-tabler-hash" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<line x1="5" x2="19" y1="9" y2="9"></line>
<line x1="5" x2="19" y1="15" y2="15"></line>
<line x1="11" x2="7" y1="4" y2="20"></line>
<line x1="17" x2="13" y1="4" y2="20"></line>
</svg>
<span>å¯¼èˆª</span>
</a>
</li>
<li>
<a href="/archives/">
<svg class="icon icon-tabler icon-tabler-archive" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<rect height="4" rx="2" width="18" x="3" y="4"></rect>
<path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10"></path>
<line x1="10" x2="14" y1="12" y2="12"></line>
</svg>
<span>å½’æ¡£</span>
</a>
</li>
<li>
<a href="/search/">
<svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="10" cy="10" r="7"></circle>
<line x1="21" x2="15" y1="21" y2="15"></line>
</svg>
<span>æœç´¢</span>
</a>
</li>
<li>
<a href="/friends/">
<svg class="icon icon-tabler icon-tabler-link" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path>
<path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path>
</svg>
<span>å‹é“¾</span>
</a>
</li>
<li>
<a href="https://blog.imyangty.com" target="_blank">
<svg class="icon icon-tabler icon-tabler-home" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<polyline points="5 12 3 12 12 3 21 12 19 12"></polyline>
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
</svg>
<span>ä¸»åšå®¢</span>
</a>
</li>
<div class="menu-bottom-section">
<li id="dark-mode-toggle">
<svg class="icon icon-tabler icon-tabler-toggle-left" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="8" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="16" cy="12" r="2"></circle>
<rect height="12" rx="6" width="20" x="2" y="6"></rect>
</svg>
<span>æš—è‰²æ¨¡å¼</span>
</li>
</div>
</ol>
</aside>
<main class="main full-width">
<article class="has-image main-article">
<header class="article-header">
<div class="article-image">
<a href="/summary-noitraining/">
<img alt="Featured image of post NOI èµ›å‰è®­ç»ƒæ€»ç»“" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg29.webp"/>
</a>
</div>
<div class="article-details">
<header class="article-category">
<a href="/categories/oi/">
                OI
            </a>
<a href="/categories/summary/">
                æ€»ç»“
            </a>
</header>
<div class="article-title-wrapper">
<h2 class="article-title">
<a href="/summary-noitraining/">NOI èµ›å‰è®­ç»ƒæ€»ç»“</a>
</h2>
</div>
<footer class="article-time">
<div>
<svg class="icon icon-tabler icon-tabler-calendar-time" fill="none" height="56" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="56" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4"></path>
<circle cx="18" cy="18" r="4"></circle>
<path d="M15 3v4"></path>
<path d="M7 3v4"></path>
<path d="M3 11h16"></path>
<path d="M18 16.496v1.504l1 1"></path>
</svg>
<time class="article-time--published">Jun 13, 2022</time>
</div>
<div>
<svg class="icon icon-tabler icon-tabler-clock" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<polyline points="12 7 12 12 15 15"></polyline>
</svg>
<time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 17 åˆ†é’Ÿ
                </time>
</div>
</footer>
</div>
</header>
<section class="article-content">
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>èœæ­»äº†ã€‚</p>
<h2 id="xjoi-d16">XJOI D16</h2>
<h3 id="a-ç»„åˆ">A ç»„åˆ</h3>
<p>é¢˜æ„ï¼šå¯¹äº <span class="math inline">\(|a|\le 1\)</span>ï¼Œ<span class="math inline">\(T\le 5000\)</span> æ¬¡è¯¢é—® <span class="math display">\[
\sum_{k=r}^n(-1)^k\binom nk^a\binom kr
\]</span> å¯¹è´¨æ•° <span class="math inline">\(p\)</span> å–æ¨¡çš„ç»“æœï¼Œ<span class="math inline">\(0&lt;r\le 5000, r\le n\le 8\times 10^8\)</span>ï¼Œä¸” <span class="math inline">\(9\times 10^8\le p\le 10^9 + 7\)</span>ã€‚</p>
<p>é¦–å…ˆå¯¹äº <span class="math inline">\(a = 1\)</span> çš„æƒ…å†µï¼ŒåŒ–ç®€å¼å­ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{k=r}^n(-1)^k\binom nk\binom kr\\
=&amp;(-1)^r\binom nr\sum_{k=r}^n(-1)^{k-r}\binom{n-r}{k-r}\\
=&amp;(-1)^r\binom nr\sum_{k=0}^{n-r}(-1)^k\binom{n-r}{k}\\
=&amp;(-1)^r\binom nr[n=r]
\end{aligned}
\]</span> <del>ç„¶åå°±æœ‰äº† 10pts</del>ã€‚</p>
<p>å¯¹äº <span class="math inline">\(a = 0\)</span> çš„æƒ…å†µï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{k=r}^n(-1)^k\binom{k}{r}\\
=&amp;\frac{1}{r!}\sum_{k=r}^n(-1)^kk^{\underline r}\\
\end{aligned}
\]</span> <span class="math inline">\(a=-1\)</span> çš„æƒ…å†µï¼šå¤ªéš¾äº†ï¼Œä¸ä¼šã€‚</p>
<h3 id="b-äºšç™»">B äºšç™»</h3>
<p><span class="math inline">\(n\)</span> ä¸ªç‚¹çš„æ ‘ï¼Œ<span class="math inline">\(m\)</span> ç§é­”æ³•ã€‚ç¬¬ <span class="math inline">\(i\)</span> ç§é­”æ³• <span class="math inline">\((a_i, d_i)\)</span> ä¼šä½¿å¾—åˆ° <span class="math inline">\(a_i\)</span> çš„è·ç¦» <span class="math inline">\(\le d_i\)</span> çš„è¿é€šå—å†…ç‚¹æƒ <span class="math inline">\(+1\)</span>ã€‚ä¸€å¼€å§‹é€‰æ‹©ä¸€ä¸ªæ•´æ•° <span class="math inline">\(t\le [0,m]\)</span>ï¼Œç„¶åé€‰æ‹© <span class="math inline">\(t\)</span> ç§é­”æ³•ä¾æ¬¡æ–½æ³•ï¼Œä»¤ç‚¹æƒæ°å¥½ä¸º <span class="math inline">\(t\)</span> çš„ç‚¹æœ‰ <span class="math inline">\(k\)</span> ä¸ªï¼Œè®¾ <span class="math inline">\(f_x\)</span> è¡¨ç¤ºé€‰æ‹©æ–½æ³•æ–¹å¼ä½¿å¾— <span class="math inline">\(k=x\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå¯¹ <span class="math inline">\(x\in[0,R]\)</span> æ±‚ <span class="math inline">\(f_x\bmod 998244353\)</span>ã€‚</p>
<h4 id="b.part1">B.part1</h4>
<p><span class="math inline">\(n,m\le 500, R\le n\)</span>ã€‚è®¾ <span class="math inline">\(S(u,d)\)</span> è¡¨ç¤ºåˆ° <span class="math inline">\(u\)</span> çš„è·ç¦» <span class="math inline">\(\le d\)</span> çš„ç‚¹é›†ï¼Œ</p>
<h3 id="c-æ—…è¡Œå®¶">C æ—…è¡Œå®¶</h3>
<p>ç»™å®š <span class="math inline">\(a,b\)</span> æ•°ç»„ã€‚ä¸€æ£µæ ‘ï¼Œæ ¹ä¸º <span class="math inline">\(1\)</span>ã€‚å¯¹ <span class="math inline">\(s\in[1, n]\)</span>ï¼Œå¯¹äº <span class="math inline">\(1\to s\)</span> é“¾ä¸Šçš„æ‰€æœ‰ç‚¹ï¼Œè®¾å…¶åˆ° <span class="math inline">\(s\)</span> çš„è·ç¦»ä¸º <span class="math inline">\(t\)</span>ï¼Œå¯¹ <span class="math inline">\(|a_u - b_t|^2\)</span> æ±‚å’Œã€‚<span class="math inline">\(1\le n\le 5\times 10^5\)</span>ï¼Œ<span class="math inline">\(0\le a_i,b_i&lt;16\)</span>ã€‚</p>
<p>å¯¹äºé“¾çš„æƒ…å†µï¼Œæ‹†å¼€å¯å¾—åˆ° <span class="math inline">\(a_u^2 + b_t^2 - 2a_ub_t\)</span>ï¼Œ<span class="math inline">\(a_u^2\)</span> å’Œ <span class="math inline">\(b_t^2\)</span> å¾ˆå¥½æ±‚å’Œï¼Œä¸»è¦é—®é¢˜åœ¨äº <span class="math inline">\(a_ub_t\)</span>ã€‚å‘ç°å¯ä»¥ NTTã€‚</p>
<p>è€Œæ ‘ä¸Šä¸ä¼šå¼±äºé“¾ï¼Œæ‰€ä»¥è€ƒè™‘è¿›è¡Œé“¾å‰–åˆ†ã€‚å¯¹äºæ ‘æ ¹å¼•ä¸‹æ¥çš„é“¾ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—ä¸Šé¢æ¯ä¸ªç‚¹çš„ç­”æ¡ˆï¼Œä½†æ˜¯å¯¹äºå…¶ä»–çš„é“¾ï¼ˆé•¿ä¸º <span class="math inline">\(l\)</span>ï¼‰ï¼Œç”±äºé“¾é¡¶ä¸Šé¢æœ‰ç‚¹ï¼Œæ‰€ä»¥è¦åšä¸€ä¸ªé•¿ <span class="math inline">\(l\)</span> çš„æ•°ç»„å’Œé•¿ <span class="math inline">\(n\)</span> çš„æ•°ç»„çš„å·ç§¯ã€‚ä½†æ˜¯é“¾ä¸Šé¢çš„éƒ¨åˆ†å·²ç»è¢«è®¡ç®—è¿‡äº†ï¼Œæ‰€ä»¥å¯¹äºå½“å‰é“¾æ·±åº¦ä¸º <span class="math inline">\(d\)</span> çš„ç‚¹å¯ä»¥å¤ç”¨ä¸Šä¸€æ¡é“¾æ·±åº¦ä¸º <span class="math inline">\(d\)</span> çš„ç­”æ¡ˆï¼Œç„¶åå†å¤„ç†å¤šå·çš„éƒ¨åˆ†ï¼ˆå‡æ‰ï¼‰ã€‚</p>
<p>è¯¦è§ä»£ç ã€‚</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1"></a><span class="kw">using</span> polynomial::Poly;</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2"></a></span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3"></a><span class="kw">using</span> fastIO::is;</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4"></a><span class="kw">using</span> fastIO::os;</span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">5e5</span> + <span class="dv">5</span>;</span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6"></a><span class="dt">int</span> a[maxn], b[maxn], a2[maxn], b2[maxn], fa[maxn], n;</span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7"></a><span class="dt">int</span> dep[maxn], son[maxn], h[maxn], *arr[maxn], ans[maxn];</span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8"></a>vector&lt;<span class="dt">int</span>&gt; G[maxn];</span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9"></a></span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10"></a><span class="dt">void</span> dfs1(<span class="dt">int</span> u) {</span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11"></a>    <span class="cf">for</span> (<span class="dt">int</span> &amp;v : G[u]) {</span>
<span id="cb1-12"><a aria-hidden="true" href="#cb1-12"></a>        dep[v] = dep[u] + <span class="dv">1</span>;</span>
<span id="cb1-13"><a aria-hidden="true" href="#cb1-13"></a>        dfs1(v);</span>
<span id="cb1-14"><a aria-hidden="true" href="#cb1-14"></a>        <span class="cf">if</span> (h[v] &gt;= h[son[u]])</span>
<span id="cb1-15"><a aria-hidden="true" href="#cb1-15"></a>            son[u] = v, h[u] = h[son[u]] + <span class="dv">1</span>;</span>
<span id="cb1-16"><a aria-hidden="true" href="#cb1-16"></a>    }</span>
<span id="cb1-17"><a aria-hidden="true" href="#cb1-17"></a>    <span class="cf">return</span>;</span>
<span id="cb1-18"><a aria-hidden="true" href="#cb1-18"></a>}</span>
<span id="cb1-19"><a aria-hidden="true" href="#cb1-19"></a></span>
<span id="cb1-20"><a aria-hidden="true" href="#cb1-20"></a><span class="dt">void</span> dfs2(<span class="dt">int</span> u) {</span>
<span id="cb1-21"><a aria-hidden="true" href="#cb1-21"></a>    vector&lt;<span class="dt">int</span>&gt; stk;</span>
<span id="cb1-22"><a aria-hidden="true" href="#cb1-22"></a>    <span class="cf">for</span> (<span class="dt">int</span> x = u; x; x = son[x]) stk.emplace_back(x);</span>
<span id="cb1-23"><a aria-hidden="true" href="#cb1-23"></a>    Poly f(szof(stk)), g(szof(stk));</span>
<span id="cb1-24"><a aria-hidden="true" href="#cb1-24"></a>    FOR(i, <span class="dv">0</span>, szof(stk) - <span class="dv">1</span>) f[i] = a[stk[i]], g[i] = b[i];</span>
<span id="cb1-25"><a aria-hidden="true" href="#cb1-25"></a>    f = f * g;</span>
<span id="cb1-26"><a aria-hidden="true" href="#cb1-26"></a>    FOR(i, <span class="dv">0</span>, szof(stk) - <span class="dv">1</span>) arr[u][i] += f[i];</span>
<span id="cb1-27"><a aria-hidden="true" href="#cb1-27"></a>    FOR(i, <span class="dv">0</span>, szof(stk) - <span class="dv">1</span>) ans[stk[i]] = arr[u][i];</span>
<span id="cb1-28"><a aria-hidden="true" href="#cb1-28"></a>    FOR(i, <span class="dv">0</span>, szof(stk) - <span class="dv">1</span>) {</span>
<span id="cb1-29"><a aria-hidden="true" href="#cb1-29"></a>        <span class="dt">int</span> x = stk[i], d = i + <span class="dv">1</span>;</span>
<span id="cb1-30"><a aria-hidden="true" href="#cb1-30"></a>        <span class="cf">for</span> (<span class="kw">auto</span> &amp;v : G[x]) <span class="cf">if</span> (v != son[x]) {</span>
<span id="cb1-31"><a aria-hidden="true" href="#cb1-31"></a>            arr[v] = <span class="kw">new</span> <span class="dt">int</span>[h[v] + <span class="dv">1</span>];</span>
<span id="cb1-32"><a aria-hidden="true" href="#cb1-32"></a>            FOR(j, <span class="dv">0</span>, h[v]) arr[v][j] = arr[u][j + d];</span>
<span id="cb1-33"><a aria-hidden="true" href="#cb1-33"></a>            Poly A(h[v] + <span class="dv">1</span>), B(h[v] + <span class="dv">1</span>);</span>
<span id="cb1-34"><a aria-hidden="true" href="#cb1-34"></a>            FOR(j, <span class="dv">0</span>, h[v]) A[j] = a[stk[j + d]];</span>
<span id="cb1-35"><a aria-hidden="true" href="#cb1-35"></a>            FOR(j, <span class="dv">0</span>, h[v]) B[j] = b[j];</span>
<span id="cb1-36"><a aria-hidden="true" href="#cb1-36"></a>            A = A * B;</span>
<span id="cb1-37"><a aria-hidden="true" href="#cb1-37"></a>            FOR(j, <span class="dv">0</span>, h[v]) arr[v][j] -= A[j];</span>
<span id="cb1-38"><a aria-hidden="true" href="#cb1-38"></a>            dfs2(v);</span>
<span id="cb1-39"><a aria-hidden="true" href="#cb1-39"></a>        }</span>
<span id="cb1-40"><a aria-hidden="true" href="#cb1-40"></a>    }</span>
<span id="cb1-41"><a aria-hidden="true" href="#cb1-41"></a>    <span class="cf">return</span>;</span>
<span id="cb1-42"><a aria-hidden="true" href="#cb1-42"></a>}</span>
<span id="cb1-43"><a aria-hidden="true" href="#cb1-43"></a></span>
<span id="cb1-44"><a aria-hidden="true" href="#cb1-44"></a><span class="dt">int</span> main() {</span>
<span id="cb1-45"><a aria-hidden="true" href="#cb1-45"></a>    fileIn(<span class="st">"tourist.in"</span>);</span>
<span id="cb1-46"><a aria-hidden="true" href="#cb1-46"></a>    fileOut(<span class="st">"tourist.out"</span>);</span>
<span id="cb1-47"><a aria-hidden="true" href="#cb1-47"></a>    is &gt;&gt; n;</span>
<span id="cb1-48"><a aria-hidden="true" href="#cb1-48"></a>    FOR(i, <span class="dv">2</span>, n) is &gt;&gt; fa[i], G[fa[i]].emplace_back(i);</span>
<span id="cb1-49"><a aria-hidden="true" href="#cb1-49"></a>    FOR(i, <span class="dv">1</span>, n) is &gt;&gt; a[i], a2[i] = a[i] * a[i];</span>
<span id="cb1-50"><a aria-hidden="true" href="#cb1-50"></a>    FOR(i, <span class="dv">0</span>, n - <span class="dv">1</span>) is &gt;&gt; b[i], b2[i] = b[i] * b[i];</span>
<span id="cb1-51"><a aria-hidden="true" href="#cb1-51"></a>    FOR(i, <span class="dv">1</span>, n) a2[i] += a2[fa[i]], b2[i] += b2[i - <span class="dv">1</span>];</span>
<span id="cb1-52"><a aria-hidden="true" href="#cb1-52"></a>    dfs1(<span class="dv">1</span>);</span>
<span id="cb1-53"><a aria-hidden="true" href="#cb1-53"></a>    arr[<span class="dv">1</span>] = <span class="kw">new</span> <span class="dt">int</span>[h[<span class="dv">1</span>] + <span class="dv">1</span>];</span>
<span id="cb1-54"><a aria-hidden="true" href="#cb1-54"></a>    FOR(i, <span class="dv">0</span>, h[<span class="dv">1</span>]) arr[<span class="dv">1</span>][i] = <span class="dv">0</span>;</span>
<span id="cb1-55"><a aria-hidden="true" href="#cb1-55"></a>    dfs2(<span class="dv">1</span>);</span>
<span id="cb1-56"><a aria-hidden="true" href="#cb1-56"></a>    FOR(i, <span class="dv">1</span>, n) os &lt;&lt; a2[i] + b2[dep[i]] - <span class="dv">2</span> * ans[i] &lt;&lt; <span class="ch">' '</span>;</span>
<span id="cb1-57"><a aria-hidden="true" href="#cb1-57"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb1-58"><a aria-hidden="true" href="#cb1-58"></a>}</span></code></pre></div>
<h2 id="xjoi-d17">XJOI D17</h2>
<h3 id="a-åŒè‰²ç –">A åŒè‰²ç –</h3>
<p>è®¾ç™½è‰²ä¸º <span class="math inline">\(0\)</span>ï¼Œçº¢è‰²ä¸º <span class="math inline">\(1\)</span>ã€‚</p>
<p>åˆ™é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œä»»æ„ä¸¤ä¸ªå¯¹è¾¹çš„é¢œè‰²ä¸åŒï¼Œæ‰€ä»¥å¯¹äº <span class="math inline">\(H,W\le 10\)</span> çš„ç‚¹å¯ä»¥è€ƒè™‘æšä¸¾ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—çš„é¢œè‰²ï¼Œç„¶åå°±å¯ä»¥ç¡®å®šæ•´ä¸ªçŸ©å½¢ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šåˆ¤ç¯å³å¯ã€‚</p>
<p>ç„¶åè€ƒè™‘åˆ° <span class="math inline">\(n\)</span> ä¸ªé™åˆ¶ç‚¹ï¼Œå®é™…ä¸Š <span class="math inline">\((R, C, D)\)</span> ç­‰ä»·äºé’¦å®š <span class="math inline">\(colorx_R\)</span> å’Œ <span class="math inline">\(colorx_C\)</span> ä¸ºä¸€ä¸ªå€¼ï¼Œå‘ç°çŸ›ç›¾å³æ— è§£ã€‚</p>
<p>å¯¹äºä¸èƒ½æˆç¯çš„é™åˆ¶å³è€ƒè™‘å®šä¹‰ <span class="math inline">\(parityx_i = (colorx_i + i)\bmod 2\)</span>ï¼Œ<span class="math inline">\(parityy_i = (colory_i + i)\bmod 2\)</span>ã€‚åˆ™å½“ <span class="math inline">\(parityx\)</span> å…¨ç›¸åŒçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„åŒè‰²æ®µéƒ½å½¢å¦‚ä¸€ä¸ªä»å·¦åˆ°å³çš„â€œæ³¢æµªâ€ï¼Œä¸å¯èƒ½æˆç¯ã€‚è¯¥ç»“è®ºå¯¹ <span class="math inline">\(parityy\)</span> ç±»ä¼¼ã€‚</p>
<h2 id="xjoi-d18">XJOI D18</h2>
<h3 id="a-æ•°å­¦é¢˜">A æ•°å­¦é¢˜</h3>
<p>é¦–å…ˆé—®é¢˜è½¬åŒ–ä¸ºæ±‚å’Œ <span class="math display">\[
\sum_{i=0}^n\left(\sum_{j=0}^i\binom{i - j + 1}{j}\right)^k = \sum_{i=2}^{n + 2}F_i^k
\]</span> ç”±äº <span class="math inline">\(p\)</span> ä¸ä¸€å®šæ˜¯è´¨æ•°æ‰€ä»¥æ— æ³•ä½¿ç”¨å…¶é€šé¡¹å…¬å¼è¾…åŠ©æ±‚è§£ã€‚ç”±äº <span class="math inline">\(k\)</span> å¾ˆå°æ•…è€ƒè™‘çŸ©é˜µã€‚</p>
<p>ä¸éš¾å‘ç°æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºé½æ¬¡çŸ©é˜µ <span class="math inline">\(\begin{bmatrix}F_{i-1}^k&amp;F_{i-1}^{k-1}F_{i}&amp;F_{i-2}^{k-2}F_i^2&amp;\cdots&amp;F_{i-1}F_i^{k-1}&amp;F_{i}^k&amp;S_i\end{bmatrix}^T\)</span>ï¼Œæ‰‹ç©å‘ç°è½¬ç§»çŸ©é˜µå°±æ˜¯ä¸ªç±»ä¼¼äºæ¨è¾‰ä¸‰è§’çš„ä¸œè¥¿ï¼Œç›´æ¥å¤„ç†åè¿›åˆ¶å¿«é€Ÿå¹‚å¯ä»¥é€šè¿‡ <span class="math inline">\(\lg n\le 10^5\)</span> çš„éƒ¨åˆ†åˆ†ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(k^3\log n\)</span>ã€‚</p>
<p>ä½†æ˜¯ <span class="math inline">\(\log n\)</span> å¾ˆå¤§ï¼Œæ‰€ä»¥è€ƒè™‘åœ¨æ­¤åŸºç¡€ä¸Šä¼˜åŒ–ã€‚å›å¿†æ–æ³¢é‚£å¥‘çš„å¾ªç¯èŠ‚çš„ä¸Šç•Œä¸º <span class="math inline">\(6p\)</span>ï¼Œæšä¸¾è¿™ä¸ªå¾ªç¯èŠ‚å¯ä»¥é€šè¿‡ <span class="math inline">\(\lg n\le 10^7,p\le 10^4\)</span> çš„éƒ¨åˆ†åˆ†ï¼ŒéšæœºåŒ–æ‰¾å¾ªç¯èŠ‚æ ¹æ®ç”Ÿæ—¥æ‚–è®ºæœ€å¤š <span class="math inline">\(O(\sqrt p)\)</span> æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ <span class="math inline">\(O(\sqrt p + k^3)\log p + \log n\)</span> çš„æ—¶é—´å¤æ‚åº¦è§£å†³æœ¬é¢˜ã€‚</p>
<blockquote>
<p>ä¸è¦å†™å°è£…çš„çŸ©é˜µä¹˜æ³•ï¼Œåå€å¸¸æ•°ã€‚</p>
</blockquote>
<h3 id="b-é’é‡‘çŸ³çš„å›¾ä¹¦é¦†">B é’é‡‘çŸ³çš„å›¾ä¹¦é¦†</h3>
<p>ç»™å®šä¸€æ£µå¸¦ç‚¹æƒå’Œè¾¹æƒçš„æ ‘ <span class="math inline">\(T\)</span>ï¼Œè®¾èŠ‚ç‚¹ <span class="math inline">\(i\)</span> çš„ç‚¹æƒä¸º <span class="math inline">\(a_i\)</span>ï¼Œ<span class="math inline">\(i,j\)</span> é—´çš„æ ‘ä¸Šè·¯å¾„é•¿åº¦ä¸º <span class="math inline">\(dis(i,j)\)</span>ã€‚ç°åœ¨è¦æ ¹æ®è¿™æ£µæ ‘æ„å‡ºä¸€å¼ å®Œå…¨å›¾ <span class="math inline">\(G\)</span>ï¼Œ<span class="math inline">\(G\)</span> ä¸­å¯¹åº”èŠ‚ç‚¹ <span class="math inline">\(i,j\)</span> çš„è¿è¾¹é•¿åº¦ <span class="math inline">\(b(i,j)=\min(a_i,a_j)+dis(i,j)\)</span>ï¼Œæ±‚å›¾ <span class="math inline">\(G\)</span> ä¸­æœ€å°ç”Ÿæˆæ ‘çš„æœ€å¤§è¾¹é•¿åº¦å’Œæœ€å¤§è¾¹å‡ºç°æ¬¡æ•°ã€‚</p>
<p>é¦–å…ˆå¯ä»¥è€ƒè™‘äºŒåˆ†ç­”æ¡ˆä¹‹åè½¬ä¸ºåˆ¤å®šå›¾æ˜¯å¦è”é€šçš„é—®é¢˜ï¼ˆå°† <span class="math inline">\(&gt; mid\)</span> çš„è¾¹åˆ æ‰ï¼‰ã€‚</p>
<p>ç»“è®ºï¼šæ ¹æ®æˆ‘ä»¬å®šä¹‰çš„ä»£ä»·ï¼ŒåŸæ ‘ <span class="math inline">\(T\)</span> æœ€åä¸€å®šä¼šè¢«åˆ’åˆ†æˆè‹¥å¹²æ ‘å½¢è¿é€šå—ã€‚æ‰€ä»¥è‹¥æ˜¯å›¾ä¸è¿é€šï¼Œåˆ™è¯´æ˜å¯¹äºåŸæ ‘ä¸Šçš„æŸä¸€æ¡è¾¹ <span class="math inline">\((u, v)\)</span>ï¼Œä¸¤ä¾§çš„ç‚¹é›†çš„è¿è¾¹çš„æœ€å°å€¼æ˜¯å¤§äº <span class="math inline">\(mid\)</span> çš„ã€‚å°† <span class="math inline">\((i,j,\min(a_i, a_j) + dis(i,j))\)</span> æ‹†è´¡çŒ®å˜æˆ <span class="math inline">\((i,j,a_i)\)</span> å’Œ <span class="math inline">\((j,i,a_j)\)</span> ä¹‹åå¯ä»¥ dp æ¥æ±‚å‡ºè¿™ä¸ªæœ€å°å€¼ã€‚</p>
<p>ç„¶åå‘ç°æ²¡å¿…è¦äºŒåˆ†äº†ï¼Œç›´æ¥æ¢æ ¹ dp å°±è¡Œäº†ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">5e5</span> + <span class="dv">5</span>;</span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2"></a><span class="kw">using</span> ll = <span class="dt">long</span> <span class="dt">long</span>;</span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3"></a><span class="kw">struct</span> Edge {</span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4"></a>    <span class="dt">int</span> to; ll w;</span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5"></a>    Edge(<span class="dt">int</span> _to, ll _w) : to(_to), w(_w) {}</span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6"></a>};</span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7"></a>vector&lt;Edge&gt; G[maxn];</span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8"></a>ll a[maxn], f[maxn], ans;</span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9"></a><span class="dt">int</span> n, cnt;</span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10"></a></span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11"></a><span class="dt">void</span> dfs1(<span class="dt">int</span> u, <span class="dt">int</span> fa) {</span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12"></a>    f[u] = a[u];</span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13"></a>    <span class="cf">for</span> (<span class="kw">auto</span> &amp;e : G[u]) <span class="cf">if</span> (e.to != fa) {</span>
<span id="cb2-14"><a aria-hidden="true" href="#cb2-14"></a>        <span class="dt">int</span> &amp;v = e.to; ll &amp;w = e.w;</span>
<span id="cb2-15"><a aria-hidden="true" href="#cb2-15"></a>        dfs1(v, u);</span>
<span id="cb2-16"><a aria-hidden="true" href="#cb2-16"></a>        chkmin(f[u], f[v] + w);</span>
<span id="cb2-17"><a aria-hidden="true" href="#cb2-17"></a>    }</span>
<span id="cb2-18"><a aria-hidden="true" href="#cb2-18"></a>    <span class="cf">return</span>;</span>
<span id="cb2-19"><a aria-hidden="true" href="#cb2-19"></a>}</span>
<span id="cb2-20"><a aria-hidden="true" href="#cb2-20"></a></span>
<span id="cb2-21"><a aria-hidden="true" href="#cb2-21"></a><span class="dt">void</span> dfs2(<span class="dt">int</span> u, <span class="dt">int</span> fa, ll _mv) {</span>
<span id="cb2-22"><a aria-hidden="true" href="#cb2-22"></a>    <span class="dt">int</span> mx = u;</span>
<span id="cb2-23"><a aria-hidden="true" href="#cb2-23"></a>    ll mv = min(a[u], _mv), h = <span class="fl">1e18</span>;</span>
<span id="cb2-24"><a aria-hidden="true" href="#cb2-24"></a>    <span class="cf">for</span> (<span class="kw">auto</span> &amp;e : G[u]) <span class="cf">if</span> (e.to != fa) {</span>
<span id="cb2-25"><a aria-hidden="true" href="#cb2-25"></a>        <span class="dt">int</span> &amp;v = e.to; ll &amp;w = e.w;</span>
<span id="cb2-26"><a aria-hidden="true" href="#cb2-26"></a>        <span class="cf">if</span> (f[v] + w &lt; mv) mx = v, h = mv, mv = f[v] + w;</span>
<span id="cb2-27"><a aria-hidden="true" href="#cb2-27"></a>        <span class="cf">else</span> <span class="cf">if</span> (f[v] + w &lt; h) h = f[v] + w;</span>
<span id="cb2-28"><a aria-hidden="true" href="#cb2-28"></a>    }</span>
<span id="cb2-29"><a aria-hidden="true" href="#cb2-29"></a>    <span class="cf">for</span> (<span class="kw">auto</span> &amp;e : G[u]) <span class="cf">if</span> (e.to != fa) {</span>
<span id="cb2-30"><a aria-hidden="true" href="#cb2-30"></a>        <span class="dt">int</span> &amp;v = e.to; ll &amp;w = e.w;</span>
<span id="cb2-31"><a aria-hidden="true" href="#cb2-31"></a>        ll now = (v == mx ? h : mv);</span>
<span id="cb2-32"><a aria-hidden="true" href="#cb2-32"></a>        ll val = min(now, f[v]) + w;</span>
<span id="cb2-33"><a aria-hidden="true" href="#cb2-33"></a>        <span class="cf">if</span> (val &gt; ans) ans = val, cnt = <span class="dv">1</span>;</span>
<span id="cb2-34"><a aria-hidden="true" href="#cb2-34"></a>        <span class="cf">else</span> <span class="cf">if</span> (val == ans) ++cnt;</span>
<span id="cb2-35"><a aria-hidden="true" href="#cb2-35"></a>        dfs2(v, u, now + w);</span>
<span id="cb2-36"><a aria-hidden="true" href="#cb2-36"></a>    }</span>
<span id="cb2-37"><a aria-hidden="true" href="#cb2-37"></a>    <span class="cf">return</span>;</span>
<span id="cb2-38"><a aria-hidden="true" href="#cb2-38"></a>}</span>
<span id="cb2-39"><a aria-hidden="true" href="#cb2-39"></a></span>
<span id="cb2-40"><a aria-hidden="true" href="#cb2-40"></a><span class="dt">int</span> main() {</span>
<span id="cb2-41"><a aria-hidden="true" href="#cb2-41"></a>    fileIn(<span class="st">"tree.in"</span>);</span>
<span id="cb2-42"><a aria-hidden="true" href="#cb2-42"></a>    fileOut(<span class="st">"tree.out"</span>);</span>
<span id="cb2-43"><a aria-hidden="true" href="#cb2-43"></a>    is &gt;&gt; n;</span>
<span id="cb2-44"><a aria-hidden="true" href="#cb2-44"></a>    FOR(i, <span class="dv">1</span>, n) is &gt;&gt; a[i];</span>
<span id="cb2-45"><a aria-hidden="true" href="#cb2-45"></a>    FOR(i, <span class="dv">2</span>, n) {</span>
<span id="cb2-46"><a aria-hidden="true" href="#cb2-46"></a>        <span class="dt">int</span> u, v, w;</span>
<span id="cb2-47"><a aria-hidden="true" href="#cb2-47"></a>        is &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span>
<span id="cb2-48"><a aria-hidden="true" href="#cb2-48"></a>        G[u].push_back(Edge(v, w));</span>
<span id="cb2-49"><a aria-hidden="true" href="#cb2-49"></a>        G[v].push_back(Edge(u, w));</span>
<span id="cb2-50"><a aria-hidden="true" href="#cb2-50"></a>    }</span>
<span id="cb2-51"><a aria-hidden="true" href="#cb2-51"></a>    dfs1(<span class="dv">1</span>, <span class="dv">0</span>);</span>
<span id="cb2-52"><a aria-hidden="true" href="#cb2-52"></a>    dfs2(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">1e18</span>);</span>
<span id="cb2-53"><a aria-hidden="true" href="#cb2-53"></a>    os &lt;&lt; ans &lt;&lt; <span class="ch">' '</span> &lt;&lt; cnt;</span>
<span id="cb2-54"><a aria-hidden="true" href="#cb2-54"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb2-55"><a aria-hidden="true" href="#cb2-55"></a>}</span></code></pre></div>
<h3 id="c-åºåˆ—è®¡æ•°">C åºåˆ—è®¡æ•°</h3>
<p>ä¸€ä¸ª <span class="math inline">\(n\times m\)</span> çš„ <span class="math inline">\(0-1\)</span> çŸ©é˜µ <span class="math inline">\(C\)</span>ã€‚ç°æƒ³ç”Ÿæˆä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º <span class="math inline">\(n\)</span> å’Œ <span class="math inline">\(m\)</span> ä¸”å€¼åŸŸ <span class="math inline">\([0, k]\)</span> çš„æ•°ç»„ <span class="math inline">\(A\)</span> å’Œ <span class="math inline">\(B\)</span>ã€‚è¦æ±‚ <span class="math inline">\(\forall 1\le i\le n,1\le j\le m\)</span>ï¼Œéƒ½æ»¡è¶³è‹¥ <span class="math inline">\(C_{i,j} = 0\)</span> åˆ™ <span class="math inline">\(A_i + B_j \le k\)</span>ï¼Œè‹¥ <span class="math inline">\(C_{i,j} = 1\)</span> åˆ™ <span class="math inline">\(A_i + B_j\ge k\)</span>ã€‚å¯¹å¯èƒ½çš„ <span class="math inline">\((A,B)\)</span> è®¡æ•°ï¼Œç­”æ¡ˆæ¨¡ <span class="math inline">\(998244353\)</span>ï¼Œ<span class="math inline">\(n,m\le 3000\)</span>ï¼Œ<span class="math inline">\(k\le 100\)</span>ã€‚</p>
<p>ä»¤ <span class="math inline">\(B_i'\leftarrow k - B_i\)</span>ï¼Œåˆ™ <span class="math inline">\(C\)</span> çŸ©é˜µå˜æˆäº†ä¸€ä¸ªæè¿° <span class="math inline">\(A_i\)</span> å’Œ <span class="math inline">\(B_j'\)</span> å¤§å°å…³ç³»çš„ä¸€ä¸ªçŸ©é˜µã€‚ ä¸‹æ–‡ä»¤ <span class="math inline">\(B_i\leftarrow B'_i\)</span>ã€‚</p>
<h2 id="xjoi-d20">XJOI D20</h2>
<h3 id="b-èŒèŒè®¡æ•°é¢˜">B èŒèŒè®¡æ•°é¢˜</h3>
<p>ç»™å®š <span class="math inline">\(n,k\)</span>ï¼Œéšæœºç”Ÿæˆæ’åˆ— <span class="math inline">\(\pi\)</span>ï¼Œé—®é€†åºå¯¹æ•° <span class="math inline">\(\operatorname{inv}(\pi)^k\)</span> çš„æœŸæœ›ã€‚<span class="math inline">\(n\le 10^9,k\le 10^5\)</span>ã€‚</p>
<h2 id="xjoi-d21">XJOI D21</h2>
<h3 id="a-åŠ è¾¹">A åŠ è¾¹</h3>
<p>é¦–å…ˆä¸€æ£µæ ‘åŠ è¾¹åè¦å˜æˆè¾¹åŒè¿é€šåˆ†é‡çš„å……è¦æ¡ä»¶æ˜¯è¿™äº›è¾¹å¯¹åº”çš„æ ‘é“¾èƒ½å°†æ•´æ£µæ ‘è¦†ç›–å®Œã€‚</p>
<h3 id="b-åŠ é›¶">B åŠ é›¶</h3>
<p>å®šä¹‰ <span class="math inline">\(1\)</span> é˜¶æ–æ³¢é‚£å¥‘æ•°åˆ— <span class="math inline">\(F_1\)</span>ï¼š <span class="math display">\[
F_{1,0} =1 , F_{1,1} = 1\\
F_{1,i} = F_{1,i-1} + F_{1,i-2}
\]</span> åœ¨æ­¤åŸºç¡€ä¸Šå®šä¹‰ <span class="math inline">\(k\)</span> é˜¶æ–æ³¢é‚£å¥‘æ•°åˆ— <span class="math inline">\(F_k\)</span>ï¼š <span class="math display">\[
F_{k,0} = 1, F_{k,1} = F_{k-1,1} + F_{k,0}\\
F_{k,i} = F_{k-1,i} + F_{k,i - 1} + F_{k,i - 2}
\]</span> æ±‚ <span class="math inline">\(F_{k,n}\bmod 469762049\)</span>ã€‚å…¶ä¸­ <span class="math inline">\(469762049\)</span> ä¸º NTT æ¨¡æ•°ï¼Œ<span class="math inline">\(g=3\)</span>ï¼Œä¸” <span class="math inline">\(\sqrt 5\equiv 13845527\pmod{469762049}\)</span>ã€‚<span class="math inline">\(1\le k\le 10^7\)</span>ï¼Œ<span class="math inline">\(10\le \lg n\le 10^5\)</span>ã€‚</p>
<p>æ³¨æ„åˆ° <span class="math inline">\(F_k\)</span> çš„æœ¬è´¨å°±æ˜¯ <span class="math inline">\(F_{k-1}\)</span> å·ä¸Š <span class="math inline">\(F_1\)</span>ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯ <span class="math inline">\(\displaystyle[x^n]\frac{1}{(1-x-x^2)^k}\)</span>ã€‚ <span class="math display">\[
\begin{aligned}
&amp;\left[x^n\right] \frac{1}{(1-x-x^2)^k}\\
=&amp;[x^n]\frac{1}{(1-\lambda_1x)^k}\frac{1}{(1-\lambda_2x)^k}\\
=&amp;\sum_{i=0}^n\binom{i+K}{K}\binom{n-i+K}{K}\lambda_1^i\lambda_2^{n-i}&amp;&amp;\text{let }K = k + 1\\
=&amp;\frac{\lambda_2^n}{(K!)^2}\sum_{i=0}^n(i+K)^{\underline K}(n-i+K)^{\underline K}q^i&amp;&amp;\text{let }q = \frac{\lambda_1}{\lambda_2}\\
=&amp;C \sum_{i=0}^n(i+K)^{\underline K}(i-n-1)^{\underline K}q^i&amp;&amp;\text{let }C = \frac{\lambda_2^n(-1)^k}{(K!)^2}\\
=&amp;C\sum_{i=0}^n(i+K)^{\underline K}q_i\sum_{j=0}^K\binom Kji^{\underline j}(-n-1)^{\underline{K-j}}\\
=&amp;C\sum_{j=0}^n\binom Kj(-n-1)^{\underline{K - j}}\sum_{i=0}^n(i+K)^{\underline{K+j}}q^i
\end{aligned}
\]</span> ä»¤ <span class="math inline">\(S_p = \displaystyle\sum_{i=0}^n(i+K)^{\underline p}q^i\)</span>ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥é€’æ¨ï¼š <span class="math display">\[
\begin{aligned}
S_p &amp;= \sum_{i=0}^n(i+K)^{\underline p}q^i\\
&amp;= \sum_{i=0}^n(i+K-1)^{\underline p}q^i+p(i+K-1)^{\underline{p-1}}q^i\\
&amp;= 
\end{aligned}
\]</span> åé¢ä¸ä¼šäº†ï¼Œå‘Šè¾ã€‚</p>
<h3 id="c-å˜‰ç„¶">C å˜‰ç„¶</h3>
<p>ç»™å®šé•¿ä¸º <span class="math inline">\(n\)</span> çš„æ’åˆ— <span class="math inline">\(p\)</span>ï¼Œ<span class="math inline">\(q\)</span> æ¬¡è¯¢é—®ã€‚æ¯æ¬¡è¯¢é—®ç»™å®š <span class="math inline">\(l,r\)</span>ï¼Œæ±‚ <span class="math display">\[
\max_{l\le i&lt; j\le r}\varphi(p_i\times p_j)
\]</span> é¦–å…ˆæœ‰æ’ç­‰å¼ <span class="math inline">\(\displaystyle\varphi(ab) = \varphi(a)\varphi(b)\frac{\gcd(a,b)}{\varphi(\gcd(a,b))}\)</span>ã€‚é‚£ä¹ˆå°±è€ƒè™‘æšä¸¾ <span class="math inline">\(d = \gcd(p_i, p_j)\)</span>ï¼Œå‘ç°è‹¥å¯¹äº <span class="math inline">\(\gcd(p_i, p_j) = g\)</span>ï¼Œè€Œæšä¸¾çš„ <span class="math inline">\(d\)</span> æ˜¯ <span class="math inline">\(g\)</span> çš„å› æ•°ï¼Œåˆ™ç®—å‡ºæ¥çš„ <span class="math inline">\(\varphi(p_i)\varphi(p_j)\frac{d}{\varphi(d)}\)</span> ä¸ä¼šå¤§äºçœŸå®ç»“æœã€‚æ‰€ä»¥å¯¹äºä¸€æ¬¡è¯¢é—®ï¼Œæšä¸¾ <span class="math inline">\(d\)</span>ï¼Œç„¶ååœ¨åŒºé—´å†…æ‹¿å‡º <span class="math inline">\(d\)</span> çš„æ‰€æœ‰å€æ•°ï¼Œç›´æ¥æŒ‰ç…§ <span class="math inline">\(\varphi(p_ip_j) = \varphi(p_i)\varphi(p_j)\frac{d}{\varphi(d)}\)</span> è®¡ç®—ï¼Œä¸€å®šèƒ½å¾—åˆ°ç­”æ¡ˆï¼Œç”±äºæ˜¯æ’åˆ—ï¼Œæ‰€æœ‰ <span class="math inline">\(d\)</span> çš„å€æ•°ä¸ªæ•°å’Œæ˜¯ <span class="math inline">\(O(n\ln n)\)</span> çš„ï¼Œæ‰€ä»¥å¤æ‚åº¦ <span class="math inline">\(O(qn\ln n)\)</span>ã€‚</p>
<p>æšä¸¾ <span class="math inline">\(d\)</span> çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ <span class="math inline">\(d\mid p_i\)</span> å’Œ <span class="math inline">\(d\mid p_j\)</span> çš„ <span class="math inline">\((i,j)\)</span> å¯¹æ‹¿å‡ºæ¥ï¼Œç„¶åè®¡ç®—å…¶è´¡çŒ® <span class="math inline">\(v = \varphi(p_i)\varphi(p_j)\frac{d}{\varphi(d)}\)</span>ï¼ŒæŠ½è±¡æˆä¸‰å…ƒç»„ <span class="math inline">\((i,j,v)\)</span>ã€‚äºæ˜¯æ¯æ¬¡è¯¢é—®å°±åªéœ€è¦æ‰¾åˆ° <span class="math inline">\(l\le i&lt;j\le r\)</span> çš„ä¸‰å…ƒç»„ä¸­ <span class="math inline">\(v\)</span> æœ€å¤§çš„ä¸€ä¸ªï¼Œå¯ä»¥é€šè¿‡æ’åº + æ‰«æçº¿å®ç°ã€‚</p>
<p>è¿™æ ·åšçš„è¯ä¼šå‘ç°æ— ç”¨çš„ä¸‰å…ƒç»„ä¸ªæ•°å¾ˆå¤šï¼Œæ³¨æ„åˆ° <span class="math inline">\(d\)</span> ç¡®å®šæ—¶ <span class="math inline">\(v\)</span> çš„å¤§å°åªä¸ <span class="math inline">\(\varphi(p_i)\)</span> å’Œ <span class="math inline">\(\varphi(p_j)\)</span> æœ‰å…³ã€‚è€ƒè™‘æšä¸¾è¾ƒå°çš„ä¸€ä¸ªï¼Œè®¾ä¸º <span class="math inline">\(p_i\)</span>ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªå…³é”®ç»“è®ºï¼šä¸‰å…ƒç»„ä¸­çš„ <span class="math inline">\(j\)</span> åªå¯èƒ½æ˜¯ <span class="math inline">\(i\)</span> å·¦è¾¹ç¬¬ä¸€ä¸ª <span class="math inline">\(\varphi(p_j)\ge \varphi(p_i)\)</span> çš„ <span class="math inline">\(j\)</span> æˆ–è€… <span class="math inline">\(i\)</span> å³è¾¹ç¬¬ä¸€ä¸ª <span class="math inline">\(\varphi(p_j)\ge \varphi(p_i)\)</span> çš„ <span class="math inline">\(j\)</span>ã€‚</p>
<p>å…ˆè€ƒè™‘ <span class="math inline">\(j&lt;i\)</span>ï¼Œ<span class="math inline">\(\varphi(p_j)\ge \varphi(p_i)\)</span>ï¼Œä¸” <span class="math inline">\(\exist k\in (j,i)\)</span> æ»¡è¶³ <span class="math inline">\(\varphi(p_k)\ge \varphi(p_i)\)</span>ï¼Œåˆ™ <span class="math inline">\(j,k\)</span> æ„æˆçš„ä¸‰å…ƒç»„çš„ <span class="math inline">\(v\)</span> ä¸€å®šä¸å°äº <span class="math inline">\(i,j\)</span> æ„æˆçš„ä¸‰å…ƒç»„çš„ <span class="math inline">\(v\)</span>ï¼Œä¸” <span class="math inline">\((j,k)\)</span> è¢« <span class="math inline">\((j,i)\)</span> å®Œå…¨åŒ…å«ï¼Œä¸€å®šæ›´å®¹æ˜“è¢« <span class="math inline">\((l,r)\)</span> åŒ…å«ã€‚<span class="math inline">\(j&gt;i\)</span> åŒç†ã€‚</p>
<p>é‚£ä¹ˆå°±æšä¸¾ <span class="math inline">\(d\)</span>ï¼Œç„¶åç”¨å•è°ƒæ ˆæ‰¾æ¯ä¸ª <span class="math inline">\(i\)</span> çš„ <span class="math inline">\(j_L\)</span> å’Œ <span class="math inline">\(j_R\)</span>ï¼Œç„¶ååªè®°å½• <span class="math inline">\((j_L, i)\)</span> å’Œ <span class="math inline">\((i, j_R)\)</span> æ‰€åœ¨çš„ä¸‰å…ƒç»„ï¼Œæœ‰ç”¨çš„ä¸‰å…ƒç»„å°±æ˜¯ <span class="math inline">\(O(n\ln n)\)</span> çº§åˆ«çš„äº†ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\ln n + q)\log n\)</span>ã€‚</p>
<h2 id="xjoi-d22">XJOI D22</h2>
<h3 id="a-å¤ç›˜">A å¤ç›˜</h3>
<p>è§<a href="/sol-cf1033g">CF1033G</a>ã€‚</p>
<h3 id="b-ç‹ä½ä¹‹äº‰">B ç‹ä½ä¹‹äº‰</h3>
<p>é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„å­—ç¬¦ä¸² <span class="math inline">\(s\)</span>ï¼Œè€ƒè™‘å…¶æ‰€æœ‰æœ¬è´¨ä¸åŒå­ä¸² <span class="math inline">\(t\)</span>ã€‚å¯¹äº <span class="math inline">\(t\)</span> çš„æ¯ä¸€ä¸ªå‰ç¼€ <span class="math inline">\(p\)</span>ï¼Œè‹¥å…¶ä¹Ÿæ˜¯å¦ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(|t|\)</span> ä¸” <span class="math inline">\(\ne t\)</span> çš„å­ä¸² <span class="math inline">\(u\)</span> çš„å‰ç¼€ï¼Œåˆ™ <span class="math inline">\(p\)</span> å¯¹äº <span class="math inline">\(t\)</span> äº§ç”Ÿ <span class="math inline">\(1\)</span> çš„è´¡çŒ®ã€‚æ±‚é•¿ä¸ºå¶æ•°çš„ <span class="math inline">\(p\)</span> çš„è´¡çŒ®å‡å»é•¿ä¸ºå¥‡æ•°çš„ <span class="math inline">\(p\)</span> çš„è´¡çŒ®ã€‚</p>
<p>å¯¹äº <span class="math inline">\(n\le 2000\)</span> çš„æƒ…å†µï¼Œé¦–å…ˆå¯ä»¥å°†æ‰€æœ‰çš„åç¼€æ’å…¥ä¸€æ£µ Trie æ ‘ï¼ˆå“¦å¥½åƒå°±æ˜¯åç¼€æ ‘ä½†é—®é¢˜ä¸å¤§ï¼‰ï¼Œç„¶åéå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæšä¸¾ <span class="math inline">\(p\)</span>ï¼‰ç„¶åè€ƒè™‘æšä¸¾ <span class="math inline">\(u\)</span>ï¼Œå‘ç°å®é™…ä¸Šè¦æ±‚çš„å°±æ˜¯åœ¨å¯¹åº”æ·±åº¦è‡³å°‘æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œè¿™ä¸ªå¯èƒ½å¯ä»¥ç”¨é•¿é“¾å‰–åˆ†æˆ–è€… bitset ä»€ä¹ˆç»´æŠ¤ä¸€ä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦æˆ‘è§‰å¾—èƒ½è¿‡ã€‚äºæ˜¯çœŸçš„è¸é©¬èƒ½è¿‡ã€‚</p>
<p>æ­£è§£æ˜¯ç”¨å¯¹åä¸²å»º SAM æ¥å¾—åˆ°åç¼€æ ‘ï¼Œç»Ÿè®¡æ²¡æœ‰è´¡çŒ®çš„èŠ‚ç‚¹ï¼Œ</p>
<h3 id="c-æ•°è®ºé¢˜">C æ•°è®ºé¢˜</h3>
<p>å®šä¹‰åºåˆ— <span class="math inline">\(a\)</span> æ˜¯å¥½çš„å½“ä¸”ä»…å½“ <span class="math inline">\(\forall a_i,a_i\in[1,m]\cap\mathbb Z\)</span>ï¼Œä¸” <span class="math inline">\(\forall i,\forall j&lt;i, a_j\mid a_i\)</span>ã€‚å®šä¹‰ä¸€ä¸ªåºåˆ—çš„æƒå€¼æ˜¯åºåˆ—ä¸­æ‰€æœ‰æ•°çš„ä¹˜ç§¯ã€‚ä¸¤ç§è¯¢é—®ï¼š</p>
<ul>
<li>æ±‚æ‰€æœ‰é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„å¥½åºåˆ—çš„æƒå€¼ä¹‹å’Œã€‚</li>
<li>æ±‚æ‰€æœ‰é•¿åº¦ä¸º <span class="math inline">\(n\)</span> ä¸”ä»¥ <span class="math inline">\(x\)</span>ï¼ˆ<span class="math inline">\(x\)</span> ä¸ºè´¨æ•°çš„æ•´æ•°æ¬¡å¹‚ï¼‰ç»“å°¾çš„å¥½åºåˆ—çš„æƒå€¼ä¹‹å’Œã€‚</li>
</ul>
<p>ç­”æ¡ˆæ¨¡ <span class="math inline">\(10^9 + 7\)</span>ï¼Œ<span class="math inline">\(1\le n\le 10^9\)</span>ï¼Œ<span class="math inline">\(1\le m\le 10^7\)</span>ã€‚</p>
<p>æ˜¾ç„¶æœ‰ <span class="math inline">\(O(nm\log m)\)</span> çš„ dpï¼š<span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºé•¿ <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(j\)</span> ç»“å°¾çš„å¥½åºåˆ—æƒå€¼ä¹‹å’Œï¼Œåˆ™ <span class="math display">\[
f_{i,j} = j\times \sum_{k\mid j}f_{i - 1,k }
\]</span> æš´åŠ›è½¬ç§»æœ‰ <span class="math inline">\(20\)</span> åˆ†ã€‚</p>
<p>ç„¶åå¯¹äº <span class="math inline">\(n,m\le 10^5\)</span> çš„è¯¢é—®äºŒï¼Œå¯ä»¥æ”¹çŠ¶æ€ä¸º <span class="math inline">\(f_{i,j}\)</span>ï¼šé•¿åº¦ä¸º <span class="math inline">\(i\)</span>ï¼Œä»¥ <span class="math inline">\(p^j\)</span> ç»“å°¾çš„å¥½åºåˆ—æƒå€¼ä¹‹å’Œï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log^2m)\)</span>ã€‚</p>
<p>è€Œå¯¹äº <span class="math inline">\(n,m\le 10^7\)</span>ï¼Œå†™å‡ºè½¬ç§»æ–¹ç¨‹ï¼š <span class="math display">\[
f_{i,j} = p^j\times \sum_{k\le j}f_{i - 1, k}
\]</span> è€ƒè™‘å…¶ç”Ÿæˆå‡½æ•°ï¼Œè®¾ <span class="math inline">\([z^m]F_n(z) = f_{n,m}\)</span>ï¼Œåœ¨ä¸Šé¢çš„è½¬ç§»ä¸­å°† <span class="math inline">\(p^j\)</span> æ‹†æˆ <span class="math inline">\(p^kp^{j-k}\)</span> ä¹‹åå°† <span class="math inline">\(p^k\)</span> åˆ†é…åˆ°æ±‚å’Œå·å†…ï¼Œ <span class="math display">\[
f_{i,j} = \sum_{k\le j}f_{i-1,k}p^kp^{j-k}
\]</span> æ‰€ä»¥ <span class="math display">\[
[z^j]F_i(z) = \sum_{k=0}^j[z^k]F_{i-1}(pz)p^{j-k}
\]</span> è¿™ä¸ªä¸œè¥¿æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼ï¼Œæ‰€ä»¥ <span class="math display">\[
F_i(z) = \frac{F_{i-1}(pz)}{1-pz} = \prod_{j\le i}\frac{1}{1-p^jz} = \frac{F_{i-1}(z)}{1-p^iz}
\]</span></p>
<p>æ‰€ä»¥ <span class="math display">\[
F_{n}(pz)(1-p^{n+1}z) = F_{n}(z)(1-pz)
\]</span> æ‹†å¼€ï¼Œ <span class="math display">\[
\begin{aligned}
F_n(pz) - p^{n+1}zF_n(pz) &amp;= F_n(z) - pzF_n(z)\\
f_{n, i}p^i - p^{n+i}f_{n,i-1} &amp;= f_{n,i} - pf_{n,i -1}\\
f_{n,i} &amp;= f_{n,i-1}\times\frac{p^{n+i} - p}{p^i - 1}
\end{aligned}
\]</span> æ‰€ä»¥å¯¹äºè´¨æ•°å¹‚å¤„çš„å€¼ï¼Œå¯ä»¥é€’æ¨ã€‚</p>
<p>å›é¡¾ä¸€å¼€å§‹çš„è½¬ç§»æ–¹ç¨‹ï¼Œå‘ç°å…¶å°±ä¸º <span class="math display">\[
f_{i,j} = j\times \sum_{k\mid j}f_{i-1,k}
\]</span> å¯ä»¥å‘ç° <span class="math inline">\(f_i = \mathrm{id}\cdot (f_{i-1}*1)\)</span>ï¼Œè€Œ <span class="math inline">\(f_0 = [x=1]\)</span>ï¼Œæ‰€ä»¥æ¯ä¸ª <span class="math inline">\(f_i\)</span> éƒ½æ˜¯ç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥çº¿æ€§ç­›ã€‚</p>
<h2 id="xjoi-d25">XJOI D25</h2>
<h3 id="a-æ˜Ÿæµ·">A æ˜Ÿæµ·</h3>
<p>é¦–å…ˆä»¤ <span class="math inline">\(a_i\leftarrow a_i - i\)</span>ï¼Œç„¶åä¸¥æ ¼é€’å¢å°±å˜æˆäº†éä¸¥æ ¼é€’å¢ï¼Œè€ƒè™‘å…¶å·®åˆ†æ•°ç»„ <span class="math inline">\(d_i = a_i - a_{i-1}\)</span>ï¼Œæœ€ç»ˆç›®çš„å°±æ˜¯è®©æ‰€æœ‰ <span class="math inline">\(d_i\)</span> å˜ä¸º <span class="math inline">\(0\)</span>ã€‚æ¯æ¬¡æ“ä½œå¯ä»¥è®© <span class="math inline">\(d_i\leftarrow d_i -x\)</span> ç„¶åè®© <span class="math inline">\(d_{i+1}\leftarrow d_{i+1} + x\)</span>ï¼Œç‰¹åˆ«åœ°å¯¹äº <span class="math inline">\(i=n\)</span> åªæœ‰ <span class="math inline">\(d_n \leftarrow d_n - x\)</span>ã€‚</p>
<p>ç„¶åå°±æ˜¯æˆ‘å­¦ä¸ä¼šçš„ç¥ç§˜ç»“è®ºï¼š</p>
<ul>
<li><span class="math inline">\(n\)</span> ä¸ºå¥‡æ•°æ—¶ï¼Œä»¤ <span class="math inline">\(x = d_1\oplus d_3\oplus \cdots \oplus d_n\)</span>ï¼›</li>
<li><span class="math inline">\(n\)</span> ä¸ºå¶æ•°æ—¶ï¼Œä»¤ <span class="math inline">\(x = d_2\oplus d_4\oplus\cdots \oplus d_n\)</span>ï¼›</li>
</ul>
<p>è‹¥ <span class="math inline">\(x = 0\)</span> åˆ™å…ˆæ‰‹å¿…è´¥ï¼Œè¯æ˜ï¼š</p>
<p>è€ƒè™‘ä¸€æ¬¡æ“ä½œæ¶‰åŠç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œæ‰€ä»¥å¿…è´¥æ€æ— æ³•èµ°å‘å¿…è´¥æ€ã€‚è®° <span class="math inline">\(\operatorname{highbit}(x)\)</span> è¡¨ç¤ºäºŒè¿›åˆ¶ä¸­ <span class="math inline">\(x\)</span> çš„æœ€é«˜ä½ï¼Œåˆ™å¯¹äºä¸€ä¸ªå¿…èƒœæ€ï¼Œåˆ¤å®šå¼ä¸­çš„ <span class="math inline">\(d\)</span> å¿…ç„¶è‡³å°‘ä¸€ä¸ªåœ¨ <span class="math inline">\(\operatorname{highbit}(x)\)</span> ä½ä¸Šä¸º <span class="math inline">\(1\)</span>ï¼Œæ‰¾åˆ°ä¸€ä¸ªè¿™æ ·çš„ <span class="math inline">\(d_q\)</span>ï¼Œé‚£ä¹ˆåˆ¤å®šå¼ä¸­å…¶ä»–æˆå‘˜çš„å¼‚æˆ–å’Œå³ä¸º <span class="math inline">\(x' = x\oplus d_q\)</span>ã€‚</p>
<p>å‘ç° <span class="math inline">\(x'&lt; d_q\)</span>ï¼Œæ‰€ä»¥å­˜åœ¨ <span class="math inline">\(\Delta = d_q - x'&gt; 0\)</span>ï¼Œè¿™ä¾¿èƒ½æŒ‡å¼•æ–°çš„åˆ¤å®šå¼å˜ä¸º <span class="math inline">\(x'\oplus x' = 0\)</span>ï¼Œèµ°å‘ä¸€ä¸ªå¿…è´¥æ€ã€‚è¯æ¯•ã€‚</p>
<h3 id="b-å·æ€ª">B å·æ€ª</h3>
<h2 id="xjoi-d27">XJOI D27</h2>
<h3 id="a-é«˜ç»´æ¸¸èµ°">A é«˜ç»´æ¸¸èµ°</h3>
<p><span class="math display">\[
\sum_{s\ge 0}\left(\left(\sum_{\sum c_i i = s}\binom{t_0}{c_1,c_2,\cdots, c_m }\prod_{i=1}^m\binom{t_i}{c_i}\right)\bmod 2\right)
\]</span></p>
<h2 id="xjoi-tp1done">XJOI TP1ï¼ˆDoneï¼‰</h2>
<h3 id="a-æ±‚è§£">A æ±‚è§£</h3>
<p>éšæœºåºåˆ— <span class="math inline">\(a_i\)</span>ï¼Œæ‰¾åˆ° <span class="math inline">\(k\)</span> ä¸ªéç©ºä¸äº¤åŒºé—´ä½¿å¾— <span class="math display">\[
\bigoplus_{i=1}^k\bigoplus_{j=l_i}^{r_i}a_j = p
\]</span> <span class="math inline">\(T\)</span> ç»„è¯¢é—®ï¼Œ<span class="math inline">\(1\le k\le n\le 64\)</span>ï¼Œ<span class="math inline">\(a_i\in[0, 2^{64})\)</span>ã€‚</p>
<p>æ³¨æ„åˆ° <span class="math inline">\(a_i\)</span> éšæœºï¼Œæ‰€ä»¥çº¿æ€§åŸºä¼šæ¯”è¾ƒæ»¡ã€‚é‚£ä¹ˆçº¿æ€§åŸºå¤–é¢çš„å…ƒç´ å°±å¾ˆå°‘ï¼Œç›´æ¥æšä¸¾å¤–é¢çš„å…ƒç´ é€‰äº†å•¥ï¼Œç„¶åå¾€çº¿æ€§åŸºé‡Œé¢æ–—å‡ºå¦å¤–è¦é€‰çš„å…ƒç´ çœ‹æ»¡ä¸æ»¡è¶³ <span class="math inline">\(k\)</span> çš„é™åˆ¶å³å¯ã€‚</p>
<p>å¥½éš¾å†™å•Šï¼Œä½ å¦ˆçš„ã€‚</p>
<h3 id="b-æ±‚å€¼">B æ±‚å€¼</h3>
<p>ç»™å®šé•¿åº¦ä¸º <span class="math inline">\(n\le 5\times 10^5\)</span> çš„æ­£æ•´æ•°åºåˆ— <span class="math inline">\(\langle a_n\rangle\)</span>ã€‚å¯¹äºä¸€ä¸ªç½®æ¢ <span class="math inline">\(p\)</span>ï¼Œå®šä¹‰å…¶ä»·å€¼ <span class="math inline">\(f(p)\)</span> ä¸ºå…¶æ¯ä¸ªè½®æ¢å†…æœ€å°çš„ <span class="math inline">\(a_i\)</span> ä¹‹ç§¯ã€‚å®šä¹‰ <span class="math inline">\(b_i\)</span> è¡¨ç¤ºæœ‰ <span class="math inline">\(i\)</span> ä¸ªè½®æ¢çš„ç½®æ¢çš„ä»·å€¼ä¹‹å’Œï¼Œæ±‚ <span class="math inline">\(\gcd\limits_{i=1}^n\{b_i\}\bmod 998244353\)</span>ã€‚</p>
<p>åˆ†æˆåœ†æ’åˆ—ï¼Œè€ƒè™‘ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°ï¼Œå°†å…¶é€’æ¨å¼å†…æ–°å»ºåœ†æ’åˆ—çš„ç³»æ•°æ”¹æˆæ­¤åœ†æ’åˆ—çš„æœ€å°å€¼å³å¯ã€‚æœ¬é¢˜ä¸­å¯ä»¥å°† <span class="math inline">\(a\)</span> å‡åºæ’åºï¼Œç„¶å <span class="math inline">\(f_{i,j} = a_if_{i-1,j-1} + (i-1)f_{i-1,j}\)</span>ã€‚</p>
<p>åˆ™ <span class="math inline">\(f_{n,i}\)</span> çš„ GF ä¸º <span class="math inline">\(\prod\limits_{i=1}^n(a_iz + i - 1)\)</span>ã€‚ç„¶åæœ‰ç»“è®ºï¼šè‹¥æœ‰å¤šé¡¹å¼ <span class="math inline">\(P(z),Q(z)\)</span> å’Œå‡½æ•° <span class="math inline">\(c(P(z)) = \gcd\limits_i\{[z^i]P(z)\}\)</span>ï¼Œåˆ™ <span class="math inline">\(c(P(z)Q(z)) = c(P(z))c(Q(z))\)</span>ã€‚æœ¬é¢˜ç­”æ¡ˆå³ä¸º <span class="math inline">\(\prod\limits_{i=1}^n\gcd(a_i, i - 1)\)</span>ã€‚</p>
<p>è¯æ˜å¯ä»¥è€ƒè™‘åè¯ï¼Œè¯æ˜ <span class="math inline">\(c(P) = c(Q) = 1\)</span> æ—¶ <span class="math inline">\(c(PQ) = 1\)</span> å³å¯ã€‚</p>
<h3 id="c-æ±‚å’Œ">C æ±‚å’Œ</h3>
<p>ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„åºåˆ— <span class="math inline">\(A,B\)</span>ã€‚å¯ä»¥é€‰æ‹©è‹¥å¹² <span class="math inline">\(i\)</span> å¹¶äº¤æ¢ <span class="math inline">\(A_i, B_i\)</span>ã€‚æœ€å¤§åŒ– <span class="math inline">\(\sum\limits_{i=1}^n\sum\limits_{j=1}^n\min(A_i,B_j)\)</span>ã€‚å¹¶æ„é€ æ–¹æ¡ˆã€‚</p>
<p>å¥‡æ€ªå¥—è·¯é¢˜ã€‚</p>
<p>å‡è®¾ <span class="math inline">\(a_i\le b_i\)</span>ã€‚è®¨è®º <span class="math inline">\(a_i,b_i,a_j,b_j\)</span> çš„è´¡çŒ®ã€‚</p>
<ul>
<li>è‹¥ <span class="math inline">\(a_i\le b_i\le a_j\le b_j\)</span>ï¼Œäº¤æ¢æŸä¸€ç»„ <span class="math inline">\(a,b\)</span> åç­”æ¡ˆä¸å˜ã€‚</li>
<li>è‹¥ <span class="math inline">\(a_i\le a_j\le b_i\le b_j\)</span>ï¼Œäº¤æ¢åç­”æ¡ˆå¢åŠ  <span class="math inline">\(b_i - a_j\)</span>ã€‚</li>
<li>è‹¥ <span class="math inline">\(a_i\le a_j\le b_j\le b_i\)</span>ï¼Œäº¤æ¢åç­”æ¡ˆå¢åŠ  <span class="math inline">\(b_j - a_j\)</span>ã€‚</li>
</ul>
<p>å³ï¼Œäº¤æ¢ä¸€ç»„ <span class="math inline">\(a,b\)</span> åï¼Œ<span class="math inline">\((a_i,b_i)\)</span> å’Œ <span class="math inline">\((a_j,b_j)\)</span> çš„è´¡çŒ®ä¼šåŠ ä¸Šè¿™ä¸¤æ¡çº¿æ®µçš„äº¤çš„å¤§å°ã€‚æ‰€ä»¥ç°åœ¨é—®é¢˜å˜ä¸ºå°† <span class="math inline">\(n\)</span> æ¡çº¿æ®µæŸ“è‰²ï¼Œä½¿å¾—æ¯ä¸€å¯¹å¼‚è‰²çº¿æ®µçš„äº¤ä¹‹å’Œæœ€å¤§ã€‚</p>
<p>è€ƒè™‘æ¯ä¸ªè¿ç»­æ®µï¼Œè‹¥å…¶è¢«è¦†ç›–äº† <span class="math inline">\(k\)</span> æ¬¡ï¼Œåˆ™å…¶èƒ½è´¡çŒ® <span class="math inline">\(len\times\lceil k / 2\rceil\times\lfloor k / 2\rfloor\)</span>ï¼Œä¸‹é¢æ„é€ è¿™ä¸ªä¸Šç•Œã€‚</p>
<p>è‹¥æŸä¸ªå°æ®µè¢«è¦†ç›–å¥‡æ•°æ¬¡ï¼Œåˆ™é¢å¤–è¿ä¸€æ¡è¾¹ã€‚è¿™æ ·æ‰€æœ‰ç‚¹çš„åº¦æ•°éƒ½ä¸ºå¶æ•°ï¼Œè·‘ä¸ªæ¬§æ‹‰å›è·¯ï¼Œè¢«è¦†ç›–äº† <span class="math inline">\(k\)</span> æ¬¡çš„å°æ®µä¼šè¢«ä»å·¦å¾€å³èµ° <span class="math inline">\(k/2\)</span> æ¬¡ï¼Œä»å³å¾€å·¦èµ° <span class="math inline">\(k/2\)</span> æ¬¡ã€‚è€Œä»–åªä¼šè¢«é¢å¤–è¾¹è¦†ç›–ä¸€æ¬¡ï¼Œå°†å·¦å¾€å³çš„è¾¹æŸ“æˆé»‘è‰²ï¼Œå³å¾€å·¦çš„è¾¹æŸ“æˆç™½è‰²ï¼Œä¸Šç•Œå³å¯è¾¾åˆ°ã€‚</p>
<h2 id="xjoi-noi-d14">XJOI NOI D14</h2>
<h3 id="b-å¯æ€œ">B å¯æ€œ</h3>
<h2 id="å®éªŒèˆ±-7.21">å®éªŒèˆ± 7.21</h2>
<h3 id="a-å¹³é¢åµŒå…¥">A å¹³é¢åµŒå…¥</h3>
<h3 id="b-åºåˆ—">B åºåˆ—</h3>
<p>æ–¹æ¡ˆå¾ˆå¥½æ„é€ ï¼Œç›´æ¥è«é˜Ÿå³å¯ã€‚</p>
<h3 id="c-åˆ’åˆ†">C åˆ’åˆ†</h3>
<h2 id="å®éªŒèˆ±-7.22">å®éªŒèˆ± 7.22</h2>
<h3 id="a-é›†åˆ">A é›†åˆ</h3>
<p>é¢˜æ„ï¼šè®¾ <span class="math inline">\([n] = \{1,2,\cdots, n\}\)</span>ï¼Œè®¾ <span class="math inline">\(F(S) = T^{\min S}\)</span>ï¼Œæ±‚ <span class="math inline">\(E[F(S)\mid S\subseteq[n], |S|=k]\)</span>ï¼Œæ¨¡ <span class="math inline">\(M = 998244353\)</span>ï¼Œ<span class="math inline">\(1\le k\le n&lt;M\)</span>ï¼Œ<span class="math inline">\(k\le 10^7\)</span>ã€‚</p>
<p>æšä¸¾æœ€å°å€¼å®¹æ˜“å¾—åˆ° <span class="math display">\[
\sum_{i=1}^{n}T^i\binom{n-i}{k-1}
\]</span> å½“ç„¶è¿™ä¸ªç®—æ³•æ˜¯ <span class="math inline">\(O(n)\)</span> çš„ï¼Œè§‚å¯Ÿæ•°æ®èŒƒå›´å‘ç°æˆ‘ä»¬æƒ³è¦çš„æ˜¯ä¸€ä¸ª <span class="math inline">\(O(k)\)</span> çš„é€’æ¨å¼ã€‚è®¾ <span class="math inline">\(A_k = \sum\limits_{i=1}^{n}T^i\binom{n-i}{k-1}\)</span>ï¼Œæ³¨æ„åˆ°ç»„åˆæ•°çš„ä¸‹æ ‡å…¨éƒ¨æ˜¯ <span class="math inline">\(k-1\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªç»„åˆæ•°ä¸‹æ ‡ä¸º <span class="math inline">\(k\)</span> çš„å½¢å¼æ¥æ–¹ä¾¿ä»£å…¥ã€‚æšä¸¾æœ€å°å€¼è‡³å°‘æ˜¯å¤šå°‘ï¼Œç®€å•å®¹æ–¥ä¸€ä¸‹å¾—åˆ°ï¼š <span class="math display">\[
\begin{aligned}
A_{k-1} &amp;= T\binom n {k-1} + \sum_{i=2}^{n}(T^i - T^{i-1})\binom{n-i + 1}{k-1}\\
&amp;=T\binom{n}{k-1} + \sum_{i=1}^{n-1}(T-1)T^{i}\binom{n-i}{k-1}
\end{aligned}
\]</span> ç„¶åæ³¨æ„åˆ°ä¸Šé¢å¯ä»¥ä»£å…¥ä¸‹é¢ï¼Œæ³¨æ„åˆ° <span class="math inline">\(k&gt;1\)</span> çš„æ—¶å€™ç¬¬ <span class="math inline">\(n\)</span> é¡¹æ²¡æœ‰è´¡çŒ®ï¼š <span class="math display">\[
A_{k-1} = T\binom{n}{k-1} + (T-1)A_k
\]</span> é€’æ¨å¼å°±æœ‰äº†ï¼š <span class="math display">\[
\begin{aligned}
A_k &amp;= \frac{1}{T-1}\left(A_{k-1}-T\binom{n}{k-1}\right)\\
A_1 &amp;= \sum_{i=1}^nT^i = \frac{T(1-T^n)}{1-T}
\end{aligned}
\]</span> ç›´æ¥æ¨å°±è¡Œäº†ã€‚ç»†èŠ‚ï¼šçº¿æ€§ç­›é€†å…ƒï¼Œ<span class="math inline">\(\dbinom ni = \dfrac{n-i+1}{i}\dbinom{n}{i-1}\)</span>ã€‚</p>
<h3 id="b">B</h3>
<h3 id="c">C</h3>
<h2 id="å®éªŒèˆ±-7.23">å®éªŒèˆ± 7.23</h2>
<p>Rushcheyo Roundï¼Œorz rushcheyoã€‚</p>
<h3 id="a-covering">A Covering</h3>
<p>é¢˜æ„ï¼š<span class="math inline">\(n\le 5\times 10^5\)</span> ä¸ªç‚¹ï¼Œ<span class="math inline">\(q\le 5000\)</span>ï¼ŒåŒºé—´è¯¢é—®æœ€å°åœ†è¦†ç›–ï¼Œ<span class="math inline">\(\varepsilon = 10^{-4}\)</span>ã€‚</p>
<p><span class="math inline">\(60\)</span> åˆ†æš´åŠ›è¿˜ç®—è‰¯å¿ƒï¼ˆ</p>
<p>æœ¬é¢˜çš„åˆ‡å…¥ç‚¹åœ¨äº <span class="math inline">\(\varepsilon\)</span> ç‰¹åˆ«å¤§ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ coreset è¿‘ä¼¼æ–¹æ³•æ¥å°†ç‚¹çš„è§„æ¨¡ç¼©å‡åˆ°èƒ½æ¥å—çš„èŒƒå›´å†…ã€‚</p>
<p>è€ƒè™‘ç‚¹é›† <span class="math inline">\(S\)</span>ï¼Œå‡åŒ€å– <span class="math inline">\(k=\dfrac{\pi}{\sqrt\varepsilon}\)</span> ä¸ªå•ä½å‘é‡ï¼Œå¯¹æ¯ä¸ªå•ä½å‘é‡ <span class="math inline">\(\boldsymbol v\)</span>ï¼Œå– <span class="math inline">\(S\)</span> ä¸­æŠ•å½±åˆ° <span class="math inline">\(\boldsymbol v\)</span> çš„ä¸¤ç«¯ç‚¹ï¼Œè¿™æ · <span class="math inline">\(S\)</span> å°±åªå‰©ä¸‹ <span class="math inline">\(O(\varepsilon^{-0.5})\)</span> ä¸ªç‚¹ï¼Œè®°ä¸º <span class="math inline">\(S\)</span> çš„æ ¸å¿ƒé›† <span class="math inline">\(S'\)</span>ï¼Œç¤ºæ„å›¾ï¼š</p>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/syc0723_1.png"/><figcaption>syc0723_1</figcaption>
</figure>
<p>å¯ä»¥è¯æ˜ï¼Œ<span class="math inline">\((1-\varepsilon)v(S)\le v(S')\le v(S)\)</span>ã€‚ä¸‹é¢ç»™å‡ºè¯æ˜ã€‚</p>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/syc0723_2.png"/><figcaption>syc0723_2</figcaption>
</figure>
<p>è€ƒè™‘ä»»æ„ç‚¹ <span class="math inline">\(x\)</span>ï¼Œè®¾ <span class="math inline">\(z\)</span> æ˜¯ <span class="math inline">\(S\)</span> ä¸­è·ç¦» <span class="math inline">\(x\)</span> æœ€è¿œçš„ç‚¹ï¼Œæ‰¾ä¸€ä¸ªä¸ <span class="math inline">\(x\)</span> å¤¹è§’ä¸è¶…è¿‡ <span class="math inline">\(\sqrt\varepsilon\)</span> çš„æ–¹å‘ <span class="math inline">\(\boldsymbol u_i\)</span>ï¼Œè®¾ <span class="math inline">\(z\)</span> åœ¨ä¸Šé¢æŠ•å½±ä¸º <span class="math inline">\(z'\)</span>ï¼Œåˆ™ <span class="math inline">\(S'\)</span> ä¸­å¿…ç„¶æœ‰ä¸€ä¸ªç‚¹æŠ•å½±åˆ° <span class="math inline">\(\boldsymbol u_i\)</span> ä¸Šä»‹äº <span class="math inline">\(z'y\)</span> ä¹‹é—´ã€‚<span class="math inline">\(x\)</span> åˆ°å…¶è·ç¦»è‡³å°‘ä¸º <span class="math inline">\(d(x,z)\cos(\sqrt\varepsilon)\ge (1-\epsilon)d(x,z)\)</span>ï¼Œè¯æ¯•ã€‚</p>
<p>é‚£ä¹ˆå°±ä½¿ç”¨æ•°æ®ç»“æ„ç»´æŠ¤åŒºé—´æ ¸å¿ƒé›†ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å¯¹å…¶ä½¿ç”¨éšæœºå¢é‡çš„æœ€å°åœ†è¦†ç›–ç®—æ³•ï¼Œç”¨æ—¶ <span class="math inline">\(O(k)\)</span>ã€‚æ‹¿çº¿æ®µæ ‘ç»´æŠ¤çš„æ—¶é—´å¤æ‚åº¦å¤§æ¦‚æ˜¯ <span class="math inline">\(O(nk + q\varepsilon^{-1/2}\log n)\)</span>ã€‚</p>
<h3 id="b-sorting">B Sorting</h3>
<p>é¢˜æ„ï¼šäº¤äº’é¢˜ï¼Œä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„æ’åˆ—ï¼Œé€†åºå¯¹æ•°ä¸º <span class="math inline">\(k\)</span>ï¼Œè¦æ±‚åœ¨ <span class="math inline">\(M\)</span> æ¬¡å†…æ’å¥½åºï¼Œå…¶ä¸­ <span class="math inline">\(M\)</span> ä¸º <span class="math inline">\(n\log(k/n)\)</span> çº§åˆ«ã€‚</p>
<h3 id="c-factor">C Factor</h3>
<p>é¢˜æ„ï¼š<span class="math inline">\(T\le 10^4\)</span> æ¬¡è¯¢é—®ï¼Œç»™å®š <span class="math inline">\(n\le 9\times 10^{18}\)</span>ï¼Œå·²çŸ¥å…¶ä¸ºå¥‡ç´ æ•° <span class="math inline">\(p,q\)</span> ä¹‹ç§¯ï¼Œä¸” <span class="math inline">\(q-p\le k\le 10^8\)</span>ï¼Œæ±‚ <span class="math inline">\(p\)</span>ã€‚</p>
<h2 id="å®éªŒèˆ±-7.24">å®éªŒèˆ± 7.24</h2>
<h3 id="a-ç»å…¸é¢˜">A ç»å…¸é¢˜</h3>
<p><span class="math display">\[
\sum_{i=1}^n\sum_{j=1}^n\gcd(a^i+1,a^j+1)
\]</span></p>
<p><span class="math inline">\(n,a\le 10^9\)</span>ã€‚</p>
<p>æ‰“äº†ä¸ªè¡¨å‘ç° <span class="math inline">\(\gcd\)</span> ä¸€å®šåœ¨ <span class="math inline">\(a^k + 1\)</span> å’Œ <span class="math inline">\((a\bmod 2) + 1\)</span> é‡Œé¢äº§ç”Ÿã€‚å¹¶ä¸” <span class="math inline">\(a^{kx} + 1~(k\bmod 2=1)\)</span> ä¸€å®šæ˜¯ <span class="math inline">\(a^x + 1\)</span> çš„å€æ•°ã€‚ <span class="math display">\[
\sum_{k=1}^n(a^k+1)\sum_{\substack{i\text{ is odd}\\i\le \lfloor n / k\rfloor}}\sum_{\substack{j\text{ is odd}\\j\le \lfloor n/k\rfloor}}[\gcd(a^{ik}+1, a^{jk}+1)=a^k+1]
\]</span> å†æ‰“ä¸ªè¡¨å‘ç°ä¸€å®šæœ‰ <span class="math inline">\(\gcd(i, j) = 1\)</span>ï¼Œå¾ˆç¥å¥‡ï¼Œå—¨å—¨ã€‚è€Œå¯¹äº <span class="math inline">\(\gcd = (a\bmod 2) + 1\)</span> çš„æƒ…å†µï¼Œå‘ç°åªæœ‰å½“ <span class="math inline">\(i/d\)</span> å’Œ <span class="math inline">\(j/d\)</span> å…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯å¶æ•°çš„æ—¶å€™å­˜åœ¨ï¼Œè¿™ä¸€éƒ¨åˆ†çš„è´¡çŒ®å°±åˆå§‹ä»¤ <span class="math inline">\(ans = n^2\)</span>ï¼Œ<span class="math inline">\(a^k+1\)</span> çš„è´¡çŒ®å°±æŠŠ <span class="math inline">\(+1\)</span> æ‰”æ‰ï¼Œç„¶åå¦‚æœ <span class="math inline">\(a\)</span> ä¸ºå¥‡æ•°çš„è¯ä¸ºé‚£äº›ä½ç½®å†è´¡çŒ®ä¸€æ³¢ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘ <span class="math inline">\(\gcd = a^{k} + 1\)</span> çš„è´¡çŒ®ï¼š <span class="math display">\[
\begin{aligned}
&amp;\sum_{d=1}^na^d\sum_{\substack{i\text{ is odd}\\i\le \lfloor n / d\rfloor}}\sum_{\substack{j\text{ is odd}\\j\le \lfloor n/d\rfloor}}[\gcd(i,j)=1]\\
=&amp;\sum_{d=1}^na^d\sum_{k=1}^{\lfloor n / d\rfloor}\mu(k)\sum_{\substack{i\text{ is odd}\\i\le n / d}}\sum_{\substack{j\text{ is odd}\\j\le n/d}}[k\mid\gcd(i,j)]\\
=&amp;\sum_{d=1}^na^d\sum_{\substack{k\text{ is odd}\\k\le \lfloor n/d\rfloor }}\mu(k)g^2\left(\left\lfloor\frac{n}{dk}\right\rfloor\right)
\end{aligned}
\]</span> å…¶ä¸­ <span class="math inline">\(g(n)\)</span> è¡¨ç¤º <span class="math inline">\([1,n]\)</span> å†…å¥‡æ•°ä¸ªæ•°ï¼Œå…¶ç­‰äº <span class="math inline">\(\left\lfloor\dfrac{n+1}{2}\right\rfloor\)</span>ã€‚è®¾ <span class="math inline">\(f(d) = a^d\)</span>ï¼Œç„¶åå¯¹äºå³åŠè¾¹è¿™ä¸ªéƒ¨åˆ†ï¼Œä»¤ <span class="math display">\[
F(x) =\sum_{\substack{k\text{ is odd}\\k\le x }}\mu(k)g^2\left(\left\lfloor\frac{x}{k}\right\rfloor\right)
\]</span> åˆ™åŸå¼å°±æ˜¯ <span class="math display">\[
\sum_{d=1}^nf(d)F\left(\left\lfloor\frac{n}{d}\right\rfloor\right)
\]</span> ä¸€æ®µ <span class="math inline">\(f(d)\)</span> ä¹‹å’Œæ‹¿ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼éšä¾¿æ±‚ä¸€ä¸‹ï¼Œæ‰€ä»¥æœ€å¤–å±‚å¯ä»¥æ•´é™¤åˆ†å—ï¼Œè€Œè‹¥æˆ‘ä»¬å¯ä»¥å¿«é€Ÿç»´æŠ¤å¥‡æ•°ä½ç½®ä¸Šçš„ <span class="math inline">\(\mu\)</span> çš„å‰ç¼€å’Œï¼Œåˆ™ <span class="math inline">\(F(x)\)</span> ä¹Ÿæ˜¯å¯ä»¥æ•´é™¤åˆ†å—çš„ã€‚æ•´é™¤åˆ†å—å¥—æ•´é™¤åˆ†å—ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯ <span class="math inline">\(O(n^{3/4})\)</span> ä½†åº”è¯¥èƒ½è¿‡ã€‚ç­›å¥‡æ•°ä½ç½®ä¸Š <span class="math inline">\(\mu\)</span> çš„å‰ç¼€å’Œå¯ä»¥é€’å½’ã€‚</p>
<h2 id="å®éªŒèˆ±-7.26">å®éªŒèˆ± 7.26</h2>
<h3 id="a-çŒ«">A çŒ«</h3>
<p>åŸé¢˜ã€‚</p>
<h3 id="b-ç”Ÿæˆæ ‘">B ç”Ÿæˆæ ‘</h3>
<p>èŒèŒæ„é€ ï¼Œè€ƒè™‘è¿™æ ·ä¸€ä»¶äº‹ï¼šæˆ‘ä»¬è€ƒè™‘å°† <span class="math inline">\(1\sim n\)</span> è¿æˆä¸€ä¸ªç¯ï¼Œç„¶åéšä¾¿åˆ ä¸€æ¡è¾¹å³å¯å¾—åˆ°ä¸€æ£µç”Ÿæˆæ ‘ã€‚å¯¹äº <span class="math inline">\(u\)</span> è‹¥ <span class="math inline">\((u-1,u)\)</span> å’Œ <span class="math inline">\((u,u+1)\)</span> å¼‚è‰²ï¼Œåˆ™å°† <span class="math inline">\(u\)</span> åˆ æ‰ï¼Œå†æŠŠ <span class="math inline">\(u-1\)</span> å’Œ <span class="math inline">\(u+1\)</span> è¿èµ·æ¥ï¼Œå˜æˆä¸€ä¸ªå­é—®é¢˜ï¼Œæœ€åå†æŠŠ <span class="math inline">\(u\)</span> åŠ å›æ¥ã€‚</p>
<p>æ ˆç»´æŠ¤ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1"></a><span class="kw">using</span> ll = <span class="dt">long</span> <span class="dt">long</span>;</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="fl">5e5</span> + <span class="dv">5</span>;</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3"></a>unordered_map&lt;<span class="dt">int</span>, <span class="dt">int</span>&gt; G[maxn];</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4"></a>ll x, y, z, p[maxn];</span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5"></a><span class="dt">int</span> n, m;</span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6"></a></span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7"></a><span class="dt">int</span> query(<span class="dt">int</span> a, <span class="dt">int</span> b) {</span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8"></a>    <span class="cf">if</span> (G[a].count(b)) <span class="cf">return</span> G[a][b];</span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9"></a>    <span class="cf">else</span> <span class="cf">return</span> (min(a, b) * x + max(a, b) * y) % z &gt;= p[a] + p[b];</span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10"></a>}</span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11"></a></span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12"></a><span class="dt">int</span> main() {</span>
<span id="cb3-13"><a aria-hidden="true" href="#cb3-13"></a>    is &gt;&gt; n &gt;&gt; m;</span>
<span id="cb3-14"><a aria-hidden="true" href="#cb3-14"></a>    FOR(i, <span class="dv">1</span>, m) {</span>
<span id="cb3-15"><a aria-hidden="true" href="#cb3-15"></a>        <span class="dt">int</span> a, b, c; is &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span>
<span id="cb3-16"><a aria-hidden="true" href="#cb3-16"></a>        G[a][b] = G[b][a] = c;</span>
<span id="cb3-17"><a aria-hidden="true" href="#cb3-17"></a>    }</span>
<span id="cb3-18"><a aria-hidden="true" href="#cb3-18"></a>    is &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span>
<span id="cb3-19"><a aria-hidden="true" href="#cb3-19"></a>    FOR(i, <span class="dv">1</span>, n) is &gt;&gt; p[i];</span>
<span id="cb3-20"><a aria-hidden="true" href="#cb3-20"></a>    stack&lt;<span class="dt">int</span>&gt; stk;</span>
<span id="cb3-21"><a aria-hidden="true" href="#cb3-21"></a>    vector&lt;pair&lt;<span class="dt">int</span>, <span class="dt">int</span>&gt;&gt; ans[<span class="dv">2</span>];</span>
<span id="cb3-22"><a aria-hidden="true" href="#cb3-22"></a>    stk.push(<span class="dv">1</span>);</span>
<span id="cb3-23"><a aria-hidden="true" href="#cb3-23"></a>    <span class="dt">int</span> col = <span class="dv">0</span>;</span>
<span id="cb3-24"><a aria-hidden="true" href="#cb3-24"></a>    FOR(i, <span class="dv">2</span>, n) {</span>
<span id="cb3-25"><a aria-hidden="true" href="#cb3-25"></a>        <span class="cf">while</span> (!stk.empty()) {</span>
<span id="cb3-26"><a aria-hidden="true" href="#cb3-26"></a>            <span class="dt">int</span> u = stk.top();</span>
<span id="cb3-27"><a aria-hidden="true" href="#cb3-27"></a>            <span class="dt">int</span> c = query(u, i);</span>
<span id="cb3-28"><a aria-hidden="true" href="#cb3-28"></a>            ans[c].emplace_back(u, i);</span>
<span id="cb3-29"><a aria-hidden="true" href="#cb3-29"></a>            <span class="cf">if</span> (c ^ col) stk.pop();</span>
<span id="cb3-30"><a aria-hidden="true" href="#cb3-30"></a>            <span class="cf">else</span> <span class="cf">break</span>;</span>
<span id="cb3-31"><a aria-hidden="true" href="#cb3-31"></a>        }</span>
<span id="cb3-32"><a aria-hidden="true" href="#cb3-32"></a>        <span class="cf">if</span> (stk.empty()) col ^= <span class="dv">1</span>, stk.push(<span class="dv">1</span>);</span>
<span id="cb3-33"><a aria-hidden="true" href="#cb3-33"></a>        stk.push(i);</span>
<span id="cb3-34"><a aria-hidden="true" href="#cb3-34"></a>    }</span>
<span id="cb3-35"><a aria-hidden="true" href="#cb3-35"></a>    <span class="cf">if</span> (ans[col].size() != n - <span class="dv">1</span>) <span class="cf">return</span> os &lt;&lt; <span class="st">"No solution</span><span class="sc">\n</span><span class="st">"</span>, <span class="dv">0</span>;</span>
<span id="cb3-36"><a aria-hidden="true" href="#cb3-36"></a>    <span class="cf">else</span> {</span>
<span id="cb3-37"><a aria-hidden="true" href="#cb3-37"></a>        <span class="cf">for</span> (<span class="kw">auto</span> &amp;p : ans[col])</span>
<span id="cb3-38"><a aria-hidden="true" href="#cb3-38"></a>            os &lt;&lt; p.first &lt;&lt; <span class="ch">' '</span> &lt;&lt; p.second &lt;&lt; <span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span>;</span>
<span id="cb3-39"><a aria-hidden="true" href="#cb3-39"></a>    }</span>
<span id="cb3-40"><a aria-hidden="true" href="#cb3-40"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb3-41"><a aria-hidden="true" href="#cb3-41"></a>}</span></code></pre></div>
<h3 id="c-æ‰“åœ°é¼ ">C æ‰“åœ°é¼ </h3>
<p><span class="math inline">\(n\times m\)</span> çš„ç½‘æ ¼ã€‚ç»™å®šåœ°é¼ çš„åˆæ€å’Œç›®æ ‡æ€ã€‚æ‰“ä¸€æ¬¡åœ°é¼ ä¼šä½¿å¾—å…¶æœ¬èº«ç¼©å›å»ä½†æ˜¯åŒè¡ŒåŒåˆ—çš„éƒ½ä¼šå…¨éƒ¨å†’å‡ºæ¥ã€‚é—®åˆæ€èƒ½å¦åˆ°è¾¾ç›®æ ‡æ€ã€‚<span class="math inline">\(n,m\le 1000\)</span>ã€‚</p>
<p>æ­£ç€åšå¾ˆä¸å¥½åšï¼Œè€ƒè™‘å€’ç€åšã€‚</p>
<p>ä»¤é»‘è‰²è¡¨ç¤ºç¼©ä¸‹å»ï¼Œç™½è‰²è¡¨ç¤ºå‡ºå¤´ã€‚æ­£ç€çš„æ¯æ¬¡æ“ä½œç›¸å½“äºæ¯æ¬¡é€‰ä¸€ä¸ªç™½çš„å˜é»‘ï¼Œç„¶åå°†æ•´è¡Œæ•´åˆ—å˜ç™½ã€‚</p>
<p>è€Œå€’ç€åšçš„è¯å¯ä»¥è€ƒè™‘ä»¤ç°è‰²ä¸ºå¯èƒ½ç¼©ä¸‹å»å¯èƒ½å‡ºå¤´ã€‚</p>
<p>æ“ä½œå˜æˆé€‰ä¸€ä¸ªé»‘è‰²æˆ–ç°è‰²çš„ï¼Œæ»¡è¶³<strong>è¿™è¡Œè¿™åˆ—é™¤äº†å®ƒæ²¡æœ‰é»‘è‰²</strong>ï¼Œç„¶åæŠŠå®ƒå˜ç™½ç„¶åæ•´è¡Œæ•´åˆ—å˜ç°ã€‚</p>
<h2 id="å®éªŒèˆ±-7.27">å®éªŒèˆ± 7.27</h2>
<h3 id="b-mirror">B mirror</h3>
<p>é¦–å…ˆ Mirror åºåˆ—ä¹Ÿä¸è¿‡æ˜¯è‹¥å¹²ä¸ªäºŒå…ƒç¯å’Œè‡ªç¯æ‹¼æ¥åœ¨ä¸€èµ·çš„ç»“æ„ã€‚</p>
<p>ç»“è®ºï¼šè‹¥ <span class="math inline">\(b\)</span> ä¸º <span class="math inline">\(a\)</span> çš„å­åºåˆ—ï¼Œåˆ™ <span class="math inline">\(\forall i &lt; j\)</span> æœ‰ <span class="math inline">\(a_{b_i}&lt;a_{b_j}\)</span>ã€‚</p>
<p>è¯æ˜ï¼šä»¤ <span class="math inline">\(a_u = b_i\)</span>ï¼Œ<span class="math inline">\(a_v = b_j\)</span>ï¼Œä¸€å®šæœ‰ <span class="math inline">\(u&lt;v\)</span>ï¼Œè€Œ <span class="math inline">\(a_{b_i} = u, a_{b_j}=v\)</span>ï¼Œæ‰€ä»¥ <span class="math inline">\(a_{b_i}&lt;a_{b_j}\)</span>ã€‚</p>
<p>æ‰€ä»¥è¿™ä¸ªå–å€¼æœ‰å•è°ƒæ€§ä»€ä¹ˆçš„ï¼Œæšä¸¾ <span class="math inline">\(0\le k\le m\)</span>ï¼Œå¼ºåˆ¶å¯¹äº <span class="math inline">\(i\le k\)</span> æ»¡è¶³ <span class="math inline">\(a_{b_i}\le m\)</span>ï¼Œä¸”å¯¹äº <span class="math inline">\(i&gt;k\)</span> æ»¡è¶³ <span class="math inline">\(a_{b_i}&gt;m\)</span>ã€‚</p>
<ul>
<li><p>è€ƒè™‘ <span class="math inline">\(i\le k\)</span> çš„ <span class="math inline">\(a_{b_i}\)</span>ï¼Œæœ‰ <span class="math inline">\(a_{b_i}\le m\)</span>ã€‚</p>
<p>ç”±äºå¯¹äº <span class="math inline">\(i&gt;k\)</span> æ»¡è¶³ <span class="math inline">\(a_{b_i}&gt;m\)</span>ï¼Œæ‰€ä»¥å¯¹ <span class="math inline">\(i\le k\)</span>ï¼Œ<span class="math inline">\(a_{b_i}\)</span> çš„å–å€¼å¿…é¡»åœ¨ <span class="math inline">\(b_j~(j\le k)\)</span> é‡Œé¢ã€‚</p>
<p>å¡«å†™æ–¹å¼æ˜¯å”¯ä¸€çš„ï¼Œæš´åŠ›åˆ¤ä¸€ä¸‹å³å¯ã€‚</p></li>
<li><p>è€ƒè™‘ <span class="math inline">\(i&gt;k\)</span> çš„ <span class="math inline">\(a_{b_i}\)</span>ï¼Œæœ‰ <span class="math inline">\(a_{b_i}&gt; m\)</span>ã€‚</p>
<p>å› ä¸ºå¯¹äº <span class="math inline">\(i&lt;j\)</span> æœ‰ <span class="math inline">\(a_{b_i}&lt;a_{b_j}\)</span>ï¼Œæ‰€ä»¥å¡«å†™æ–¹å¼ä¸º <span class="math inline">\(\dbinom{n-m}{m-k}\)</span>ã€‚å³è¿™äº›æ˜¯å‰ <span class="math inline">\(m\)</span> ä¸ªé‡Œé¢å’Œåé¢æœ‰â€œäº¤æ¢â€çš„ã€‚</p></li>
<li><p>è€ƒè™‘ <span class="math inline">\(i&gt;m\)</span> ä¸” <span class="math inline">\(a_i&gt;m\)</span> çš„ä½ç½®ï¼Œæœ‰ <span class="math inline">\(n-2m+k\)</span> ä¸ªã€‚</p>
<p>ç­”æ¡ˆä¹‹å’Œä½ç½®æœ‰å…³ï¼Œdp ä¸€éå¯ä»¥å¼„å‡ºæ¥ <span class="math inline">\(f_n = f_{n-1} + (n-1)f_{n-2}\)</span>ã€‚</p></li>
</ul>
<p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n+m^2)\)</span>ã€‚</p>
<h2 id="å®éªŒèˆ±-7.28">å®éªŒèˆ± 7.28</h2>
<h3 id="b-graph">B Graph</h3>
<p>è½¬åŒ–æˆè‹¥å¹²å½¢å¦‚ <span class="math inline">\(x_i+x_j = z_{i,j}'\)</span>ï¼Œ<span class="math inline">\(x_i\le p_i\)</span> çš„é™åˆ¶ã€‚</p>
<p>ç°åœ¨å°±æ˜¯è¦åˆ†åˆ«æœ€å°åŒ–å’Œæœ€å¤§åŒ– <span class="math inline">\(\sum x_i\)</span>ã€‚è¿™å°¼ç›æ˜¯ä¸æ˜¯å¯ä»¥è½¬åŒ–æˆå·®åˆ†çº¦æŸï¼Ÿ</p>
<p>ä¼šå‘ç°å¦‚æœæˆ‘ä»¬é’¦å®šäº†ä¸€ä¸ª <span class="math inline">\(x_u\)</span> çš„å€¼ä¹‹åï¼Œå‰©ä¸‹çš„éƒ½ä¼šå˜æˆå…³äº <span class="math inline">\(x_u\)</span> çš„ä¸€æ¬¡å‡½æ•°è¡¨è¾¾å¼ï¼Œè¿™ä¸ªåœ¨æŸä¸ªè¿é€šå—å†…å¯ä»¥éšç¼˜é¢„å¤„ç†ä¸€ä¸‹ã€‚</p>
<h3 id="c-æ ‘">C æ ‘</h3>
<p>ç»™ä½ ä¸€æ£µ <span class="math inline">\(n\le 2000\)</span> ä¸ªç‚¹çš„æ ‘ <span class="math inline">\(A\)</span>ï¼Œ<span class="math inline">\(t\le 10000\)</span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™ä½ ä¸€æ£µ <span class="math inline">\(m\le 12\)</span> ä¸ªç‚¹çš„æ ‘ <span class="math inline">\(B\)</span>ï¼Œé—®æœ‰å¤šå°‘ä¸ª <span class="math inline">\(A\)</span> çš„è¿é€šå­å›¾å’Œ<span class="math inline">\(B\)</span> åŒæ„ï¼Œç­”æ¡ˆå¯¹ <span class="math inline">\(10^9+7\)</span> å–æ¨¡ã€‚</p>
<p>é¦–å…ˆ <span class="math inline">\(12\)</span> ä¸ªç‚¹çš„æ— æ ‡å·æœ‰æ ¹æ ‘åªæœ‰ä¸åˆ° <span class="math inline">\(8000\)</span> æ£µï¼Œæƒ³åˆ°å¯ä»¥ä½¿ç”¨æ ‘å“ˆå¸Œè¿›è¡Œå¤„ç†ã€‚å…ˆé¢„å¤„ç†å‡ºæ‰€æœ‰çš„æ— æ ‡å·æœ‰æ ¹æ ‘ï¼Œå³è€ƒè™‘å°†å¶å­æ¥åˆ°ä¹‹å‰çš„æ ‘ä¸Šç„¶åå“ˆå¸Œå»é‡ã€‚ä¹‹åå¤„ç†å‡º <span class="math inline">\(tr_{i,j}\)</span> è¡¨ç¤ºå°† <span class="math inline">\(j\)</span> æ ‘æ¥åˆ° <span class="math inline">\(i\)</span> çš„æ ¹ä¸Šåå¾—åˆ°å“ªæ£µæ ‘ï¼Œç”±äº <span class="math inline">\(|i| + |j|\le 12\)</span> æ‰€ä»¥å¤§æ¦‚ä¹Ÿåªæœ‰ <span class="math inline">\(10000\)</span> æ¥å¯¹è¿™æ ·çš„å…³ç³»ã€‚</p>
<p>äºæ˜¯å¯ä»¥é¢„å¤„ç†ä¸€ä¸‹ <span class="math inline">\(f_{u, i}\)</span> è¡¨ç¤º <span class="math inline">\(A\)</span> çš„ <span class="math inline">\(u\)</span> å­æ ‘ä¸­æŠ½å‡ºæ ‘ <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œè¿™ä¸ªå¯ä»¥å¾ˆå®¹æ˜“çš„ dpã€‚ç„¶åå¯¹äºæ¯ä¸ªè¯¢é—®çš„ <span class="math inline">\(B\)</span>ï¼Œæšä¸¾æ ¹å¹¶å»é‡ï¼Œç„¶åå¯¹æ¯ä¸ªå¾—åˆ°çš„æ ‘ <span class="math inline">\(i\)</span> æ±‚ <span class="math inline">\(\sum_u f_{u, i}\)</span> å†åŠ åœ¨ä¸€èµ·å³å¯ã€‚</p>
<p>æ ‘å“ˆå¸Œè°ƒæ­»æˆ‘äº†ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰é—®é¢˜ã€‚æœ€å°è¡¨ç¤ºæ³•æ‰æ­£ç¡®ï¼Œä½†æ˜¯å–œææœ€åŠ£è§£ã€‚</p>
<h2 id="å®éªŒèˆ±-7.30">å®éªŒèˆ± 7.30</h2>
<h3 id="a.-é™¶æ£®ç‰¹çš„å®éªŒå®¤">A. é™¶æ£®ç‰¹çš„å®éªŒå®¤</h3>
<p>é¦–å…ˆåº”è¯¥å¯ä»¥è·‘ä¸€ä¸ªè¾¹åŒç¼©ç‚¹ï¼Œå› ä¸ºæ˜¾ç„¶åªæœ‰å‰²äº†æ¡¥ä¹‹åæ‰å¯èƒ½å‡ºç°é—®é¢˜ã€‚ç„¶åå¯¹äºæ¯ä¸ªè¿é€šå—ï¼ˆæ ‘ï¼‰æ¥è€ƒè™‘ã€‚</p>
<p>è®¾ <span class="math inline">\(f_{i,j}\)</span> ä¸º <span class="math inline">\(i\)</span> å­æ ‘å†…é¢œè‰² <span class="math inline">\(j\)</span> çš„ä¸ªæ•°ï¼Œéšä¾¿æ¨ä¸€ä¸‹å¯ä»¥æ¨å‡ºæ¥ï¼Œç„¶åæ±‚å‡º <span class="math inline">\(f_{1,\cdots}\)</span> ååº”è¯¥æ˜¯å¯ä»¥æ±‚å‡º <span class="math inline">\(g_{i,\cdots}\)</span> è¡¨ç¤ºå­æ ‘å¤–çš„ã€‚</p>
<p>å‘ç°æˆ‘ä»¬è¦æ–­å¼€ä¸€æ¡è¾¹ï¼Œç„¶åå– <span class="math inline">\(\max_i\{f_{u,i}\} + \max_i\{g_{u,i}\}\)</span>ã€‚è¿™ä¸ªä¸œè¥¿ä¸æ˜¯å¾ˆçŸ¥é“å¯ä»¥æ€ä¹ˆå¤„ç†å•Šã€‚ã€‚ã€‚</p>
<p>å¥½å“¦ï¼Œæœ€åæ˜¯ dsu on treeã€‚å¤šæµ‹å‡ºé¢˜äººæˆ‘ç¥ä½ å…¨å®¶å¥åº·ã€‚</p>
<h3 id="b.-è¯ºç»´æ ¼ç‘çš„è¡—é“">B. è¯ºç»´æ ¼ç‘çš„è¡—é“</h3>
<p>é¢˜æ„ï¼šç»™å®šè‹¥å¹²ç‚¹åˆ° <span class="math inline">\((0,0)\)</span> çš„æ¬§æ°è·ç¦» <span class="math inline">\(e_i\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(e_i\le e_{i+1}\)</span>ã€‚è¦æ±‚æ„é€ ä¸€ç»„æ–¹æ¡ˆï¼Œä½¿å¾—å…¶æ›¼å“ˆé¡¿è·ç¦» <span class="math inline">\(t_i\)</span> çš„åºåˆ—ä¸­é€†åºå¯¹æ•°é‡æœ€å¤§ã€‚</p>
<p>é¦–å…ˆæ˜¾ç„¶ <span class="math inline">\(e_i\le t_i\le \sqrt 2e_i\)</span>ã€‚ç„¶åç”±è°ƒæ•´æ³•å¯ä»¥è¯æ˜æœ€ä¼˜ç­”æ¡ˆä¸­çš„ <span class="math inline">\(t_i\)</span> ä¸€å®šå‘ˆè‹¥å¹²ä¸‹é™çš„æ®µã€‚å³åœ¨å„è‡ªæ®µå†… <span class="math inline">\(t_i&gt;t_{i+1}\)</span>ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥æä¸€ä¸ª dpï¼š<span class="math inline">\(f_i\)</span> è¡¨ç¤º <span class="math inline">\([1,i]\)</span> çš„ç­”æ¡ˆã€‚è½¬ç§»ï¼š <span class="math display">\[
f_i = \max_{e_i&lt;\sqrt2e_{j+1}}\left\{f_j + \dfrac{(i-j)(i-j-1)}{2}\right\}
\]</span> åŒ–ç®€ä¸€ä¸‹å¼å­å¾—åˆ° <span class="math display">\[
\begin{aligned}
f_i &amp;= f_j + \dfrac{i^2-ij-i - ij + j^2 + j}{2}\\
f_i &amp;= f_j + \frac{j^2 + j}{2} - i\times j + \frac{i^2 - i}{2}
\end{aligned}
\]</span> æ–œç‡ä¸º <span class="math inline">\(-j\)</span>ï¼Œæˆªè·ä¸º <span class="math inline">\(f_j + \dfrac{j^2 + j}{2}\)</span>ï¼Œæ–œç‡ä¼˜åŒ–ã€‚ä½†æ˜¯æˆ‘å¥½åƒä¸æ˜¯å¾ˆä¼šè¿™ç§ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>çº¿æ®µæ ‘å¥—æè¶…æ ‘å†™å¥½äº†ä»–å‘Šè¯‰æˆ‘è¿‡ä¸å»ï¼Œæˆ‘æŠ•é™æˆ‘æŠ•é™ã€‚cdq åˆ†æ²»çš„é‚£ç§çœŸçš„ä¸ä¼šå†™å•Šï¼Ÿæˆ‘åäº†ã€‚è€ƒè™‘æœ¬æ ¼æ–œç‡ä¼˜åŒ–å§ã€‚æŒ‰é‚£ç§ cdq åˆ†æ²»çš„è½¬ç§»æ–¹æ³•ã€‚ä¸‹é¢å‡è®¾ <span class="math inline">\(j &lt; k\)</span> ä¸” <span class="math inline">\(j\)</span> <span class="math display">\[
\begin{aligned}
f_j + \frac{j(j+1)}{2} - ij &amp;&gt; f_k + \frac{k(k+1)}{2} - ik\\
i(k - j)  &amp;&gt; f_k + \frac{k(k+1)}{2} - f_j - \frac{j(j+1)}{2}\\
i &amp;&gt; \frac{Y(k) - Y(j)}{X(k) - X(j)}
\end{aligned}
\]</span> äºæ˜¯ç±»ä¼¼ cdq çŠ¶è½¬ç§»å³å¯</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1"></a><span class="dt">void</span> solve(<span class="dt">int</span> l, <span class="dt">int</span> r) {</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2"></a>    <span class="cf">if</span> (l == r) {</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3"></a>        h[l] = f[l] + l * (l + <span class="dv">1</span><span class="bu">ll</span>) / <span class="dv">2</span>;</span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4"></a>        <span class="cf">return</span>;</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5"></a>    }</span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6"></a>    <span class="dt">int</span> mid = (l + r) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb4-7"><a aria-hidden="true" href="#cb4-7"></a>    solve(l, mid);</span>
<span id="cb4-8"><a aria-hidden="true" href="#cb4-8"></a>    top = <span class="dv">0</span>;</span>
<span id="cb4-9"><a aria-hidden="true" href="#cb4-9"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = r, p = mid; i &gt; mid; --i) {</span>
<span id="cb4-10"><a aria-hidden="true" href="#cb4-10"></a>        <span class="cf">for</span> (; p &gt;= l &amp;&amp; <span class="dv">2</span> * e[p + <span class="dv">1</span>] &gt; e[i]; --p) {</span>
<span id="cb4-11"><a aria-hidden="true" href="#cb4-11"></a>            pll c = {p, h[p]};</span>
<span id="cb4-12"><a aria-hidden="true" href="#cb4-12"></a>            <span class="cf">while</span> (top &gt; <span class="dv">1</span> &amp;&amp; slope(stk[top - <span class="dv">1</span>], stk[top]) &gt;= slope(stk[top - <span class="dv">1</span>], c)) --top;</span>
<span id="cb4-13"><a aria-hidden="true" href="#cb4-13"></a>            stk[++top] = c;</span>
<span id="cb4-14"><a aria-hidden="true" href="#cb4-14"></a>        }</span>
<span id="cb4-15"><a aria-hidden="true" href="#cb4-15"></a>        <span class="cf">while</span> (top &gt; <span class="dv">1</span> &amp;&amp; slope(stk[top - <span class="dv">1</span>], stk[top]) &gt;= i) --top;</span>
<span id="cb4-16"><a aria-hidden="true" href="#cb4-16"></a>        <span class="cf">if</span> (top) {</span>
<span id="cb4-17"><a aria-hidden="true" href="#cb4-17"></a>            <span class="dt">int</span> j = stk[top].first;</span>
<span id="cb4-18"><a aria-hidden="true" href="#cb4-18"></a>            chkmax(f[i], f[j] + (i - j) * (i - j - <span class="dv">1</span><span class="bu">ll</span>) / <span class="dv">2</span>);</span>
<span id="cb4-19"><a aria-hidden="true" href="#cb4-19"></a>        }</span>
<span id="cb4-20"><a aria-hidden="true" href="#cb4-20"></a>    }</span>
<span id="cb4-21"><a aria-hidden="true" href="#cb4-21"></a>    solve(mid + <span class="dv">1</span>, r);</span>
<span id="cb4-22"><a aria-hidden="true" href="#cb4-22"></a>    <span class="cf">return</span>;</span>
<span id="cb4-23"><a aria-hidden="true" href="#cb4-23"></a>}</span></code></pre></div>
<h2 id="å®éªŒèˆ±-7.31">å®éªŒèˆ± 7.31</h2>
<h3 id="a.-æ›¿æ¢æ’åº">A. æ›¿æ¢æ’åº</h3>
<p>é¦–å…ˆå°†ä¸¤ä¸ªæ•°ç»„ä¸€èµ·ç¦»æ•£åŒ–ä¹‹åå¯ä»¥ç¼–å‡ºè¿™æ ·çš„åšæ³•ï¼š</p>
<p>è®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºå°† <span class="math inline">\([1,i]\)</span> å¼„æˆç»“å°¾ä¸º <span class="math inline">\(j\)</span> çš„åºåˆ—çš„æœ€å°ä»£ä»·ï¼Œç„¶åè½¬ç§»å°±å¾ˆè ¢ï¼Œè€ƒè™‘ä¸€ä¸‹ä¸Šä¸€ä¸ªè½¬ç§»ä½ç½® <span class="math inline">\(k\)</span>ï¼š <span class="math display">\[
f_{i,x} = \min_{\substack{y&lt;x, j&lt;i\\\sum\limits_{k=j+1}^i[a_k\ne x]\le cnt_a}}\left\{ f_{j, y} + \sum_{k=j+1}^i[a_k\ne x]\right\}
\]</span> è¿™ä¸ªä¸œè¥¿æˆ‘ä¹Ÿä¸æ˜¯å¾ˆçŸ¥é“æ€ä¹ˆä¼˜åŒ–äº†ã€‚ã€‚ã€‚å…ˆå†™å†™çœ‹å§ã€‚å¦ˆçš„éš”å£ï¼Œ<span class="math inline">\(O(n^4)\)</span> çš„ï¼Œæ‰“ä¸ªé”¤å­ã€‚</p>
<h2 id="å®éªŒèˆ±-8.3">å®éªŒèˆ± 8.3</h2>
<h3 id="a-stone">A stone</h3>
<p>Alice å’Œ Bob å– <span class="math inline">\(n\)</span> å †çŸ³å­ï¼Œæ¯æ¬¡å¯ä»¥å– <span class="math inline">\([a,b]\)</span> ä¸ªã€‚æ— æ³•å–çš„äººè´¥ï¼Œç‰¹åˆ«åœ°è‹¥ä¸€ä¸ªäººç›´æ¥å–å®Œäº†æŸå †çŸ³å­é‚£ä¹ˆå°±ç›´æ¥èµ¢äº†ã€‚</p>
<p>ä¸»è¦è€ƒè™‘åˆ° <span class="math inline">\(\exist x_i\in[a,b]\)</span> çš„æ—¶å€™ Alice å¿…èƒœï¼Œç„¶åè€ƒè™‘æŠŠè¿™äº›çŠ¶æ€ä»å›¾ä¸Šåˆ æ‰æ¥è·‘ SG å‡½æ•°ï¼Œè·‘å‡ºæ¥çš„æ€§è´¨æ¯”è¾ƒçš„å¥½ï¼Œæ‰“è¡¨æ‰¾è§„å¾‹å³å¯ã€‚</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="dv">2005</span>;</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2"></a><span class="dt">int</span> n, a, b, x[maxn];</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3"></a></span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4"></a><span class="dt">int</span> calc(<span class="dt">int</span> x) {</span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5"></a>    <span class="cf">if</span> (x &lt;= a - <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6"></a>    <span class="cf">else</span> <span class="cf">if</span> (a == <span class="dv">1</span>) <span class="cf">return</span> x % (a + b);</span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7"></a>    <span class="cf">if</span> (x &lt;= b) <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8"></a>    x = ((x - b) % (a + b)) / a;</span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9"></a>    <span class="cf">if</span> (x &lt;= <span class="dv">1</span>) <span class="cf">return</span> x ^ <span class="dv">1</span>;</span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10"></a>    <span class="cf">return</span> x;</span>
<span id="cb5-11"><a aria-hidden="true" href="#cb5-11"></a>}</span>
<span id="cb5-12"><a aria-hidden="true" href="#cb5-12"></a></span>
<span id="cb5-13"><a aria-hidden="true" href="#cb5-13"></a><span class="dt">int</span> main() {</span>
<span id="cb5-14"><a aria-hidden="true" href="#cb5-14"></a>    <span class="dt">int</span> T; cin &gt;&gt; T;</span>
<span id="cb5-15"><a aria-hidden="true" href="#cb5-15"></a>    <span class="cf">while</span> (T--) {</span>
<span id="cb5-16"><a aria-hidden="true" href="#cb5-16"></a>        cin &gt;&gt; n &gt;&gt; a &gt;&gt; b;</span>
<span id="cb5-17"><a aria-hidden="true" href="#cb5-17"></a>        FOR(i, <span class="dv">1</span>, n) cin &gt;&gt; x[i];</span>
<span id="cb5-18"><a aria-hidden="true" href="#cb5-18"></a>        <span class="dt">bool</span> flg = <span class="dv">0</span>;</span>
<span id="cb5-19"><a aria-hidden="true" href="#cb5-19"></a>        FOR(i, <span class="dv">1</span>, n) flg |= (a &lt;= x[i] &amp;&amp; x[i] &lt;= b);</span>
<span id="cb5-20"><a aria-hidden="true" href="#cb5-20"></a>        <span class="cf">if</span> (flg) {</span>
<span id="cb5-21"><a aria-hidden="true" href="#cb5-21"></a>            puts(<span class="st">"Alice"</span>);</span>
<span id="cb5-22"><a aria-hidden="true" href="#cb5-22"></a>            <span class="cf">continue</span>;</span>
<span id="cb5-23"><a aria-hidden="true" href="#cb5-23"></a>        }</span>
<span id="cb5-24"><a aria-hidden="true" href="#cb5-24"></a>        <span class="dt">int</span> sg = <span class="dv">0</span>;</span>
<span id="cb5-25"><a aria-hidden="true" href="#cb5-25"></a>        FOR(i, <span class="dv">1</span>, n) sg ^= calc(x[i]);</span>
<span id="cb5-26"><a aria-hidden="true" href="#cb5-26"></a>        puts(sg ? <span class="st">"Alice"</span> : <span class="st">"Bob"</span>);</span>
<span id="cb5-27"><a aria-hidden="true" href="#cb5-27"></a>    }</span>
<span id="cb5-28"><a aria-hidden="true" href="#cb5-28"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb5-29"><a aria-hidden="true" href="#cb5-29"></a>}</span></code></pre></div>
<h3 id="c-tree">C tree</h3>
<p>ç»™å®š <span class="math inline">\(n\le 10^5\)</span> çš„æ ‘ï¼Œæ ‘å¸¦è¾¹æƒï¼Œé—®æœ‰å¤šå°‘æ¡è·¯å¾„æ»¡è¶³è·¯å¾„ä¸Šè¾¹æƒçš„ <span class="math inline">\(\gcd = 1\)</span>ã€‚åŒæ—¶ä¼šæœ‰ <span class="math inline">\(q\le 100\)</span> æ¬¡å•ç‚¹ä¿®æ”¹ï¼Œå€¼åŸŸ <span class="math inline">\(10^6\)</span>ã€‚</p>
<p>æ²¡æƒ³åˆ°å¯ä»¥è«åçº¯è„‘ç˜«äº†é‚£å°±æ˜¯ã€‚</p>
<p>ç»Ÿè®¡ <span class="math display">\[
\sum_{w}[\gcd w = 1] = \sum_{d}\mu(d)\sum_{w}[d\mid \gcd w]
\]</span> é¦–å…ˆç”±äºæœ‰å¹³æ–¹å› å­çš„ <span class="math inline">\(\mu\)</span> éƒ½æ˜¯ <span class="math inline">\(0\)</span>ï¼Œè¿™æ ·å­æšä¸¾é‡ç›´æ¥é™åˆ° <span class="math inline">\(O(2^c)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(c = 7\)</span>ã€‚</p>
<p>ç„¶åå¯¹äºä¸å¸¦ä¿®çš„æƒ…å†µå°±æ˜¯æšä¸¾äº† <span class="math inline">\(d\)</span> ä¹‹åæŠŠ <span class="math inline">\(d\)</span> çš„å€æ•°çš„è¾¹å…¨éƒ¨åŠ è¿›å¹¶æŸ¥é›†é‡Œé¢ç„¶åæŒ¨ä¸ªè¿é€šå—ç®—è´¡çŒ®äº†ã€‚</p>
<p>ç°åœ¨å¸¦ä¸Šä¿®æ”¹ï¼Œç”±äº <span class="math inline">\(q\)</span> å¾ˆå°ï¼Œæ‰€ä»¥ç›´æ¥å…ˆä¸ç®¡è¿™ <span class="math inline">\(O(q)\)</span> æ¡æ¶‰åŠåˆ°ä¿®æ”¹äº†çš„è¾¹ï¼ŒæŠŠä¹‹å‰çš„çŠ¶æ€å¤„ç†å¥½ï¼ŒåŠ è¿›å» <span class="math inline">\(O(q)\)</span> æ¡è¾¹å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(L + 2^c(n + q^2)\log n)\)</span>ã€‚åˆ©ç”¨çº¿æ®µæ ‘åˆ†æ²»å¯ä»¥åšåˆ° <span class="math inline">\(n,q\)</span> åŒé˜¶çš„æƒ…å†µï¼Œå³ç›´æ¥å…³äºæ—¶é—´åˆ†æ²»å°±è¡Œã€‚</p>
<p>å®é™…ä¸Šæˆ‘å†™äº†çº¿æ®µæ ‘åˆ†æ²»ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯ <span class="math inline">\(O(L + 2^c(n + q)\log n)\)</span>ã€‚</p>
<h2 id="å®éªŒèˆ±-8.10">å®éªŒèˆ± 8.10</h2>
<p>60 + 100 + 0ã€‚è®¡ç®—å‡ ä½•ä¸æƒ³å»è¡¥ã€‚</p>
<h3 id="c-å•†åº—">C å•†åº—</h3>
<p>æ ‘ä¸Šæ¯ä¸ªç‚¹çš„ç‚¹æƒä¸ºæ ‡å·ï¼ˆ<span class="math inline">\(0\sim n - 1\)</span>ï¼‰ï¼Œæœ‰ <span class="math inline">\(m\)</span> ä¸ªäººï¼Œåˆ†åˆ«åœ¨ç‚¹ <span class="math inline">\(c_i\)</span> ä¸Šï¼ˆå¯ä»¥ç›¸åŒï¼‰ã€‚æ¯ä¸ªäººå¯ä»¥å–å­æ ‘å†…ä¸€ä¸ªç‚¹ï¼Œè¦æ±‚æ€»ç‚¹æƒæœ€å¤§ï¼ˆä¸èƒ½é‡å¤é€‰ï¼‰ã€‚</p>
<p>äº‹å®ä¸Šå°±æ˜¯è´ªå¿ƒï¼Œè€ƒè™‘ä» <span class="math inline">\(n - 1\)</span> å¼€å§‹å€’åºéå†ï¼Œæ¯æ¬¡é…å¯¹ä¸€ä¸ªæ·±åº¦æœ€ä½çš„äººã€‚çº¿æ®µæ ‘ä¸å¤ªè¿‡å¾—å»ï¼Œå†™ä¸ªå¹¶æŸ¥é›†æ‰èƒ½è¿‡ã€‚</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1"></a><span class="dt">int</span> fa[maxn], n, m, c[maxn], p[maxn];</span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2"></a></span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3"></a><span class="dt">int</span> find(<span class="dt">int</span> x) {<span class="cf">return</span> x == fa[x] ? x : fa[x] = find(fa[x]);}</span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4"></a></span>
<span id="cb6-5"><a aria-hidden="true" href="#cb6-5"></a><span class="dt">int</span> main() {</span>
<span id="cb6-6"><a aria-hidden="true" href="#cb6-6"></a>    is &gt;&gt; n &gt;&gt; m;</span>
<span id="cb6-7"><a aria-hidden="true" href="#cb6-7"></a>    FOR(i, <span class="dv">1</span>, n - <span class="dv">1</span>) {</span>
<span id="cb6-8"><a aria-hidden="true" href="#cb6-8"></a>        is &gt;&gt; p[i];</span>
<span id="cb6-9"><a aria-hidden="true" href="#cb6-9"></a>        fa[i] = i;</span>
<span id="cb6-10"><a aria-hidden="true" href="#cb6-10"></a>    }</span>
<span id="cb6-11"><a aria-hidden="true" href="#cb6-11"></a>    FOR(i, <span class="dv">1</span>, m) {</span>
<span id="cb6-12"><a aria-hidden="true" href="#cb6-12"></a>        <span class="dt">int</span> x; is &gt;&gt; x;</span>
<span id="cb6-13"><a aria-hidden="true" href="#cb6-13"></a>        ++c[x];</span>
<span id="cb6-14"><a aria-hidden="true" href="#cb6-14"></a>    }</span>
<span id="cb6-15"><a aria-hidden="true" href="#cb6-15"></a>    ll ans = <span class="dv">0</span>;</span>
<span id="cb6-16"><a aria-hidden="true" href="#cb6-16"></a>    DEC(i, n - <span class="dv">1</span>, <span class="dv">1</span>) {</span>
<span id="cb6-17"><a aria-hidden="true" href="#cb6-17"></a>        <span class="dt">int</span> x = i;</span>
<span id="cb6-18"><a aria-hidden="true" href="#cb6-18"></a>        <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb6-19"><a aria-hidden="true" href="#cb6-19"></a>            x = find(i);</span>
<span id="cb6-20"><a aria-hidden="true" href="#cb6-20"></a>            <span class="cf">if</span> (c[x]) {</span>
<span id="cb6-21"><a aria-hidden="true" href="#cb6-21"></a>                --c[x];</span>
<span id="cb6-22"><a aria-hidden="true" href="#cb6-22"></a>                ans += i;</span>
<span id="cb6-23"><a aria-hidden="true" href="#cb6-23"></a>                <span class="cf">break</span>;</span>
<span id="cb6-24"><a aria-hidden="true" href="#cb6-24"></a>            }</span>
<span id="cb6-25"><a aria-hidden="true" href="#cb6-25"></a>            <span class="cf">if</span> (!x) <span class="cf">break</span>;</span>
<span id="cb6-26"><a aria-hidden="true" href="#cb6-26"></a>            fa[x] = p[x];</span>
<span id="cb6-27"><a aria-hidden="true" href="#cb6-27"></a>        }</span>
<span id="cb6-28"><a aria-hidden="true" href="#cb6-28"></a>    }</span>
<span id="cb6-29"><a aria-hidden="true" href="#cb6-29"></a>    os &lt;&lt; ans &lt;&lt; <span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span>;</span>
<span id="cb6-30"><a aria-hidden="true" href="#cb6-30"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb6-31"><a aria-hidden="true" href="#cb6-31"></a>}</span></code></pre></div>
<h3 id="a-nim">A nim</h3>
<p>ä»ä¸€ä¸ªæ•°åˆ—ä¸­åˆ æ‰æœ€å°‘çš„æ•°ä½¿å¾—å¼‚æˆ–å’Œä¸º <span class="math inline">\(0\)</span>ã€‚</p>
<p>å®é™…ä¸Šå°±æ˜¯é€‰æœ€å°‘çš„æ•°ä½¿å¾—å¼‚æˆ–å’Œä¸ºåŸåºåˆ—çš„å¼‚æˆ–å’Œ <span class="math inline">\(s\)</span>ã€‚æ ¹æ®çº¿æ€§åŸºå‘ç°è¿™ä¸ªä¸Šç•Œæ˜¯ <span class="math inline">\(\log s\)</span> çš„ï¼Œæ‰€ä»¥å¯ä»¥æšä¸¾ç­”æ¡ˆæ¥ç®—ã€‚</p>
<p>æä¸€ä¸ªé›†åˆå¹‚çº§æ•°å‡ºæ¥ï¼Œå¼‚æˆ–å·ç§¯çš„ <span class="math inline">\(k\)</span> æ¬¡æ–¹ï¼Œ<span class="math inline">\(i\)</span> ä¸Šæœ‰å€¼è¯´æ˜ <span class="math inline">\(k\)</span> ä¸ªå…ƒç´ å¯ä»¥å‡‘å‡º <span class="math inline">\(i\)</span>ã€‚ç„¶åå°±æœ‰ <span class="math inline">\(O(n\log^2 n)\)</span> åšæ³•äº†ï¼Œå¯è¿‡ã€‚</p>
<p>å¾€é›†åˆå¹‚çº§æ•°é‡Œé¢åŠ ä¸€ä¸ª <span class="math inline">\(x^0\)</span>ï¼Œç„¶åå˜å¾—æœ‰å¯äºŒåˆ†æ€§ï¼Œ<span class="math inline">\(O(n\log n\log\log n)\)</span>ã€‚</p>
<p>å½“ç„¶ç”±äº IFWT åªç”¨ç®—ä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥ <span class="math inline">\(O(n\log n)\)</span>ã€‚</p>
<h2 id="å®éªŒèˆ±-8.11">å®éªŒèˆ± 8.11</h2>
<p>100 + 50 + 0ã€‚æœ€å T2 è°ƒå‡ºæ¥äº† 50pts å¾ˆæé™ï¼ŒT3 æš´åŠ›æ‡’å¾—æ‰“äº†ã€‚</p>
<h3 id="b-å½’å¹¶">B å½’å¹¶</h3>
<p>ç»™å®šä¸€ä¸ªæ’åˆ— <span class="math inline">\(a\)</span>ï¼Œä¸¤ç§æ“ä½œï¼š</p>
<ul>
<li><code>1 l m r</code>ï¼Œå°† <span class="math inline">\(a_{l..m}\)</span> å’Œ <span class="math inline">\(a_{m+1..r}\)</span> å½’å¹¶æ’åºï¼Œ<strong>ä¿è¯ <span class="math inline">\(l=1\)</span></strong>ã€‚</li>
<li><code>2 x</code>ï¼ŒæŸ¥è¯¢å½“å‰ <span class="math inline">\(a_x\)</span> çš„å€¼ã€‚</li>
</ul>
<p>æ³¨æ„åˆ°å½’å¹¶æ’åºçš„è¿‡ç¨‹ç›¸å½“äºæ˜¯å°†å¾…åˆå¹¶çš„ä¸¤æ®µåˆ†å—ï¼Œä¿è¯å—é¦–ä¸ºå—å†…æœ€å¤§å€¼ä¸”ä¸ºå½“å‰éƒ¨åˆ†çš„å‰ç¼€æœ€å¤§å€¼ï¼Œç„¶åå°†è¿™äº›å—æŒ‰ç…§å—é¦–å…ƒç´ å¤§å°å½’å¹¶ã€‚</p>
<p>è€Œæˆ‘ä»¬è€ƒè™‘ç çš„è¿™åˆ€ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>
<ul>
<li>ç¬¬ä¸€ç§æƒ…å†µæ˜¯ <span class="math inline">\(m\)</span> å’Œ <span class="math inline">\(r\)</span> ä¸åœ¨åŒä¸€å—å†…ï¼Œè¿™ç§æƒ…å†µæ¯”è¾ƒå¥½å¤„ç†ï¼Œå› ä¸ºå®é™…ä¸Šä¼šå‘ç°åªæœ‰ <span class="math inline">\(m\)</span> æ‰€åœ¨å—å†…çš„ååŠæ®µä¼šè¢«åˆ†è£‚ç„¶åæ”¾åˆ°å‰é¢å½’å¹¶ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†éƒ½ä¸ä¼šåŠ¨ã€‚ä½†æ˜¯éœ€è¦å°† <span class="math inline">\(r\)</span> æ‰€åœ¨å—çš„ååŠæ®µä¹Ÿåˆ†è£‚æ‰å¹¶ä¿æŒåŸæ¥é¡ºåºï¼ˆä¸å‚ä¸å½’å¹¶ï¼‰ã€‚</li>
<li>ç¬¬äºŒç§æƒ…å†µæ˜¯ <span class="math inline">\(m\)</span> å’Œ <span class="math inline">\(r\)</span> åœ¨åŒä¸€å—å†…ï¼Œè¿™ç§æƒ…å†µå°±æ˜¯ <span class="math inline">\([m+1,r]\)</span> çš„éƒ¨åˆ†ä¼šè¢«åˆ†è£‚ç„¶åä¸å‰é¢å½’å¹¶ï¼Œç„¶åå‰©ä¸‹çš„éƒ¨åˆ†åˆå¹¶æˆä¸€å—ï¼ˆä¸‹å›¾è“è‰²éƒ¨åˆ†ï¼‰</li>
</ul>
<figure>
<img alt="" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/NOI.AC609.png"/><figcaption>NOI.AC609</figcaption>
</figure>
<p>ç”±äºéœ€è¦æ”¯æŒåŒºé—´çš„åˆ†è£‚ï¼Œæ‰€ä»¥éœ€è¦ç”¨å¹³è¡¡æ ‘æ¥ç»´æŠ¤è¿™äº›åŒºé—´ã€‚æ¯æ£µå¹³è¡¡æ ‘ç»´æŠ¤è¿™æ ·çš„ä¸€å—ï¼Œæœ€å¤šåˆ†è£‚å‡º <span class="math inline">\(n\)</span> å—å¹¶ä¸”ä¸ä¼šåˆå¹¶ï¼Œæ—¶é—´å¤æ‚åº¦æ²¡é—®é¢˜ã€‚</p>
<p>æ³¨æ„å¤–å±‚å¯ä»¥ä½¿ç”¨æƒå€¼çº¿æ®µæ ‘æ¥ç»´æŠ¤è¿™äº›æœ‰åºå—ï¼ˆå› ä¸ºå—é¦–è‚¯å®šæœ‰åºï¼‰ã€‚åæ­£è°ƒè¯•å¾—æŒºåŠ²çˆ†çš„ï¼Œå“ˆå“ˆå®³ã€‚</p>
<h2 id="å®éªŒèˆ±-8.16">å®éªŒèˆ± 8.16</h2>
<h3 id="a-carry">A Carry</h3>
<p>æ˜¾ç„¶æœ‰å¯äºŒåˆ†æ€§ï¼Œç°åœ¨å°±æ˜¯é—® <span class="math inline">\(a_1, a_2, a_3\)</span> ä¸ªä½“ç§¯åˆ†åˆ«ä¸º <span class="math inline">\(1,2,3\)</span> çš„ç‰©å“èƒ½å¦è£…æ»¡ <span class="math inline">\(m\)</span> ä¸ªå¤§å°ä¸º <span class="math inline">\(h_1,\cdots, h_m\)</span> çš„èƒŒåŒ…ã€‚</p>
<p>å¦‚æœåªæœ‰å¤§å°ä¸º <span class="math inline">\(1,2\)</span> çš„ç‰©å“é‚£å°±æ˜¯å…ˆå°½å¯èƒ½ä¸æº¢å‡ºåœ°æ”¾ <span class="math inline">\(2\)</span>ï¼Œç„¶åç”¨å‰©ä¸‹çš„ <span class="math inline">\(1\)</span> å’Œ <span class="math inline">\(2\)</span> è¡¥ç©ºã€‚å°½é‡é¿å…ä½“ç§¯çš„æµªè´¹ã€‚</p>
<p>è€ŒåŠ ä¸Šå¤§å°ä¸º <span class="math inline">\(3\)</span>â€‹ çš„ç‰©å“ä¹‹åï¼Œè´ªå¿ƒç­–ç•¥å¦‚ä¸‹ï¼Œå¦‚æœè¿‡ç¨‹ä¸­<span class="math inline">\(3\)</span>ç”¨å®Œäº†å°±ç›´æ¥ç»“æŸè¯¥è¿‡ç¨‹ï¼š</p>
<ol type="1">
<li>å¾€å‰©ä½™ç©ºé—´å¤§äºç­‰äº <span class="math inline">\(3\)</span> çš„å¥‡æ•°ä½ç½®æ”¾ä¸€ä¸ª <span class="math inline">\(3\)</span>ã€‚</li>
<li>å¾€æ‰€æœ‰å¤§äºç­‰äº <span class="math inline">\(6\)</span> çš„ä½ç½®å°½é‡å¤šåœ°æ”¾ä¸¤ä¸ªä¸€ç»„çš„ <span class="math inline">\(3\)</span>ï¼ˆå°½é‡ä¿æŒå¶æ•°å¯ä»¥å‡å°‘æ”¾ <span class="math inline">\(2\)</span> å’Œ <span class="math inline">\(1\)</span> æ—¶çš„æµªè´¹ï¼‰ã€‚</li>
<li>å¦‚æœæ°å¥½å‰©ä¸‹ä¸€ä¸ª <span class="math inline">\(3\)</span>ï¼ŒæŠŠå®ƒæ”¾åˆ°å‰©ä½™çš„æœ€å¤§çš„ä½ç½®é‡Œã€‚</li>
<li>å¦‚æœ <span class="math inline">\(3\)</span> è¿˜æœ‰å‰©ä½™ï¼Œç°åœ¨å‰©ä¸‹çš„ä½ç½®åªå‰©ä¸‹ <span class="math inline">\(4, 2, 1\)</span> ä¸‰ç§ä½™é‡ã€‚ä¾æ¬¡è´ªå¿ƒåœ°æ”¾å…¥å³å¯ã€‚</li>
</ol>
<p>è¯æ˜æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œå°±ä¸å†™äº†ï¼Œorz Asd_Okuuã€‚</p>
<h3 id="c-è§‚å¯Ÿç¬”è®°">C è§‚å¯Ÿç¬”è®°</h3>
<p>ç»™å®šä¸€æ£µæ ‘ï¼Œä»¥åŠè‹¥å¹²å½¢å¦‚ <span class="math inline">\((x,y)\)</span> é“¾ä¸Šçš„æœ€å¤§å€¼/æœ€å°å€¼æ˜¯ <span class="math inline">\(z\)</span> çš„ä¿¡æ¯ï¼Œæ„é€ ä¸€æ£µæ»¡è¶³æ¡ä»¶çš„æ ‘ã€‚</p>
<p>å¯ä»¥è®©æ¯æ¡è¾¹çš„æƒå€¼è¦ä¹ˆæ˜¯è¦†ç›–å…¶çš„è®°å½•ä¸­çš„æœ€å°çš„ <span class="math inline">\(1\)</span> æ ‡è®°ï¼ˆæœ€å¤§å€¼ï¼‰æˆ–è€…æœ€å¤§çš„ <span class="math inline">\(2\)</span> æ ‡è®°ï¼ˆæœ€å°å€¼ï¼‰ï¼šè‹¥éƒ½ä¸æ»¡è¶³ï¼Œè°ƒæ•´ä¸ºå…¶ä¸­ä¹‹ä¸€ä¸ä¼šä½¿å¾—æ»¡è¶³çš„è®°å½•æ¡æ•°å‡å°‘ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨é—®é¢˜å˜ä¸ºï¼š</p>
<ul>
<li>å¯¹äºæ¯æ¡è¾¹æ‰¾åˆ°è¦†ç›–å…¶çš„æå€¼ï¼›</li>
<li>åœ¨ä¸¤ç§æå€¼ä¸­äºŒé€‰ä¸€ï¼Œä½¿æ¯æ¡è®°å½•è‡³å°‘è¢«æ»¡è¶³ä¸€æ¬¡ã€‚</li>
</ul>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥å°†æ ‡è®°æŒ‰æƒå€¼æ’åºåä¾æ¬¡è¦†ç›–ï¼Œæ‹¿ä¸ªæ ‘å‰–ä¹Ÿè®¸å°±å¯ä»¥ç»Ÿè®¡äº†ã€‚å“¦å½“ç„¶æ‹¿å¹¶æŸ¥é›†ä»€ä¹ˆçš„ä¼¼ä¹ä¹Ÿè¡Œã€‚</p>
<p>å°±æ˜¯å¹¶æŸ¥é›†çš„æ ¹ç»´æŠ¤æœªè¢«æŸ“è‰²çš„æœ€æµ…çš„èŠ‚ç‚¹ï¼Œç„¶åå‡è®¾éœ€è¦æ‰¾è¦†ç›–çš„æœ€å°å€¼é‚£ä¹ˆå°±ç›´æ¥ä»å°åˆ°å¤§å‘ä¸Šæ‰¾ç„¶åæŸ“è‰²ã€‚</p>
<p>ç¬¬äºŒä¸ªé—®é¢˜å‘ç°æ˜¯ä¸ªäºŒåˆ†å›¾åŒ¹é…ï¼Œä¸Š Dinic å°±è¡Œã€‚</p>
<h2 id="å®éªŒèˆ±-8.18">å®éªŒèˆ± 8.18</h2>
<h3 id="a-æå·®">A æå·®</h3>
<p>æœ€ç®€å•çš„æƒ³æ³•æ˜¯è€ƒè™‘å¯¹äºæ¯ä¸ªå­åºåˆ—ï¼Œè®¡ç®—ä¸€ä¸‹å…¶èƒ½è¢«å¤šå°‘å­æ®µåŒ…å«ã€‚</p>
<p>å³æˆ‘ä»¬è€ƒè™‘è‹¥æœ€å·¦ç«¯å’Œæœ€å³ç«¯ä¸º <span class="math inline">\(l,r\)</span>ï¼Œæå·®ä¸º <span class="math inline">\(d\)</span>ï¼Œé‚£ä¹ˆä»–ä¼šè´¡çŒ®å‡º <span class="math inline">\(l\times(n - r + 1)\times d\)</span>ã€‚</p>
<p>äºæ˜¯å¾—åˆ°äº†ä¸€ä¸ª <span class="math inline">\(O(n2^n)\)</span> çš„åšæ³•ã€‚</p>
<p>è¿™ç§è´¡çŒ®æ–¹å¼å¤ªè ¢äº†ï¼Œæ€è€ƒä¸€ä¸‹ <span class="math inline">\(O(n^2)\)</span> æ€ä¹ˆæã€‚</p>
<p><strong>æå·®æ˜¯å¯ä»¥æ‹†æˆæœ€å¤§å€¼ - æœ€å°å€¼çš„ã€‚</strong>é—®é¢˜å°±ç›´æ¥å˜æˆæ¯ä¸ªå­æ®µçš„æ‰€æœ‰å­åºåˆ—çš„æœ€å€¼ä¹‹å’Œã€‚</p>
<p>ç›´æ¥å†²æ­£è§£çš„è¯ï¼Œå°±æ˜¯è®¡ç®—æ¯ä¸ªæ•°è¢«å½“ä½œæœ€å€¼ç»Ÿè®¡äº†å‡ æ¬¡ã€‚</p>
<p>é¦–å…ˆä¸ºäº†é¿å…ç®—é‡ï¼Œç›´æ¥å¼ºè¡Œå¡ä¸€ä¸ªå³è¾¹çš„æ•°æ›´å¤§çš„ååºå…³ç³»ã€‚</p>
<p>ç›¸å½“äºæˆ‘ä»¬è¦ç¡¬ç‚¹å­åºåˆ—é‡Œé¢æœ‰è¿™ä¸ªæ•°ï¼Œç„¶åæ¯”è¿™ä¸ªæ•°å¤§çš„éƒ½ä¸å¯ä»¥é€‰ã€‚</p>
<p>è®¾æˆ <span class="math inline">\(a_x\)</span>ï¼Œæœ€å¤§å€¼ï¼š <span class="math display">\[
a_x\times\sum_{l\le x}[a_l \le a_x]\times l\times 2^{cnt(l + 1, x - 1, a_x)}\sum_{r\ge x}[a_r \le a_x] \times 2^{cnt(x + 1,r - 1, a_x)}\times (n - r + 1)
\]</span> æŒ‡æ•°ä½ä¸Šé¢å¯ä»¥æ‹†æˆä¸¤åŠæ¥ç»´æŠ¤ï¼Œç„¶ååˆå’Œä¸‹æ ‡æœ‰å…³åˆå’Œå€¼åŸŸæœ‰å…³ï¼Œæ‰€ä»¥æ”¾åœ¨ä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šï¼Œ<span class="math inline">\(l\le x\)</span> å’Œ <span class="math inline">\(a_l &lt; a_x\)</span> çš„é™åˆ¶ç›¸å½“äºäºŒç»´æ•°ç‚¹ï¼Œè€ƒè™‘æ‰«æçº¿ä»å°åˆ°å¤§æ‰«å€¼ï¼Œç„¶ååŠ ç‚¹ï¼Œæ•°ç‚¹ã€‚åœ¨çº¿æ®µæ ‘ç»´æŠ¤è¯¥åŒºé—´çš„ç­”æ¡ˆä»¥åŠæ•°ã€‚</p>
<h3 id="c-å†å²">C å†å²</h3>
<p>é—®é¢˜è½¬åŒ–åï¼Œåˆæ³•çš„ä¸»è§’åºåˆ—åº”è¯¥ä¸ºç”±è‹¥å¹²æ®µå½¢å¦‚ï¼šè‹¥å¹² <span class="math inline">\(C\)</span>ï¼Œç›¸é‚»ä¸¤ä¸ª <span class="math inline">\(C\)</span> ä¸­å¯ä»¥æ’å…¥è‹¥å¹²æ•´æ®µåˆ«çš„å…ƒç´ ï¼Œä¾‹å¦‚ <span class="math inline">\(CABBCCCEEEC\)</span>ï¼Œè¿™æ ·çš„æ®µã€‚</p>
<p>ç„¶åè€ƒè™‘è¿™æ ·ä¸€ä»¶äº‹ï¼šå‡è®¾ä¸€å…±æœ‰ <span class="math inline">\(a\)</span> ä¸ªä¸»è§’ï¼Œç„¶åæˆ‘ä»¬æ‹¿æ¥åšè¿ç»­æ®µ <span class="math inline">\(C\)</span> çš„æœ‰ <span class="math inline">\(k\)</span> ä¸ªï¼Œä»–ä»¬å ç”¨äº† <span class="math inline">\(m\)</span> çš„åºåˆ—é•¿åº¦ã€‚ç„¶åå¯¹è¿™ä¸ªä¸œè¥¿è®¡æ•°å…¶å®æ˜¯å¾ˆå¥½è®¡çš„ï¼Œé¦–å…ˆæœ‰ä¸ª <span class="math inline">\(k!\)</span> çš„æ’åˆ—æ•°ï¼Œç„¶åèƒ½æ’å…¥çš„ç©ºæœ‰ <span class="math inline">\(m - k\)</span> ä¸ªï¼Œè¦æ’å…¥ <span class="math inline">\(a - k\)</span> æ®µã€‚è¿™ <span class="math inline">\(a-k\)</span> æ®µæœ‰ä¸ª <span class="math inline">\((a-k)!\)</span> çš„æ’åˆ—æ•°ï¼Œç„¶åå°±æ˜¯ <span class="math inline">\(a-k\)</span> ä¸ªçƒæ”¾å…¥ <span class="math inline">\(m-k\)</span> ä¸ªç›’å­é‡Œï¼Œè¿™æ ·çš„æ–¹æ¡ˆæ•°æ˜¯ <span class="math inline">\(\dbinom{a + m - 2k - 1}{m - k - 1}\)</span>ã€‚</p>
<p>é‚£ä¹ˆä¼šå‘ç°è¿™æ ·çš„æ–¹æ¡ˆæ•°åªä¸ <span class="math inline">\(k\)</span> å’Œ <span class="math inline">\(m\)</span> æœ‰å…³ï¼Œæ‰€ä»¥å°±åšä¸€ä¸ªäºŒç»´ä½“ç§¯çš„èƒŒåŒ…ï¼Œå¯¹äºæ¯ä¸ªçŠ¶æ€åˆå¹¶ä¸€ä¸‹ç­”æ¡ˆå³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\max\{a_i\}^2)\)</span>ã€‚</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1"></a><span class="at">const</span> <span class="dt">int</span> maxn = <span class="dv">5005</span>, maxa = <span class="dv">105</span>, N = <span class="dv">10005</span>, A = <span class="dv">100</span>;</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2"></a><span class="at">const</span> <span class="dt">int</span> mod = <span class="dv">998244353</span>;</span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3"></a><span class="dt">int</span> n, c[maxn], fac[maxn &lt;&lt; <span class="dv">1</span>], ifac[maxn &lt;&lt; <span class="dv">1</span>], a;</span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4"></a><span class="dt">int</span> f[maxa][maxn];</span>
<span id="cb7-5"><a aria-hidden="true" href="#cb7-5"></a></span>
<span id="cb7-6"><a aria-hidden="true" href="#cb7-6"></a><span class="dt">int</span> qPow(<span class="dt">int</span> a, <span class="dt">int</span> b) {</span>
<span id="cb7-7"><a aria-hidden="true" href="#cb7-7"></a>    <span class="dt">int</span> ret = <span class="dv">1</span>;</span>
<span id="cb7-8"><a aria-hidden="true" href="#cb7-8"></a>    <span class="cf">for</span> (a %= mod; b; b &gt;&gt;= <span class="dv">1</span>, a = <span class="dv">1</span><span class="bu">ll</span> * a * a % mod)</span>
<span id="cb7-9"><a aria-hidden="true" href="#cb7-9"></a>        <span class="cf">if</span> (b &amp; <span class="dv">1</span>) ret = <span class="dv">1</span><span class="bu">ll</span> * ret * a % mod;</span>
<span id="cb7-10"><a aria-hidden="true" href="#cb7-10"></a>    <span class="cf">return</span> ret;</span>
<span id="cb7-11"><a aria-hidden="true" href="#cb7-11"></a>}</span>
<span id="cb7-12"><a aria-hidden="true" href="#cb7-12"></a></span>
<span id="cb7-13"><a aria-hidden="true" href="#cb7-13"></a>il <span class="dt">int</span> binom(<span class="dt">int</span> n, <span class="dt">int</span> m) {</span>
<span id="cb7-14"><a aria-hidden="true" href="#cb7-14"></a>    <span class="cf">return</span> (n &lt; m || m &lt; <span class="dv">0</span>) ? <span class="dv">0</span> : <span class="dv">1</span><span class="bu">ll</span> * fac[n] * ifac[m] % mod * ifac[n - m] % mod;</span>
<span id="cb7-15"><a aria-hidden="true" href="#cb7-15"></a>}</span>
<span id="cb7-16"><a aria-hidden="true" href="#cb7-16"></a></span>
<span id="cb7-17"><a aria-hidden="true" href="#cb7-17"></a><span class="dt">int</span> main() {</span>
<span id="cb7-18"><a aria-hidden="true" href="#cb7-18"></a>    fac[<span class="dv">0</span>] = <span class="dv">1</span>;</span>
<span id="cb7-19"><a aria-hidden="true" href="#cb7-19"></a>    FOR(i, <span class="dv">1</span>, N) fac[i] = <span class="dv">1</span><span class="bu">ll</span> * fac[i - <span class="dv">1</span>] * i % mod;</span>
<span id="cb7-20"><a aria-hidden="true" href="#cb7-20"></a>    ifac[N] = qPow(fac[N], mod - <span class="dv">2</span>);</span>
<span id="cb7-21"><a aria-hidden="true" href="#cb7-21"></a>    DEC(i, N - <span class="dv">1</span>, <span class="dv">0</span>) ifac[i] = (i + <span class="dv">1</span><span class="bu">ll</span>) * ifac[i + <span class="dv">1</span>] % mod;</span>
<span id="cb7-22"><a aria-hidden="true" href="#cb7-22"></a>    cin &gt;&gt; n;</span>
<span id="cb7-23"><a aria-hidden="true" href="#cb7-23"></a>    FOR(i, <span class="dv">1</span>, n) {</span>
<span id="cb7-24"><a aria-hidden="true" href="#cb7-24"></a>        <span class="dt">int</span> x; cin &gt;&gt; x;</span>
<span id="cb7-25"><a aria-hidden="true" href="#cb7-25"></a>        ++c[x];</span>
<span id="cb7-26"><a aria-hidden="true" href="#cb7-26"></a>    }</span>
<span id="cb7-27"><a aria-hidden="true" href="#cb7-27"></a>    FOR(i, <span class="dv">1</span>, A) <span class="cf">if</span> (c[i]) c[++a] = c[i];</span>
<span id="cb7-28"><a aria-hidden="true" href="#cb7-28"></a>    f[<span class="dv">0</span>][<span class="dv">0</span>] = <span class="dv">1</span>;</span>
<span id="cb7-29"><a aria-hidden="true" href="#cb7-29"></a>    FOR(k, <span class="dv">1</span>, a)</span>
<span id="cb7-30"><a aria-hidden="true" href="#cb7-30"></a>        DEC(i, k, <span class="dv">1</span>)</span>
<span id="cb7-31"><a aria-hidden="true" href="#cb7-31"></a>            DEC(j, <span class="dv">5000</span>, c[k])</span>
<span id="cb7-32"><a aria-hidden="true" href="#cb7-32"></a>                f[i][j] = (f[i][j] + f[i - <span class="dv">1</span>][j - c[k]]) % mod;</span>
<span id="cb7-33"><a aria-hidden="true" href="#cb7-33"></a>    <span class="dt">int</span> ans = <span class="dv">0</span>;</span>
<span id="cb7-34"><a aria-hidden="true" href="#cb7-34"></a>    FOR(k, <span class="dv">1</span>, a) FOR(m, <span class="dv">1</span>, <span class="dv">5000</span>) <span class="cf">if</span> (f[k][m]) {</span>
<span id="cb7-35"><a aria-hidden="true" href="#cb7-35"></a>        <span class="cf">if</span> (k &lt; m) ans = (ans + <span class="dv">1</span><span class="bu">ll</span> * f[k][m] * fac[k] % mod * fac[a - k] % mod * binom(a + m - <span class="dv">2</span> * k - <span class="dv">1</span>, m - k - <span class="dv">1</span>) % mod) % mod;</span>
<span id="cb7-36"><a aria-hidden="true" href="#cb7-36"></a>        <span class="cf">else</span> <span class="cf">if</span> (k == a) ans = (ans + fac[k]) % mod; <span class="co">// ç‰¹åˆ¤</span></span>
<span id="cb7-37"><a aria-hidden="true" href="#cb7-37"></a>    }</span>
<span id="cb7-38"><a aria-hidden="true" href="#cb7-38"></a>    FOR(k, <span class="dv">1</span>, a) ans = <span class="dv">1</span><span class="bu">ll</span> * ans * fac[c[k]] % mod;</span>
<span id="cb7-39"><a aria-hidden="true" href="#cb7-39"></a>    cout &lt;&lt; ans &lt;&lt; endl;</span>
<span id="cb7-40"><a aria-hidden="true" href="#cb7-40"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb7-41"><a aria-hidden="true" href="#cb7-41"></a>}</span></code></pre></div>
</section>
<footer class="article-footer">
<section class="article-tags">
<a href="/tags/OI/">OI</a>
</section>
<section class="article-copyright">
<svg class="icon icon-tabler icon-tabler-copyright" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M14.5 9a3.5 4 0 1 0 0 6"></path>
</svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" rel="stylesheet"/><script crossorigin="anonymous" defer="" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js">
</script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
</article>
<aside class="related-contents--wrapper">
<h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
<div class="related-contents">
<div class="flex article-list--tile">
<article class="has-image">
<a href="/sol-luogu-p5468/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">P5468 [NOI2019] å›å®¶è·¯çº¿</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/travels-noi2022/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">NOI2022 æ¸¸è®°</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/sol-cf715b/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg57.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg57.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">CF715B Complete The Graph</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/sol-agc027d/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">AGC027D - Modulo Matrix</h2>
</div>
</a>
</article>
<article class="has-image">
<a href="/sol-luogu-p5305/">
<div class="article-image">
<img data-hash="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg32.webp" data-key="" loading="lazy" src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg32.webp"/>
</div>
<div class="article-details">
<h2 class="article-title">P5305 [GXOI/GZOI2019]æ—§è¯</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class="site-footer">
<section class="copyright">
        Â© 
        
            2019 - 
        
        2024 æ¸…çƒ›çš„åšå®¢
    </section>
<section class="powerby">
        Built with <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a> <br/>
        ä¸»é¢˜ <b><a data-version="3.11.0" href="https://github.com/CaiJimmy/hugo-theme-stack" rel="noopener" target="_blank">Stack</a></b> ç”± <a href="https://jimmycai.com" rel="noopener" target="_blank">Jimmy</a> è®¾è®¡
    </section>
</footer>
<div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">
<div class="pswp__bg"></div>
<div class="pswp__scroll-wrap">
<div class="pswp__container">
<div class="pswp__item"></div>
<div class="pswp__item"></div>
<div class="pswp__item"></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class="pswp__top-bar">
<div class="pswp__counter"></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class="pswp__preloader">
<div class="pswp__preloader__icn">
<div class="pswp__preloader__cut">
<div class="pswp__preloader__donut"></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class="pswp__share-tooltip"></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class="pswp__caption">
<div class="pswp__caption__center"></div>
</div>
</div>
</div>
</div><script crossorigin="anonymous" defer="" integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js">
</script><script crossorigin="anonymous" defer="" integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js">
</script><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" rel="stylesheet"/><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" rel="stylesheet"/>
</main>
</div>
<script crossorigin="anonymous" integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js">
</script><script defer="" src="/ts/main.js" type="text/javascript"></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
</body>
</html>

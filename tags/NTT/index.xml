<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>NTT on æ¸…çƒ›çš„åšå®¢</title>
        <link>https://oi.imyangty.com/tags/NTT/</link>
        <description>Recent content in NTT on æ¸…çƒ›çš„åšå®¢</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-CN</language>
        <lastBuildDate>Sat, 04 Sep 2021 23:13:03 +0800</lastBuildDate><atom:link href="https://oi.imyangty.com/tags/NTT/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>AtCoder æ¯”èµ›æ—¥è®°</title>
        <link>https://oi.imyangty.com/summary-atcoder/</link>
        <pubDate>Fri, 23 Apr 2021 12:38:59 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/summary-atcoder/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg70.webp" alt="Featured image of post AtCoder æ¯”èµ›æ—¥è®°" /&gt;&lt;h2 id=&#34;abc&#34;&gt;ABC&lt;/h2&gt;
&lt;h3 id=&#34;è¡¥é¢˜è¡¨&#34;&gt;è¡¥é¢˜è¡¨&lt;/h3&gt;
&lt;p&gt;è¿‘æœŸç›®æ ‡ï¼šABC ç¨³å®š 30min è¿‡ 4 é¢˜ï¼Œäº‰å–èµ›æ—¶è¿‡ Gï¼Œå°½é‡è¡¥å…¨å¥— ABCã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Round&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Rank&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Perf&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Sol&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;th&gt;E&lt;/th&gt;
&lt;th&gt;F&lt;/th&gt;
&lt;th&gt;G&lt;/th&gt;
&lt;th&gt;H&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC202&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc202/standings?watching=YangTY&#34;&gt;1095&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1437&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC207&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc207/standings?watching=YangTY&#34;&gt;956&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1484&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC210&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc210/standings?watching=YangTY&#34;&gt;485&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1823&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC212&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc212/standings?watching=YangTY&#34;&gt;856&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1536&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC213&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc213/standings?watching=YangTY&#34;&gt;1031&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1485&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC214&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc214/standings?watching=YangTY&#34;&gt;742&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1647&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC217&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc217/standings?watching=Cgfyufsygsm&#34;&gt;1320&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1383&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC219&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc219/standings?watching=YangTY&#34;&gt;1153&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1375&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC222&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc222/standings?watching=YangTY&#34;&gt;425&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1880&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC223&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc223/standings?watching=Cgfyufsygsm&#34;&gt;1573&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1074&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC224&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc224/standings?watching=YangTY&#34;&gt;426&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1828&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC231&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc231/standings?watching=Cgfyufsygsm&#34;&gt;571&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1665&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC232&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc232/standings?watching=YangTY&#34;&gt;762&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1518&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC233&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc233/standings?watching=YangTY&#34;&gt;659&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1660&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC234&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc234/standings?watching=YangTY&#34;&gt;1553&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1224&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC235&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc235/standings?watching=YangTY&#34;&gt;913&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1525&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC237&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc237/standings?watching=YangTY&#34;&gt;534&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1790&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC244&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc244/standings?watching=YangTY&#34;&gt;333&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1788&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;6&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC246&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc246/standings?watching=YangTY&#34;&gt;703&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1656&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC247&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc247/standings?watching=YangTY&#34;&gt;640&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1703&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;6&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;ä¸€äº›æ–°è§åˆ°çš„-trick&#34;&gt;ä¸€äº›æ–°è§åˆ°çš„ trick&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ABC212Eï¼šè¡¥é›†æ€æƒ³ä¼˜åŒ– dpã€‚&lt;/li&gt;
&lt;li&gt;ABC212Hï¼šFWT çš„çº¿æ€§æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ABC219Eï¼šç½‘æ ¼å¾ˆå°æ‰€ä»¥ç›´æ¥å°†æŠ¤åŸæ²³çš„çŠ¶æ€å’Œæ ¼å­åŒå°„ã€‚&lt;/li&gt;
&lt;li&gt;ABC231Gï¼šæœŸæœ›çº¿æ€§æ€§æ¨å¤§å¼å­ã€‚&lt;/li&gt;
&lt;li&gt;ABC232Gï¼šå¯¹äºæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ç±»é—®é¢˜å»ºç¯ã€‚&lt;/li&gt;
&lt;li&gt;ABC233Exï¼šæ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«ç„¶åä¸»å¸­æ ‘äºŒç»´æ•°ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;ABC235Gï¼šé€†å‘è€ƒè™‘é—®é¢˜â†’äºŒé¡¹å¼åæ¼”â†’&lt;strong&gt;æ£‹ç›˜è·¯å¾„è®¡æ•°çš„é€’æ¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ABC237Eï¼šç‚¹é«˜åº¦ç›´æ¥æ»¡è¶³åŠ¿èƒ½æ€§è´¨â†’ç›´æ¥ Dijkstraã€‚&lt;/li&gt;
&lt;li&gt;ABC237Exï¼šä¸²çš„åŒ…å«å…³ç³»è½¬ä¸ºååºå…³ç³»ğŸ‘‰æ±‚æœ€å¤§åé“¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;abc212&#34;&gt;ABC212&lt;/h3&gt;
&lt;p&gt;A + B + C + D + Eã€‚A - D ç•¥ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc212e---safety-journey&#34;&gt;ABC212E - Safety Journey&lt;/h4&gt;
&lt;p&gt;è¡¥é›†æ€æƒ³ä¼˜åŒ– DP ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = \sum_{j&amp;#39;\text{ is connected with j}}f_{i - 1, j&amp;#39;}
\]&lt;/span&gt; å¯ä»¥è½¬åŒ–ä¸º &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = \sum_{j&amp;#39; = 1}^n f_{i - 1, j&amp;#39;} - \sum_{j&amp;#39;\text{ isn&amp;#39;t connected with j}}f_{i - 1, j&amp;#39;}
\]&lt;/span&gt; æ²¡è¿è¾¹çš„æ•°é‡æ˜¯æ€»å…± &lt;span class=&#34;math inline&#34;&gt;\(O(m)\)&lt;/span&gt; çš„ï¼Œæ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O((n + m)k)\)&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;abc212f---greedy-takahashi&#34;&gt;ABC212F - Greedy Takahashi&lt;/h4&gt;
&lt;p&gt;å»ºæ¨¡æˆæ£®æ—ç„¶åç›´æ¥æ ‘ä¸Šå€å¢æ±‚è§£ã€‚ç åŠ›è¦æ±‚è¾ƒé«˜ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc212g---power-pair&#34;&gt;ABC212G - Power Pair&lt;/h4&gt;
&lt;p&gt;ç»™å®šè´¨æ•° &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œé—®æ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; çš„ä¸ªæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(0\le x, y\le p - 1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\exists n, x^n\equiv y\pmod p\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le p\le 10^{12}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å›é¡¾åŸæ ¹çš„æ¦‚å¿µã€‚&lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ºæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„åŸæ ¹å½“ä¸”ä»…å½“æœ€å°çš„ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(r^e\equiv 1\pmod p\)&lt;/span&gt; çš„æ­£æ•´æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(e = p - 1\)&lt;/span&gt;ã€‚æœ¬é¢˜éœ€è¦ç”¨åˆ°çš„æ€§è´¨ï¼š&lt;span class=&#34;math inline&#34;&gt;\(r^i\bmod p, i\in[0, p - 1]\)&lt;/span&gt; çš„å€¼ä¸¤ä¸¤ä¸åŒï¼Œä¸”å¯¹äºä¸€ä¸ªè´¨æ•°ï¼Œä¸€å®šæœ‰åŸæ ¹å­˜åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(x\equiv r^a\pmod p\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(y\equiv r^b\pmod p\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; æ€»èƒ½æœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; ä¸ä¹‹å¯¹åº”ã€‚äºæ˜¯å°±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(an\equiv b\pmod{p - 1}\)&lt;/span&gt;ã€‚ç°åœ¨å°±æ˜¯éœ€è¦æ‰¾æ»¡è¶³ä¸Šå¼çš„ &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œåˆ™ä¸Šå¼æœ‰è§£çš„æ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a, p - 1)\mid b\)&lt;/span&gt;ï¼ˆè£´èœ€å®šç†ï¼‰ã€‚é‚£å¯¹äºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å°±å¯ä»¥å†™æˆï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{a = 1}^{p - 1}\frac{p - 1}{\gcd(a, p - 1)}
\]&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(O(p)\)&lt;/span&gt; æ˜¯è¿‡ä¸å»çš„ï¼Œè¦è€ƒè™‘ä¼˜åŒ–ã€‚ä¼˜åŒ–å®ƒçš„æ–¹æ³•æ˜æ˜¾æ˜¯å¯»æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a, p - 1)\)&lt;/span&gt; ç›¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä¸ªæ•°ã€‚æ ¹æ® &lt;span class=&#34;math inline&#34;&gt;\(p - 1\)&lt;/span&gt; çš„å› æ•°ä¸ªæ•° ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt p)\)&lt;/span&gt; çš„ï¼Œæ•…è¿™äº› &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; ä¹Ÿåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt p)\)&lt;/span&gt; ä¸ªã€‚æˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a, p - 1) = g\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{g\mid p - 1}\frac{p - 1}{g}\times\phi\left(\frac{p - 1}{g}\right)
\]&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(\phi(n)\)&lt;/span&gt; å¯ä»¥æš´åŠ›è®¡ç®—ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt p\log p)\)&lt;/span&gt;ï¼Œå› ä¸º $$ çš„ä¸Šç•Œå¾ˆæ¾ï¼Œè½»æ¾é€šè¿‡ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc212h---nim-counting&#34;&gt;ABC212H - Nim Counting&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((A_1, \cdots, A_k)\)&lt;/span&gt;ã€‚å¯ä»¥å¦‚ä¸‹å®‰æ’çŸ³å­ï¼šæ¯å †çŸ³å­æ•°é‡å¿…é¡»æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä¹‹ä¸€ï¼Œä¸”çŸ³å­å †æ•°é‡å°ç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚é—®å®‰æ’çŸ³å­ä½¿å¾—å…ˆæ‰‹ Nim å¿…èƒœçš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k, A_i\le 2^{17}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä¸¤ä¸¤ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°é—®é¢˜è½¬åŒ–ä¸ºæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\bigoplus_{i = 1}^m B_i\not=0\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ºçŸ³å­ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè€ƒè™‘å›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚åˆ™æ„é€ åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(C_i = [\exist j, A_j = i]\)&lt;/span&gt;ï¼Œå®šä¹‰å·ç§¯ &lt;span class=&#34;math inline&#34;&gt;\(*\)&lt;/span&gt; ä¸ºå¼‚æˆ–å·ç§¯ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(C * C * \cdots * C\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt;ï¼‰çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; é¡¹ç³»æ•°å³ä¸ºå¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯ä»¥ FWT åšçš„ï¼Œå…·ä½“åœ°ï¼Œç»™ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{FWT}(C)_i\)&lt;/span&gt; çš„æ¯ä¸€é¡¹åšä¸€ä¸‹å¿«é€Ÿå¹‚å† IFWT å›å»ï¼ŒæŠŠé™¤äº†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; é¡¹ä¹‹å¤–çš„æ±‚ä¸ªå’Œï¼Œå°±å¾—åˆ°äº†çŸ³å­å †æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œä¸å›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ€ä¹ˆåšå‘¢ï¼Ÿå› ä¸º FWT æ˜¯çº¿æ€§å˜æ¢ï¼Œè€Œæˆ‘ä»¬éœ€è¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{IFWT}(\operatorname{FWT}(C)_i + \operatorname{FWT}(C)_i^2 + \operatorname{FWT}(C)_i^3 + \cdots \operatorname{FWT}(C)_i^n)\)&lt;/span&gt;ï¼Œæ‰€ä»¥å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(C&amp;#39;_i = \operatorname{FWT}(C)_i\)&lt;/span&gt;ï¼Œç„¶åæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(D_i = C_i&amp;#39; + C_i&amp;#39;^2 + \cdots + C_i&amp;#39;^n\)&lt;/span&gt; å†æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{IFWT}(D)\)&lt;/span&gt; æŠŠé™¤äº†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; é¡¹å¤–çš„ç³»æ•°ç´¯åŠ å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint calc(modint x, modint n) {&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x * (qPow(x, n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * qPow(x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(k);&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) read(tmp), maxa = tmp &amp;gt; maxa ? tmp : maxa, f[tmp] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ++maxa;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; lim &amp;lt;= maxa; lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    XOR(f, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = calc(f[i], n);&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    XOR(f, lim, inv2);&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans += f[i];&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;abc213&#34;&gt;ABC213&lt;/h3&gt;
&lt;p&gt;A + B + C + D + F&lt;/p&gt;
&lt;h4 id=&#34;abc213e---stronger-takahashi&#34;&gt;ABC213E - Stronger Takahashi&lt;/h4&gt;
&lt;p&gt;0-1 bfsï¼Œå› ä¸ºè¾¹æƒåªä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc213f---common-prefixes&#34;&gt;ABC213F - Common Prefixes&lt;/h4&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{LCP}(S_i, S_j)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¼€å¤´å­ä¸²å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¼€å¤´å­ä¸²çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\in[1, n]\)&lt;/span&gt; æ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^n\operatorname{LCP}(S_k, S_i)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;SA æ¿å­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc213g---connectivity-2&#34;&gt;ABC213G - Connectivity 2&lt;/h4&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è”é€šçš„å­å›¾ä¸ªæ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 17\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å¾ˆå°ã€‚&lt;/p&gt;
&lt;p&gt;çŠ¶å‹ dpã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g(S)\)&lt;/span&gt; è¡¨ç¤ºç‚¹é›† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­æœ‰è¿è¾¹çš„æ•°é‡ã€‚è¿™å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(2^nm)\)&lt;/span&gt; çš„æ—¶é—´å†…å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f(S)\)&lt;/span&gt; ä¸ºä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…ç‚¹è”é€šçš„è¿è¾¹æ–¹æ¡ˆæ•°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è€ƒè™‘å®¹æ–¥ï¼Œéšä¾¿é€‰ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œç„¶åè€ƒè™‘è¿™ä¸ªç‚¹æ‰€åœ¨çš„è¿é€šåˆ†é‡ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(T\subset S\)&lt;/span&gt;ã€‚åˆ™æœ‰å¦‚ä¸‹è½¬ç§» &lt;span class=&#34;math display&#34;&gt;\[
f(S) = g(S) - \sum_{x\in T, T\subset S} f(T)
\]&lt;/span&gt; ç„¶åå¯¹äºç­”æ¡ˆï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å·ç‚¹çš„ç­”æ¡ˆå³ä¸ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{1\in S, k\in S} f(S)
\]&lt;/span&gt; è¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc213h---stroll&#34;&gt;ABC213H - Stroll&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å¯¹ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((a_i, b_i)\)&lt;/span&gt; é—´æœ‰è¿è¾¹ï¼Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(p_{i, d}\)&lt;/span&gt; æ¡ã€‚é—®ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹å‡ºå‘ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ç»“æŸçš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„è·¯å¾„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæŠŠæœ€æœ´ç´ çš„ DP æ–¹ç¨‹å†™å‡ºæ¥ï¼šè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u, s}\)&lt;/span&gt; ä¸ºç»“æŸç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„è·¯å¾„æ¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åˆ™æœ€æœ´ç´ çš„æ–¹ç¨‹ï¼šå¯¹äºæ¯æ¡è¾¹è¿›è¡Œè½¬ç§» &lt;span class=&#34;math display&#34;&gt;\[
f_{u_i, s} := f_{u_i, s} + \sum_{t = 0}^sf_{v_i, t}p_{i, t}
\]&lt;/span&gt; å†™æˆç”Ÿæˆå‡½æ•°çš„å½¢å¼å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
F_{u_i}(x) := F_{u_i}(x) + F_{v_i}(x)P_i(x)
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿çœ‹ä¼¼å¯ä»¥ NTT ä¼˜åŒ–ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°å­˜åœ¨åå¤æ¨ªè·³çš„æƒ…å†µã€‚æ‰€ä»¥ç›´æ¥å»åšè‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åœ¨é•¿åº¦çš„ç»´åº¦åˆ†æ²»ã€‚è€ƒè™‘å½“å‰åˆ†æ²»åŒºé—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt;ï¼Œç„¶åé¦–å…ˆå¤„ç†ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\([l, mid]\)&lt;/span&gt; å†…éƒ¨ï¼ŒæŠŠè¿™äº›ç®—å®Œï¼Œç„¶åå¤„ç† &lt;span class=&#34;math inline&#34;&gt;\([l, mid]\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\([mid + 1, r]\)&lt;/span&gt; çš„è´¡çŒ®ã€‚å³ &lt;span class=&#34;math display&#34;&gt;\[
f_{u_i, s} := f_{u_i, s} + \sum_{t = l}^{mid}f_{v_i, t}p_{i, s - t}\quad s\in[mid + 1, r]
\]&lt;/span&gt; ç±»ä¼¼åˆ†æ²» NTT å¤„ç†å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb2-1&#34;&gt;&lt;a href=&#34;#cb2-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], p[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], t1, t2;&lt;/span&gt;
&lt;span id=&#34;cb2-2&#34;&gt;&lt;a href=&#34;#cb2-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, T, u[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], v[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-3&#34;&gt;&lt;a href=&#34;#cb2-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-4&#34;&gt;&lt;a href=&#34;#cb2-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve(Poly &amp;amp;f, Poly &amp;amp;g, Poly &amp;amp;ret, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r) {&lt;/span&gt;
&lt;span id=&#34;cb2-5&#34;&gt;&lt;a href=&#34;#cb2-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-6&#34;&gt;&lt;a href=&#34;#cb2-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t1 = {f.begin() + l, f.begin() + mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb2-7&#34;&gt;&lt;a href=&#34;#cb2-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t2 = {g.begin() + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, g.begin() + r - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb2-8&#34;&gt;&lt;a href=&#34;#cb2-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t1 = t1 * t2;&lt;/span&gt;
&lt;span id=&#34;cb2-9&#34;&gt;&lt;a href=&#34;#cb2-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r) ret[i] = (ret[i] + t1[i - l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb2-10&#34;&gt;&lt;a href=&#34;#cb2-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-11&#34;&gt;&lt;a href=&#34;#cb2-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-12&#34;&gt;&lt;a href=&#34;#cb2-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-13&#34;&gt;&lt;a href=&#34;#cb2-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r) {&lt;/span&gt;
&lt;span id=&#34;cb2-14&#34;&gt;&lt;a href=&#34;#cb2-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-15&#34;&gt;&lt;a href=&#34;#cb2-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == r) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-16&#34;&gt;&lt;a href=&#34;#cb2-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    solve(l, mid);&lt;/span&gt;
&lt;span id=&#34;cb2-17&#34;&gt;&lt;a href=&#34;#cb2-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb2-18&#34;&gt;&lt;a href=&#34;#cb2-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        solve(f[u[i]], p[i], f[v[i]], l, r);&lt;/span&gt;
&lt;span id=&#34;cb2-19&#34;&gt;&lt;a href=&#34;#cb2-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        solve(f[v[i]], p[i], f[u[i]], l, r);&lt;/span&gt;
&lt;span id=&#34;cb2-20&#34;&gt;&lt;a href=&#34;#cb2-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-21&#34;&gt;&lt;a href=&#34;#cb2-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    solve(mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r);&lt;/span&gt;
&lt;span id=&#34;cb2-22&#34;&gt;&lt;a href=&#34;#cb2-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-23&#34;&gt;&lt;a href=&#34;#cb2-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-24&#34;&gt;&lt;a href=&#34;#cb2-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-25&#34;&gt;&lt;a href=&#34;#cb2-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb2-26&#34;&gt;&lt;a href=&#34;#cb2-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m), read(T);&lt;/span&gt;
&lt;span id=&#34;cb2-27&#34;&gt;&lt;a href=&#34;#cb2-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = T + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-28&#34;&gt;&lt;a href=&#34;#cb2-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb2-29&#34;&gt;&lt;a href=&#34;#cb2-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(u[i]), read(v[i]);&lt;/span&gt;
&lt;span id=&#34;cb2-30&#34;&gt;&lt;a href=&#34;#cb2-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        p[i].resize(T + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-31&#34;&gt;&lt;a href=&#34;#cb2-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, T) read(p[i][j]);&lt;/span&gt;
&lt;span id=&#34;cb2-32&#34;&gt;&lt;a href=&#34;#cb2-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-33&#34;&gt;&lt;a href=&#34;#cb2-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) f[i].resize(T + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-34&#34;&gt;&lt;a href=&#34;#cb2-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-35&#34;&gt;&lt;a href=&#34;#cb2-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    solve(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, T);&lt;/span&gt;
&lt;span id=&#34;cb2-36&#34;&gt;&lt;a href=&#34;#cb2-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][T]);&lt;/span&gt;
&lt;span id=&#34;cb2-37&#34;&gt;&lt;a href=&#34;#cb2-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-38&#34;&gt;&lt;a href=&#34;#cb2-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;abc217&#34;&gt;ABC217&lt;/h3&gt;
&lt;p&gt;A + B + C + D + E&lt;/p&gt;
&lt;h4 id=&#34;abc217f---make-pair&#34;&gt;ABC217F - Make Pair&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; ä¸ªå­¦ç”Ÿï¼Œå…¶ä¸­åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å¯¹å…³ç³»å¥½ã€‚æ¯æ¬¡é€‰æ‹©ç›¸é‚»ä¸¤ä¸ªå…³ç³»å¥½çš„è¿›è¡Œé…å¯¹å¹¶ä»åºåˆ—ä¸­åˆ é™¤ï¼Œé—®æŠŠæ‰€æœ‰å­¦ç”Ÿé…å¯¹çš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸€çœ¼å°±æ˜¯åŒºé—´ dpã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{l, r}\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; é‡Œé¢çš„äººé…å¯¹çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè‡³äºè½¬ç§»ï¼Œè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; ä¸è°é…å¯¹ï¼Œè®¾å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚åˆ™é¦–å…ˆï¼Œ &lt;span class=&#34;math inline&#34;&gt;\([l, x]\)&lt;/span&gt; çš„é•¿åº¦ä¸€å®šæ˜¯å¶æ•°ï¼Œå¹¶ä¸” &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å…³ç³»å¥½ã€‚ç„¶åæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{l + 1, x - 1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_{x + 1, r}\)&lt;/span&gt;ã€‚æ³¨æ„åˆ°ç§»é™¤ &lt;span class=&#34;math inline&#34;&gt;\([l + 1, x - 1]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([x + 1, r]\)&lt;/span&gt; æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼Œå¹¶ä¸” &lt;span class=&#34;math inline&#34;&gt;\([l + 1, x - 1]\)&lt;/span&gt; å¿…é¡»åœ¨é…å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¹‹å‰å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼Œåˆå¹¶ &lt;span class=&#34;math inline&#34;&gt;\([l, x]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([x + 1, r]\)&lt;/span&gt; æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è€ƒè™‘ä¸€å…±è¿›è¡Œäº† &lt;span class=&#34;math inline&#34;&gt;\((r - l + 1) / 2\)&lt;/span&gt; æ¬¡åˆå¹¶ï¼Œè€Œæˆ‘ä»¬éœ€è¦ç¡®å®šæœ‰å“ªå‡ æ¬¡æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\([x + 1, r]\)&lt;/span&gt; é‡Œé¢çš„åœ¨åšï¼Œä¸éš¾å‘ç°å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
\binom{(r - l + 1) / 2}{(r - x) / 2}
\]&lt;/span&gt; è½¬ç§»çš„æ—¶å€™ä¹˜ä¸Šè¿™ä¸ªç³»æ•°å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc217/submissions/25628059&#34;&gt;ä»£ç &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc217g---groups&#34;&gt;ABC217G - Groups&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªæ•°ï¼Œè¦æ±‚åˆ’åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªéç©ºç»„ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(i\equiv j\pmod m\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸èƒ½åœ¨ä¸€ç»„ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k = 1,\cdots, n\)&lt;/span&gt; è¾“å‡ºæ–¹æ¡ˆæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;åŸæ¥çš„ç»„æ˜¯éç©ºä¸”æ— æ ‡å·çš„ï¼Œæ–¹æ¡ˆæ•°è®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(k)\)&lt;/span&gt;ï¼Œå…ˆè€ƒè™‘å¯ä»¥ä¸ºç©ºå¹¶ä¸”æœ‰æ ‡å·çš„æƒ…å†µï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(g(k)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; ä¸­æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„ä½™æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„æ•°å­—æ„æˆçš„é›†åˆï¼Œåˆ™å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt;ï¼Œæˆ‘ä»¬éƒ½è¦å°†å…¶åˆ’åˆ†åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªä¸åŒçš„ç»„é‡Œé¢å»ï¼Œæ¯ä¸ªç»„é‡Œé¢æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(P(n, m) = \displaystyle\frac{n!}{(n - m)!}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; é€‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„æ’åˆ—æ•°ï¼š &lt;span class=&#34;math display&#34;&gt;\[
g(k) = \prod_{i = 0}^{m - 1 }P(k, |S_i|)
\]&lt;/span&gt; è¿™æ˜¯ä¸è¦æ±‚æ”¾æ»¡çš„ã€‚è€Œå¦‚æœçŸ¥é“æ°å¥½æ”¾æ»¡çš„ï¼Œé™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(k!\)&lt;/span&gt; å°±æ˜¯ä¸å¸¦æ ‡å·çš„äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ°å¥½æ”¾æ»¡å¯ä»¥ç”¨å®¹æ–¥ã€‚å»æ‰çš„æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{p = 0}^{k - 1}\binom kpf(p)p!
\]&lt;/span&gt; å³ä¸ºæœ‰åºéç©ºç»„æ•°ä¸åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ï¼Œæ‰€ä»¥ &lt;span class=&#34;math display&#34;&gt;\[
f(k) = \frac{\prod_{i = 0}^{m - 1}P(k, |S_i|) - \sum_{p = 0}^{k - 1}\binom k p f(p)p!}{k!}
\]&lt;/span&gt; é€’æ¨å¯åšï¼Œå‰é¢é‚£ä¸€æ®µå¯ä»¥å¿«é€Ÿé¢„å¤„ç†ç„¶åç”¨å¿«é€Ÿå¹‚ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; æ¥ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc217/submissions/25641347/&#34;&gt;ä»£ç &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc219&#34;&gt;ABC219&lt;/h3&gt;
&lt;p&gt;çŠ¶æ€å·®ã€‚A + B + C + Dã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc219e---moat&#34;&gt;ABC219E - Moat&lt;/h4&gt;
&lt;p&gt;ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(4\times 4\)&lt;/span&gt; çš„ç½‘æ ¼ï¼Œè¦æ±‚åœ¨ç½‘æ ¼è¾¹ä¸Šä¿®ä¸€ä¸ªæŠ¤åŸæ²³ï¼Œä½¿å¾—æŠ¤åŸæ²³æ˜¯ä¸€ä¸ªåˆæ³•å¤šè¾¹å½¢å¹¶ä¸”åŒ…å«äº†æ‰€æœ‰çš„æ‘åº„ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒç¥å¥‡çš„æ€è·¯ï¼Œé‰´äºç½‘æ ¼åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(16\)&lt;/span&gt; ä¸ªï¼Œè€Œä¸”ä¸€ä¸ªæŠ¤åŸæ²³å¿…å®šå’Œä¸€ç§çŠ¶æ€ï¼ˆä¸€ä¸ªæ ¼å­æœ‰æ²¡æœ‰è¢«åŒ…å«ï¼‰ä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æšä¸¾è¿™ &lt;span class=&#34;math inline&#34;&gt;\(O(2^{16})\)&lt;/span&gt; ä¸ªçŠ¶æ€ç„¶ååˆ¤æ–­ç½‘æ ¼æ˜¯å¦åˆæ³•ã€‚&lt;/p&gt;
&lt;p&gt;åˆ¤æ–­ç½‘æ ¼æ˜¯å¦åˆæ³•è¿™ä¸ªï¼Œé¦–å…ˆéœ€è¦åˆ¤æ–­æ¯ä¸ªæ‘åº„æ˜¯ä¸æ˜¯è¢«åŒ…å«ï¼Œå…¶æ¬¡éœ€è¦é¿å…ä¸­é—´è¢«æŒ–ç©ºçš„æƒ…å†µï¼Œç„¶åè¦é¿å… &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„æ ¼å­è¢«å‰²è£‚å¼€çš„æƒ…å†µï¼Œç»¼ä¸Šå³æ•´å¼ å›¾ï¼ˆæŠŠè¾¹ç•Œå¤–çš„è€ƒè™‘è¿›å»ï¼‰åªèƒ½æœ‰ä¸¤ä¸ªè¿é€šå—ï¼Œdfs æŸ“è‰²å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc222&#34;&gt;ABC222&lt;/h3&gt;
&lt;p&gt;A + B + C + D + Gï¼Œrk 425ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc222e---red-and-blue-tree&#34;&gt;ABC222E - Red and Blue Tree&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¡æ ‘ä¸Šè·¯å¾„ï¼Œæ¯æ¬¡ä¼šè¦†ç›–è‹¥å¹²è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘è®¾ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¡è¾¹çš„è¢«è¦†ç›–æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯æ¬¡éƒ½ä¼šç»™é€”å¾„çš„ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚è¦†ç›–å®Œä¹‹åè®¿é—®çº¢è¾¹çš„æ¬¡æ•°-è®¿é—®è“è¾¹çš„æ¬¡æ•°=&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé—®æŸ“è‰²æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æš´åŠ›ç»™è¾¹æŸ“è‰²ã€‚&lt;/p&gt;
&lt;p&gt;æŸ“å®Œä¹‹åä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(R\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; æ˜¯ç¡®å®šçš„ã€‚æ‰€ä»¥ç›´æ¥èƒŒåŒ…ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc222f---expensive-expense&#34;&gt;ABC222F - Expensive Expense&lt;/h4&gt;
&lt;p&gt;æ ‘ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(E_{i, j}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è·¯å¾„ä¸Šè¾¹æƒå’ŒåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ç‚¹æƒï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰¾åˆ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(E_{i, j}\)&lt;/span&gt;ï¼Œç‚¹æ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(2\times 10^5\)&lt;/span&gt; çº§åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•æ¢æ ¹ dpã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc231&#34;&gt;ABC231&lt;/h3&gt;
&lt;p&gt;A + B + C + D + Fï¼Œrk571&lt;/p&gt;
&lt;h4 id=&#34;abc231e---minimal-payments&#34;&gt;ABC231E - Minimal payments&lt;/h4&gt;
&lt;p&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(A_{i - 1}\mid A_i\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å¯ä»¥åªè€ƒè™‘ä¸¤ç§æ–¹æ¡ˆï¼šç”¨è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å°½å¯èƒ½å‡‘ï¼Œæˆ–è€…ç”¨æ›´å¤§çš„é¢å€¼ä»˜ç„¶åè¦æ‰¾é›¶ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb3&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb3-1&#34;&gt;&lt;a href=&#34;#cb3-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-2&#34;&gt;&lt;a href=&#34;#cb3-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb3-3&#34;&gt;&lt;a href=&#34;#cb3-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll a[&lt;span class=&#34;dv&#34;&gt;65&lt;/span&gt;], x, ans;&lt;/span&gt;
&lt;span id=&#34;cb3-4&#34;&gt;&lt;a href=&#34;#cb3-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;unordered_map&amp;lt;ll, unordered_map&amp;lt;ll, ll&amp;gt; &amp;gt; f;&lt;/span&gt;
&lt;span id=&#34;cb3-5&#34;&gt;&lt;a href=&#34;#cb3-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-6&#34;&gt;&lt;a href=&#34;#cb3-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll dfs(ll x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now) {&lt;/span&gt;
&lt;span id=&#34;cb3-7&#34;&gt;&lt;a href=&#34;#cb3-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x;&lt;/span&gt;
&lt;span id=&#34;cb3-8&#34;&gt;&lt;a href=&#34;#cb3-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[x][now] &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[x][now];&lt;/span&gt;
&lt;span id=&#34;cb3-9&#34;&gt;&lt;a href=&#34;#cb3-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll r = x % a[now], q = x / a[now], p = a[now] - r;&lt;/span&gt;
&lt;span id=&#34;cb3-10&#34;&gt;&lt;a href=&#34;#cb3-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; q;&lt;/span&gt;
&lt;span id=&#34;cb3-11&#34;&gt;&lt;a href=&#34;#cb3-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll w1 = q + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; + dfs(p, now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-12&#34;&gt;&lt;a href=&#34;#cb3-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll w2 = q + dfs(r, now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-13&#34;&gt;&lt;a href=&#34;#cb3-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[x][now] = min(w1, w2);&lt;/span&gt;
&lt;span id=&#34;cb3-14&#34;&gt;&lt;a href=&#34;#cb3-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb3-15&#34;&gt;&lt;a href=&#34;#cb3-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-16&#34;&gt;&lt;a href=&#34;#cb3-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb3-17&#34;&gt;&lt;a href=&#34;#cb3-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, x);&lt;/span&gt;
&lt;span id=&#34;cb3-18&#34;&gt;&lt;a href=&#34;#cb3-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb3-19&#34;&gt;&lt;a href=&#34;#cb3-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans = x;&lt;/span&gt;
&lt;span id=&#34;cb3-20&#34;&gt;&lt;a href=&#34;#cb3-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(dfs(x, n));&lt;/span&gt;
&lt;span id=&#34;cb3-21&#34;&gt;&lt;a href=&#34;#cb3-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-22&#34;&gt;&lt;a href=&#34;#cb3-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc231g---balls-in-boxes&#34;&gt;ABC231G - Balls in Boxes&lt;/h4&gt;
&lt;p&gt;æœŸæœ›ç‰›é€¼é¢˜ã€‚å¤§ä½“æ€è·¯å°±æ˜¯æ‹†å¼€æœŸæœ›çš„å¼å­ï¼Œåˆ©ç”¨çº¿æ€§æ€§è¿›è¡ŒåŒ–ç®€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªç›’å­ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç›’å­ä¸€å¼€å§‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä¸ªçƒï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéšæœºé€‰ä¸€ä¸ªç›’å­åŠ ä¸€ä¸ªçƒï¼Œæœ€åæ¯ä¸ªç›’å­æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; ä¸ªçƒï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\(S = \prod B_i\)&lt;/span&gt; çš„æœŸæœ›ï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(E[S]\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(X_i\)&lt;/span&gt; ä¸ºè¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç›’å­è¢«é€‰ä¸­æ¬¡æ•°çš„éšæœºå˜é‡ï¼Œåˆ™æˆ‘ä»¬è¦çš„æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(E[\prod_i(A_i + X_i)]\)&lt;/span&gt;ã€‚è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(N = 2\)&lt;/span&gt; çš„æƒ…å†µï¼Œå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(E[(A_1 + X_1)(A_2 + X_2)] = E[A_1A_2] + E[A_1X_2] + E[A_2X_1] + E[X_1X_2]\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¨è€Œå¹¿ä¹‹ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªä¸ä¸€æ ·çš„ä¸‹æ ‡ &lt;span class=&#34;math inline&#34;&gt;\(i_1,\cdots, i_n\)&lt;/span&gt;ï¼Œå®¹æ˜“çŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(E[\prod_{j = 1}^n X_{i_j}] = E[\prod_{i = 1}^nX_i]\)&lt;/span&gt;ã€‚æ‰€ä»¥æå‡ºè¿™ä¸ªå…¬å› å¼ï¼Œæœ‰ &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i =1}^N(A_i + X_i)\right] = \sum_{n = 0}^NS_{N, n}(A_1,\cdots, A_N)E\left[\prod_{i =1}^{N - n}X_i\right]
\]&lt;/span&gt; å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(S_{N, n}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªå˜é‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å¯¹ç§°å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨åªéœ€è¦å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ç®—å‡º &lt;span class=&#34;math inline&#34;&gt;\(S_{N, n}(A_1,\cdots, A_N)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(E[\prod_{i = 1}^nX_i]\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å‰è€…ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S_{N, n}(A_1,\cdots, A_N) = [x^n]\prod_{i =1}^N(A_ix + 1)\)&lt;/span&gt;ã€‚è¿™ä¸ªä¸œè¥¿ä¸€ä¸ªåˆ†æ²» NTT ç¢¾è¿‡å»åº”è¯¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯åè€…ã€‚æˆ‘ä»¬è€ƒè™‘éšæœºå˜é‡ &lt;span class=&#34;math inline&#34;&gt;\(X_{i, j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç›’å­åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ¬¡æ“ä½œæ˜¯å¦ä¼šè¢«é€‰ä¸­ï¼ˆ0/1ï¼‰ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(X_i = \sum_{j = 1}^KX_{i, j}\)&lt;/span&gt;ã€‚æšä¸¾ä¸€ä¸‹ä¸‹æ ‡ï¼Œå‘ç° &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i = 1}^n X_i \right] = \sum_{j_1, j_2,\cdots, j_n}E\left[\prod_{i = 1}^nX_{i, j_i}\right]
\]&lt;/span&gt; ç„¶åå½“ &lt;span class=&#34;math inline&#34;&gt;\(i_1\not= i_2\)&lt;/span&gt; çš„æ—¶å€™ï¼Œæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(X_{i_1, j}X_{i_2, j} = 0\)&lt;/span&gt;ã€‚æ•… &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i = 1}^nX_{i, j_i}\right] =
\begin{cases}
\left(\frac 1N\right)^n \quad&amp;amp; \text{if }j_i\text{ are pairwise different}\\
0\quad&amp;amp; \text{otherwise}
\end{cases}
\]&lt;/span&gt; äºæ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i = 1}^n X_i \right] = \left(\prod_{i = 1}^n(K + 1 - i)\right)\left(\frac1N\right)^n
\]&lt;/span&gt; è¿™ä¸ªå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; ç®—ï¼Œäºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; è§£å†³äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc232&#34;&gt;ABC232&lt;/h3&gt;
&lt;p&gt;Aï¼ŒB ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;C å»ºå‡ºä¸€å¼ å›¾çš„é‚»æ¥çŸ©é˜µç„¶åç”¨ &lt;code&gt;next_permutation&lt;/code&gt; æšä¸¾æ’åˆ—åˆ¤æ–­æ˜¯å¦èƒ½å»ºç«‹æ˜ å°„å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;D ç®€å•ç½‘æ ¼ dpï¼Œæ³¨æ„è¾¹ç•Œæ¡ä»¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232e---rook-path&#34;&gt;ABC232E - Rook Path&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H \times W\)&lt;/span&gt; çš„ç½‘æ ¼ï¼Œä½ åˆå§‹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((x_1, y_1)\)&lt;/span&gt;ï¼Œè¦æ±‚åš &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; æ¬¡æ“ä½œåä½ç½®å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\((x_2, y_2)\)&lt;/span&gt;ã€‚æ¯æ¬¡æ“ä½œå½¢å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç§»åŠ¨æ¨ªåæ ‡ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\((x&amp;#39;, y)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(1\le x&amp;#39;\le H\land x&amp;#39;\neq x\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç§»åŠ¨çºµåæ ‡ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\((x, y&amp;#39;)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(1\le y&amp;#39;\le W\land y&amp;#39;\neq y\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ï¼ˆå°±æ˜¯è½¦çš„ç§»åŠ¨æ–¹å¼ï¼‰é—®æœ‰å¤šå°‘ç§å¯èƒ½çš„æ“ä½œæ–¹æ¡ˆï¼Œä¸¤ç§æ“ä½œæ–¹æ¡ˆä¸åŒå½“ä¸”ä»…å½“ä¸­é—´æŸä¸€æ­¥ç»è¿‡çš„ç‚¹ä¸åŒã€‚ç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®å¥—è·¯ï¼Œè¿™ä¸ªä¸œè¥¿çš„æ¨ªå‘ç§»åŠ¨å’Œçºµå‘ç§»åŠ¨æ˜¯å¯ä»¥åˆ†å¼€æ¥è€ƒè™‘çš„ã€‚å³ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ¨ªå‘ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆï¼Œå†ä¹˜ä¸Šçºµå‘ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(K - m\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆï¼Œå†ä¹˜ä¸Šç»„åˆç³»æ•° &lt;span class=&#34;math inline&#34;&gt;\(\dbinom K m\)&lt;/span&gt;ã€‚è€ƒè™‘è®¡ç®—åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ DPï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{0/1, i}\)&lt;/span&gt; è¡¨ç¤ºæ¨ªå‘ç§»åŠ¨ï¼ˆçºµå‘çš„ç±»ä¼¼ï¼‰å›åˆ°å‡ºå‘ç‚¹ä¸å¦ï¼Œèµ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­åˆå§‹è¾¹ç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{1,0} = 1\)&lt;/span&gt;ï¼Œå³èµ° &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ­¥ï¼Œç»ˆç‚¹åœ¨åŸç‚¹çš„æ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚è½¬ç§»å¦‚ä¸‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{cases}
f_{1, i} = (H - 1)f_{1, i - 1}\\
f_{0, i} = f_{1, i - 1} + (H - 2)f_{0, i - 1}
\end{cases}
\]&lt;/span&gt; è½¬ç§»çš„æ„ä¹‰è¿˜æ˜¯å¾ˆæ˜¾ç„¶çš„ã€‚äºæ˜¯æˆ‘ä»¬ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; æ±‚å‡º dp æ•°ç»„ï¼Œè¿™é¢˜å°±åšå®Œäº†ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc232/submissions/28029224&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232f---simple-operations-on-sequence&#34;&gt;ABC232F - Simple Operations on Sequence&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(2\le N\le 18\)&lt;/span&gt;ï¼‰ï¼š&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le A_i, B_i\le 10^8\)&lt;/span&gt;ï¼‰ã€‚å¯ä»¥è¿›è¡Œå¦‚ä¸‹ä¸¤ç§æ“ä½œï¼Œé—®æœ€å°çš„ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; çš„æ“ä½œä»£ä»·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; åŠ ä¸€/å‡ä¸€ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le X\le 10^8\)&lt;/span&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­çš„ç›¸é‚»å…ƒç´ ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le Y\le 10^{16}\)&lt;/span&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯«æ— ç–‘é—®ï¼Œä¸¤ä¸ªæ“ä½œæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¯ä»¥åˆ†å¼€è€ƒè™‘ã€‚å¦‚æœæˆ‘ä»¬å…ˆäº¤æ¢ï¼Œå‡ºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(P_1, P_2,\cdots,P_N\)&lt;/span&gt; çš„æ’åˆ—ï¼Œç„¶åå†ç»Ÿè®¡ç¬¬ä¸€ä¸ªçš„ç­”æ¡ˆã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{inv}(P)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; çš„é€†åºå¯¹æ•°ï¼Œåˆ™æ€»ä»£ä»·ä¸ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^N|A_{P_i} - B_i|\cdot X + \operatorname{inv}(P)\cdot Y
\]&lt;/span&gt; æŠŠé€†åºå¯¹çš„è¿™ä¸ªå…³äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„è´¡çŒ®æ‹†å¼€ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^N(|A_{P_i} - B_i|\cdot X + |\{p:p\in\{1,2,\cdots, N\} \backslash \{P_1, \cdots, P_{i - 1}\}, p &amp;lt; P_i\}|\cdot Y)
\]&lt;/span&gt; ç„¶åä¼šå‘ç°ä¸€ä¸ªå¾ˆå…³é”®çš„åœ°æ–¹ï¼šåé¢é‚£ä¸ªä¸œè¥¿åªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{P_1, \cdots, P_i\}\)&lt;/span&gt; è¿™ä¸ªé›†åˆæœ‰å…³ï¼Œè€Œè¿™ä¸ªé›†åˆå¾ˆå°ï¼Œæ‰€ä»¥ä¸å¦¨è€ƒè™‘å°†å…¶çŠ¶å‹èµ·æ¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(x, S)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(|p:p\in\{1, \cdots, N\}\backslash S, p &amp;lt; x|\)&lt;/span&gt;ã€‚ç„¶åå¼å­æ”¹å†™ä¸ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^N(|A_{P_i} - B_i|\cdot X + f(P_i, \{P_1, \cdots, P_{i - 1}\})\cdot Y)
\]&lt;/span&gt; äºæ˜¯å‘ç°ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥çŠ¶å‹ dpï¼Œå…·ä½“åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(dp_S\)&lt;/span&gt; è¡¨ç¤ºæ’åˆ—çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(|S|\)&lt;/span&gt; é¡¹æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…çš„å…ƒç´ ï¼Œåˆ™è½¬ç§»åº”è¯¥æ˜¯å¾ˆå¥½è½¬ç§»çš„ã€‚è¿™é¢˜å°±åšå®Œäº†ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc232/submissions/28032712&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232g---modulo-shortest-path&#34;&gt;ABC232G - Modulo Shortest Path&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€å¼  &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªç‚¹çš„æœ‰å‘å®Œå…¨å›¾ï¼Œå…¶ä¸­ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ‰å‘è¾¹è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\((A_i + B_j)\bmod M\)&lt;/span&gt;ã€‚é—® &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le N\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\le M\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¦‚æœæˆ‘ä»¬ç›´æ¥è¿è¾¹è·‘ Dijï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šå¯„ï¼Œè¾¹æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çº§åˆ«çš„ï¼Œè¦æƒ³åŠæ³•å°‘ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸ªæŠ€å·§ï¼Œå»ºä¸€å¼ æ–°å›¾ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„å»º &lt;span class=&#34;math inline&#34;&gt;\([0, M)\)&lt;/span&gt; çš„è™šç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(\overline{0},\overline 1,\cdots,\overline{M - 1}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(\forall k\in[0, M - 1)\)&lt;/span&gt;ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(\overline k\to \overline{k + 1}\)&lt;/span&gt;ï¼Œè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\in [1, N]\)&lt;/span&gt;ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(i\to \overline{-A_i\bmod M}\)&lt;/span&gt;ï¼Œè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\in [1, N]\)&lt;/span&gt;ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(\overline{B_i}\)&lt;/span&gt;ï¼Œè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å°±ç›¸å½“äºï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\overline{-A_i\bmod M}\)&lt;/span&gt;ï¼Œç„¶åä¸€æ­¥æ­¥èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\overline{B_j}\)&lt;/span&gt;ï¼Œå†èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚å‘ç°ä¸­é—´çš„è·¯ç¨‹åˆšå¥½å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((A_i + B_j)\bmod M\)&lt;/span&gt;ï¼Œäºæ˜¯é—®é¢˜å°±å¾—åˆ°äº†è½¬åŒ–ï¼Œæˆ‘ä»¬æ±‚æ–°å›¾ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€çŸ­è·¯å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯æ˜¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n + m)\)&lt;/span&gt; ä¼¼ä¹ä¹Ÿå¿…æ­»æ— ç–‘ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¯ä¸Šçš„å¾ˆå¤šç‚¹æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç¼©èµ·æ¥ï¼Œä¼šå’ŒåŸæ¥çš„ç‚¹è¿æ¥çš„è™šç‚¹åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; ä¸ªï¼Œè¿™æ ·å­ç‚¹æ•°å’Œè¾¹æ•°å°±éƒ½æ§åˆ¶åœ¨äº† &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çº§åˆ«ï¼Œç›´æ¥è·‘ Dij ä¾¿å¯é€šè¿‡ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc232/submissions/28035096&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232h---kings-tour&#34;&gt;ABC232H - Kingâ€™s Tour&lt;/h4&gt;
&lt;p&gt;ä¸çŸ¥é“ç»„é¢˜äººæ€ä¹ˆæƒ³çš„ã€‚ã€‚ã€‚è¿™ä¸ªé¢˜å±…ç„¶æ”¾åœ¨ Hã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(H\times W\)&lt;/span&gt; æ£‹ç›˜ï¼Œä¸€ä¸ªå›½ç‹åˆå§‹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((1, 1)\)&lt;/span&gt;ã€‚å›½ç‹æ¯æ­¥å¯ä»¥èµ°åˆ°ä¸å…¶å…«è¿é€šçš„æ ¼å­ï¼Œè¯·æ„é€ ä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—å›½ç‹ä¸é‡å¤åœ°èµ°å®Œäº†æ¯ä¸ªæ ¼å­ï¼Œä¸”ç»ˆç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le H, W\le 100\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((a, b)\neq (1, 1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è€ƒè™‘å‡æ²»æ„é€ ã€‚è€ƒè™‘å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H = 2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(W = 2\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(H = 2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·æ„é€ æ–¹æ¡ˆï¼ˆå›¾æº AtCoder å®˜æ–¹é¢˜è§£ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/ghi/45d400563f38eb01ffea2e66239b9664.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å³ï¼Œè½¨è¿¹ä¸ºï¼š&lt;span class=&#34;math inline&#34;&gt;\((1, 1)\to (2, 1)\to\cdots\to(1, b)\to (1, b + 1)\to \cdots \to(1, W)\to (2, W)\to \cdots\to (2, b)\)&lt;/span&gt;ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(W= 2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°†è¡Œåˆ—è°ƒæ¢ä¹‹åæ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H &amp;gt; 2\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(W &amp;gt; 2\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸‹é¢è¿™ä¸ªæ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/ghi/6a11b9fe7eebca4ddd44a12826580c99.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç»¿è‰²åœˆå‡ºæ¥çš„ç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œåˆ†ç±»è®¨è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((a, b)\notin S\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥èµ°å®Œ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…çš„ç‚¹ï¼Œç„¶åå‚ç›´ç¿»è½¬ä¸€ä¸‹åæ ‡ç³»ï¼Œå°±å˜æˆäº†ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å­é—®é¢˜ï¼Œé€’å½’å¤„ç†å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((a, b)\in S\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬äº¤æ¢è¡Œåˆ—ä¹‹åï¼Œå°±å˜æˆäº† &lt;span class=&#34;math inline&#34;&gt;\((a,b)\notin S\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥é€’å½’åœ°å»è§£å†³è¿™é“é¢˜äº†ã€‚è¿™ç§ä»£ç å†™çš„å¾ˆå·§å¦™ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb4&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb4-1&#34;&gt;&lt;a href=&#34;#cb4-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-2&#34;&gt;&lt;a href=&#34;#cb4-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt; &lt;/span&gt;
&lt;span id=&#34;cb4-3&#34;&gt;&lt;a href=&#34;#cb4-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pii&amp;gt; solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; h, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; w, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;/span&gt;
&lt;span id=&#34;cb4-4&#34;&gt;&lt;a href=&#34;#cb4-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;pii&amp;gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb4-5&#34;&gt;&lt;a href=&#34;#cb4-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (h == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb4-6&#34;&gt;&lt;a href=&#34;#cb4-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, b - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i)), ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, i));&lt;/span&gt;
&lt;span id=&#34;cb4-7&#34;&gt;&lt;a href=&#34;#cb4-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; - a, b));&lt;/span&gt;
&lt;span id=&#34;cb4-8&#34;&gt;&lt;a href=&#34;#cb4-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, b + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, w) ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i));&lt;/span&gt;
&lt;span id=&#34;cb4-9&#34;&gt;&lt;a href=&#34;#cb4-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, w, b + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, i));&lt;/span&gt;
&lt;span id=&#34;cb4-10&#34;&gt;&lt;a href=&#34;#cb4-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back(pii(a, b));&lt;/span&gt;
&lt;span id=&#34;cb4-11&#34;&gt;&lt;a href=&#34;#cb4-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((h &amp;gt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; &amp;amp;&amp;amp; w == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) || b == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; || (a == h &amp;amp;&amp;amp; b == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)) {&lt;/span&gt;
&lt;span id=&#34;cb4-12&#34;&gt;&lt;a href=&#34;#cb4-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret = solve(w, h, b, a);&lt;/span&gt;
&lt;span id=&#34;cb4-13&#34;&gt;&lt;a href=&#34;#cb4-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : ret) myswap(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb4-14&#34;&gt;&lt;a href=&#34;#cb4-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb4-15&#34;&gt;&lt;a href=&#34;#cb4-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, h) ret.push_back(pii(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb4-16&#34;&gt;&lt;a href=&#34;#cb4-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; res = solve(h, w - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, h + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - a, b - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb4-17&#34;&gt;&lt;a href=&#34;#cb4-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : res) p.first = h + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - p.first, ++p.second;&lt;/span&gt;
&lt;span id=&#34;cb4-18&#34;&gt;&lt;a href=&#34;#cb4-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.insert(ret.end(), res.begin(), res.end());&lt;/span&gt;
&lt;span id=&#34;cb4-19&#34;&gt;&lt;a href=&#34;#cb4-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb4-20&#34;&gt;&lt;a href=&#34;#cb4-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb4-21&#34;&gt;&lt;a href=&#34;#cb4-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb4-22&#34;&gt;&lt;a href=&#34;#cb4-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt; &lt;/span&gt;
&lt;span id=&#34;cb4-23&#34;&gt;&lt;a href=&#34;#cb4-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb4-24&#34;&gt;&lt;a href=&#34;#cb4-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; h, w, a, b; read(h, w, a, b);&lt;/span&gt;
&lt;span id=&#34;cb4-25&#34;&gt;&lt;a href=&#34;#cb4-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; ans = solve(h, w, a, b);&lt;/span&gt;
&lt;span id=&#34;cb4-26&#34;&gt;&lt;a href=&#34;#cb4-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; p : ans) print(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb4-27&#34;&gt;&lt;a href=&#34;#cb4-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-28&#34;&gt;&lt;a href=&#34;#cb4-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;abc233&#34;&gt;ABC233&lt;/h3&gt;
&lt;h4 id=&#34;abc233f---swap-and-sort&#34;&gt;ABC233F - Swap and Sort&lt;/h4&gt;
&lt;p&gt;ç®€è¦é¢˜æ„ï¼šç»™å®šæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 1000\)&lt;/span&gt;ã€‚åŒæ—¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç»„å…³ç³» &lt;span class=&#34;math inline&#34;&gt;\((a_i, b_i)\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯ä»¥äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(P_{a_i}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(P_{b_i}\)&lt;/span&gt;ã€‚æ„é€ ä¸€ä¸ªæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(5\times 10^5\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; ä¸ºå‡åºã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªé—®é¢˜å¯ä»¥æŠ½è±¡æˆä¸€å¼ å›¾ã€‚ç„¶åå¯ä»¥å‘ç°ï¼Œå½“ä¸”ä»…å½“æ•°å­— &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; å’Œç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åœ¨ä¸€ä¸ªè¿é€šåˆ†é‡å†…æ—¶æ•´ä¸ªé—®é¢˜æœ‰è§£ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥å†™ä¸€ä¸ªå¹¶æŸ¥é›†ä¹‹ç±»çš„ä¸œè¥¿åˆ¤æ–­ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ„é€ æ–¹æ¡ˆã€‚ç”±äºä¸è¦æ±‚æœ€ä¼˜æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è€ƒè™‘å»ºå‡ºä¸€ä¸ªç”Ÿæˆæ ‘ï¼Œç„¶åä»ç‚¹åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ç‚¹å¼€å§‹é€ä¸ªå¤ä½å¹¶åˆ ç‚¹ã€‚æ“ä½œæ¬¡æ•°æœ€å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(999 + 998 + \cdots + 1 = 499500\)&lt;/span&gt;ã€‚&lt;a href=&#34;https://atcoder.jp/contests/abc233/submissions/28192989&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc233g---strongest-takahashi&#34;&gt;ABC233G - Strongest Takahashi&lt;/h4&gt;
&lt;p&gt;ç®€è¦é¢˜æ„ï¼šç»™å®šä¸€å¼  &lt;span class=&#34;math inline&#34;&gt;\(N\times N\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le N\le 50\)&lt;/span&gt;ï¼‰ç½‘æ ¼ï¼Œé‡Œé¢è‹¥å¹²ä¸ªæ ¼å­æœ‰éšœç¢ã€‚æ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(D\times D\)&lt;/span&gt; çš„åŒºåŸŸç„¶åæ¶ˆè€— &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt; ç‚¹ä½“åŠ›å°†å…¶ä¸­çš„éšœç¢æ¶ˆå»ã€‚é—®å°†æ‰€æœ‰éšœç¢æ¶ˆå»çš„æœ€å°ä½“åŠ›æ¶ˆè€—ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§é«˜ç»´åº¦çš„ dp ä¸€ç›´æ˜¯æˆ‘çš„å¼±ç‚¹ã€‚ã€‚ã€‚è€ƒè™‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A\times B\)&lt;/span&gt; çš„çŸ©å½¢åŒºåŸŸï¼ˆå­é—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬æ˜¾ç„¶éœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(C = \max(A,B)\)&lt;/span&gt; çš„ä½“åŠ›æ¥è¦†ç›–æ•´ä¸ªçŸ©å½¢ã€‚ç„¶è€Œå¯èƒ½å­˜åœ¨æ›´å°‘çš„ä½“åŠ›æ¶ˆè€—å°±èƒ½è¦†ç›–ã€‚å…·ä½“åœ°ï¼Œå½“å­˜åœ¨ä¸€ä¸ªç©ºè¡Œ/ç©ºåˆ—æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘å°†å­çŸ©å½¢åˆ’å¼€ï¼Œå˜æˆä¸¤ä¸ªç‹¬ç«‹å­é—®é¢˜ï¼Œçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰æ›´ä¼˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è®¾ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_{l,u,r,d}\)&lt;/span&gt; æ¥è¿›è¡Œ dpï¼ˆä½¿ç”¨è®°æœè½¬ç§»ï¼‰å³å¯ï¼Œè½¬ç§»å¤æ‚åº¦ä¼¼ä¹æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^5)\)&lt;/span&gt; çš„ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc233/submissions/28194586&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc233ex---manhattan-christmas-tree&#34;&gt;ABC233Ex - Manhattan Christmas Tree&lt;/h4&gt;
&lt;p&gt;ç®€è¦é¢˜æ„ï¼šç»™å®šå¹³é¢å†… &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡è¯¢é—®åˆ° &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿‘çš„ç‚¹åˆ° &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; çš„è·ç¦»ï¼Œè¿™é‡Œçš„è·ç¦»æŒ‡æ›¼å“ˆé¡¿è·ç¦»ã€‚&lt;span class=&#34;math inline&#34;&gt;\(5\times 10^5\)&lt;/span&gt;ï¼Œ7sã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å‘ç°æ›¼å“ˆé¡¿è·ç¦»å¾ˆä¸å¥½å¤„ç†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿‘ä¹‹ç±»çš„é—®é¢˜ï¼Œå› ä¸ºæ—¢è¦è€ƒè™‘ä¸¤ä¸ªç»´åº¦åˆæœ‰ç»å¯¹å€¼ã€‚æ‰€ä»¥è€ƒè™‘å°†æ¯ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\((x + y, x - y)\)&lt;/span&gt;ï¼Œè¿™æ ·åŸå›¾çš„æ›¼å“ˆé¡¿è·ç¦»å°±å¯ä»¥è¢«è½¬åŒ–ä¸ºåˆ‡æ¯”é›ªå¤«è·ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¯¹äºæ¯ä¸ªè¯¢é—®å°±å¯ä»¥äºŒåˆ†ä¸€ä¸‹ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿‘çš„è·ç¦»ï¼ŒæŸ¥è¯¢æœ‰å¤šå°‘ä¸ªç‚¹åˆ° &lt;span class=&#34;math inline&#34;&gt;\((a,b)\)&lt;/span&gt; çš„åˆ‡æ¯”é›ªå¤«è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(\le d\)&lt;/span&gt;ï¼Œè¿™ä¸ªæŸ¥è¯¢å…¶å®å°±æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç‚¹ï¼ˆæŸ¥è¯¢çŸ©å½¢å’Œï¼‰ï¼Œå¯ä»¥é€šè¿‡å†™ä¸€ä¸ªä¸»å¸­æ ‘æ¥å®ç°ã€‚å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O((n + Q)\log^2X)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; ä¸ºç‚¹çš„å€¼åŸŸã€‚ä¸»å¸­æ ‘å†™ç€æœ‰ç‚¹å¿ƒçƒ¦ï¼Œè¦æ³¨æ„ç»†èŠ‚ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc233/submissions/28193992&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc234&#34;&gt;ABC234&lt;/h3&gt;
&lt;p&gt;Aï¼ŒB ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;C è€ƒè™‘å°† &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;D ç»´æŠ¤ä¸€ä¸ªå°æ ¹å †åœ¨çº¿ç»´æŠ¤å‰ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; å¤§å…ƒç´ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;E å‘ç°é¦–é¡¹åªå¯èƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_1\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(a_1 + 1\)&lt;/span&gt;ï¼Œéšåæšä¸¾å…¬å·®åˆ¤æ–­æ˜¯å¦å¯è¡Œå³å¯ï¼Œç»†èŠ‚ç•¥å¤šã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc234f---reordering&#34;&gt;ABC234F - Reordering&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œé—®é€‰å‡ºé‡Œé¢çš„éƒ¨åˆ†å­—æ¯å¹¶é‡æ’åèƒ½å¾—åˆ°å¤šå°‘ç§ä¸åŒå­—ç¬¦ä¸²ã€‚&lt;span class=&#34;math inline&#34;&gt;\(|S|\le 5000\)&lt;/span&gt;ï¼Œæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘èƒ½æ„æˆçš„å­—ç¬¦ä¸²åªä¸å­—ç¬¦é›†åˆæœ‰å…³ã€‚æˆ‘ä»¬ä¸å¦¨ä» &lt;span class=&#34;math inline&#34;&gt;\(\texttt a\)&lt;/span&gt; å¼€å§‹ï¼Œä¸€ä¸ªä¸ªçš„åŠ å­—ç¬¦ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; è¡¨ç¤ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§å­—ç¬¦ä¸­ï¼Œå¡«æ»¡äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæ ¼å­çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™è€ƒè™‘ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå­—ç¬¦æˆ‘ä»¬å¡« &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªè¿›å»ï¼Œå°±ç›¸å½“äºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(j - k + 1\)&lt;/span&gt; ä¸ªä¸åŒçš„æ¡¶é‡Œé¢æ”¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªç›¸åŒçƒï¼Œå¯ä»¥æœ‰ç©ºæ¡¶ï¼Œæ‰€ä»¥è½¬ç§»å¦‚ä¸‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_{i,j} = \sum_{k = 0}^{\min(j, g(i))}\binom k jf_{i- 1, j - k}
\]&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(g(i)\)&lt;/span&gt; ä¸ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§å­—ç¬¦åœ¨åŸä¸²ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(\sum f_{26, i}\)&lt;/span&gt; å°±æ˜¯ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb5&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb5-1&#34;&gt;&lt;a href=&#34;#cb5-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;5005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-2&#34;&gt;&lt;a href=&#34;#cb5-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb5-3&#34;&gt;&lt;a href=&#34;#cb5-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[&lt;span class=&#34;dv&#34;&gt;26&lt;/span&gt;][maxn], fac[maxn], ifac[maxn];&lt;/span&gt;
&lt;span id=&#34;cb5-4&#34;&gt;&lt;a href=&#34;#cb5-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; buc[&lt;span class=&#34;dv&#34;&gt;27&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-5&#34;&gt;&lt;a href=&#34;#cb5-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb5-6&#34;&gt;&lt;a href=&#34;#cb5-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint binom(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; fac[n] * ifac[m] * ifac[n - m];}&lt;/span&gt;
&lt;span id=&#34;cb5-7&#34;&gt;&lt;a href=&#34;#cb5-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb5-8&#34;&gt;&lt;a href=&#34;#cb5-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb5-9&#34;&gt;&lt;a href=&#34;#cb5-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-10&#34;&gt;&lt;a href=&#34;#cb5-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = strlen(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-11&#34;&gt;&lt;a href=&#34;#cb5-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) ++buc[s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-12&#34;&gt;&lt;a href=&#34;#cb5-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    fac[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-13&#34;&gt;&lt;a href=&#34;#cb5-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) fac[i] = i * fac[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-14&#34;&gt;&lt;a href=&#34;#cb5-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ifac[n] = qPow(fac[n], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-15&#34;&gt;&lt;a href=&#34;#cb5-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ifac[i] = (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * ifac[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-16&#34;&gt;&lt;a href=&#34;#cb5-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, buc[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]) f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][j] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-17&#34;&gt;&lt;a href=&#34;#cb5-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb5-18&#34;&gt;&lt;a href=&#34;#cb5-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb5-19&#34;&gt;&lt;a href=&#34;#cb5-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, min(buc[i], j)) {&lt;/span&gt;
&lt;span id=&#34;cb5-20&#34;&gt;&lt;a href=&#34;#cb5-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[i][j] += binom(j, k) * f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j - k];&lt;/span&gt;
&lt;span id=&#34;cb5-21&#34;&gt;&lt;a href=&#34;#cb5-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb5-22&#34;&gt;&lt;a href=&#34;#cb5-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb5-23&#34;&gt;&lt;a href=&#34;#cb5-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb5-24&#34;&gt;&lt;a href=&#34;#cb5-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-25&#34;&gt;&lt;a href=&#34;#cb5-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) ans += f[&lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;][j];&lt;/span&gt;
&lt;span id=&#34;cb5-26&#34;&gt;&lt;a href=&#34;#cb5-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb5-27&#34;&gt;&lt;a href=&#34;#cb5-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-28&#34;&gt;&lt;a href=&#34;#cb5-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc234g---divide-a-sequence&#34;&gt;ABC234G - Divide a Sequence&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2^{N - 1}\)&lt;/span&gt; ç§æ–¹æ³•å°†å…¶åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéç©ºåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(B_1,\cdots, B_k\)&lt;/span&gt;ï¼Œæ±‚å‡ºå¯¹äºæ¯ç§åˆ’åˆ†æ–¹å¼ï¼Œä¸‹é¢è¿™ä¸ªå¼å­çš„å’Œï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\le 3\times 10^5\)&lt;/span&gt;ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\prod_{i = 1}^k(\max\{B_i\} - \min\{B_i\})
\]&lt;/span&gt; è€ƒè™‘ä¸€ä¸ª dpï¼š&lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(A_1, \cdots, A_i\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œè¾¹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_0 = 1\)&lt;/span&gt;ã€‚åˆ™æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_i = \sum_{j = 0}^{i - 1}f_j(\max_{k = j + 1}^i\{A_i\} - \min_{k = j + 1}^i\{A_i\})
\]&lt;/span&gt; è¿™ä¸ªå¼å­çœ‹ä¼¼æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„ï¼Œæ‹†å¼€æ¥ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_i = \sum_{j = 0}^{i - 1}f_j\max_{k = j + 1}^i\{A_i\} - \sum_{j = 0}^{i - 1}f_j\min_{k = j + 1}^i\{A_i\}
\]&lt;/span&gt; ç„¶åæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(\max_{k = j + 1}^i\{A_k\}\)&lt;/span&gt;ï¼Œä»¥åŠå¯¹åº”çš„ dp å€¼ä¹‹å’Œï¼Œä½¿ç”¨å•è°ƒæ ˆå°±å¯ä»¥å®Œæˆè¿™é¢˜äº†ã€‚ç­”æ¡ˆå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_n\)&lt;/span&gt;ï¼Œå®ç°ç»†èŠ‚è§ä»£ç ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb6&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb6-1&#34;&gt;&lt;a href=&#34;#cb6-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-2&#34;&gt;&lt;a href=&#34;#cb6-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[maxn];&lt;/span&gt;
&lt;span id=&#34;cb6-3&#34;&gt;&lt;a href=&#34;#cb6-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n;&lt;/span&gt;
&lt;span id=&#34;cb6-4&#34;&gt;&lt;a href=&#34;#cb6-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-5&#34;&gt;&lt;a href=&#34;#cb6-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; node {&lt;/span&gt;
&lt;span id=&#34;cb6-6&#34;&gt;&lt;a href=&#34;#cb6-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a;&lt;/span&gt;
&lt;span id=&#34;cb6-7&#34;&gt;&lt;a href=&#34;#cb6-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint v;&lt;/span&gt;
&lt;span id=&#34;cb6-8&#34;&gt;&lt;a href=&#34;#cb6-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} st1[maxn], st2[maxn];&lt;/span&gt;
&lt;span id=&#34;cb6-9&#34;&gt;&lt;a href=&#34;#cb6-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; top1, top2;&lt;/span&gt;
&lt;span id=&#34;cb6-10&#34;&gt;&lt;a href=&#34;#cb6-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-11&#34;&gt;&lt;a href=&#34;#cb6-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb6-12&#34;&gt;&lt;a href=&#34;#cb6-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb6-13&#34;&gt;&lt;a href=&#34;#cb6-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb6-14&#34;&gt;&lt;a href=&#34;#cb6-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-15&#34;&gt;&lt;a href=&#34;#cb6-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint maxsum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, minsum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-16&#34;&gt;&lt;a href=&#34;#cb6-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb6-17&#34;&gt;&lt;a href=&#34;#cb6-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        modint sumv = f[i];&lt;/span&gt;
&lt;span id=&#34;cb6-18&#34;&gt;&lt;a href=&#34;#cb6-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top1 &amp;amp;&amp;amp; st1[top1].a &amp;lt; a[i]) {&lt;/span&gt;
&lt;span id=&#34;cb6-19&#34;&gt;&lt;a href=&#34;#cb6-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            maxsum -= st1[top1].a * st1[top1].v;&lt;/span&gt;
&lt;span id=&#34;cb6-20&#34;&gt;&lt;a href=&#34;#cb6-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            sumv += st1[top1].v;&lt;/span&gt;
&lt;span id=&#34;cb6-21&#34;&gt;&lt;a href=&#34;#cb6-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            --top1;&lt;/span&gt;
&lt;span id=&#34;cb6-22&#34;&gt;&lt;a href=&#34;#cb6-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb6-23&#34;&gt;&lt;a href=&#34;#cb6-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        maxsum += sumv * a[i];&lt;/span&gt;
&lt;span id=&#34;cb6-24&#34;&gt;&lt;a href=&#34;#cb6-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++top1, st1[top1] = {a[i], sumv};&lt;/span&gt;
&lt;span id=&#34;cb6-25&#34;&gt;&lt;a href=&#34;#cb6-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        sumv = f[i];&lt;/span&gt;
&lt;span id=&#34;cb6-26&#34;&gt;&lt;a href=&#34;#cb6-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top2 &amp;amp;&amp;amp; st2[top2].a &amp;gt; a[i]) {&lt;/span&gt;
&lt;span id=&#34;cb6-27&#34;&gt;&lt;a href=&#34;#cb6-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            minsum -= st2[top2].a * st2[top2].v;&lt;/span&gt;
&lt;span id=&#34;cb6-28&#34;&gt;&lt;a href=&#34;#cb6-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            sumv += st2[top2].v;&lt;/span&gt;
&lt;span id=&#34;cb6-29&#34;&gt;&lt;a href=&#34;#cb6-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            --top2;&lt;/span&gt;
&lt;span id=&#34;cb6-30&#34;&gt;&lt;a href=&#34;#cb6-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb6-31&#34;&gt;&lt;a href=&#34;#cb6-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        minsum += sumv * a[i];&lt;/span&gt;
&lt;span id=&#34;cb6-32&#34;&gt;&lt;a href=&#34;#cb6-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++top2, st2[top2] = {a[i], sumv};&lt;/span&gt;
&lt;span id=&#34;cb6-33&#34;&gt;&lt;a href=&#34;#cb6-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = maxsum - minsum;&lt;/span&gt;
&lt;span id=&#34;cb6-34&#34;&gt;&lt;a href=&#34;#cb6-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb6-35&#34;&gt;&lt;a href=&#34;#cb6-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb6-36&#34;&gt;&lt;a href=&#34;#cb6-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-37&#34;&gt;&lt;a href=&#34;#cb6-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc234ex---enumerate-pairs&#34;&gt;ABC234Ex - Enumerate Pairs&lt;/h4&gt;
&lt;p&gt;ç»™å®šäºŒç»´å¹³é¢ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x_i, y_i)\)&lt;/span&gt; å’Œä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ã€‚è¯·åˆ—å‡ºæ‰€æœ‰æ¬§å‡ é‡Œå¾—è·ç¦»å°äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ç‚¹å¯¹ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le N\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le K\le 1.5\times 10^9\)&lt;/span&gt;ã€‚ä¿è¯æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(4\times 10^5\)&lt;/span&gt; å¯¹ç‚¹å¯¹å°†è¢«æšä¸¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»¥ä¸‹é¢˜è§£å‚è€ƒäº† AtCoder å®˜æ–¹é¢˜è§£&lt;/strong&gt;ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc234/editorial/3235&#34;&gt;ä¼ é€é—¨&lt;/a&gt;ã€‚ç¥ä»™ç»“è®ºé¢˜ï¼Œå…ˆç»™å‡ºç»“è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x_i, y_i)\)&lt;/span&gt;ï¼Œå°†å…¶åˆ†é…åˆ°é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\((\lfloor x_i/K\rfloor, \lfloor y_i/K\rfloor)\)&lt;/span&gt; ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åå¯¹äºä»»æ„ä¸€ä¸ªç‚¹ï¼Œè‹¥å…¶è¢«åˆ†é…åˆ°äº† &lt;span class=&#34;math inline&#34;&gt;\((X, Y)\)&lt;/span&gt; é›†åˆä¸­ï¼Œåˆ™èƒ½ä¸å…¶é…å¯¹çš„ç‚¹ä¸€å®šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\((X + m, Y + l)\)&lt;/span&gt; é›†åˆä¸­ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(-1\le m,l\le 1\)&lt;/span&gt;ã€‚ç›´æ¥æšä¸¾å³å¯å¾—åˆ°ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ä¸ºè¾“å‡ºçš„ç­”æ¡ˆä¸ªæ•°ï¼ˆå¿½ç•¥äº†ä½¿ç”¨æ•°æ®ç»“æ„äº§ç”Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb7&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb7-1&#34;&gt;&lt;a href=&#34;#cb7-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-2&#34;&gt;&lt;a href=&#34;#cb7-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-3&#34;&gt;&lt;a href=&#34;#cb7-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pll = pair&amp;lt;ll, ll&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-4&#34;&gt;&lt;a href=&#34;#cb7-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-5&#34;&gt;&lt;a href=&#34;#cb7-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll big = &lt;span class=&#34;dv&#34;&gt;2000000000&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-6&#34;&gt;&lt;a href=&#34;#cb7-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; ll K;&lt;/span&gt;
&lt;span id=&#34;cb7-7&#34;&gt;&lt;a href=&#34;#cb7-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pll p[maxn];&lt;/span&gt;
&lt;span id=&#34;cb7-8&#34;&gt;&lt;a href=&#34;#cb7-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;ll, vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; &amp;gt; mp;&lt;/span&gt;
&lt;span id=&#34;cb7-9&#34;&gt;&lt;a href=&#34;#cb7-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;ll&amp;gt; delta = {-big - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -big, -big + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, big - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, big, big + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb7-10&#34;&gt;&lt;a href=&#34;#cb7-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-11&#34;&gt;&lt;a href=&#34;#cb7-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb7-12&#34;&gt;&lt;a href=&#34;#cb7-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, K);&lt;/span&gt;
&lt;span id=&#34;cb7-13&#34;&gt;&lt;a href=&#34;#cb7-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb7-14&#34;&gt;&lt;a href=&#34;#cb7-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(p[i].first, p[i].second);&lt;/span&gt;
&lt;span id=&#34;cb7-15&#34;&gt;&lt;a href=&#34;#cb7-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll id = (p[i].first / K) * big + (p[i].second / K);&lt;/span&gt;
&lt;span id=&#34;cb7-16&#34;&gt;&lt;a href=&#34;#cb7-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        mp[id].push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb7-17&#34;&gt;&lt;a href=&#34;#cb7-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb7-18&#34;&gt;&lt;a href=&#34;#cb7-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;pii&amp;gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb7-19&#34;&gt;&lt;a href=&#34;#cb7-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb7-20&#34;&gt;&lt;a href=&#34;#cb7-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll id = (p[i].first / K) * big + (p[i].second / K);&lt;/span&gt;
&lt;span id=&#34;cb7-21&#34;&gt;&lt;a href=&#34;#cb7-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;d : delta) {&lt;/span&gt;
&lt;span id=&#34;cb7-22&#34;&gt;&lt;a href=&#34;#cb7-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll curid = id + d;&lt;/span&gt;
&lt;span id=&#34;cb7-23&#34;&gt;&lt;a href=&#34;#cb7-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;j : mp[curid]) {&lt;/span&gt;
&lt;span id=&#34;cb7-24&#34;&gt;&lt;a href=&#34;#cb7-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (j &amp;gt;= i) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-25&#34;&gt;&lt;a href=&#34;#cb7-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll dis = (p[i].first - p[j].first) * (p[i].first - p[j].first) + (p[i].second - p[j].second) * (p[i].second - p[j].second);&lt;/span&gt;
&lt;span id=&#34;cb7-26&#34;&gt;&lt;a href=&#34;#cb7-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dis &amp;lt;= K * K) ans.push_back(pii(j, i));&lt;/span&gt;
&lt;span id=&#34;cb7-27&#34;&gt;&lt;a href=&#34;#cb7-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb7-28&#34;&gt;&lt;a href=&#34;#cb7-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb7-29&#34;&gt;&lt;a href=&#34;#cb7-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb7-30&#34;&gt;&lt;a href=&#34;#cb7-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(ans.begin(), ans.end());&lt;/span&gt;
&lt;span id=&#34;cb7-31&#34;&gt;&lt;a href=&#34;#cb7-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans.size());&lt;/span&gt;
&lt;span id=&#34;cb7-32&#34;&gt;&lt;a href=&#34;#cb7-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : ans) print(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb7-33&#34;&gt;&lt;a href=&#34;#cb7-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-34&#34;&gt;&lt;a href=&#34;#cb7-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šè¿°åšæ³•å¾—è§£çš„æ­£ç¡®æ€§è¾ƒä¸ºæ˜¾ç„¶ï¼Œè¿™é‡Œä¸è¯´æ˜ã€‚ä¸‹é¢å¯¹æ—¶é—´å¤æ‚åº¦ç»™å‡ºè¯æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(B_{X, Y}\)&lt;/span&gt; ä¸ºé›†åˆ &lt;span class=&#34;math inline&#34;&gt;\((X,Y)\)&lt;/span&gt; ä¸­çš„ç‚¹çš„æ•°é‡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; ä¸ºâ€œå« &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªç‚¹çš„é›†åˆå†…æœ€å°‘çš„è·ç¦»å°äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ç‚¹å¯¹æ•°â€ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„ä¸Šç•Œæ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ï¼Œä¸‹é¢è¯æ˜å…¶ä¸‹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Omega(n^2)\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªè¾¹é•¿å°äº &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{K}{\sqrt 2}\)&lt;/span&gt; çš„å­æ­£æ–¹å½¢åŒºåŸŸä¸­ï¼Œæ¯ä¸€å¯¹ç‚¹å¯¹çš„è·ç¦»éƒ½å°äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ã€‚è€Œä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(K\times K\)&lt;/span&gt; çš„æ­£æ–¹å½¢åŒºåŸŸèƒ½ç”± &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; ä¸ªå°çš„è¾¹é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{K}{\sqrt 2}\)&lt;/span&gt; çš„å°æ­£æ–¹å½¢è¦†ç›–ã€‚è€ƒè™‘å¾€å¤§åŒºåŸŸä¸­æ”¾ &lt;span class=&#34;math inline&#34;&gt;\(4n\)&lt;/span&gt; ä¸ªç‚¹ï¼Œåˆ™è‡³å°‘ä¸€ä¸ªå°åŒºåŸŸåŒ…å«è‡³å°‘ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ã€‚è¯¥å°åŒºåŸŸæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{n(n - 1)}{2}\)&lt;/span&gt; ä¸ªç‚¹å¯¹ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„ä¸‹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Omega(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è€Œ &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}f(B_{X,Y}) \le M\)&lt;/span&gt;ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}B^2_{X,Y}\)&lt;/span&gt; çš„ä¸Šç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬çš„ç®—æ³•é‡Œé¢ï¼Œè¦æšä¸¾çš„ç‚¹å¯¹æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}\sum_{m = -1}^1\sum_{l = -1}^1B_{X,Y}B_{X+m,Y+l}\)&lt;/span&gt;ã€‚å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}B^2_{X,Y}\)&lt;/span&gt; çš„ä¸Šç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ï¼Œç„¶åï¼Œæ ¹æ®å‡å€¼ä¸ç­‰å¼ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B_{X,Y}B_{X + m,Y+l}\le \dfrac12(B_{X,Y}^2 + B_{X + m, Y + l}^2)\)&lt;/span&gt;ï¼Œæ‰€ä»¥æ•´ä½“çš„ä¸Šç•Œä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯æ¯•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc235&#34;&gt;ABC235&lt;/h3&gt;
&lt;p&gt;A, B, C ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;D è€ƒè™‘ä¸€ä¸ª BFSï¼Œæ¯æ¬¡å˜æ¢çœ‹ä½œä¸€æ¬¡è½¬ç§»ï¼Œç”±äºæœ‰æ•ˆçŠ¶æ€æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(10^7\)&lt;/span&gt; ä¸ªï¼Œæ‰€ä»¥æ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc235f---variety-of-digits&#34;&gt;ABC235F - Variety of Digits&lt;/h4&gt;
&lt;p&gt;ç»™ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªæ•°ä½ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt;ï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; ä¸­åè¿›åˆ¶ä¸‹åŒ…å«äº†å…¨éƒ¨ &lt;span class=&#34;math inline&#34;&gt;\(c_1,\cdots, c_m\)&lt;/span&gt; æ•°ä½çš„æ•´æ•°çš„å’Œï¼ˆå‰å¯¼ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ç®—ï¼‰ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^{10^4}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le 10\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le c_1&amp;lt;\cdots&amp;lt;c_m\le 9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ•°ä½ DPã€‚è€ƒè™‘åˆ°æˆ‘ä»¬å¯ä»¥å°†æ•°ä½é›†åˆå‹èµ·æ¥ï¼Œæ‰€ä»¥è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, S}\)&lt;/span&gt; è¡¨ç¤ºä»ä½åˆ°é«˜ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½ï¼Œä»é«˜åˆ°ä½å·²ç»é€‰çš„æ•°ä½é›†åˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ•°å­—ä¸ªæ•°å’Œæ•°å­—å’Œï¼ˆæ³¨æ„è¿™ä¸¤ä¸ªä¸œè¥¿éœ€è¦åŒæ—¶ç»´æŠ¤ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè½¬ç§»åº”è¯¥æ˜¯æ¯”è¾ƒå¥½æƒ³çš„ï¼Œæ³¨æ„å‰å¯¼ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸åº”è®¡ç®—åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb8&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb8-1&#34;&gt;&lt;a href=&#34;#cb8-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e4&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-2&#34;&gt;&lt;a href=&#34;#cb8-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-3&#34;&gt;&lt;a href=&#34;#cb8-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, c[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], S0, a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-4&#34;&gt;&lt;a href=&#34;#cb8-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pair&amp;lt;modint, modint&amp;gt; f[maxn][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb8-5&#34;&gt;&lt;a href=&#34;#cb8-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint pow10[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-6&#34;&gt;&lt;a href=&#34;#cb8-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; vis[maxn][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb8-7&#34;&gt;&lt;a href=&#34;#cb8-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-8&#34;&gt;&lt;a href=&#34;#cb8-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pair&amp;lt;modint, modint&amp;gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pos, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; S, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; zero) {&lt;/span&gt;
&lt;span id=&#34;cb8-9&#34;&gt;&lt;a href=&#34;#cb8-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (pos == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb8-10&#34;&gt;&lt;a href=&#34;#cb8-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((S &amp;amp; S0) == S0) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb8-11&#34;&gt;&lt;a href=&#34;#cb8-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb8-12&#34;&gt;&lt;a href=&#34;#cb8-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-13&#34;&gt;&lt;a href=&#34;#cb8-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!lim &amp;amp;&amp;amp; !zero &amp;amp;&amp;amp; vis[pos][S]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[pos][S];&lt;/span&gt;
&lt;span id=&#34;cb8-14&#34;&gt;&lt;a href=&#34;#cb8-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; up = lim ? a[pos] : &lt;span class=&#34;dv&#34;&gt;9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-15&#34;&gt;&lt;a href=&#34;#cb8-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pair&amp;lt;modint, modint&amp;gt; ret = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb8-16&#34;&gt;&lt;a href=&#34;#cb8-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, up) {&lt;/span&gt;
&lt;span id=&#34;cb8-17&#34;&gt;&lt;a href=&#34;#cb8-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        pair&amp;lt;modint, modint&amp;gt; tmp;&lt;/span&gt;
&lt;span id=&#34;cb8-18&#34;&gt;&lt;a href=&#34;#cb8-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (zero &amp;amp;&amp;amp; !i) tmp = dfs(pos - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, S, lim &amp;amp;&amp;amp; i == up, zero);&lt;/span&gt;
&lt;span id=&#34;cb8-19&#34;&gt;&lt;a href=&#34;#cb8-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; tmp = dfs(pos - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, S | (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; i), lim &amp;amp;&amp;amp; i == up, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-20&#34;&gt;&lt;a href=&#34;#cb8-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.first += tmp.first;&lt;/span&gt;
&lt;span id=&#34;cb8-21&#34;&gt;&lt;a href=&#34;#cb8-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.second += tmp.second + tmp.first * pow10[pos] * i;&lt;/span&gt;
&lt;span id=&#34;cb8-22&#34;&gt;&lt;a href=&#34;#cb8-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-23&#34;&gt;&lt;a href=&#34;#cb8-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!lim &amp;amp;&amp;amp; !zero) vis[pos][S] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, f[pos][S] = ret;&lt;/span&gt;
&lt;span id=&#34;cb8-24&#34;&gt;&lt;a href=&#34;#cb8-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb8-25&#34;&gt;&lt;a href=&#34;#cb8-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb8-26&#34;&gt;&lt;a href=&#34;#cb8-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-27&#34;&gt;&lt;a href=&#34;#cb8-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb8-28&#34;&gt;&lt;a href=&#34;#cb8-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), n = strlen(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-29&#34;&gt;&lt;a href=&#34;#cb8-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pow10[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-30&#34;&gt;&lt;a href=&#34;#cb8-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = s[n - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, pow10[i] = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * pow10[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb8-31&#34;&gt;&lt;a href=&#34;#cb8-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(m);&lt;/span&gt;
&lt;span id=&#34;cb8-32&#34;&gt;&lt;a href=&#34;#cb8-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) read(c[i]), S0 |= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; c[i]);&lt;/span&gt;
&lt;span id=&#34;cb8-33&#34;&gt;&lt;a href=&#34;#cb8-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(dfs(n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;).second);&lt;/span&gt;
&lt;span id=&#34;cb8-34&#34;&gt;&lt;a href=&#34;#cb8-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-35&#34;&gt;&lt;a href=&#34;#cb8-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc235g---gardens&#34;&gt;ABC235G - Gardens&lt;/h4&gt;
&lt;p&gt;ä¸‰ç§é¢œè‰²çš„çƒåˆ†åˆ«æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A, B, C\)&lt;/span&gt; ä¸ªï¼ŒåŒç§é¢œè‰²çš„çƒä¸åŒºåˆ†ï¼Œç°å°†å…¶æ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·çš„ç®±å­å†…ï¼Œè¦æ±‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªç®±å­è‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªçƒã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªç®±å­å†…è‡³å¤šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªåŒç§çƒã€‚&lt;/li&gt;
&lt;li&gt;ä¸å¿…æ”¾å®Œæ‰€æœ‰çš„çƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ±‚æ–¹æ¡ˆæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le N\le 5\times 10^6\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le A,B,C\le N\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ´ç´ çš„ DP å®¹æ˜“æƒ³åˆ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(NABC) = O(N^4)\)&lt;/span&gt;ï¼Œé“å®šè¿‡ä¸å»ã€‚ä¸å¦¨åç€è€ƒè™‘é—®é¢˜ï¼Œå‘ç°â€œä¸ºç©ºâ€æ¯”â€œä¸ä¸ºç©ºâ€è¦å¥½æƒ³å¾—å¤šï¼Œè€ƒè™‘å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œè®¡ç®—â€œè‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç®±å­ä¸ºç©ºâ€çš„æ–¹æ¡ˆæ•°ï¼Œä¸éš¾å‘ç°å…¶å°±ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\binom{N}{i}\left(\sum_{a=0}^{\min\{N-  i, A\}}\binom{N - i}{a}\right)\left(\sum_{b=0}^{\min\{N-  i, B\}}\binom{N - i}{b}\right)\left(\sum_{c=0}^{\min\{N-  i, C\}}\binom{N - i}{c}\right)
\]&lt;/span&gt; è§£é‡Šï¼šé¦–å…ˆé€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªä¸€å®šä¸ºç©ºçš„ç®±å­ï¼Œç„¶ååˆ†åˆ«æšä¸¾ä¸‰ç§é¢œè‰²çš„çƒæ”¾çš„ä¸ªæ•°å¹¶æ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(N - i\)&lt;/span&gt; ä¸ªå¯èƒ½ä¸ä¸ºç©ºçš„ç®±å­ã€‚&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆä¸ºâ€œæ°å¥½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªç®±å­ä¸ºç©ºâ€ï¼ŒäºŒé¡¹å¼åæ¼”ä¸€ä¸‹ï¼ˆä¸­é—´æ¨å¯¼è¿‡ç¨‹çœç•¥ï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•å®¹æ–¥ï¼‰å¾—åˆ°ç­”æ¡ˆä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^N(-1)^i\binom{N}{i}\left(\sum_{a=0}^{\min\{N-  i, A\}}\binom{N - i}{a}\right)\left(\sum_{b=0}^{\min\{N-  i, B\}}\binom{N - i}{b}\right)\left(\sum_{c=0}^{\min\{N-  i, C\}}\binom{N - i}{c}\right)
\]&lt;/span&gt; åŒ–çš„å¥½çœ‹ç‚¹å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^N(-1)^{N - i}\binom{N}{i}\left(\sum_{a=0}^{\min\{i, A\}}\binom{i}{a}\right)\left(\sum_{b=0}^{\min\{i, B\}}\binom{i}{b}\right)\left(\sum_{c=0}^{\min\{i, C\}}\binom{i}{c}\right)
\]&lt;/span&gt; ç„¶è€Œç›´æ¥è®¡ç®—è¿˜æ˜¯éœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(O(N^2)\)&lt;/span&gt;ï¼Œç»§ç»­ä¼˜åŒ–è®¡ç®—è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{M}(N) = \displaystyle\sum_{i=0}^{\min\{N, M\}}\binom N i\)&lt;/span&gt;ï¼Œåˆ™ç­”æ¡ˆå¯ä»¥æ”¹å†™ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^N(-1)^{N-i}\binom Ni f_{A}(i)f_{B}(i)f_C(i)
\]&lt;/span&gt; å¦‚æœæˆ‘ä»¬çŸ¥é“äº† &lt;span class=&#34;math inline&#34;&gt;\(f_M(N)\)&lt;/span&gt; çš„å€¼åèƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ¨å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_{M}(N + 1)\)&lt;/span&gt; çš„å€¼ï¼Œæ•´ä¸ªé—®é¢˜å°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(N)\)&lt;/span&gt; è§£å†³äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(N+ 1\le M\)&lt;/span&gt; çš„æ—¶å€™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\min\{N+1,M\} = N+1\)&lt;/span&gt;ï¼Œæ‰€ä»¥æ ¹æ®äºŒé¡¹å¼å®šç†ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{M}(N+1)=2f_M(N)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„è§£æ³•å‚è€ƒ &lt;a href=&#34;https://atcoder.jp/contests/abc235/editorial/3262&#34;&gt;AtCoder å®˜æ–¹é¢˜è§£&lt;/a&gt;ï¼Œæ¨èå»å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ€æƒ³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/ghi/d93c643497867d310c6255fb673d9682.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_M(N)\)&lt;/span&gt; å°±å¯ä»¥çœ‹ä½œä»å·¦ä¸‹è§’å‡ºå‘ï¼Œæ¯ä¸€æ­¥å¾€ä¸Š/å³èµ°ä¸€æ ¼ï¼Œèµ°åˆ°æ©™è‰²ç‚¹çš„æ–¹æ¡ˆæ•°ï¼ˆæ€»æ­¥æ•°éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæˆ‘ä»¬æšä¸¾äº†æ¨ªå‘èµ°çš„æ­¥æ•° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è€Œå·²ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_M(N)\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(f_M(N + 1)\)&lt;/span&gt; çš„å…³ç³»å°±å˜æˆäº†æ±‚èµ°åˆ°æ©™è‰²ç‚¹çš„æ–¹æ¡ˆæ•°ä¸èµ°åˆ°è“è‰²ç‚¹çš„æ–¹æ¡ˆæ•°ä¹‹é—´çš„å…³ç³»ã€‚å‘ç°ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªæ©™è‰²ç‚¹çš„æ—¶å€™æ€»å¯ä»¥å¾€ä¸Š/å³èµ°ä¸€æ ¼åˆ°è¾¾è“è‰²ç‚¹ï¼Œé™¤å»æœ€å³ä¸‹è§’é‚£ä¸ªç‚¹å³å¯ã€‚æ‰€ä»¥ &lt;span class=&#34;math display&#34;&gt;\[
f_M(N+ 1) = 2f_M(N) - \binom{N}{M}
\]&lt;/span&gt; å‘ç°å¯¹äºä¸Šé¢çš„æƒ…å†µï¼Œåªéœ€å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(N&amp;lt;M\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom NM\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä¸‹é¢çš„å…¬å¼ä¹Ÿæ˜¯å®Œå…¨é€‚ç”¨çš„ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f_M(0) = 0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯è¿™é“é¢˜ &lt;span class=&#34;math inline&#34;&gt;\(O(N)\)&lt;/span&gt; è§£å†³äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb9&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb9-1&#34;&gt;&lt;a href=&#34;#cb9-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;5e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-2&#34;&gt;&lt;a href=&#34;#cb9-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint fac[maxn], ifac[maxn];&lt;/span&gt;
&lt;span id=&#34;cb9-3&#34;&gt;&lt;a href=&#34;#cb9-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, A, B, C;&lt;/span&gt;
&lt;span id=&#34;cb9-4&#34;&gt;&lt;a href=&#34;#cb9-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-5&#34;&gt;&lt;a href=&#34;#cb9-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint binom(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;/span&gt;
&lt;span id=&#34;cb9-6&#34;&gt;&lt;a href=&#34;#cb9-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;lt; m) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-7&#34;&gt;&lt;a href=&#34;#cb9-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; fac[n] * ifac[m] * ifac[n - m];&lt;/span&gt;
&lt;span id=&#34;cb9-8&#34;&gt;&lt;a href=&#34;#cb9-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb9-9&#34;&gt;&lt;a href=&#34;#cb9-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-10&#34;&gt;&lt;a href=&#34;#cb9-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb9-11&#34;&gt;&lt;a href=&#34;#cb9-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, A, B, C);&lt;/span&gt;
&lt;span id=&#34;cb9-12&#34;&gt;&lt;a href=&#34;#cb9-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    fac[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-13&#34;&gt;&lt;a href=&#34;#cb9-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) fac[i] = fac[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * i;&lt;/span&gt;
&lt;span id=&#34;cb9-14&#34;&gt;&lt;a href=&#34;#cb9-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ifac[n] = qPow(fac[n], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb9-15&#34;&gt;&lt;a href=&#34;#cb9-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ifac[i] = (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * ifac[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb9-16&#34;&gt;&lt;a href=&#34;#cb9-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, a = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, b = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, c = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-17&#34;&gt;&lt;a href=&#34;#cb9-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb9-18&#34;&gt;&lt;a href=&#34;#cb9-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        modint tmp = ((n - i) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-19&#34;&gt;&lt;a href=&#34;#cb9-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp *= binom(n, i);&lt;/span&gt;
&lt;span id=&#34;cb9-20&#34;&gt;&lt;a href=&#34;#cb9-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb9-21&#34;&gt;&lt;a href=&#34;#cb9-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * a - binom(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, A);&lt;/span&gt;
&lt;span id=&#34;cb9-22&#34;&gt;&lt;a href=&#34;#cb9-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            b = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * b - binom(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, B);&lt;/span&gt;
&lt;span id=&#34;cb9-23&#34;&gt;&lt;a href=&#34;#cb9-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            c = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * c - binom(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, C);&lt;/span&gt;
&lt;span id=&#34;cb9-24&#34;&gt;&lt;a href=&#34;#cb9-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb9-25&#34;&gt;&lt;a href=&#34;#cb9-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp *= a * b * c;&lt;/span&gt;
&lt;span id=&#34;cb9-26&#34;&gt;&lt;a href=&#34;#cb9-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += tmp;&lt;/span&gt;
&lt;span id=&#34;cb9-27&#34;&gt;&lt;a href=&#34;#cb9-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb9-28&#34;&gt;&lt;a href=&#34;#cb9-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb9-29&#34;&gt;&lt;a href=&#34;#cb9-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-30&#34;&gt;&lt;a href=&#34;#cb9-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc235ex---painting-weighted-graph&#34;&gt;ABC235Ex - Painting Weighted Graph&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; è¾¹å¸¦è¾¹æƒæ— å‘å›¾ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\le N\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le M\le 10^5\)&lt;/span&gt;ã€‚ä¸€å¼€å§‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šæ¶‚é»‘è‰²ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œè‡³å¤š &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; æ¬¡ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å’Œä¸€ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå°†æ‰€æœ‰çš„ä» &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å‡ºå‘ï¼Œä¸ç»è¿‡ä»»ä½•æƒå€¼å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„è¾¹èƒ½åˆ°è¾¾çš„ç‚¹æ¶‚ä¸ºçº¢è‰²ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é—®å¯èƒ½çš„çº¢è‰²ç‚¹é›†çš„æ•°é‡ï¼Œæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚å›¾å¯èƒ½æœ‰é‡è¾¹å’Œè‡ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;å’•ï¼Œä»¥åæœ‰ç©ºæ¥è¡¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc237&#34;&gt;ABC237&lt;/h3&gt;
&lt;p&gt;A å¯ä»¥æŠ•æœºå–å·§ä¸€ä¸‹å¼ºåˆ¶è½¬ä¸º &lt;code&gt;int&lt;/code&gt; ä¹‹åæ˜¯å¦ä¸åŸæ¥ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;B ç•¥ï¼ŒC éšä¾¿è§‚å¯Ÿä¸€ä¸‹å³å¯ï¼Œç•¥ã€‚D å¯ä»¥å®ç°ä¸€ä¸ª &lt;code&gt;deque&lt;/code&gt; æˆ–è€…å€’åºè€ƒè™‘é—®é¢˜ï¼Œç•¥ã€‚&lt;/p&gt;
&lt;p&gt;E å»ºå‡ºå›¾åå‘ç°æ˜¯ä¸€ä¸ªå¸¦æœ‰è´Ÿæƒè¾¹çš„æœ€çŸ­è·¯æ¨¡å‹ï¼Œè·‘ä¸ª SPFA å¯ä»¥è¿‡ï¼Œç•¥ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc237e---skiing&#34;&gt;ABC237E - Skiing&lt;/h4&gt;
&lt;p&gt;æ»‘é›ªåœºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªåœ°ç‚¹ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªå¡ï¼Œä¿è¯å›¾è¿é€šã€‚æ¯ä¸ªèŠ‚ç‚¹æœ‰é«˜åº¦ &lt;span class=&#34;math inline&#34;&gt;\(h_u\)&lt;/span&gt;ã€‚å½“ä»è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt; é€šè¿‡æ—¶ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(h_u &amp;gt; h_v\)&lt;/span&gt;ï¼Œåˆ™å¿«ä¹æŒ‡æ•°å¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(h_u - h_v\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œå¿«ä¹æŒ‡æ•°å‡å° &lt;span class=&#34;math inline&#34;&gt;\(2(h_v - h_u)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å‡ºå‘ï¼Œåˆå§‹å¿«ä¹æŒ‡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé—®èƒ½è¾¾åˆ°çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n, m\)&lt;/span&gt; å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\times 10^5\)&lt;/span&gt; çº§åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯¹è¾¹æƒå–ç›¸åæ•°å»ºæ¨¡æˆæœ€çŸ­è·¯æ¨¡å‹ï¼Œå‘ç°å…¶æœ‰è´Ÿæƒè¾¹ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ Dijkstraï¼Œè€Œæ•°æ®èŒƒå›´åˆææœ‰å¯èƒ½å¡æ­» SPFAï¼ˆäº‹å®è¯æ˜ SPFA èƒ½è¿‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åŠ¿èƒ½ Dijkstraï¼Œä¸ºæ¯ä¸ªç‚¹å¢åŠ ä¸€ä¸ªåŠ¿èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(h_u\)&lt;/span&gt;ï¼Œç„¶åå¯¹è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt; çš„æƒå€¼åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(h_u - h_v\)&lt;/span&gt;ï¼Œä½¿å¾—æ‰€æœ‰è¾¹æƒéè´Ÿï¼Œæœ€åæ¯ä¸ªç‚¹çš„ç­”æ¡ˆå°±ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d_u + h_u - h_1\)&lt;/span&gt;ã€‚ä½†æ˜¯æ±‚åŠ¿èƒ½çš„è¿‡ç¨‹ä»ç„¶éœ€è¦ SPFAï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æœ¬é¢˜ä¸­çš„â€œé«˜åº¦â€å°±æ˜¯ä¸€ä¸ªç°æˆçš„åŠ¿èƒ½ï¼Œæ»¡è¶³äº†åŠ¿èƒ½ä¹‹å·®åªå’Œç›¸å¯¹é«˜åº¦æœ‰å…³è¿™ä¸€æ€§è´¨ï¼Œæ‰€ä»¥ç›´æ¥å°†å…¶å½“ä½œåŠ¿èƒ½æ¥åšå°±å¯ä»¥äº†ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log n)\)&lt;/span&gt;ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc237/submissions/29219115&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc237f---lis-3&#34;&gt;ABC237F - |LIS| = 3&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œæ±‚æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æ­£æ•´æ•°åºåˆ—çš„ä¸ªæ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæ¯ä¸ªå…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(\in[1, M]\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ LIS çš„é•¿åº¦æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(3\le N\le 1000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(3\le M\le 10\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç»å…¸çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; çš„ LIS çš„åšæ³•ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸ºâ€œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ LIS çš„æœ€å°ç»“å°¾æ•°å­—â€ï¼Œè€Œ DP æ•°ç»„çš„é•¿åº¦å³ä¸º LIS çš„é•¿åº¦ï¼Œæ‰€ä»¥å¹²è„†è€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, a, b, c}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰è€ƒè™‘åˆ° &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt;ï¼ŒLIS çš„ DP æ•°ç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a, b, c\)&lt;/span&gt; çš„åºåˆ—ä¸ªæ•°ã€‚ä¸éš¾å‘ç°è¿™ä¸ªçŠ¶æ€æ˜¯æ²¡æœ‰åæ•ˆæ€§çš„ï¼Œè½¬ç§»å°±è€ƒè™‘å½“å‰å¡«ä»€ä¹ˆæ•°ï¼Œç„¶åä»¿ç…§ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; LIS çš„è½¬ç§»æ–¹å¼è¿›è¡Œè½¬ç§»ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(NM^4)\)&lt;/span&gt;ï¼Œå¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb10&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb10-1&#34;&gt;&lt;a href=&#34;#cb10-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[&lt;span class=&#34;dv&#34;&gt;1005&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb10-2&#34;&gt;&lt;a href=&#34;#cb10-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb10-3&#34;&gt;&lt;a href=&#34;#cb10-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-4&#34;&gt;&lt;a href=&#34;#cb10-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb10-5&#34;&gt;&lt;a href=&#34;#cb10-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb10-6&#34;&gt;&lt;a href=&#34;#cb10-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-7&#34;&gt;&lt;a href=&#34;#cb10-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(k, j, m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(l, k, m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(t, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb10-8&#34;&gt;&lt;a href=&#34;#cb10-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (t &amp;lt;= j) f[i][t][k][l] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j][k][l];&lt;/span&gt;
&lt;span id=&#34;cb10-9&#34;&gt;&lt;a href=&#34;#cb10-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (t &amp;lt;= k) f[i][j][t][l] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j][k][l];&lt;/span&gt;
&lt;span id=&#34;cb10-10&#34;&gt;&lt;a href=&#34;#cb10-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (t &amp;lt;= l) f[i][j][k][t] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j][k][l];&lt;/span&gt;
&lt;span id=&#34;cb10-11&#34;&gt;&lt;a href=&#34;#cb10-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-12&#34;&gt;&lt;a href=&#34;#cb10-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-13&#34;&gt;&lt;a href=&#34;#cb10-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) FOR(j, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) FOR(k, j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) ans += f[n][i][j][k];&lt;/span&gt;
&lt;span id=&#34;cb10-14&#34;&gt;&lt;a href=&#34;#cb10-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb10-15&#34;&gt;&lt;a href=&#34;#cb10-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-16&#34;&gt;&lt;a href=&#34;#cb10-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc237g---range-sort-query&#34;&gt;ABC237G - Range Sort Query&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æ’åˆ—ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ“ä½œä¸ºé€‰å®šä¸€åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; ç„¶åå‡åº/é™åºæ’åºï¼Œé—®å…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; æœ€åçš„ä¸‹æ ‡åœ¨å“ªé‡Œã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le N, Q\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç»å…¸é—®é¢˜ï¼ˆHEOI æ’åºï¼‰çš„å˜å¼ã€‚æœ€å¼ºå¤§çš„è§£æ³•æ˜¾ç„¶ä¸ºçº¿æ®µæ ‘åˆå¹¶/åˆ†è£‚ï¼Œä½†æ˜¯åœ¨è¿™é‡Œä¸éœ€è¦ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ï¼Œ0-1 åºåˆ—çš„åŒºé—´æ’åºå¾ˆå¥½ä½¿ç”¨çº¿æ®µæ ‘æ¥å®Œæˆï¼Œåªéœ€è¦å®ç°åŒºé—´æŸ“è‰²å’ŒåŒºé—´æ±‚å’Œã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å°†å…¶è½¬ä¸º 0-1 åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; X\)&lt;/span&gt; çš„å…ƒç´ å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå…¶ä»–å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªç»“æœã€‚å°† &lt;span class=&#34;math inline&#34;&gt;\(\le X\)&lt;/span&gt; çš„å…ƒç´ å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå…¶ä»–å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ“ä½œï¼Œå¾—åˆ°å¦ä¸€ä¸ªç»“æœï¼Œç„¶åç„¶åç„¶åå‘ç°è¿™ä¸¤ä¸ªåºåˆ—å”¯ä¸€ä¸€ä¸ªä¸ä¸€æ ·çš„åœ°æ–¹æ˜¾ç„¶å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; æœ€åçš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N\log N)\)&lt;/span&gt;ï¼Œè§† &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; åŒé˜¶ã€‚&lt;a href=&#34;https://atcoder.jp/contests/abc237/submissions/29158241&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc237ex---hakata&#34;&gt;ABC237Ex - Hakata&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\le 200\)&lt;/span&gt; çš„å­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œé—®æœ€å¤šèƒ½ä»é‡Œé¢é€‰å‡ºå¤šå°‘ä¸ª&lt;strong&gt;å›æ–‡å­æ®µ&lt;/strong&gt;ï¼Œä½¿å¾—ä¸€ä¸ªå­æ®µä¸æ˜¯å¦ä¸€ä¸ªå­æ®µçš„å­æ®µã€‚å­æ®µæŒ‡è¿ç»­çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œä¸åŒå›æ–‡å­ä¸²çš„ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(\le |S|\)&lt;/span&gt;ï¼Œç„¶åå­ä¸²é—´çš„åŒ…å«å…³ç³»æ˜¯ä¸€ç§ååºå…³ç³»ï¼Œå¯ä»¥å½¢æˆä¸€ä¸ª DAGï¼Œè€ŒåŸé—®é¢˜é—®çš„å°±æ˜¯å…¶çš„æœ€å¤§åé“¾ã€‚&lt;/p&gt;
&lt;p&gt;å¤ä¹ ä¸€ä¸‹ &lt;a href=&#34;https://www.luogu.com.cn/problem/P4298&#34;&gt;P4298 [CTSC2008]ç¥­ç¥€&lt;/a&gt; ä¾¿çŸ¥é“æœ€å¤§åé“¾ = æœ€å°é“¾è¦†ç›–ï¼ˆDilworth å¼•ç†ï¼‰ï¼Œè€Œæœ€å°é“¾è¦†ç›–å¯ä»¥é€šè¿‡æ‹†ç‚¹äºŒåˆ†å›¾åŒ¹é…æ¥æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;æ”¾åˆ°æœ¬é¢˜é‡Œé¢ï¼Œå°±å¯¹äºæ¯ä¸ªä¸åŒå›æ–‡å­æ®µï¼ˆè¿™éƒ¨åˆ†é¡¶å¤© &lt;span class=&#34;math inline&#34;&gt;\(O(|S|^3)\)&lt;/span&gt;ï¼‰ï¼Œä¸ºå…¶æ ‡å·ï¼Œç„¶åå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å­ä¸²ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(i_{\mathrm {left}}\to j_{\mathrm{right}}\)&lt;/span&gt;ï¼Œç„¶åè·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œç”¨å›æ–‡ä¸²æ•°é‡å‡å»åŒ¹é…å³å¾—åˆ°ç­”æ¡ˆã€‚æ—¶é—´å¤æ‚åº¦å°±ä¸åˆ†æäº†ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(400\)&lt;/span&gt; ä¸ªç‚¹çš„äºŒåˆ†å›¾åŒ¹é…å¹¶ä¸æ…¢ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc237/submissions/29158769&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc244&#34;&gt;ABC244&lt;/h3&gt;
&lt;h4 id=&#34;abc244d---swap-hats&#34;&gt;ABC244D - Swap Hats&lt;/h4&gt;
&lt;p&gt;&lt;del&gt;å¤§èƒ†çŒœç»“è®º&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è‹¥ç›¸åŒçš„ä½ç½®æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªæˆ– &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªæ—¶ä¸º Yesï¼Œå¦åˆ™ä¸º Noï¼Œä¸‹é¢ç»™å‡ºç®€è¦è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªçš„æ—¶å€™å°±æŠŠä¸¤ä¸ªåå¤æ¨ªè·³å³å¯ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªçš„è¯å¯ä»¥æ„é€ æ–¹æ¡ˆåœ¨æ“ä½œä¸¤æ¬¡åè½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªä¸€æ ·çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ç›¸åŒçš„ä½ç½®åªå¯èƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªï¼Œåšä»»æ„ä¸€æ¬¡äº¤æ¢åéƒ½ä¼šå˜æˆä¸Šé¢ä¸¤ç§æƒ…å†µï¼Œæ‰€ä»¥å¯„äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc244f---shortest-good-path&#34;&gt;ABC244F - Shortest Good Path&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; è¾¹æ— å‘å›¾ï¼Œä»¤é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„è·¯å¾„ &lt;span class=&#34;math inline&#34;&gt;\(A_{1,\cdots, K}\)&lt;/span&gt; å¯¹é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ 0-1 ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ºåˆæ³•çš„å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; åç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(S_i\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(2^n\)&lt;/span&gt; ç§ä¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œæ±‚å‡ºæœ€å°çš„åˆæ³•çš„è·¯å¾„çš„ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¹‹å’Œã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 17\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;èŒƒå›´è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶å‹ dpã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§å›¾ä¸Šæœ‰é“¾çš„ï¼Œå°±ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; ä¸ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„é“¾çš„ä»€ä¹ˆä»€ä¹ˆã€‚ç„¶åæ³¨æ„åˆ°è¿™ä¸ªçŠ¶æ€æ˜¯æ²¡æ³•è½¬ç§»çš„ï¼Œå› ä¸ºæ¥ä¸Šä¸€ä¸ªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; é‡Œé¢å­˜åœ¨çš„ç‚¹ä¹‹åï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S&amp;#39;\)&lt;/span&gt; æ˜¯å°äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£å°±è€ƒè™‘ç¿»è½¬ä¸€ä¸‹çŠ¶æ€å’Œå€¼ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k,S}\)&lt;/span&gt; ä¸ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„é“¾æ˜¯å¦å­˜åœ¨ã€‚ç„¶åè½¬ç§»å°±å¾ˆå¥½åšåˆ°äº†ï¼Œæ¯›ä¼°ä¼°å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^32^n)\)&lt;/span&gt;ï¼Œæœ‰ç‚¹å‹‰å¼ºä½†æ˜¯å®ç°çš„å¥½çš„è¯å¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆé•¿åº¦ä¸Šç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(4n\)&lt;/span&gt;ï¼Œå› ä¸º G é¢˜è¯´äº†ä¸Šç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(4n\)&lt;/span&gt;&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb11&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb11-1&#34;&gt;&lt;a href=&#34;#cb11-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;18&lt;/span&gt;, maxS = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;17&lt;/span&gt;) | &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-2&#34;&gt;&lt;a href=&#34;#cb11-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, G[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb11-3&#34;&gt;&lt;a href=&#34;#cb11-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; f[maxn][&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt; * maxn][maxS];&lt;/span&gt;
&lt;span id=&#34;cb11-4&#34;&gt;&lt;a href=&#34;#cb11-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[maxS];&lt;/span&gt;
&lt;span id=&#34;cb11-5&#34;&gt;&lt;a href=&#34;#cb11-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-6&#34;&gt;&lt;a href=&#34;#cb11-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb11-7&#34;&gt;&lt;a href=&#34;#cb11-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb11-8&#34;&gt;&lt;a href=&#34;#cb11-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb11-9&#34;&gt;&lt;a href=&#34;#cb11-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u, v);&lt;/span&gt;
&lt;span id=&#34;cb11-10&#34;&gt;&lt;a href=&#34;#cb11-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u][v] = G[v][u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-11&#34;&gt;&lt;a href=&#34;#cb11-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-12&#34;&gt;&lt;a href=&#34;#cb11-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(vis, &lt;span class=&#34;bn&#34;&gt;0x3f&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; vis);&lt;/span&gt;
&lt;span id=&#34;cb11-13&#34;&gt;&lt;a href=&#34;#cb11-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) f[i][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-14&#34;&gt;&lt;a href=&#34;#cb11-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; vis[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-15&#34;&gt;&lt;a href=&#34;#cb11-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt; * n) { &lt;span class=&#34;co&#34;&gt;// length&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-16&#34;&gt;&lt;a href=&#34;#cb11-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb11-17&#34;&gt;&lt;a href=&#34;#cb11-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(S, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb11-18&#34;&gt;&lt;a href=&#34;#cb11-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (G[i][j]) {&lt;/span&gt;
&lt;span id=&#34;cb11-19&#34;&gt;&lt;a href=&#34;#cb11-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[i][k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S] |= f[j][k][S ^ (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))];&lt;/span&gt;
&lt;span id=&#34;cb11-20&#34;&gt;&lt;a href=&#34;#cb11-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[i][k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S]) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-21&#34;&gt;&lt;a href=&#34;#cb11-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb11-22&#34;&gt;&lt;a href=&#34;#cb11-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmin(vis[S], f[i][k][S] ? k : (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)&lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-23&#34;&gt;&lt;a href=&#34;#cb11-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb11-24&#34;&gt;&lt;a href=&#34;#cb11-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb11-25&#34;&gt;&lt;a href=&#34;#cb11-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-26&#34;&gt;&lt;a href=&#34;#cb11-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans += vis[i];&lt;/span&gt;
&lt;span id=&#34;cb11-27&#34;&gt;&lt;a href=&#34;#cb11-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb11-28&#34;&gt;&lt;a href=&#34;#cb11-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-29&#34;&gt;&lt;a href=&#34;#cb11-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½†æ˜¯è¿™è¿˜ä¸æ˜¯æœ€ä¼˜çš„ï¼Œè€Œä¸”è¿™ä¸ªæ‹¿ç»“è®ºæ¥æ¨çš„æƒ³æ³•å¾ˆä¸ä¼˜ç¾ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè‹¥å°† dp çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\((i, S)\)&lt;/span&gt; çœ‹ä½œç‚¹ï¼Œè½¬ç§»çœ‹ä½œè¾¹ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ä¼šå°‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n^22^n)\)&lt;/span&gt; è·‘çš„è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œè€Œä¸”å°‘äº† &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; å€å¸¸æ•°ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc244g---construct-good-path&#34;&gt;ABC244G - Construct Good Path&lt;/h4&gt;
&lt;p&gt;å…¨éƒ¨ç»§æ‰¿ F çš„å®šä¹‰ï¼Œå°†èŒƒå›´æ”¹æˆ &lt;span class=&#34;math inline&#34;&gt;\(N\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(M\le 2\times 10^5\)&lt;/span&gt;ï¼Œå¹¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ç„¶åè®©ä½ æ„é€ ä¸€ä¸ªåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ã€‚è¦æ±‚é•¿åº¦ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(4N\)&lt;/span&gt;ï¼Œä¿è¯æœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå°†è¿™ä¸ªé—®é¢˜æ”¾åˆ°ç”Ÿæˆæ ‘ä¸Šã€‚ç„¶åå°±ä»æ ¹èŠ‚ç‚¹å¾€ä¸‹èµ°ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œè‹¥ä»ä»–çš„å­æ ‘å‡ºæ¥åè¿˜æ˜¯ä¸å¯¹å¤´ï¼Œé‚£å°±åå¤æ¨ªè·³ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ ¹èŠ‚ç‚¹ç‰¹åˆ¤ä¸€ä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb12&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb12-1&#34;&gt;&lt;a href=&#34;#cb12-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-2&#34;&gt;&lt;a href=&#34;#cb12-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb12-3&#34;&gt;&lt;a href=&#34;#cb12-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb12-4&#34;&gt;&lt;a href=&#34;#cb12-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn], ans;&lt;/span&gt;
&lt;span id=&#34;cb12-5&#34;&gt;&lt;a href=&#34;#cb12-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-6&#34;&gt;&lt;a href=&#34;#cb12-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u) {&lt;/span&gt;
&lt;span id=&#34;cb12-7&#34;&gt;&lt;a href=&#34;#cb12-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans.push_back(u), ++vis[u];&lt;/span&gt;
&lt;span id=&#34;cb12-8&#34;&gt;&lt;a href=&#34;#cb12-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;v : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb12-9&#34;&gt;&lt;a href=&#34;#cb12-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[v]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-10&#34;&gt;&lt;a href=&#34;#cb12-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(v);&lt;/span&gt;
&lt;span id=&#34;cb12-11&#34;&gt;&lt;a href=&#34;#cb12-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((vis[v] &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) != s[v] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb12-12&#34;&gt;&lt;a href=&#34;#cb12-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back(u), ++vis[u], ans.push_back(v), ++vis[v];&lt;/span&gt;
&lt;span id=&#34;cb12-13&#34;&gt;&lt;a href=&#34;#cb12-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans.push_back(u), ++vis[u];&lt;/span&gt;
&lt;span id=&#34;cb12-14&#34;&gt;&lt;a href=&#34;#cb12-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-15&#34;&gt;&lt;a href=&#34;#cb12-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-16&#34;&gt;&lt;a href=&#34;#cb12-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb12-17&#34;&gt;&lt;a href=&#34;#cb12-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-18&#34;&gt;&lt;a href=&#34;#cb12-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb12-19&#34;&gt;&lt;a href=&#34;#cb12-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb12-20&#34;&gt;&lt;a href=&#34;#cb12-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb12-21&#34;&gt;&lt;a href=&#34;#cb12-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u, v);&lt;/span&gt;
&lt;span id=&#34;cb12-22&#34;&gt;&lt;a href=&#34;#cb12-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb12-23&#34;&gt;&lt;a href=&#34;#cb12-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-24&#34;&gt;&lt;a href=&#34;#cb12-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-25&#34;&gt;&lt;a href=&#34;#cb12-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-26&#34;&gt;&lt;a href=&#34;#cb12-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((vis[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) != s[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) ans.pop_back();&lt;/span&gt;
&lt;span id=&#34;cb12-27&#34;&gt;&lt;a href=&#34;#cb12-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans.size());&lt;/span&gt;
&lt;span id=&#34;cb12-28&#34;&gt;&lt;a href=&#34;#cb12-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;x : ans) print(x, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-29&#34;&gt;&lt;a href=&#34;#cb12-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-30&#34;&gt;&lt;a href=&#34;#cb12-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc244ex---linear-maximizationæœªå†™ä»£ç &#34;&gt;ABC244Ex - Linear Maximizationï¼ˆæœªå†™ä»£ç ï¼‰&lt;/h4&gt;
&lt;p&gt;ç»´æŠ¤äºŒç»´å¹³é¢ä¸Šçš„ç‚¹é›† &lt;span class=&#34;math inline&#34;&gt;\(S = \{(x, y)\}\)&lt;/span&gt;ï¼Œåˆå§‹ä¸ºç©ºã€‚ä¸‹é¢è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ¯æ¬¡å¾€ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­åŠ å…¥ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; å¹¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; å¹¶æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(\max_{(x,y)\in S}\{ax + by\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(Q\le 2\times 10^5\)&lt;/span&gt;ï¼Œåæ ‡ç»å¯¹å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ³• &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼šè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(ax + by = b(\frac ab\cdot x + y)\)&lt;/span&gt;ï¼Œçœ‹å‡ºä¸€æ¬¡å‡½æ•°çš„å½¢å¼ä¹‹åæ— è„‘æè¶…æ ‘å³å¯ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ç‰¹åˆ¤ç¬¦å·ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b=0\)&lt;/span&gt; ç­‰æƒ…å†µã€‚è€Œä¸”æµ®ç‚¹è¯¯å·®ä¼¼ä¹æœ‰ç‚¹å¿ƒçƒ¦æ‰€ä»¥æˆ‘æ²¡å†™ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ³• &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼šæ‹¿å¹³è¡¡æ ‘ç»´æŠ¤åŠ¨æ€å‡¸åŒ…ï¼Œç„¶ååœ¨å‡¸åŒ…ä¸Šä¸‰åˆ†æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸æƒ³å†™ä»£ç äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc246&#34;&gt;ABC246&lt;/h3&gt;
&lt;p&gt;A ç›´æ¥éšä¾¿åšã€‚&lt;/p&gt;
&lt;p&gt;B è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(\cos(\theta)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\sin(\theta)\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;C å…ˆæŒ‰ç…§ç‰©å“å¤§å°è´ªä¸€æ¬¡å¿ƒï¼Œç„¶åå†å°†å‰©ä¸‹éƒ¨åˆ†ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(a_i\bmod x\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼‰é‡æ–°æ’åºå†åšä¸€æ¬¡è´ªå¿ƒã€‚å®¹æ˜“è¯´æ˜å…¶æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;D å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((a+b)(a^2+b^2)\le 10^{18}\)&lt;/span&gt;ï¼Œé’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(a\ge b\)&lt;/span&gt; çš„è¯å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä¸Šç•Œåªèƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(10^6\)&lt;/span&gt;ï¼Œæ‰€ä»¥æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ç„¶åäºŒåˆ† &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc246e---bishop-2&#34;&gt;ABC246E - Bishop 2&lt;/h4&gt;
&lt;p&gt;åœºä¸Šè°ƒè¿™é¢˜è°ƒåˆ°æœ€åéƒ½å¯„äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ•´ä¸ªå°±æ˜¯ä¸€ä¸ª 0-1 bfs çš„æ¨¡å‹ï¼Œæ¯æ¬¡çœ‹æˆèµ°ä¸€æ ¼ï¼ŒåŒå‘èµ°ç›¸å½“äºæ¯”è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œè½¬å‘ç›¸å½“äºè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦å°±æ˜¯ bfs çš„å¤æ‚åº¦ï¼Œå®¹æ˜“è¯´æ˜å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb13&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb13-1&#34;&gt;&lt;a href=&#34;#cb13-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-2&#34;&gt;&lt;a href=&#34;#cb13-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb13-3&#34;&gt;&lt;a href=&#34;#cb13-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb13-4&#34;&gt;&lt;a href=&#34;#cb13-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-5&#34;&gt;&lt;a href=&#34;#cb13-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1505&lt;/span&gt;, fx[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;}, fy[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb13-6&#34;&gt;&lt;a href=&#34;#cb13-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;queue&amp;lt;pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb13-7&#34;&gt;&lt;a href=&#34;#cb13-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; mp[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb13-8&#34;&gt;&lt;a href=&#34;#cb13-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, sx, sy, tx, ty, f[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb13-9&#34;&gt;&lt;a href=&#34;#cb13-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-10&#34;&gt;&lt;a href=&#34;#cb13-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb13-11&#34;&gt;&lt;a href=&#34;#cb13-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; sx &amp;gt;&amp;gt; sy &amp;gt;&amp;gt; tx &amp;gt;&amp;gt; ty;&lt;/span&gt;
&lt;span id=&#34;cb13-12&#34;&gt;&lt;a href=&#34;#cb13-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; &amp;amp;mp[i][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb13-13&#34;&gt;&lt;a href=&#34;#cb13-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[sx][sy] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, q.push({sx, sy});&lt;/span&gt;
&lt;span id=&#34;cb13-14&#34;&gt;&lt;a href=&#34;#cb13-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; check = [](&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; y &amp;lt;= n &amp;amp;&amp;amp; mp[x][y] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;;};&lt;/span&gt;
&lt;span id=&#34;cb13-15&#34;&gt;&lt;a href=&#34;#cb13-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb13-16&#34;&gt;&lt;a href=&#34;#cb13-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; now = q.front(); q.pop();&lt;/span&gt;
&lt;span id=&#34;cb13-17&#34;&gt;&lt;a href=&#34;#cb13-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-18&#34;&gt;&lt;a href=&#34;#cb13-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = now.first, y = now.second;&lt;/span&gt;
&lt;span id=&#34;cb13-19&#34;&gt;&lt;a href=&#34;#cb13-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;true&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-20&#34;&gt;&lt;a href=&#34;#cb13-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                x += fx[k], y += fy[k];&lt;/span&gt;
&lt;span id=&#34;cb13-21&#34;&gt;&lt;a href=&#34;#cb13-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!check(x, y)) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-22&#34;&gt;&lt;a href=&#34;#cb13-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!f[x][y]) f[x][y] = f[now.first][now.second] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, q.push({x, y});&lt;/span&gt;
&lt;span id=&#34;cb13-23&#34;&gt;&lt;a href=&#34;#cb13-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[x][y] &amp;lt;= f[now.first][now.second]) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-24&#34;&gt;&lt;a href=&#34;#cb13-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb13-25&#34;&gt;&lt;a href=&#34;#cb13-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb13-26&#34;&gt;&lt;a href=&#34;#cb13-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-27&#34;&gt;&lt;a href=&#34;#cb13-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; f[tx][ty] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb13-28&#34;&gt;&lt;a href=&#34;#cb13-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-29&#34;&gt;&lt;a href=&#34;#cb13-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc246f---typewriter&#34;&gt;ABC246F - typewriter&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘å¯¹å•ä¸ªä¸²æˆ‘ä»¬æ€ä¹ˆè®¡æ•°ï¼Œä¸éš¾å‘ç°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\text{å­—æ¯ä¸ªæ•°}^L\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¤šä¸ªä¸²æ¥äº†ï¼Œæˆ‘ä»¬å°±éœ€è¦å»é‡ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬å–ä¸¤ä¸ªä¸²å­—æ¯çš„äº¤ï¼Œç„¶åæ‰£æ‰è¿™ä¸€éƒ¨åˆ†çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ‰©å±•ä¸€ä¸‹å°±æ˜¯æœ€åŸºæœ¬çš„å®¹æ–¥ï¼Œçœ‹åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\le 18\)&lt;/span&gt; å°±æšä¸¾æ‰€æœ‰ä¸²çš„å­é›†ï¼Œç®—å…¶äº¤çš„ç­”æ¡ˆï¼Œè´¡çŒ®ä¹˜ä¸Šå®¹æ–¥ç³»æ•° &lt;span class=&#34;math inline&#34;&gt;\((-1)^{|S|}\)&lt;/span&gt;ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(2^nc)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸ºæŸå’Œå­—ç¬¦é›†å¤§å°æœ‰å…³çš„å¸¸æ•°ï¼ˆ&lt;del&gt;æ‡’å¾—åˆ†æäº†&lt;/del&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc246g---game-on-tree-3&#34;&gt;ABC246G - Game on Tree 3&lt;/h4&gt;
&lt;p&gt;ç‚¹å¸¦æƒ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ ¹æ ‘ï¼Œåˆå§‹æœ‰ä¸€ä¸ªæŒ‡é’ˆåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ï¼Œæ¯è½®æ¸¸æˆä¸­å…ˆé’æœ¨é€‰æ‹©ä¸€ä¸ªéæ ¹ç‚¹å¹¶å°†å…¶æƒç½®é›¶ï¼Œç„¶åé«˜æ¡¥å°†æŒ‡é’ˆç§»å‘å…¶æ‰€åœ¨ä½ç½®çš„ä»»æ„å„¿å­ã€‚é«˜æ¡¥å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»ç»“æŸæ¸¸æˆï¼ˆä½†å½“æŒ‡é’ˆç§»åˆ°å¶å­èŠ‚ç‚¹åæ¸¸æˆå¼ºåˆ¶ç»“æŸï¼‰ã€‚åˆ†æ•°ä¸ºæŒ‡é’ˆæœ€åæŒ‡å‘çš„ç‚¹çš„æƒã€‚é’æœ¨æƒ³æœ€å°åŒ–åˆ†æ•°ï¼Œé«˜æ¡¥æƒ³æœ€å¤§åŒ–åˆ†æ•°ï¼Œä¸¤äººç»é¡¶èªæ˜ï¼Œé—®æœ€åçš„åˆ†æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥åšä¼¼ä¹ä¸å¤ªå¯èƒ½ï¼Œæˆ‘ä»¬è€ƒè™‘äºŒåˆ†ç­”æ¡ˆï¼Œå³â€œæœ€ä¼˜ç­–ç•¥ä¸‹ï¼Œé«˜æ¡¥èƒ½å¦è‡³å°‘æ‹¿åˆ° &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; åˆ†â€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªè½¬åŒ–ï¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(\ge c\)&lt;/span&gt; çš„æƒçœ‹ä½œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; c\)&lt;/span&gt; çš„æƒçœ‹ä½œ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œç„¶åå‘ç°ï¼Œåªè¦é«˜æ¡¥å›èµ°åˆ°äº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ï¼Œé‚£ä¹ˆä»–å°±èµ¢äº†ï¼Œå¦åˆ™è¾“äº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæ˜¾ç„¶ï¼Œè‹¥é«˜æ¡¥å°†æŒ‡é’ˆç§»å‘ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; åï¼Œé’æœ¨ä¼šé€‰æ‹©åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†…å°†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ ‘å½¢ dpï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†…é«˜æ¡¥å›èƒ½èµ°åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ä¸ªæ•°ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_u = \max(\sum f_v - 1, 0) + [a_u\ge c]\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f_1 &amp;gt; 0\)&lt;/span&gt; æ—¶åˆæ³•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc246ex---01-queries&#34;&gt;ABC246Ex - 01? Queries&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5\)&lt;/span&gt; çš„åŒ…å« &lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;code&gt;1&lt;/code&gt; å’Œ &lt;code&gt;?&lt;/code&gt; çš„ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä»¥åŠ &lt;span class=&#34;math inline&#34;&gt;\(q\le 10^5\)&lt;/span&gt; æ¬¡æ“ä½œ &lt;span class=&#34;math inline&#34;&gt;\((x_i, c_i)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; ä¸ºä¸‹æ ‡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; ä¸ºå­—ç¬¦é›†ä¸­çš„æŸå­—ç¬¦ã€‚æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(1,\cdots, q\)&lt;/span&gt; çš„é¡ºåºï¼Œæ¯æ¬¡å°† &lt;span class=&#34;math inline&#34;&gt;\(S_{x_i}\leftarrow c_i\)&lt;/span&gt;ï¼Œç„¶åè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ 0-1 å­ä¸²ä¸ªæ•°ï¼ˆ&lt;code&gt;?&lt;/code&gt; è§†ä¸ºé€šé…ç¬¦ï¼‰ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ€è€ƒå¯¹äºä¸€ä¸ªå›ºå®šçš„ 0-1 ä¸²å¦‚ä½•è®¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è®¾è®¡ä¸€ä¸ª dp çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0/1}\)&lt;/span&gt; è¡¨ç¤ºè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt;ï¼Œç»“å°¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; çš„å­åºåˆ—æ•°é‡ï¼Œåˆ™ç­”æ¡ˆæ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{n, 0} + f_{n,1}\)&lt;/span&gt;ï¼Œç°åœ¨è€ƒè™‘è½¬ç§»ï¼šå‘ç°å¯ä»¥å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt; ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;code&gt;1&lt;/code&gt; è¿˜æ˜¯ &lt;code&gt;?&lt;/code&gt; åˆ†ç±»è®¨è®ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,0} &amp;amp;=
\begin{cases}
f_{i - 1, 0} + (f_{i - 1, 1} + 1) &amp;amp; S_i = \texttt 0\lor S_i = \texttt{?}\\
f_{i - 1, 0} &amp;amp; S_i = \texttt 1\\
\end{cases}
\\
f_{i,1} &amp;amp;= 
\begin{cases}
f_{i - 1, 1} + (f_{i - 1, 0} + 1) &amp;amp; S_i = \texttt 1 \lor S_i = \texttt{?}\\
f_{i - 1, 1} &amp;amp; S_i = \texttt 0
\end{cases}
\end{aligned}
\]&lt;/span&gt; é‚£ä¹ˆæˆ‘ä»¬ä¼šå‘ç°ï¼Œdp æ•°ç»„çš„è½¬ç§»æ˜¯å¾ˆæœ‰è§„å¾‹çš„ï¼Œè€Œä¸”æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹éƒ½æ˜¯ä¿®æ”¹ä¸€ä¸ªç‚¹å¤„çš„è½¬ç§»æ–¹å¼ï¼Œè€Œä¸”è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(f_{n,0} + f_{n, 1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™è®©ä½ æƒ³åˆ°ä»€ä¹ˆï¼åŠ¨æ€ dpã€‚å…·ä½“åœ°ï¼Œä»¤å‘é‡ &lt;span class=&#34;math display&#34;&gt;\[
\boldsymbol F_i = \begin{bmatrix}
f_{i, 0}\\
f_{i, 1}\\
1
\end{bmatrix}
\]&lt;/span&gt; ï¼ˆæœ€ä¸‹é¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ˜¯å› ä¸ºå¸¸æ•°é¡¹éœ€è¦è½¬ç§»ï¼‰é‚£ä¹ˆå°±å¯ä»¥å†™å‡ºä¸‰ä¸ªè½¬ç§»çŸ©é˜µï¼š &lt;span class=&#34;math display&#34;&gt;\[
\boldsymbol A_{\texttt 0} = \begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 1\\
0 &amp;amp; 1 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 1
\end{bmatrix}, \boldsymbol A_{\texttt 1} = \begin{bmatrix}
1 &amp;amp; 0 &amp;amp; 0\\
1 &amp;amp; 1 &amp;amp; 1\\
0 &amp;amp; 0 &amp;amp; 1
\end{bmatrix}, A_{\texttt{?}} = \begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 1\\
1 &amp;amp; 1 &amp;amp; 1\\
0 &amp;amp; 0 &amp;amp; 1
\end{bmatrix}
\]&lt;/span&gt; äºæ˜¯å°±æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
\boldsymbol F_i = \boldsymbol A_{S_i}\times \boldsymbol F_{i - 1} = A_{S_i}A_{S_{i-1}}\cdots \boldsymbol F_0
\]&lt;/span&gt; çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µè¿ä¹˜ç§¯ï¼Œå•ç‚¹ä¿®æ”¹ä¸€ä¸‹ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O((n + q)\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc247&#34;&gt;ABC247&lt;/h3&gt;
&lt;h4 id=&#34;abc247ex---rearranging-problem&#34;&gt;ABC247Ex - Rearranging Problem&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šå€¼åŸŸä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt;ï¼Œè¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ“ä½œï¼šæ¯æ¬¡é€‰å®šä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i\ne j\)&lt;/span&gt; ç„¶åäº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c_j\)&lt;/span&gt;ã€‚æ˜¾ç„¶è¿™æ ·ä¼šå¾—åˆ°ä¸€ä¸ªä¸‹æ ‡çš„æ–°æ’åˆ—ï¼Œé—®æœ‰å¤šå°‘ç§è¿™æ ·çš„æ’åˆ—ä½¿å¾—æœ€åçš„åºåˆ—å’ŒåŸæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; ç›¸åŒã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åº”è¯¥æ˜¯æ¯”è¾ƒç»å…¸ä½†æˆ‘ä¸ä¼šçš„è®¡æ•°å¥—è·¯ã€‚å‘ç°å…¶å®æœ€åç›¸å½“äºåªåœ¨ç›¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å½¢æˆçš„è¿é€šå—å†…éƒ¨åšäº¤æ¢ï¼Œå³æ’åˆ—çš„æ¯ä¸ªç½®æ¢ç¯å†… &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; è¦ç›¸åŒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lemma 1ï¼šäº¤æ¢ä¸¤ä¸ªæ•°ï¼Œç½®æ¢ç¯çš„ä¸ªæ•°ä¼š &lt;span class=&#34;math inline&#34;&gt;\(+1/-1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªå¼•ç†åº”è¯¥ä¸éš¾è¯æ˜ï¼ˆéšä¾¿ç”»å›¾åˆ†è®¨ä¸€ä¸‹å³å¯ï¼‰ï¼Œè€Œä¸”è²Œä¼¼æ˜¯ä¸ªç»å…¸ç»“è®ºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lemma 2ï¼šä¸€ä¸ªæ’åˆ—èƒ½åœ¨äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡åå¾—åˆ°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(n - c\le k\land (n - c)\equiv k\pmod 2\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸ºç½®æ¢ç¯ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªå¼•ç†å¯ä»¥ç”¨ Lemma 1 è¯æ˜ã€‚æ³¨æ„åˆ°åˆ°ä¸€å¼€å§‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç¯ï¼Œç„¶åå¥‡å¶æ€§è®¨è®ºä¸€ä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ç°åœ¨è¦æ±‚çš„å°±æ˜¯å¯¹äºæ¯ä¸ªåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æ±‚å‡ºåˆæ³•çš„ç½®æ¢ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ dpï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt; çš„æ’åˆ—ï¼Œç½®æ¢ç¯ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„åˆæ³•æ’åˆ—ä¸ªæ•°ã€‚è½¬ç§»çš„è¯è€ƒè™‘æ·»åŠ  &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ—¶å€™å…¶æ˜¯å½¢æˆäº†æ–°ç¯è¿˜æ˜¯å¡å…¥äº†æŸä¸ªè€ç¯ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = f_{i, j - 1} + f_{i - 1, j}\times |\{x\mid 1\le x&amp;lt; i, c_i = c_x\}|
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿ç±»ä¼¼äºç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°çš„è½¬ç§»ï¼Œæ‰€ä»¥å¯ä»¥åˆ†æ²» NTTï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt;ã€‚&lt;del&gt;å·æ‡’ç”¨äº†ä»–ç»™çš„ NTTã€‚&lt;/del&gt;&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb14&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb14-1&#34;&gt;&lt;a href=&#34;#cb14-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-2&#34;&gt;&lt;a href=&#34;#cb14-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;atcoder/modint&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-3&#34;&gt;&lt;a href=&#34;#cb14-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;atcoder/convolution&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-4&#34;&gt;&lt;a href=&#34;#cb14-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb14-5&#34;&gt;&lt;a href=&#34;#cb14-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-6&#34;&gt;&lt;a href=&#34;#cb14-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb14-7&#34;&gt;&lt;a href=&#34;#cb14-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; mint = atcoder::modint998244353;&lt;/span&gt;
&lt;span id=&#34;cb14-8&#34;&gt;&lt;a href=&#34;#cb14-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; atcoder::convolution;&lt;/span&gt;
&lt;span id=&#34;cb14-9&#34;&gt;&lt;a href=&#34;#cb14-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-10&#34;&gt;&lt;a href=&#34;#cb14-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-11&#34;&gt;&lt;a href=&#34;#cb14-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;vector&amp;lt;mint&amp;gt;&amp;gt; P;&lt;/span&gt;
&lt;span id=&#34;cb14-12&#34;&gt;&lt;a href=&#34;#cb14-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt[maxn], n, k;&lt;/span&gt;
&lt;span id=&#34;cb14-13&#34;&gt;&lt;a href=&#34;#cb14-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-14&#34;&gt;&lt;a href=&#34;#cb14-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb14-15&#34;&gt;&lt;a href=&#34;#cb14-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb14-16&#34;&gt;&lt;a href=&#34;#cb14-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb14-17&#34;&gt;&lt;a href=&#34;#cb14-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x; cin &amp;gt;&amp;gt; x;&lt;/span&gt;
&lt;span id=&#34;cb14-18&#34;&gt;&lt;a href=&#34;#cb14-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        P.push_back({cnt[x]++, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb14-19&#34;&gt;&lt;a href=&#34;#cb14-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb14-20&#34;&gt;&lt;a href=&#34;#cb14-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (P.size() &amp;gt;= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb14-21&#34;&gt;&lt;a href=&#34;#cb14-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;decltype&lt;/span&gt;(P) nxt;&lt;/span&gt;
&lt;span id=&#34;cb14-22&#34;&gt;&lt;a href=&#34;#cb14-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt; P.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) nxt.push_back(convolution(P[i], P[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]));&lt;/span&gt;
&lt;span id=&#34;cb14-23&#34;&gt;&lt;a href=&#34;#cb14-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (P.size() &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) nxt.push_back(P.back());&lt;/span&gt;
&lt;span id=&#34;cb14-24&#34;&gt;&lt;a href=&#34;#cb14-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        nxt.swap(P);&lt;/span&gt;
&lt;span id=&#34;cb14-25&#34;&gt;&lt;a href=&#34;#cb14-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb14-26&#34;&gt;&lt;a href=&#34;#cb14-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;f = P.front();&lt;/span&gt;
&lt;span id=&#34;cb14-27&#34;&gt;&lt;a href=&#34;#cb14-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    mint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-28&#34;&gt;&lt;a href=&#34;#cb14-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(c, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)f.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n - c &amp;lt;= k &amp;amp;&amp;amp; ((n - c) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) == (k &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) ans += f[c];&lt;/span&gt;
&lt;span id=&#34;cb14-29&#34;&gt;&lt;a href=&#34;#cb14-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; ans.val() &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb14-30&#34;&gt;&lt;a href=&#34;#cb14-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-31&#34;&gt;&lt;a href=&#34;#cb14-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;arc&#34;&gt;ARC&lt;/h2&gt;
&lt;h3 id=&#34;arc-è¡¥é¢˜è¡¨&#34;&gt;ARC è¡¥é¢˜è¡¨&lt;/h3&gt;
&lt;p&gt;è¿‘æœŸç›®æ ‡ï¼šARC ç¨³å®šåšå‡º 3 é¢˜ï¼Œå°½åŠ›è¡¥å®Œ A-Dã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Round&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Rank&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Perf&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Sol&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;th&gt;E&lt;/th&gt;
&lt;th&gt;F&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC116&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;vp&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;vp&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC117&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc117/standings?watching=YangTY&#34;&gt;597&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1736&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC118&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc118/standings?watching=YangTY&#34;&gt;1679&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;807&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC119&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc119/standings?watching=YangTY&#34;&gt;1141&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1180&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC120&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc120/standings?watching=YangTY&#34;&gt;785&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1345&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC123&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc123/standings?watching=YangTY&#34;&gt;608&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1756&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC124&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc124/standings?watching=YangTY&#34;&gt;1276&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1004&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC125&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc125/standings?watching=Cgfyufsygsm&#34;&gt;463&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1850&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC126&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc126/standings?watching=YangTY&#34;&gt;876&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1371&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC128&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc128/standings?watching=YangTY&#34;&gt;340&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1998&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC131&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc131/standings?watching=YangTY&#34;&gt;220&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2230&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC132&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc132/standings?watching=YangTY&#34;&gt;566&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1728&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC134&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc134/standings?watching=YangTY&#34;&gt;877&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1538&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC137&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc137/standings?watching=YangTY&#34;&gt;281&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2148&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC138&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc138/standings?watching=YangTY&#34;&gt;246&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2242&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;ä¸€äº›æ–°è§åˆ°çš„-trick-1&#34;&gt;ä¸€äº›æ–°è§åˆ°çš„ trick&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ARC116Bï¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(\max\times \min\)&lt;/span&gt; æ‹†å¼€è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;ARC125Dï¼šå­åºåˆ—è‡ªåŠ¨æœº dpã€‚&lt;/li&gt;
&lt;li&gt;ARC128Cï¼šçº¿æ€§è§„åˆ’çš„æœ€å€¼ä¸€å®šåœ¨è¾¹ç•Œå–åˆ°ã€‚&lt;/li&gt;
&lt;li&gt;ARC134Cï¼š&lt;strong&gt;æŸç§å…ƒç´ è‡³å°‘å ä¸€åŠ&lt;/strong&gt;ï¼Œè€ƒè™‘å…ˆå¼ºè¡Œé…å¯¹ï¼Œç„¶åæ­£å¸¸åšã€‚&lt;/li&gt;
&lt;li&gt;ARC137Dï¼šæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„ Lucas â†’ é«˜ç»´å‰ç¼€å’Œã€‚&lt;/li&gt;
&lt;li&gt;ARC137Eï¼šæœ€å°è´¹ç”¨å¾ªç¯æµçš„å»ºå›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;arc116&#34;&gt;ARC116&lt;/h3&gt;
&lt;p&gt;VPã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc116a---odd-vs-even&#34;&gt;ARC116A - Odd vs Even&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(T\le 2\times 10^5\)&lt;/span&gt;ï¼‰ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^{18}\)&lt;/span&gt;ï¼‰ï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„å¥‡çº¦æ•°å¤šè¿˜æ˜¯å¶çº¦æ•°å¤šã€‚ï¼ˆçº¦æ•°å‡ä¸ºæ­£çº¦æ•°ï¼‰&lt;/p&gt;
&lt;p&gt;å¾ˆæ˜æ˜¾ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(n\bmod 2 = 1\)&lt;/span&gt;ï¼Œåˆ™ç­”æ¡ˆä¸ºå¥‡çº¦æ•°å¤šã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™è€ƒå¯Ÿçº¦æ•°ä»¬æ€ä¹ˆæ¥çš„ã€‚å¯¹äºä¸€ä¸ªå¶æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æˆ‘ä»¬æ€»èƒ½å°†å…¶è¿™æ ·æ‹†åˆ†ï¼š&lt;span class=&#34;math inline&#34;&gt;\(n = 2^k\times p\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; ä¸ºå¥‡æ•°ï¼‰ã€‚é‚£ä¹ˆå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(k = 1\)&lt;/span&gt;ï¼Œåˆ™ä¸éš¾å‘ç°å¥‡å¶çº¦æ•°ä¸€æ ·å¤šï¼Œå¦åˆ™è‚¯å®šæ˜¯å¶çº¦æ•°å¤šã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc116b---products-of-min-max&#34;&gt;ARC116B - Products of Min-Max&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€å«æ­£æ•´æ•°çš„é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{S\subseteq A}\max_{a\in S}\lbrace a\rbrace\min_{a\in S}\lbrace a\rbrace\bmod{998244353}
\]&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘æŠŠæœ€å¤§å€¼å’Œæœ€å°å€¼æ‹å‡ºæ¥è€ƒè™‘è´¡çŒ®ï¼šå°†å…¶ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä»å°åˆ°å¤§æ’åºã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå‡è®¾æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;lt;j\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(a_i\le a_j\)&lt;/span&gt;ï¼Œè¿™ä¸€å¯¹å…ƒç´ è´¡çŒ®çš„å­é›†ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^{j - i - 1}\)&lt;/span&gt;ã€‚æ‰€ä»¥ç­”æ¡ˆå°±ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^{n - 1}\sum_{j = i + 1}^na_ia_j\cdot2^{j - i} + \sum_{i = 1}^na_i^2
\]&lt;/span&gt; åŒ–ç®€ä¸‹æ¥å¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^{n - 1}\left(a_i\cdot 2^{-i}\sum_{j = i + 1}^na_j\cdot2^{j - 1}\right) + \sum_{i = 1}^na_i^2
\]&lt;/span&gt; é¢„å¤„ç† &lt;span class=&#34;math inline&#34;&gt;\(a_i2^{i - 1}\)&lt;/span&gt; çš„åç¼€å’Œå°±å¯ä»¥ç›´æ¥åšäº†ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc116c---multiple-sequences&#34;&gt;ARC116C - Multiple Sequences&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n,m\le 2\times 10^5\)&lt;/span&gt;ï¼‰ï¼Œæ±‚æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; çš„ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le A_i\le m\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(A_{i + 1}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„æ•´æ•°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“æœæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¦™çš„è®¡æ•°é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; çš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å°±æ˜¯æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; æ¯ä¸ªè´¨å› å­ç»™å®‰æ’åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªä¸åŒçš„ä½ç½®ä¸Šï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚ä½†æ˜¯æ­¤æ—¶éœ€è¦å¯¹æ¯ä¸ªè´¨å› å­åˆ†å¼€è€ƒè™‘ï¼Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(A_n = \prod p_i^{c_i}\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªè´¨å› å­éƒ½ç”¨æ’æ¿æ³•ç„¶åå†ä¹˜èµ·æ¥å¾—åˆ°æ€»æ–¹æ¡ˆï¼Œå³ &lt;span class=&#34;math display&#34;&gt;\[
f(A_n) = \prod\binom{n + c_i - 1}{c_i}
\]&lt;/span&gt; æœ€åæŠŠæ‰€æœ‰çš„ç»“æœåŠ èµ·æ¥å³ä¸ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc117&#34;&gt;ARC117&lt;/h3&gt;
&lt;p&gt;A + B + C + D&lt;/p&gt;
&lt;h4 id=&#34;arc117c---tricolor-pyramid&#34;&gt;ARC117C - Tricolor Pyramid&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc117/tasks/arc117_c&#34;&gt;é¢˜ç›®&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„é¢˜ã€‚é¦–å…ˆæŠŠé¢œè‰²åˆ†åˆ«çœ‹æˆ &lt;span class=&#34;math inline&#34;&gt;\(0,1,2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¸Šä¸€å±‚çš„æ–¹å—å°±ç”± &lt;span class=&#34;math inline&#34;&gt;\(-(a_1 + a_2) \bmod 3\)&lt;/span&gt; å¯ä»¥å¾—åˆ°ã€‚æŠŠæ‰€æœ‰çš„ä¸€ç›´ç´¯åŠ ä¸Šå»å°±æ˜¯æ¨è¾‰ä¸‰è§’çš„å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/arc117/6d089e1cdfb0ed3c0bf6daee87fc198e.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å›¾æº AtCoder å®˜æ–¹é¢˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ±‚äºŒé¡¹å¼ç³»æ•°å³å¯ï¼Œä½¿ç”¨ Lucas å®šç†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc117d---miracle-tree&#34;&gt;ARC117D - Miracle Tree&lt;/h4&gt;
&lt;p&gt;ç»™ä¸€æ£µæ ‘çš„æ¯ä¸ªé¡¶ç‚¹æ ‡å·ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(E_i \ge 1\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(|E_i - E_j|\le \operatorname{dist}(i, j)\)&lt;/span&gt;ã€‚å¯»æ‰¾ä¸€ç§æœ€å¤§æ ‡å·æœ€å°çš„æ–¹æ¡ˆå¹¶è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ç›¸å½“å¥½çš„æ€ç»´é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘éšä¾¿æ ‡ä¸€ä¸ªå›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/arc117/a4103a74b2e0196e17a1a389f8fad851.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å›¾æº AtCoder å®˜æ–¹é¢˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°æˆ‘ä»¬æ ‡çš„å·åº”è¯¥ä¸ºï¼š&lt;span class=&#34;math inline&#34;&gt;\(\lbrace1, 2, 3, 5, 8, 9\rbrace\)&lt;/span&gt; æ˜¯æœ€ä¼˜çš„ã€‚ç›¸å½“äºå°±æ˜¯é‡åˆ°ä¸€ä¸ªç‚¹ï¼Œé¦–å…ˆèµ°ä¸€æ¡å­é“¾ï¼Œç„¶åå›æº¯å›æ¥çš„æ—¶å€™ä»ç„¶éœ€è¦ç»Ÿè®¡å›æº¯é“¾é•¿ï¼Œç„¶ååŠ åˆ°ä¸‹ä¸€æ¡å­é“¾çš„è´¡çŒ®é‡Œé¢å»ï¼ˆå› ä¸ºè¦ &lt;span class=&#34;math inline&#34;&gt;\(|E_i - E_j|\le \operatorname{dist}(i, j)\)&lt;/span&gt;ï¼‰ã€‚æˆ‘ä»¬è‡ªç„¶å¸Œæœ›çš„æ˜¯å°½å¯èƒ½å›æº¯çš„å°‘ï¼Œæ‰€ä»¥åšçš„æ—¶å€™ä»ç›´å¾„çš„ä¸€ç«¯å¼€å§‹èµ°ï¼Œç„¶åé‡åˆ°åˆ†å‰å°±ä¼˜å…ˆèµ°éç›´å¾„çš„è¾¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc118&#34;&gt;ARC118&lt;/h3&gt;
&lt;p&gt;A&lt;/p&gt;
&lt;h4 id=&#34;arc118a---tax-included-price&#34;&gt;ARC118A - Tax Included Price&lt;/h4&gt;
&lt;p&gt;æ‰“è¡¨å¯åšã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc118b---village-of-m-people&#34;&gt;ARC118B - Village of M People&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ä»¥åŠ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œæ„é€  &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\sum B_i = M\)&lt;/span&gt; ä¸” &lt;span class=&#34;math display&#34;&gt;\[
\max_i\left|\frac{B_i}{M} - \frac{A_i}{N}\right|
\]&lt;/span&gt; æœ€å°ã€‚&lt;/p&gt;
&lt;p&gt;â€œæœ€å¤§çš„æœ€å°â€ï¼ŒäºŒåˆ†ç­”æ¡ˆå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¦è®© &lt;span class=&#34;math inline&#34;&gt;\(\max_i\left|\frac{B_i}{M} - \frac{A_i}{N}\right|\)&lt;/span&gt; æœ€å°ï¼Œå³ä¸ºè®© &lt;span class=&#34;math inline&#34;&gt;\(\max_i|B_iN - A_iM|\)&lt;/span&gt; æœ€å°ï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\forall i, \left\lceil \frac{MA_i-x}{N}\right\rceil\leq B_i\leq \left\lfloor\frac{MA_i+x}{N}\right\rfloor\)&lt;/span&gt;ã€‚è¿™æ ·å­ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; çš„ä¸Šç•Œå’Œä¸‹ç•Œå°±å‡ºæ¥äº†ï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(R_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(\sum L_i\le M\le \sum R_i\)&lt;/span&gt;ï¼Œåˆ™ç­”æ¡ˆä¸€å®šæ˜¯å¯ä»¥è¢«æ„é€ å‡ºæ¥çš„ã€‚è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥å®Œæˆå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ checkã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•æ„é€ è¿™ä¸ªç­”æ¡ˆå‘¢ï¼ŸæŠŠæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; è®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L_i\)&lt;/span&gt;ï¼Œç„¶åä¾æ¬¡ä¸Šè°ƒæ¥è¡¥é½ä½™é‡ &lt;span class=&#34;math inline&#34;&gt;\(M - \sum L_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb15&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb15-1&#34;&gt;&lt;a href=&#34;#cb15-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-2&#34;&gt;&lt;a href=&#34;#cb15-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-3&#34;&gt;&lt;a href=&#34;#cb15-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-4&#34;&gt;&lt;a href=&#34;#cb15-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb15-5&#34;&gt;&lt;a href=&#34;#cb15-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb15-6&#34;&gt;&lt;a href=&#34;#cb15-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define int &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-7&#34;&gt;&lt;a href=&#34;#cb15-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-8&#34;&gt;&lt;a href=&#34;#cb15-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-9&#34;&gt;&lt;a href=&#34;#cb15-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-10&#34;&gt;&lt;a href=&#34;#cb15-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb15-11&#34;&gt;&lt;a href=&#34;#cb15-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-12&#34;&gt;&lt;a href=&#34;#cb15-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-13&#34;&gt;&lt;a href=&#34;#cb15-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb15-14&#34;&gt;&lt;a href=&#34;#cb15-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb15-15&#34;&gt;&lt;a href=&#34;#cb15-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x |= (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb15-16&#34;&gt;&lt;a href=&#34;#cb15-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb15-17&#34;&gt;&lt;a href=&#34;#cb15-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = s * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb15-18&#34;&gt;&lt;a href=&#34;#cb15-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x ? -s : s;&lt;/span&gt;
&lt;span id=&#34;cb15-19&#34;&gt;&lt;a href=&#34;#cb15-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb15-20&#34;&gt;&lt;a href=&#34;#cb15-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-21&#34;&gt;&lt;a href=&#34;#cb15-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, a[maxn], n, m;&lt;/span&gt;
&lt;span id=&#34;cb15-22&#34;&gt;&lt;a href=&#34;#cb15-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; L[maxn], R[maxn], suml, sumr;&lt;/span&gt;
&lt;span id=&#34;cb15-23&#34;&gt;&lt;a href=&#34;#cb15-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-24&#34;&gt;&lt;a href=&#34;#cb15-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; max(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;gt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb15-25&#34;&gt;&lt;a href=&#34;#cb15-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; min(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;lt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb15-26&#34;&gt;&lt;a href=&#34;#cb15-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-27&#34;&gt;&lt;a href=&#34;#cb15-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb15-28&#34;&gt;&lt;a href=&#34;#cb15-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-29&#34;&gt;&lt;a href=&#34;#cb15-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(L, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; L), memset(R, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; R);&lt;/span&gt;
&lt;span id=&#34;cb15-30&#34;&gt;&lt;a href=&#34;#cb15-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    suml = sumr = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-31&#34;&gt;&lt;a href=&#34;#cb15-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k)&lt;/span&gt;
&lt;span id=&#34;cb15-32&#34;&gt;&lt;a href=&#34;#cb15-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-33&#34;&gt;&lt;a href=&#34;#cb15-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        L[i] = max(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (m * a[i] - x + n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / n);&lt;/span&gt;
&lt;span id=&#34;cb15-34&#34;&gt;&lt;a href=&#34;#cb15-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        R[i] = (m * a[i] + x) / n;&lt;/span&gt;
&lt;span id=&#34;cb15-35&#34;&gt;&lt;a href=&#34;#cb15-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        suml += L[i], sumr += R[i];&lt;/span&gt;
&lt;span id=&#34;cb15-36&#34;&gt;&lt;a href=&#34;#cb15-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-37&#34;&gt;&lt;a href=&#34;#cb15-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; suml &amp;lt;= m &amp;amp;&amp;amp; m &amp;lt;= sumr;&lt;/span&gt;
&lt;span id=&#34;cb15-38&#34;&gt;&lt;a href=&#34;#cb15-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb15-39&#34;&gt;&lt;a href=&#34;#cb15-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-40&#34;&gt;&lt;a href=&#34;#cb15-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;signed&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb15-41&#34;&gt;&lt;a href=&#34;#cb15-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-42&#34;&gt;&lt;a href=&#34;#cb15-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    k = read(), n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb15-43&#34;&gt;&lt;a href=&#34;#cb15-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) a[i] = read();&lt;/span&gt;
&lt;span id=&#34;cb15-44&#34;&gt;&lt;a href=&#34;#cb15-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = n * m, x;&lt;/span&gt;
&lt;span id=&#34;cb15-45&#34;&gt;&lt;a href=&#34;#cb15-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt;= r)&lt;/span&gt;
&lt;span id=&#34;cb15-46&#34;&gt;&lt;a href=&#34;#cb15-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-47&#34;&gt;&lt;a href=&#34;#cb15-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-48&#34;&gt;&lt;a href=&#34;#cb15-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (check(mid)) x = mid, r = mid - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-49&#34;&gt;&lt;a href=&#34;#cb15-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; l = mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-50&#34;&gt;&lt;a href=&#34;#cb15-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-51&#34;&gt;&lt;a href=&#34;#cb15-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    check(x);&lt;/span&gt;
&lt;span id=&#34;cb15-52&#34;&gt;&lt;a href=&#34;#cb15-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sumb = suml;&lt;/span&gt;
&lt;span id=&#34;cb15-53&#34;&gt;&lt;a href=&#34;#cb15-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k)&lt;/span&gt;
&lt;span id=&#34;cb15-54&#34;&gt;&lt;a href=&#34;#cb15-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-55&#34;&gt;&lt;a href=&#34;#cb15-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = min(R[i] - L[i], m - sumb);&lt;/span&gt;
&lt;span id=&#34;cb15-56&#34;&gt;&lt;a href=&#34;#cb15-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        sumb += x;&lt;/span&gt;
&lt;span id=&#34;cb15-57&#34;&gt;&lt;a href=&#34;#cb15-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, x + L[i]);&lt;/span&gt;
&lt;span id=&#34;cb15-58&#34;&gt;&lt;a href=&#34;#cb15-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-59&#34;&gt;&lt;a href=&#34;#cb15-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-60&#34;&gt;&lt;a href=&#34;#cb15-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc118c---coprime-set&#34;&gt;ARC118C - Coprime Set&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(3\le N\le 2500\)&lt;/span&gt;ï¼‰ï¼Œæ„é€  &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä½¿å¾—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; äº’ä¸ç›¸åŒä¸” &lt;span class=&#34;math inline&#34;&gt;\(A_i\in[1, 10000]\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i \not= j, \gcd(A_i, A_j) &amp;gt; 1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\gcd_i\{A_i\} = 1\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªé¢˜éœ€è¦ä¸€ä¸ªå¼•ç†ï¼šå¯¹äºä¸€ç³»åˆ—å·²ç»æ»¡è¶³æ¡ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œå°†ä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„å€æ•°åŠ è¿›å»ï¼Œæ–°å¾—åˆ°çš„é›†åˆä¹Ÿæ˜¯æ»¡è¶³æ¡ä»¶çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ­£ç¡®æ€§æ¯”è¾ƒæ˜¾ç„¶ï¼Œä¸è¯ã€‚æ‰€ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(\{6, 10, 15\}\)&lt;/span&gt; å‡ºå‘ï¼Œå°±å¯ä»¥æ„é€ å‡ºæ‰€æœ‰çš„åˆæ³•ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb16&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb16-1&#34;&gt;&lt;a href=&#34;#cb16-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-2&#34;&gt;&lt;a href=&#34;#cb16-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-3&#34;&gt;&lt;a href=&#34;#cb16-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[&lt;span class=&#34;dv&#34;&gt;10005&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb16-4&#34;&gt;&lt;a href=&#34;#cb16-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-5&#34;&gt;&lt;a href=&#34;#cb16-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb16-6&#34;&gt;&lt;a href=&#34;#cb16-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb16-7&#34;&gt;&lt;a href=&#34;#cb16-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-8&#34;&gt;&lt;a href=&#34;#cb16-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;
&lt;span id=&#34;cb16-9&#34;&gt;&lt;a href=&#34;#cb16-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt; &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt;; ++i) vis[i * &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-10&#34;&gt;&lt;a href=&#34;#cb16-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt;; ++i) vis[i * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-11&#34;&gt;&lt;a href=&#34;#cb16-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt; &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt;; ++i) vis[i * &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-12&#34;&gt;&lt;a href=&#34;#cb16-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-13&#34;&gt;&lt;a href=&#34;#cb16-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;), vis[&lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;] = vis[&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;] = vis[&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-14&#34;&gt;&lt;a href=&#34;#cb16-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;; i &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt; &amp;amp;&amp;amp; cnt &amp;lt;= n; ++i) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[i]) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, i), ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb16-15&#34;&gt;&lt;a href=&#34;#cb16-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-16&#34;&gt;&lt;a href=&#34;#cb16-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc119&#34;&gt;ARC119&lt;/h3&gt;
&lt;p&gt;A + B&lt;/p&gt;
&lt;h4 id=&#34;arc119b---electric-board&#34;&gt;ARC119B - Electric Board&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ª 01 ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ“ä½œå¯ä»¥é€‰å– &lt;span class=&#34;math inline&#34;&gt;\((l,r)\)&lt;/span&gt;ï¼Œæ»¡è¶³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_l = 0\land S_{l+ 1} = S_{l + 2} = \cdots = S_{r} = 1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_l = S_{l + 1} = \cdots = S_{r - 1} = 1 \land S_r = 0\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åäº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(S_l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt;ã€‚é—®æœ€å°‘å¤šå°‘æ¬¡æ“ä½œä¹‹åå¯ä»¥å°† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸å¦¨å°†æ¯æ¬¡æ“ä½œçœ‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç§»åŠ¨æ“ä½œï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ˜¯è¿ç»­åŠ¨çš„ï¼Œä¸å¥½è€ƒè™‘ã€‚é‚£ä¹ˆå°±åªéœ€è¦ä»å·¦å¾€å³è¿›è¡Œè´ªå¿ƒï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¾æ¬¡å¾€å³ç§»ç›´åˆ°ä¸ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¯¹åº”ã€‚è®°å½•ä¸‹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä½ç½®ç„¶åç›´æ¥è´ªå¿ƒå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc119c---arc-wrecker-2&#34;&gt;ARC119C - ARC Wrecker 2&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œå¯¹äºåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\([l, r - 1]\)&lt;/span&gt; é—´çš„ä¸€ä¸ªæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\(A_x\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(A_{x + 1}\)&lt;/span&gt; åŒæ—¶åŠ ä¸€æˆ–å‡ä¸€ã€‚é—®æœ‰å¤šå°‘ä¸ª &lt;span class=&#34;math inline&#34;&gt;\([l,r ]\)&lt;/span&gt; å¯ä»¥åœ¨æœ‰é™æ¬¡æ“ä½œä¹‹åå˜ä¸ºå…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æ“ä½œç›¸å½“äºæ˜¯ç»™å¥‡æ•°ä¸‹æ ‡çš„æ•°å’Œå¶æ•°ä¸‹æ ‡çš„æ•°åŒæ—¶åŠ å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ‰€ä»¥ä¸ºäº†æœ€åå¾—åˆ°å…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä¸€å¼€å§‹é€‰çš„åŒºé—´ä¸­å¥‡ä¸‹æ ‡å’Œå¶ä¸‹æ ‡æ•°çš„å’Œå¿…é¡»ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°è¿™æ¡æ€§è´¨ä¹‹åè®°å½•ä¸€ä¸‹å‰ç¼€å’Œï¼Œç„¶åç”¨ &lt;code&gt;map&lt;/code&gt; éšä¾¿è®°å½•ä»¥ä¸‹å°±å¯ä»¥åšäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb17&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb17-1&#34;&gt;&lt;a href=&#34;#cb17-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb17-2&#34;&gt;&lt;a href=&#34;#cb17-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-3&#34;&gt;&lt;a href=&#34;#cb17-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll ans, a[maxn], s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb17-4&#34;&gt;&lt;a href=&#34;#cb17-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-5&#34;&gt;&lt;a href=&#34;#cb17-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;map&amp;lt;ll, ll&amp;gt; m;&lt;/span&gt;
&lt;span id=&#34;cb17-6&#34;&gt;&lt;a href=&#34;#cb17-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-7&#34;&gt;&lt;a href=&#34;#cb17-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb17-8&#34;&gt;&lt;a href=&#34;#cb17-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb17-9&#34;&gt;&lt;a href=&#34;#cb17-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = read();&lt;/span&gt;
&lt;span id=&#34;cb17-10&#34;&gt;&lt;a href=&#34;#cb17-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i] = read() * ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-11&#34;&gt;&lt;a href=&#34;#cb17-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) s[i] = a[i] + s[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], ++m[s[i]];&lt;/span&gt;
&lt;span id=&#34;cb17-12&#34;&gt;&lt;a href=&#34;#cb17-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ++m[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb17-13&#34;&gt;&lt;a href=&#34;#cb17-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;map&amp;lt;ll, ll&amp;gt;::iterator it = m.begin(); it != m.end(); ++it)&lt;/span&gt;
&lt;span id=&#34;cb17-14&#34;&gt;&lt;a href=&#34;#cb17-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += (*it).second * ((*it).second - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-15&#34;&gt;&lt;a href=&#34;#cb17-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb17-16&#34;&gt;&lt;a href=&#34;#cb17-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-17&#34;&gt;&lt;a href=&#34;#cb17-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç­”æ¡ˆçš„ä¸Šç•Œæ˜¯ä¼šçˆ† &lt;code&gt;int&lt;/code&gt;ï¼Œè¦å¼€ &lt;code&gt;long long&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc119d---grid-repainting-3&#34;&gt;ARC119D - Grid Repainting 3&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ &lt;span class=&#34;math inline&#34;&gt;\(H\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(W\)&lt;/span&gt; åˆ—çš„æ–¹æ ¼ï¼Œæ¯ä¸ªæ–¹æ ¼ä¸€å¼€å§‹æ¶‚äº†çº¢è‰²æˆ–è€…è“è‰²ã€‚è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼šå¯¹äºå½“å‰çš„æ¯ä¸ªçº¢è‰²æ ¼å­ï¼Œå¯ä»¥é€‰æ‹©å®ƒå¹¶å°†å…¶æ‰€åœ¨çš„ä¸€è¡Œæˆ–ä¸€åˆ—å…¨éƒ¨æ¶‚æ»¡ç™½è‰²ã€‚é—®æœ€åæœ€å¤šå¤šå°‘ä¸ªæ ¼å­å¯ä»¥æ˜¯ç™½è‰²å¹¶æ„é€ æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§æ–¹æ ¼å¹¶ä¸”æ“ä½œæ˜¯å¯¹äºæ•´è¡Œæˆ–æ•´åˆ—çš„é¢˜ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ„å»ºä¸€å¼ äºŒåˆ†å›¾æ¥è§£å†³é—®é¢˜ã€‚å·¦éƒ¨çš„ç‚¹ä»£è¡¨æ¯è¡Œï¼Œå³éƒ¨çš„ç‚¹ä»£è¡¨æ¯åˆ—ï¼Œä¸€ä¸ªçº¢æ ¼å­ä»£è¡¨ä¸€æ¡è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬åˆ†æè¿™ä¸ªæ¶‚è‰²æ–¹æ¡ˆã€‚æ¶‚æ‰ä¸€æ•´è¡Œ/åˆ—ç›¸å½“äºåºŸæ‰è¿™ä¸€ä¸ªç‚¹ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªç‚¹ç›¸å…³çš„æ‰€æœ‰è¾¹å…¨éƒ¨åºŸæ‰ï¼ˆå³ä¸ºåºŸæ‰åœ¨è¿™è¡Œ/åˆ—ä¸Šçš„çº¢æ ¼å­ï¼‰ã€‚å½“ç„¶åºŸæ‰è¿™ä¸ªç‚¹çš„æ¡ä»¶æ˜¯å®ƒèƒ½å¼•å‡ºè‡³å°‘ä¸€æ¡è¾¹ï¼ˆå³å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªçº¢æ ¼å­åœ¨è¿™è¡Œ/åˆ—ä¸Šé¢ï¼‰ã€‚ä¾æ®è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›ä¸€ä¸ªè¿é€šåˆ†é‡å†…ï¼ŒåºŸæ‰çš„ç‚¹ï¼ˆå³æ¶‚æ‰çš„è¡Œ/åˆ—ï¼‰è¶Šå¤šè¶Šå¥½ï¼Œè€ƒè™‘å¦‚ä½•ä½¿å®ƒæœ€å¤šã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ï¼Œä¸€ä¸ªè¿é€šåˆ†é‡åˆ åˆ°æœ€åä¸€å®šä¼šå‰©ä¸‹ä¸€ä¸ªç‚¹ï¼ˆè‡³äºä¸ºä»€ä¹ˆå¯ä»¥è‡ªå·±æ€è€ƒä¸€ä¸‹ï¼‰ã€‚æˆ‘ä»¬å°è¯•æ„é€ ä¸€ä¸‹æ–¹æ¡ˆï¼šå‡è®¾æˆ‘ä»¬å‰©ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ„å»ºè¿™ä¸ªè¿é€šåˆ†é‡çš„ dfs ç”Ÿæˆæ ‘ï¼Œç„¶åä»å¶å­èŠ‚ç‚¹å¾€ä¸Šåˆ ç‚¹ï¼Œè¿™æ ·ä¸€å®šå¯ä»¥ä¿è¯æ˜¯åˆæ³•è€Œä¸”é™¤äº† &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œå…¶ä»–çš„ç‚¹ä¼šè¢«åˆ å¹²å‡€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼ å›¾æ˜¯æœ‰å¾ˆå¤šä¸ªè¿é€šåˆ†é‡çš„ï¼Œè€Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªè¿é€šåˆ†é‡è¿›è¡Œå†³ç­–ï¼šç•™ä¸‹å“ªä¸ªç‚¹æœ€ä¼˜ã€‚æˆ‘ä»¬è¦æ¶‚ç™½çš„æ ¼å­æœ€å¤šï¼Œå‡è®¾æ¶‚äº† &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; åˆ—ï¼Œåˆ™å‰©ä¸‹çš„è“æ ¼å­ä¸º &lt;span class=&#34;math inline&#34;&gt;\((h - r)(w - c)\)&lt;/span&gt; ä¸ªï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æœ€å°åŒ–ã€‚ä¸éš¾å‘ç°æˆ‘ä»¬å¯ä»¥ç›´æ¥æšä¸¾ç•™ä¸‹æ¥çš„è¡Œç‚¹å’Œåˆ—ç‚¹çš„ä¸ªæ•°ï¼Œç„¶åæ‰¾åˆ°æœ€ä¼˜è§£å°±ç›´æ¥å†³ç­–æ¯ä¸ªè¿é€šåˆ†é‡å‰©ä¸‹è¡Œè¿˜æ˜¯åˆ—ï¼ˆåæ­£å“ªä¸€è¡Œå“ªä¸€åˆ—ä¸é‡è¦ï¼‰ï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦çš„æµç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ“è‰²æ ‡è®°è¿é€šåˆ†é‡&lt;/li&gt;
&lt;li&gt;å†³ç­–å‰©ä¸‹å¤šå°‘åˆ—ç‚¹å’Œå¤šå°‘è¡Œç‚¹&lt;/li&gt;
&lt;li&gt;dfs è®°å½•ç­”æ¡ˆ&lt;/li&gt;
&lt;li&gt;è¾“å‡º&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;arc120&#34;&gt;ARC120&lt;/h3&gt;
&lt;p&gt;A + B&lt;/p&gt;
&lt;h4 id=&#34;arc120b---uniformly-distributed&#34;&gt;ARC120B - Uniformly Distributed&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(H \times W\)&lt;/span&gt; çš„æ–¹æ ¼ï¼Œå…¶ä¸­ä¸€äº›æ¶‚äº†çº¢è‰²ï¼Œä¸€äº›æ¶‚äº†è“è‰²ï¼Œä¸€äº›ä»€ä¹ˆéƒ½æ²¡æ¶‚ã€‚é—®å¯¹äºå‰©ä½™çš„æ ¼å­ï¼Œæœ‰å¤šå°‘ç§æ¶‚è‰²çš„æ–¹æ¡ˆä½¿å¾—ä» &lt;span class=&#34;math inline&#34;&gt;\((1,1)\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\((H,W)\)&lt;/span&gt; ä¸Šçš„æ‰€æœ‰è·¯å¾„ç»è¿‡çš„çº¢æ ¼å­æ•°é‡éƒ½ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°ï¼Œå¯¹äºä¸€ä¸ªä»å³ä¸Šåˆ°å·¦ä¸‹çš„å‰¯å¯¹è§’çº¿ï¼Œå…¶è¦ä¹ˆå…¨ä¸ºçº¢è‰²ï¼Œè¦ä¹ˆå…¨ä¸ºè“è‰²ã€‚å¤§ä½“çš„ç†ç”±å¦‚ä¸‹ï¼šï¼ˆéä¸¥æ ¼è¯æ˜ï¼‰&lt;/p&gt;
&lt;p&gt;ä» &lt;span class=&#34;math inline&#34;&gt;\((1,1)\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\((H,W)\)&lt;/span&gt; ä¸€å®šæ˜¯ä¼šç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(H + W - 1\)&lt;/span&gt; æ¡å¦‚ä¸Šé¢è¿™æ ·çš„å‰¯å¯¹è§’çº¿çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šè¦ä¿è¯æ— è®ºæ€ä¹ˆç©¿è¿‡ä¸€æ¡å‰¯å¯¹è§’çº¿ï¼Œå…¶ç»è¿‡çš„çº¢æ ¼å­æ•°é‡éƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç›´æ¥åšå°±è¡Œäº†ï¼Œå¯¹äºä¸€æ¡æœ‰çº¢æ ¼å­çš„å‰¯å¯¹è§’çº¿ï¼Œå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼›å¯¹äºä¸€æ¡å…¨ç©ºçš„å‰¯å¯¹è§’çº¿ï¼Œå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼ˆä¸¤ç§æ¶‚è‰²æ–¹æ¡ˆï¼‰ï¼›å¯¹äºæ—¢æœ‰è“è‰²åˆæœ‰çº¢è‰²çš„å‰¯å¯¹è§’çº¿ï¼Œå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æŠŠè¿™äº›è´¡çŒ®ç”¨ä¹˜æ³•åŸç†åˆå¹¶å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc120c---swaps-2&#34;&gt;ARC120C - Swaps 2&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ã€‚é—®å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; è¿›è¡Œæœ‰é™æ¬¡å¦‚ä¸‹æ“ä½œåèƒ½å¦ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(1\le i\lt N\)&lt;/span&gt;
&lt;ul&gt;
&lt;li&gt;äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(A_{i+ 1}\)&lt;/span&gt; çš„å€¼&lt;/li&gt;
&lt;li&gt;ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; åŠ ä¸€&lt;/li&gt;
&lt;li&gt;ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(A_{i + 1}\)&lt;/span&gt; å‡ä¸€&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœèƒ½ï¼Œé—®æœ€å°‘æ“ä½œæ­¥æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè€ƒè™‘è§£çš„å­˜åœ¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸ªæ•°ç§»åŠ¨çš„æƒ…å†µï¼šæ˜¾ç„¶æ˜¯å¾€å³èµ°å°±å‡å°ï¼Œå¾€å·¦èµ°å°±å¢å¤§ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„æ–°ä½ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(D_i\)&lt;/span&gt;ï¼Œåˆ™å¿…ç„¶æœ‰ï¼š &lt;span class=&#34;math display&#34;&gt;\[
B_{D_i} = A_i + i - D_i
\]&lt;/span&gt; ç§»é¡¹ï¼Œ &lt;span class=&#34;math display&#34;&gt;\[
B_{D_i} + D_i = A_i + i
\]&lt;/span&gt; å‘ç°ä¸¤è¾¹çš„å½¢å¼å¾ˆåƒï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å»ºç«‹ä¸¤ä¸ªæ–°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{A_i + i\}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{B_i + i\}\)&lt;/span&gt; ç„¶åå°†å…¶å€¼æ’åºåˆ¤æ–­å…¶èƒ½ä¸èƒ½ä¸€ä¸€å¯¹åº”å°±å¯ä»¥åˆ¤æ–­æœ‰æ²¡æœ‰è§£äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè€ƒè™‘è§£çš„æœ€ä¼˜æ€§ã€‚&lt;/p&gt;
&lt;p&gt;åˆšæ‰çš„æ’åºä¸­ï¼Œè‹¥æŒ‰ç…§å€¼ä¸ºç¬¬ä¸€å…³é”®å­—æ’åºï¼ŒåŸä¸‹æ ‡ä¸ºç¬¬äºŒå…³é”®å­—æ’åºï¼Œåˆ™æˆ‘ä»¬ä¸éš¾è¯æ˜ï¼Œæ­¤æ—¶ä¸€ä¸€å¯¹åº”çš„ç»“æœæ˜¯æœ€ä¼˜çš„ã€‚è¿™æ ·å­ &lt;span class=&#34;math inline&#34;&gt;\(D_i\)&lt;/span&gt; å°±æ‰¾åˆ°äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ç§»åˆ° &lt;span class=&#34;math inline&#34;&gt;\(A_{D_i}\)&lt;/span&gt; çš„è¿‡ç¨‹å¾ˆåƒå†’æ³¡æ’åºï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­å…ƒç´ çš„ä¸‹æ ‡å°±å¯ä»¥åšäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb18&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb18-1&#34;&gt;&lt;a href=&#34;#cb18-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-2&#34;&gt;&lt;a href=&#34;#cb18-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-3&#34;&gt;&lt;a href=&#34;#cb18-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-4&#34;&gt;&lt;a href=&#34;#cb18-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb18-5&#34;&gt;&lt;a href=&#34;#cb18-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb18-6&#34;&gt;&lt;a href=&#34;#cb18-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define int &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-7&#34;&gt;&lt;a href=&#34;#cb18-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-8&#34;&gt;&lt;a href=&#34;#cb18-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-9&#34;&gt;&lt;a href=&#34;#cb18-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-10&#34;&gt;&lt;a href=&#34;#cb18-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb18-11&#34;&gt;&lt;a href=&#34;#cb18-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-12&#34;&gt;&lt;a href=&#34;#cb18-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-13&#34;&gt;&lt;a href=&#34;#cb18-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb18-14&#34;&gt;&lt;a href=&#34;#cb18-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb18-15&#34;&gt;&lt;a href=&#34;#cb18-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x |= (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb18-16&#34;&gt;&lt;a href=&#34;#cb18-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb18-17&#34;&gt;&lt;a href=&#34;#cb18-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = s * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb18-18&#34;&gt;&lt;a href=&#34;#cb18-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x ? -s : s;&lt;/span&gt;
&lt;span id=&#34;cb18-19&#34;&gt;&lt;a href=&#34;#cb18-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-20&#34;&gt;&lt;a href=&#34;#cb18-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-21&#34;&gt;&lt;a href=&#34;#cb18-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; node&lt;/span&gt;
&lt;span id=&#34;cb18-22&#34;&gt;&lt;a href=&#34;#cb18-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-23&#34;&gt;&lt;a href=&#34;#cb18-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; val, id;&lt;/span&gt;
&lt;span id=&#34;cb18-24&#34;&gt;&lt;a href=&#34;#cb18-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; node &amp;amp;b)&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-25&#34;&gt;&lt;a href=&#34;#cb18-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb18-26&#34;&gt;&lt;a href=&#34;#cb18-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; val == b.val ? id &amp;lt; b.id : val &amp;lt; b.val;&lt;/span&gt;
&lt;span id=&#34;cb18-27&#34;&gt;&lt;a href=&#34;#cb18-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-28&#34;&gt;&lt;a href=&#34;#cb18-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} ai[maxn], bi[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-29&#34;&gt;&lt;a href=&#34;#cb18-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-30&#34;&gt;&lt;a href=&#34;#cb18-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], b[maxn], n;&lt;/span&gt;
&lt;span id=&#34;cb18-31&#34;&gt;&lt;a href=&#34;#cb18-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-32&#34;&gt;&lt;a href=&#34;#cb18-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; myabs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb18-33&#34;&gt;&lt;a href=&#34;#cb18-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-34&#34;&gt;&lt;a href=&#34;#cb18-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x &amp;gt;= &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; ? x : -x;&lt;/span&gt;
&lt;span id=&#34;cb18-35&#34;&gt;&lt;a href=&#34;#cb18-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-36&#34;&gt;&lt;a href=&#34;#cb18-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-37&#34;&gt;&lt;a href=&#34;#cb18-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], tag[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], d[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-38&#34;&gt;&lt;a href=&#34;#cb18-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-39&#34;&gt;&lt;a href=&#34;#cb18-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define L &lt;/span&gt;(k&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb18-40&#34;&gt;&lt;a href=&#34;#cb18-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define R &lt;/span&gt;(L&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;|&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb18-41&#34;&gt;&lt;a href=&#34;#cb18-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define M &lt;/span&gt;((i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;+&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;j)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb18-42&#34;&gt;&lt;a href=&#34;#cb18-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-43&#34;&gt;&lt;a href=&#34;#cb18-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; build(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k)&lt;/span&gt;
&lt;span id=&#34;cb18-44&#34;&gt;&lt;a href=&#34;#cb18-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-45&#34;&gt;&lt;a href=&#34;#cb18-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i == j)&lt;/span&gt;
&lt;span id=&#34;cb18-46&#34;&gt;&lt;a href=&#34;#cb18-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt;(f[k] = i);&lt;/span&gt;
&lt;span id=&#34;cb18-47&#34;&gt;&lt;a href=&#34;#cb18-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    build(i, M, L);&lt;/span&gt;
&lt;span id=&#34;cb18-48&#34;&gt;&lt;a href=&#34;#cb18-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    build(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R);&lt;/span&gt;
&lt;span id=&#34;cb18-49&#34;&gt;&lt;a href=&#34;#cb18-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[k] = f[L] + f[R];&lt;/span&gt;
&lt;span id=&#34;cb18-50&#34;&gt;&lt;a href=&#34;#cb18-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-51&#34;&gt;&lt;a href=&#34;#cb18-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-52&#34;&gt;&lt;a href=&#34;#cb18-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-53&#34;&gt;&lt;a href=&#34;#cb18-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; pushdown(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k)&lt;/span&gt;
&lt;span id=&#34;cb18-54&#34;&gt;&lt;a href=&#34;#cb18-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-55&#34;&gt;&lt;a href=&#34;#cb18-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    tag[L] += tag[k], tag[R] += tag[k];&lt;/span&gt;
&lt;span id=&#34;cb18-56&#34;&gt;&lt;a href=&#34;#cb18-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[L] += (M - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * tag[k];&lt;/span&gt;
&lt;span id=&#34;cb18-57&#34;&gt;&lt;a href=&#34;#cb18-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[R] += (j - M) * tag[k];&lt;/span&gt;
&lt;span id=&#34;cb18-58&#34;&gt;&lt;a href=&#34;#cb18-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    tag[k] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-59&#34;&gt;&lt;a href=&#34;#cb18-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-60&#34;&gt;&lt;a href=&#34;#cb18-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-61&#34;&gt;&lt;a href=&#34;#cb18-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-62&#34;&gt;&lt;a href=&#34;#cb18-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; modify(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; d)&lt;/span&gt;
&lt;span id=&#34;cb18-63&#34;&gt;&lt;a href=&#34;#cb18-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-64&#34;&gt;&lt;a href=&#34;#cb18-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;gt; y) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-65&#34;&gt;&lt;a href=&#34;#cb18-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;gt;= x &amp;amp;&amp;amp; j &amp;lt;= y)&lt;/span&gt;
&lt;span id=&#34;cb18-66&#34;&gt;&lt;a href=&#34;#cb18-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb18-67&#34;&gt;&lt;a href=&#34;#cb18-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[k] += d * (j - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-68&#34;&gt;&lt;a href=&#34;#cb18-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tag[k] += d;&lt;/span&gt;
&lt;span id=&#34;cb18-69&#34;&gt;&lt;a href=&#34;#cb18-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-70&#34;&gt;&lt;a href=&#34;#cb18-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-71&#34;&gt;&lt;a href=&#34;#cb18-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pushdown(i, j, k);&lt;/span&gt;
&lt;span id=&#34;cb18-72&#34;&gt;&lt;a href=&#34;#cb18-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= M) modify(i, M, L, x, y, d);&lt;/span&gt;
&lt;span id=&#34;cb18-73&#34;&gt;&lt;a href=&#34;#cb18-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (y &amp;gt; M) modify(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R, x, y, d);&lt;/span&gt;
&lt;span id=&#34;cb18-74&#34;&gt;&lt;a href=&#34;#cb18-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[k] = f[L] + f[R];&lt;/span&gt;
&lt;span id=&#34;cb18-75&#34;&gt;&lt;a href=&#34;#cb18-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-76&#34;&gt;&lt;a href=&#34;#cb18-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-77&#34;&gt;&lt;a href=&#34;#cb18-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-78&#34;&gt;&lt;a href=&#34;#cb18-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb18-79&#34;&gt;&lt;a href=&#34;#cb18-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-80&#34;&gt;&lt;a href=&#34;#cb18-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i == j) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[k];&lt;/span&gt;
&lt;span id=&#34;cb18-81&#34;&gt;&lt;a href=&#34;#cb18-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pushdown(i, j, k);&lt;/span&gt;
&lt;span id=&#34;cb18-82&#34;&gt;&lt;a href=&#34;#cb18-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= M) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; query(i, M, L, x);&lt;/span&gt;
&lt;span id=&#34;cb18-83&#34;&gt;&lt;a href=&#34;#cb18-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; query(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R, x);&lt;/span&gt;
&lt;span id=&#34;cb18-84&#34;&gt;&lt;a href=&#34;#cb18-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-85&#34;&gt;&lt;a href=&#34;#cb18-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-86&#34;&gt;&lt;a href=&#34;#cb18-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;signed&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb18-87&#34;&gt;&lt;a href=&#34;#cb18-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-88&#34;&gt;&lt;a href=&#34;#cb18-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = read();&lt;/span&gt;
&lt;span id=&#34;cb18-89&#34;&gt;&lt;a href=&#34;#cb18-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i] = read(), ai[i].val = a[i] + i, ai[i].id = i;&lt;/span&gt;
&lt;span id=&#34;cb18-90&#34;&gt;&lt;a href=&#34;#cb18-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) b[i] = read(), bi[i].val = b[i] + i, bi[i].id = i;&lt;/span&gt;
&lt;span id=&#34;cb18-91&#34;&gt;&lt;a href=&#34;#cb18-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;sort(ai + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, ai + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-92&#34;&gt;&lt;a href=&#34;#cb18-92&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;sort(bi + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, bi + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-93&#34;&gt;&lt;a href=&#34;#cb18-93&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb18-94&#34;&gt;&lt;a href=&#34;#cb18-94&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ai[i].val != bi[i].val) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;-1&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-95&#34;&gt;&lt;a href=&#34;#cb18-95&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; d[bi[i].id] = ai[i].id;&lt;/span&gt;
&lt;span id=&#34;cb18-96&#34;&gt;&lt;a href=&#34;#cb18-96&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    build(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-97&#34;&gt;&lt;a href=&#34;#cb18-97&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-98&#34;&gt;&lt;a href=&#34;#cb18-98&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb18-99&#34;&gt;&lt;a href=&#34;#cb18-99&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb18-100&#34;&gt;&lt;a href=&#34;#cb18-100&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += abs(query(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d[i]) - i);&lt;/span&gt;
&lt;span id=&#34;cb18-101&#34;&gt;&lt;a href=&#34;#cb18-101&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        modify(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d[i], &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-102&#34;&gt;&lt;a href=&#34;#cb18-102&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-103&#34;&gt;&lt;a href=&#34;#cb18-103&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb18-104&#34;&gt;&lt;a href=&#34;#cb18-104&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-105&#34;&gt;&lt;a href=&#34;#cb18-105&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc120d---bracket-score-2&#34;&gt;ARC120D - Bracket Score 2&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2N\)&lt;/span&gt; çš„æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œä¾ç…§å…¶æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2N\)&lt;/span&gt; çš„åˆæ³•æ‹¬å·åºåˆ—ï¼Œä½¿å¾—å…¶åˆ†æ•°æœ€å¤§ï¼Œåˆ†æ•°çš„è®¡ç®—æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸€å¯¹åŒ¹é…çš„æ‹¬å· &lt;span class=&#34;math inline&#34;&gt;\(S_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_j\)&lt;/span&gt;ï¼Œå…¶è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(|A_j - A_i|\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;å°†æ¯ä¸€å¯¹åŒ¹é…çš„æ‹¬å·çš„åˆ†æ•°åŠ èµ·æ¥å¾—åˆ°æ€»åˆ†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çœ¼å‰ä¸€äº®çš„æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°ï¼Œè®©å¤§çš„å°½é‡å¤§ï¼Œå°çš„å°½é‡å°å°±å¯ä»¥ä½¿å¾—æ€»åˆ†æœ€å¤§ã€‚å› æ­¤é€‰å‡ºæœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œæ ‡è®°ä¸ºé»‘è‰²ï¼Œå‰©ä½™çš„æ ‡è®°ä¸ºç™½è‰²ã€‚ç„¶åæ ¹æ®ä¸€é»‘ä¸€ç™½é…å¯¹çš„åŸåˆ™ç›´æ¥æ„é€ æ‹¬å·åºåˆ—å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc123&#34;&gt;ARC123&lt;/h3&gt;
&lt;p&gt;A + B + C&lt;/p&gt;
&lt;h4 id=&#34;arc123b---increasing-triples&#34;&gt;ARC123&lt;strong&gt;B - Increasing Triples&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(10^5\)&lt;/span&gt; çº§åˆ«çš„åºåˆ—ï¼Œå¯ä»¥ä»»æ„æ’åˆ—ï¼Œé—®æœ€å¤šèƒ½æœ‰å¤šå°‘ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(A_i &amp;lt; B_i &amp;lt; C_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨å †å®ç°çš„è´ªå¿ƒã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc123c---1-2-3---decomposition&#34;&gt;ARC123C - 1, 2, 3 - Decomposition&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œéœ€è¦æ±‚å‡ºæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½¿å¾—å­˜åœ¨é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{A_i\}\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\sum A_i = n\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„æ¯ä¸ªæ•°ä½éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1000\)&lt;/span&gt;ï¼‰ç»„æ•°æ®ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^{18}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ•°ä½ dpã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb19&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb19-1&#34;&gt;&lt;a href=&#34;#cb19-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; solve() {&lt;/span&gt;
&lt;span id=&#34;cb19-2&#34;&gt;&lt;a href=&#34;#cb19-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[&lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb19-3&#34;&gt;&lt;a href=&#34;#cb19-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(f, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; f);&lt;/span&gt;
&lt;span id=&#34;cb19-4&#34;&gt;&lt;a href=&#34;#cb19-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-5&#34;&gt;&lt;a href=&#34;#cb19-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = strlen(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb19-6&#34;&gt;&lt;a href=&#34;#cb19-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-7&#34;&gt;&lt;a href=&#34;#cb19-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-8&#34;&gt;&lt;a href=&#34;#cb19-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-9&#34;&gt;&lt;a href=&#34;#cb19-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[i][j][k]) {&lt;/span&gt;
&lt;span id=&#34;cb19-10&#34;&gt;&lt;a href=&#34;#cb19-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    FOR(l, max((j + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, k), min(j, a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb19-11&#34;&gt;&lt;a href=&#34;#cb19-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                        f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;][l] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-12&#34;&gt;&lt;a href=&#34;#cb19-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    FOR(l, max((j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, k), min(j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb19-13&#34;&gt;&lt;a href=&#34;#cb19-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                        f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;][l] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-14&#34;&gt;&lt;a href=&#34;#cb19-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb19-15&#34;&gt;&lt;a href=&#34;#cb19-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb19-16&#34;&gt;&lt;a href=&#34;#cb19-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb19-17&#34;&gt;&lt;a href=&#34;#cb19-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb19-18&#34;&gt;&lt;a href=&#34;#cb19-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-19&#34;&gt;&lt;a href=&#34;#cb19-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb19-20&#34;&gt;&lt;a href=&#34;#cb19-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb19-21&#34;&gt;&lt;a href=&#34;#cb19-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[n][i][j])&lt;/span&gt;
&lt;span id=&#34;cb19-22&#34;&gt;&lt;a href=&#34;#cb19-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans = min(ans, max((i + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, j));&lt;/span&gt;
&lt;span id=&#34;cb19-23&#34;&gt;&lt;a href=&#34;#cb19-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb19-24&#34;&gt;&lt;a href=&#34;#cb19-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc124&#34;&gt;ARC124&lt;/h3&gt;
&lt;p&gt;çŠ¶æ€å¾ˆå·® A + B&lt;/p&gt;
&lt;h3 id=&#34;arc125&#34;&gt;ARC125&lt;/h3&gt;
&lt;p&gt;A + B + C&lt;/p&gt;
&lt;h4 id=&#34;arc125a---dial-up&#34;&gt;ARC125A - Dial Up&lt;/h4&gt;
&lt;p&gt;ç›´æ¥è´ªå¿ƒå³å¯ï¼Œç»†èŠ‚ç•¥å¤šã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc125b---squares&#34;&gt;ARC125B - Squares&lt;/h4&gt;
&lt;p&gt;æ±‚æœ‰åºæ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; å…¶ä¸­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le x, y\le n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^{12}\)&lt;/span&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(x^2 - y\)&lt;/span&gt; ä¸ºå®Œå…¨å¹³æ–¹æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çš„æ•°é‡æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x^2 - y = z^2\)&lt;/span&gt;ï¼Œç„¶åå¹³æ–¹å·®æ€¼è¿‡å»å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((x + z)(x - z) = y\)&lt;/span&gt;ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x + z = p\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x - z = q\)&lt;/span&gt;ã€‚åˆ™é—®é¢˜åŒ–ä¸ºæ±‚ &lt;span class=&#34;math inline&#34;&gt;\((p, q)\)&lt;/span&gt; çš„æ•°é‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(p\ge q\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(x = \dfrac{p + q}{2}\)&lt;/span&gt; ä¸ºæ•´æ•°ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le x = \dfrac{p + q}{2}\le n\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1 \le y = pq\le n\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt; æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt;ï¼Œç„¶å &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¦æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(q\le p\le n\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(p\equiv q\pmod 2\)&lt;/span&gt;ã€‚è¿™ä¸ªä¸œè¥¿å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; ç®—ã€‚äºæ˜¯æ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc125c---lis-to-original-sequence&#34;&gt;ARC125C - LIS to Original Sequence&lt;/h4&gt;
&lt;p&gt;æ„é€ é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå•è°ƒå¢æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(\{a_1, \cdots, a_k\}\)&lt;/span&gt;ï¼Œæ„é€ å­—å…¸åºæœ€å°çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{p_1, \cdots, p_n\}\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\{p_i\}\)&lt;/span&gt; çš„ LIS ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å­é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k = 1\)&lt;/span&gt; æ—¶ï¼Œç­”æ¡ˆæ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\{n, n - 1, n - 2, \cdots, 1\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k \ge 2\)&lt;/span&gt; æ—¶ï¼Œè€ƒè™‘åˆ° LIS çš„æ€§è´¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_1 = a_1\)&lt;/span&gt;ï¼Œç„¶åå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(p_1\not= 1\)&lt;/span&gt;ï¼Œä¸ºäº†ä½¿å¾—å­—å…¸åºæœ€å°ä¸”ä¸ç ´åæœ€é•¿ LIS çš„æ€§è´¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_2 = 1\)&lt;/span&gt;ã€‚ç„¶åå°±å¯ä»¥ä¾æ¬¡ç±»æ¨ä¸‹å»æ¨å¯¼ã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºæ˜¯ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(1\le i\le k - 1\)&lt;/span&gt;ï¼Œå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_{i + 1}\)&lt;/span&gt; ä¸­æ’å…¥è‡³å¤šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(x &amp;lt; a_i\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(x &amp;lt; a_{i + 1}\)&lt;/span&gt;ã€‚æœ€åçš„æ‰€æœ‰å…ƒç´ é™åºæ’åˆ—å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc125d---unique-subsequence&#34;&gt;ARC125D - Unique Subsequence&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{a_1, \cdots, a_n\}\)&lt;/span&gt;ï¼Œé—®å‡ºç°æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å­åºåˆ—çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(a_0 = 0\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_{n + 1} = n + 1\)&lt;/span&gt;ï¼Œç„¶åè®¾è®¡ä¸€ä¸ª dp çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(\{a_0, \cdots, a_i\}\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å¼ºåˆ¶é€‰çš„ç­”æ¡ˆï¼Œåˆ™æœ€ç»ˆç­”æ¡ˆä¸ºæ‰€æœ‰æ•°å­—æœ€åå‡ºç°ä½ç½®çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æˆ‘ä»¬ä¸€å®šä¸èƒ½è®© &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸Šä¸€ä¸ªå‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(lst_i\)&lt;/span&gt; å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; äº§ç”Ÿè´¡çŒ®ï¼Œå¦åˆ™é€‰å–å­åºåˆ—çš„æ–¹å¼å°±ä¸å”¯ä¸€äº†ã€‚ç„¶åä¸€å®šè¦ä¿è¯æ˜¯æœ€åä¸€ä¸ªå‡ºç°çš„æ•°äº§ç”Ÿè´¡çŒ®ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ª BIT ç»´æŠ¤å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb20&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb20-1&#34;&gt;&lt;a href=&#34;#cb20-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb20-2&#34;&gt;&lt;a href=&#34;#cb20-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb20-3&#34;&gt;&lt;a href=&#34;#cb20-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb20-4&#34;&gt;&lt;a href=&#34;#cb20-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb20-5&#34;&gt;&lt;a href=&#34;#cb20-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        last[i] = now[a[i]];&lt;/span&gt;
&lt;span id=&#34;cb20-6&#34;&gt;&lt;a href=&#34;#cb20-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        now[a[i]] = i;&lt;/span&gt;
&lt;span id=&#34;cb20-7&#34;&gt;&lt;a href=&#34;#cb20-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb20-8&#34;&gt;&lt;a href=&#34;#cb20-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    add(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb20-9&#34;&gt;&lt;a href=&#34;#cb20-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb20-10&#34;&gt;&lt;a href=&#34;#cb20-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = sum(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - sum(last[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb20-11&#34;&gt;&lt;a href=&#34;#cb20-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        add(last[i], -f[last[i]]);&lt;/span&gt;
&lt;span id=&#34;cb20-12&#34;&gt;&lt;a href=&#34;#cb20-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        add(i, f[i]);&lt;/span&gt;
&lt;span id=&#34;cb20-13&#34;&gt;&lt;a href=&#34;#cb20-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb20-14&#34;&gt;&lt;a href=&#34;#cb20-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-15&#34;&gt;&lt;a href=&#34;#cb20-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb20-16&#34;&gt;&lt;a href=&#34;#cb20-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now[i])&lt;/span&gt;
&lt;span id=&#34;cb20-17&#34;&gt;&lt;a href=&#34;#cb20-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans += f[now[i]];&lt;/span&gt;
&lt;span id=&#34;cb20-18&#34;&gt;&lt;a href=&#34;#cb20-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb20-19&#34;&gt;&lt;a href=&#34;#cb20-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-20&#34;&gt;&lt;a href=&#34;#cb20-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc126&#34;&gt;ARC126&lt;/h3&gt;
&lt;p&gt;çŠ¶æ€å·®ã€‚A + Bã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc126c---maximize-gcd&#34;&gt;ARC126C - Maximize GCD&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\((A_1, \cdots, A_n)\)&lt;/span&gt;ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(A_i\gets A_i + 1\)&lt;/span&gt;ï¼Œé—®æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ“ä½œä¹‹åèƒ½è¾¾åˆ°çš„æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(\gcd_i\{A_i\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le A_i, n\le 3\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 10^{18}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä» &lt;span class=&#34;math inline&#34;&gt;\([1, A_{\max}]\)&lt;/span&gt; å…ˆæšä¸¾è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\gcd\{A_i\}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯è®¡ç®—å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; è¦è¿›è¡Œå¤šå°‘æ¬¡æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è®¾å½“å‰è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\((k - 1)x &amp;lt; A_i \le kx\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œè¿™ä¸ªä»£ä»·æ˜¯å¾ˆå¥½ç®—çš„ï¼Œéšä¾¿å‰ç¼€å’Œä¼˜åŒ–ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚æ‰€ä»¥å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œè®¡ç®—å…¶æ“ä½œæ¬¡æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(A_{\max} / x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåˆ°äº†æœ€åæ¯ä¸ªæ•°éƒ½å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(A_{\max}\)&lt;/span&gt; äº†ï¼Œè¿˜æœ‰å‰©ä½™çš„æ“ä½œæ¬¡æ•°ï¼Œåˆ™è€ƒè™‘ç»§ç»­å¾€ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(\lfloor k / n\rfloor\)&lt;/span&gt; ä¸ªã€‚æ€»æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n + A_{\max}\ln A_{\max})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc128&#34;&gt;ARC128&lt;/h3&gt;
&lt;p&gt;A + B + Cï¼Œrk 340ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc128c---max-dot&#34;&gt;ARC128C - Max Dot&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\text{maximize } \sum_{i = 1}^nA_ix_i\\
\text{s.t. } \begin{cases}
0\le x_1\le x_2\\
0\le x_2\le x_3\\
\cdots\\
0\le x_n\le m\\
x_1 + x_2 + \cdots x_n = S
\end{cases}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘çº¿æ€§è§„åˆ’çš„è§£ä¸€å®šåœ¨å¯è¡ŒåŸŸçš„ç«¯ç‚¹å¤„å–åˆ°ã€‚æ‰€ä»¥å‰å‡ ä¸ªå– &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œåå‡ ä¸ªå– &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼Œä¸­é—´å‡ ä¸ªå–å¹³å‡æ•°ã€‚æšä¸¾å‰åç¼€ç«¯ç‚¹å³å¯ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc131&#34;&gt;ARC131&lt;/h3&gt;
&lt;p&gt;A + B + C + Eï¼Œrk220ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc131b---grid-repainting-4&#34;&gt;ARC131B - Grid Repainting 4&lt;/h4&gt;
&lt;p&gt;ç”±å››è‰²å®šç†çŸ¥ç›´æ¥æ„é€ å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc131c---zero-xor&#34;&gt;ARC131C - Zero XOR&lt;/h4&gt;
&lt;p&gt;ç‰›é€¼é¢˜ã€‚ç»™å®šä¸€æ•°é›†ï¼Œä¸¤äººåšå¼ˆï¼Œä¸€æ­¥å¯ä»¥åˆ é™¤ä¸€ä¸ªæ•°å­—ã€‚åˆ åˆ°å‰©ä¸‹æ•°é›†çš„å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ—¶è·èƒœã€‚ä¸¤äººéƒ½æœ€ä¼˜æ–¹æ¡ˆï¼Œé—®å…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºï¼šæ‰€æœ‰æ•°å­—å¼‚æˆ–å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(\in S\)&lt;/span&gt;ï¼Œåˆ™å…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n \equiv 1\pmod 2\)&lt;/span&gt;ï¼Œå…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™åæ‰‹å¿…èƒœã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(x\in S\)&lt;/span&gt; çš„æƒ…å†µéå¸¸å¥½ç†è§£ï¼Œå…ˆæ‰‹åªéœ€è¦å–å‡º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ï¼Œæ¸¸æˆå°†åœ¨ä¸¤äººå–å®Œæ‰€æœ‰æ•°å­—ä¹‹åç»“æŸã€‚æœ€åä¸€ä¸ªå–çš„äººå°†ä¸ºèµ¢å®¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc131e---christmas-wreath&#34;&gt;ARC131E - Christmas Wreath&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®Œå…¨å›¾çš„è¾¹æŸ“è‰² &lt;span class=&#34;math inline&#34;&gt;\((R,B,W)\)&lt;/span&gt;ï¼Œè¦æ±‚ä¸‰ç§é¢œè‰²å‡ºç°çš„é¢‘ç‡ç›¸ç­‰ï¼Œä¸”ä»»æ„ä¸€ä¸ªä¸‰å…ƒç¯ä¸èƒ½å‡ºç°ä¸‰è¾¹é¢œè‰²ä¸ä¸€æ ·ï¼Œæ±‚æ„é€ æ–¹æ¡ˆæˆ–è¾“å‡ºæ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘é‚»æ¥çŸ©é˜µï¼Œå‘ç°æ¯ä¸€è¡Œé¢œè‰²ç›¸åŒå°±èƒ½æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªæ¡ä»¶å°±éšä¾¿æ„é€ å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc132&#34;&gt;ARC132&lt;/h3&gt;
&lt;h4 id=&#34;arc132a---permutation-grid&#34;&gt;ARC132A - Permutation Grid&lt;/h4&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„æ€è·¯ã€‚è€ƒè™‘åˆå§‹æ„é€ å‡ºä¸€ä¸ªçŠ¶æ€ç„¶åæ ¹æ®æ’åˆ—å˜æ¢ã€‚ç»“è®ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(R_x +C_y\ge n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc132b---shift-and-reverse&#34;&gt;ARC132B - Shift and Reverse&lt;/h4&gt;
&lt;p&gt;å¯ä»¥æ³¨æ„åˆ°ç¿»è½¬æ“ä½œè‡³å¤šè¿›è¡Œä¸¤æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥åˆ†ç±»è®¨è®ºç„¶ååšåšå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc132c---almost-sorted&#34;&gt;ARC132C - Almost Sorted&lt;/h4&gt;
&lt;p&gt;æ¯”è¾ƒå¥½çš„çŠ¶å‹é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i\in\{-1, 1, 2, 3,\cdots, n\}\)&lt;/span&gt;ï¼Œå’Œä¸€ä¸ªæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ã€‚é—®æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; çš„ä¸ªæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(p_1,\cdots,p_n\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1,n]\)&lt;/span&gt; æ’åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(a_i\ne -1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(p_i = a_i\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(|p_i - i|\le d\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le d\le 5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d &amp;lt; n\le 500\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_i\in[i - d, i + d]\)&lt;/span&gt;ï¼Œå€¼åŸŸåŒºé—´é•¿åº¦æœ€å¤§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(11\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘çŠ¶å‹èµ·æ¥ã€‚æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, S}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\([i - d, i + d]\)&lt;/span&gt; çš„å€¼åŸŸåŒºé—´çš„å ç”¨æƒ…å†µä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè½¬ç§»äº†ï¼Œæ¯æ¬¡å°±æšä¸¾ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ ¼å¡«çš„æ•°ï¼Œç»†èŠ‚æ¯”è¾ƒå¤šï¼Œå‚è§å¦‚ä¸‹ä»£ç ã€‚æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(4^ddn)\)&lt;/span&gt;ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb21&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb21-1&#34;&gt;&lt;a href=&#34;#cb21-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;505&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-2&#34;&gt;&lt;a href=&#34;#cb21-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n, d, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb21-3&#34;&gt;&lt;a href=&#34;#cb21-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[maxn][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;12&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb21-4&#34;&gt;&lt;a href=&#34;#cb21-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-5&#34;&gt;&lt;a href=&#34;#cb21-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; getfirst() {&lt;/span&gt;
&lt;span id=&#34;cb21-6&#34;&gt;&lt;a href=&#34;#cb21-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-7&#34;&gt;&lt;a href=&#34;#cb21-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d) {&lt;/span&gt;
&lt;span id=&#34;cb21-8&#34;&gt;&lt;a href=&#34;#cb21-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans |= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i + d)) * vis[i];&lt;/span&gt;
&lt;span id=&#34;cb21-9&#34;&gt;&lt;a href=&#34;#cb21-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-10&#34;&gt;&lt;a href=&#34;#cb21-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb21-11&#34;&gt;&lt;a href=&#34;#cb21-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb21-12&#34;&gt;&lt;a href=&#34;#cb21-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-13&#34;&gt;&lt;a href=&#34;#cb21-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb21-14&#34;&gt;&lt;a href=&#34;#cb21-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, d);&lt;/span&gt;
&lt;span id=&#34;cb21-15&#34;&gt;&lt;a href=&#34;#cb21-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb21-16&#34;&gt;&lt;a href=&#34;#cb21-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[i] == j) vis[j] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-17&#34;&gt;&lt;a href=&#34;#cb21-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][getfirst()] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-18&#34;&gt;&lt;a href=&#34;#cb21-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb21-19&#34;&gt;&lt;a href=&#34;#cb21-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(S, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * d + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb21-20&#34;&gt;&lt;a href=&#34;#cb21-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = (S &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | (vis[i + d] &amp;lt;&amp;lt; (&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * d));&lt;/span&gt;
&lt;span id=&#34;cb21-21&#34;&gt;&lt;a href=&#34;#cb21-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (~a[i]) f[i][now] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S];&lt;/span&gt;
&lt;span id=&#34;cb21-22&#34;&gt;&lt;a href=&#34;#cb21-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; FOR(j, -d, d) {&lt;/span&gt;
&lt;span id=&#34;cb21-23&#34;&gt;&lt;a href=&#34;#cb21-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i + j &amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; || i + j &amp;gt; n || now &amp;amp; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j + d))) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-24&#34;&gt;&lt;a href=&#34;#cb21-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[i][now | (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j + d))] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S];&lt;/span&gt;
&lt;span id=&#34;cb21-25&#34;&gt;&lt;a href=&#34;#cb21-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb21-26&#34;&gt;&lt;a href=&#34;#cb21-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb21-27&#34;&gt;&lt;a href=&#34;#cb21-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-28&#34;&gt;&lt;a href=&#34;#cb21-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[n][(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (d + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb21-29&#34;&gt;&lt;a href=&#34;#cb21-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-30&#34;&gt;&lt;a href=&#34;#cb21-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc132d---between-two-binary-strings&#34;&gt;ARC132D - Between Two Binary Strings&lt;/h4&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(S_{n,m}\)&lt;/span&gt; ä¸ºæ‰€æœ‰çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n+ m\)&lt;/span&gt;ï¼Œä¸”åŒ…å«æ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ª &lt;code&gt;0&lt;/code&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª &lt;code&gt;1&lt;/code&gt; çš„å­—ç¬¦ä¸²çš„é›†åˆã€‚å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¾ä¸½ç¨‹åº¦ä¸ºç›¸é‚»ä¸¤ä½ç›¸åŒçš„ä¸ªæ•°ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(S_1\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(S_2\)&lt;/span&gt; çš„ç¼–è¾‘è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(d_{S_1, S_2}\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\(S_1\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(S_2\)&lt;/span&gt; çš„æ“ä½œæ¬¡æ•°ï¼Œå…¶ä¸­æ¯æ¬¡æ“ä½œèƒ½äº¤æ¢ç›¸é‚»çš„ä¸¤ä¸ªå­—ç¬¦ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(S_1, S_2\in S_{n,m}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(S_2\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S_1\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(S_3\)&lt;/span&gt; é—´å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(d_{S_1, S_3} = d_{S_1, S_2} + d_{S_2, S_3}\)&lt;/span&gt;ã€‚ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œé—®åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; é—´çš„å­—ç¬¦ä¸²çš„æœ€å¤§ç¾ä¸½ç¨‹åº¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜æ˜¯ä¸€é“æ¯”è¾ƒå¦™çš„ç»“è®ºé¢˜ï¼šå½“ç¡®å®šç¬¬ä¸€ä¸ªå­—æ¯æ—¶ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²å¯ä»¥è´ªå¿ƒçš„è¿›è¡Œæ„é€ ï¼Œåªéœ€ä¿è¯&lt;strong&gt;å‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªé‡Œé¢ &lt;code&gt;1&lt;/code&gt; çš„ä¸ªæ•°å¤„äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ä¸­é—´&lt;/strong&gt;ã€‚ç„¶åæˆ‘ä»¬åˆè¦æœ€å¤§åŒ–ç¾ä¸½å€¼ï¼Œä¾æ­¤æ„é€ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¯æ˜ï¼šè€ƒè™‘ä¸€ä¸ªå­—ç¬¦ä¸²å°±æ˜¯äºŒç»´å¹³é¢ä¸Šä¸€æ¡ä» &lt;span class=&#34;math inline&#34;&gt;\((0, 0)\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\((n, m)\)&lt;/span&gt; çš„è·¯å¾„ã€‚æŸä¸€ä½æ˜¯ &lt;code&gt;1&lt;/code&gt; è¡¨ç¤ºå‘ä¸Šèµ°ä¸€æ ¼ï¼ŒæŸä¸€ä½æ˜¯ &lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºå‘å³èµ°ä¸€æ ¼ã€‚åŒæ—¶ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¾ä¸½å€¼å°±æ˜¯é•¿åº¦å‡ä¸€å†å‡æ‹ç‚¹ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬å‘ç°ï¼Œäº¤æ¢ä¸¤ä¸ªç›¸é‚»çš„ &lt;code&gt;01&lt;/code&gt; ç›¸å½“äºæ˜¯å°†ä¸€ä¸ªæ‹ç‚¹ç¿»æŠ˜ï¼Œæ•…åœ¨å¹³é¢ä¸Šå¤„äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä¸­é—´çš„è·¯å¾„éƒ½æ˜¯å¯è¡Œçš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å…¶å®å°±æ˜¯ï¼Œèƒ½ä¸æ‹å°±ä¸æ‹ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb22&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb22-1&#34;&gt;&lt;a href=&#34;#cb22-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-2&#34;&gt;&lt;a href=&#34;#cb22-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn], t[maxn];&lt;/span&gt;
&lt;span id=&#34;cb22-3&#34;&gt;&lt;a href=&#34;#cb22-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb22-4&#34;&gt;&lt;a href=&#34;#cb22-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-5&#34;&gt;&lt;a href=&#34;#cb22-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb22-6&#34;&gt;&lt;a href=&#34;#cb22-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb22-7&#34;&gt;&lt;a href=&#34;#cb22-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), read(t + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-8&#34;&gt;&lt;a href=&#34;#cb22-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, len = n + m;&lt;/span&gt;
&lt;span id=&#34;cb22-9&#34;&gt;&lt;a href=&#34;#cb22-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(init, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-10&#34;&gt;&lt;a href=&#34;#cb22-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s0 = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, t0 = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, x0 = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-11&#34;&gt;&lt;a href=&#34;#cb22-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (init != s[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &amp;amp;&amp;amp; init != t[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-12&#34;&gt;&lt;a href=&#34;#cb22-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-13&#34;&gt;&lt;a href=&#34;#cb22-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = init;&lt;/span&gt;
&lt;span id=&#34;cb22-14&#34;&gt;&lt;a href=&#34;#cb22-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, len) {&lt;/span&gt;
&lt;span id=&#34;cb22-15&#34;&gt;&lt;a href=&#34;#cb22-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            s0 += (s[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;), t0 += (t[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-16&#34;&gt;&lt;a href=&#34;#cb22-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-17&#34;&gt;&lt;a href=&#34;#cb22-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x0 + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;= max(s0, t0)) ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb22-18&#34;&gt;&lt;a href=&#34;#cb22-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; now = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-19&#34;&gt;&lt;a href=&#34;#cb22-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb22-20&#34;&gt;&lt;a href=&#34;#cb22-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x0 &amp;gt;= min(s0, t0)) ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb22-21&#34;&gt;&lt;a href=&#34;#cb22-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; now = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-22&#34;&gt;&lt;a href=&#34;#cb22-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb22-23&#34;&gt;&lt;a href=&#34;#cb22-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ++x0;&lt;/span&gt;
&lt;span id=&#34;cb22-24&#34;&gt;&lt;a href=&#34;#cb22-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb22-25&#34;&gt;&lt;a href=&#34;#cb22-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        chkmax(ans, cnt - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-26&#34;&gt;&lt;a href=&#34;#cb22-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb22-27&#34;&gt;&lt;a href=&#34;#cb22-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb22-28&#34;&gt;&lt;a href=&#34;#cb22-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-29&#34;&gt;&lt;a href=&#34;#cb22-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc134&#34;&gt;ARC134&lt;/h3&gt;
&lt;h4 id=&#34;arc134c---the-majority&#34;&gt;ARC134C - The Majority&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·ç›’å­ï¼Œåˆå§‹å…¨ä¸ºç©ºã€‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ç§é¢œè‰²çš„çƒï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§é¢œè‰²æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸ªçƒï¼ŒåŒç§é¢œè‰²çš„çƒä¸åŒºåˆ†ã€‚ç°è¦å°†æ‰€æœ‰çƒæ”¾å…¥ç›’å­é‡Œï¼Œè¦æ±‚æ¯ä¸ªç›’å­é‡Œé¢ï¼Œé¢œè‰² &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„çƒçš„ä¸ªæ•°è¦å åˆ°ä¸€åŠä»¥ä¸Šï¼ˆä¸¥æ ¼ï¼‰ã€‚é—®æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå·§å¦™çš„è®¡æ•°å¥—è·¯ï¼ˆé›¾ï¼‰ï¼Œå³æˆ‘ä»¬è€ƒè™‘å°† &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; é¢œè‰²çš„çƒå’Œå…¶ä»–çš„çƒä¸€ä¸€é…å¯¹ï¼Œå³å°† &lt;span class=&#34;math inline&#34;&gt;\(a_1:=a_1 - \sum_{i = 2}^na_i\)&lt;/span&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\([2, n]\)&lt;/span&gt; é¢œè‰²çš„çƒæ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ªç›’å­é‡Œï¼ˆå¯ä»¥æœ‰ç©ºç›’ï¼‰ï¼Œæ±‚å‡ºæ–¹æ¡ˆæ•°ï¼Œç„¶åå†ä¹˜ä¸Šå°† &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; é¢œè‰²çš„çƒæ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ªç›’å­çš„æ–¹æ¡ˆæ•°ï¼ˆä¸å…è®¸æœ‰ç©ºç›’ï¼‰ï¼Œå³ &lt;span class=&#34;math display&#34;&gt;\[
\binom{a_1 - \sum_{i = 2}^na_i}{K + 1}\prod_{i=2}^n\binom{a_i + K + 1}{K+1}
\]&lt;/span&gt; æ­£ç¡®æ€§æ˜¾ç„¶ï¼Œæ€æƒ³è¾ƒä¸ºé‡è¦ï¼Œmarkedã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc134d---concatenate-subsequences&#34;&gt;ARC134D - Concatenate Subsequences&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2N\)&lt;/span&gt; çš„æ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ã€‚ç°è¦æ„é€  &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä¸€ä¸ªå­åºåˆ—ï¼Œæ–¹æ¡ˆä¸ºï¼šä» &lt;span class=&#34;math inline&#34;&gt;\(1, 2, \cdots, N\)&lt;/span&gt; ä¸­å–å‡ºä¸€ä¸ªå­åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(x_1, \cdots, x_k\)&lt;/span&gt;ï¼Œç„¶åå–å‡º &lt;span class=&#34;math inline&#34;&gt;\(a_{x_1}, a_{x_2},\cdots, a_{x_k}, a_{x_1 + N}, a_{x_2 +N},\cdots, a_{x_k + N}\)&lt;/span&gt;ã€‚è¦æ±‚æ„é€ å‡ºæ¥çš„è¿™ä¸ªåºåˆ—å­—å…¸åºæœ€å°ï¼Œè¾“å‡ºè¿™ä¸ªåºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;å­—å…¸åºé—®é¢˜ä¸€èˆ¬è€ƒè™‘è´ªå¿ƒã€‚æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A = a_1, a_2, \cdots, a_N\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B = a_{N+ 1},\cdots, a_{2N}\)&lt;/span&gt;ï¼Œå– &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­çš„æœ€å°å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åˆ™å¦‚æœå­˜åœ¨ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(A_i = X\land B_i\le A_i\)&lt;/span&gt;ï¼Œåˆ™æŠŠåªæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; å–èµ°å°±ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å‡è®¾å¯¹äºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_i = X\)&lt;/span&gt; éƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A_i&amp;lt;B_i\)&lt;/span&gt;ï¼Œå¯ä»¥è¯æ˜æŠŠä»–ä»¬å…¨éƒ¨å–èµ°æ˜¯æœ€ä¼˜çš„ï¼Œè€Œåå°±éœ€è¦è€ƒè™‘å–å‰©ä¸‹çš„å…ƒç´ äº†ã€‚ä»¤æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A_i = X\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å‡åºæ„æˆåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(y_1,\cdots, y_k\)&lt;/span&gt;ã€‚æ¥ä¸‹æ¥è€ƒè™‘çš„å°±æ˜¯æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(y_k&amp;lt;j\le N\land A_j\le B_{y_1}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°ï¼Œå°†å…¶æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\((A_j, j)\)&lt;/span&gt; å‡åºæ’åºä¹‹åï¼Œæˆ‘ä»¬ä¼šä¼˜å…ˆå–èµ°æ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_j &amp;lt; B_{y_1}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæœ€åå°±æ˜¯è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(A_j = B_{y_1}\)&lt;/span&gt; çš„æƒ…å†µï¼Œè¿™æ—¶å€™å°±éœ€è¦è€ƒè™‘ç¬¬ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(B_{y_m}\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(B_{y_m}\ne B_{y_1}\)&lt;/span&gt;ï¼Œå³å¦‚æœåŠ è¿›å»èƒ½ä½¿å¾—å­—å…¸åºæ›´å°ï¼Œé‚£å°±åŠ ï¼Œå¦åˆ™å°±ä¸è¦åŠ ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯è¿™é¢˜å°±åšå®Œäº†ï¼Œç»†èŠ‚æœ‰ç‚¹çƒ¦ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/arc134/submissions/29161132&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc137&#34;&gt;ARC137&lt;/h3&gt;
&lt;p&gt;A + B + Dï¼Œrk281ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc137a---coprime-pair&#34;&gt;ARC137A - Coprime Pair&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(1\le L &amp;lt; R\le 10^{18}\)&lt;/span&gt;ï¼Œæ±‚ä¸€å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(L\le x\le y\le R\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\gcd(x,y) = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåœ¨é¢˜ç›®çº¦æŸä¸‹ï¼Œç´ æ•°é—´éš”è‡³å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(K= 1500\)&lt;/span&gt; å·¦å³ï¼Œæ‰€ä»¥ç›´æ¥ä» &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; å³è¾¹å’Œ &lt;span class=&#34;math inline&#34;&gt;\(R\)&lt;/span&gt; å·¦è¾¹æš´åŠ›æ‰¾ç­”æ¡ˆå³å¯ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(K^2\log R)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œè¿™ä¸ªä¸œè¥¿ä¼¼ä¹æœ‰æ›´ç´§çš„ç•Œï¼Œä½†æ˜¯ atcoder å®˜æ–¹é¢˜è§£æˆ‘çœ‹ä¸æ‡‚ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc137b---count-1s&#34;&gt;ARC137B - Count 1â€™s&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ª 0-1 ä¸²ï¼Œå¯ä»¥å°†ä¸€ä¸ªå­æ®µç¿»è½¬ä¸€æ¬¡ï¼Œé—®æœ€åèƒ½è¾¾åˆ°å¤šå°‘ç§ä¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯ä»¥è§‚å¯Ÿåˆ°æœ€åè¾¾åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°è‚¯å®šæ˜¯è¿ç»­çš„ä¸€æ®µã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è€ƒè™‘æ±‚å‡º &lt;em&gt;&lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä¸ªæ•°å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°&lt;/em&gt; çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\max + \min + 1\)&lt;/span&gt; å³ä¸ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc137c---distinct-numbers&#34;&gt;ARC137C - Distinct Numbers&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªå…ƒç´ çš„æ•°é›† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä¿è¯å…ƒç´ ä¸¤ä¸¤ä¸åŒã€‚å…ˆæ‰‹åæ‰‹åšå¼ˆï¼Œè½®åˆ°æ¯äººæ“ä½œæ—¶ï¼Œå°†æœ€å¤§çš„æ•°å–å‡ºï¼Œæ¢æˆä¸€ä¸ªæ›´å°çš„éè´Ÿæ•´æ•°å†å¡å›å»ï¼Œéœ€ä¿è¯å…ƒç´ ä¸¤ä¸¤ä¸åŒçš„æ€§è´¨ä¸è¢«ç ´åã€‚ç¬¬ä¸€ä¸ªæ²¡åŠæ³•è¿›è¡Œæ“ä½œçš„ç©å®¶è¾“ã€‚é—®èµ¢å®¶ã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºé¢˜ï¼ˆï¼Ÿï¼‰ã€‚åˆ†ç±»è®¨è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_n - a_{n-1}&amp;gt;1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(a_1, a_2,\cdots, a_{n-1}, a_{n-1} +1\)&lt;/span&gt; çš„å±€é¢ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥å…¶ä¸ºå¿…èƒœæ€ï¼Œé‚£ä¹ˆå…¶å¯ä»¥è½¬ç§»åˆ°ä¸€ä¸ªå¿…è´¥æ€ï¼ŒåŸåºåˆ—ä¹Ÿå¯ä»¥ç›´æ¥è½¬ç§»åˆ°é‚£ä¸ªå¿…è´¥æ€ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥å…¶ä¸ºå¿…è´¥æ€ï¼Œé‚£ä¹ˆåŸåºåˆ—å¯ä»¥ç›´æ¥è½¬ç§»åˆ°ä»–ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ Alice å¿…èƒœã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_n - a_{n-1} = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åŒæ–¹éƒ½è¦å°½å¯èƒ½ç»´æŒè¿™ä¸ªçŠ¶æ€ï¼Œå¦åˆ™å°±å˜æˆå¯¹æ‰‹å¿…èƒœã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æ“ä½œçš„æ—¶å€™ &lt;span class=&#34;math inline&#34;&gt;\(a_{n} - a_{n-1}\)&lt;/span&gt; éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚æ¯æ¬¡æ“ä½œåä¼šå‘ç°åŸæ¥çš„æ¬¡å¤§å€¼å˜æˆäº†æ–°çš„æœ€å¤§å€¼ã€‚åˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\(a_n - n\)&lt;/span&gt; çš„å¥‡å¶æ€§å³å¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb23&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb23-1&#34;&gt;&lt;a href=&#34;#cb23-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-2&#34;&gt;&lt;a href=&#34;#cb23-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n;&lt;/span&gt;
&lt;span id=&#34;cb23-3&#34;&gt;&lt;a href=&#34;#cb23-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb23-4&#34;&gt;&lt;a href=&#34;#cb23-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb23-5&#34;&gt;&lt;a href=&#34;#cb23-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb23-6&#34;&gt;&lt;a href=&#34;#cb23-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb23-7&#34;&gt;&lt;a href=&#34;#cb23-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[n] - a[n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) print(&lt;span class=&#34;st&#34;&gt;&amp;quot;Alice&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-8&#34;&gt;&lt;a href=&#34;#cb23-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((n + a[n] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) print(&lt;span class=&#34;st&#34;&gt;&amp;quot;Alice&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-9&#34;&gt;&lt;a href=&#34;#cb23-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; print(&lt;span class=&#34;st&#34;&gt;&amp;quot;Bob&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-10&#34;&gt;&lt;a href=&#34;#cb23-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-11&#34;&gt;&lt;a href=&#34;#cb23-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc137d---prefix-xors&#34;&gt;ARC137D - Prefix XORs&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šæ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\le 10^6\)&lt;/span&gt;ï¼Œä»¥åŠæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots, m\)&lt;/span&gt;ï¼Œæ±‚å‡ºç»è¿‡ä¸‹é¢æ“ä½œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡ä¹‹å &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(B_i = \displaystyle\bigoplus_{i=1}^i A_i\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(\oplus\)&lt;/span&gt; ä»£è¡¨å¼‚æˆ–ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A = B\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯¹äºä¸€ä¸ªå›ºå®šçš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; è´¡çŒ®äº†å¤šå°‘æ¬¡ï¼Œä¸‹é¢å‡å®š &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä» &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å§‹ç¼–å·ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä½ å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; ä¼šè´¡çŒ® &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{n - i + k - 1}{k - 1}\)&lt;/span&gt; æ¬¡ã€‚ä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬åªéœ€è¦çŸ¥é“ä»–çš„å¥‡å¶æ€§ï¼Œå…¶ä¸ºå¥‡æ•°å°±ä¼šäº§ç”Ÿè´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¢å¡æ–¯å®šç†çš„ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¿›åˆ¶å½¢å¼ï¼Œå‘ç°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(n - i + k - 1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„è¶…é›†æ—¶ï¼ŒLucas çš„å¼å­é‡Œé¢æ‰ä¸ä¼šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; é¡¹ï¼Œæ‰ä¼šäº§ç”Ÿ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{n - i + k - 1}{k - 1}\)&lt;/span&gt; çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ³¨æ„åˆ°ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n - i + k - 1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; çš„è¶…é›†ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(n - i\)&lt;/span&gt; æŒ‰ä½ä¸ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; å¿…ç„¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚é‚£ä¹ˆå°±è€ƒè™‘åšä¸€ä¸ªé«˜ç»´å‰ç¼€å’Œï¼Œç„¶åå¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; æŸ¥è¯¢çš„æ—¶å€™æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; å–è¡¥é›†å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb24&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb24-1&#34;&gt;&lt;a href=&#34;#cb24-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) | &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-2&#34;&gt;&lt;a href=&#34;#cb24-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n, m;&lt;/span&gt;
&lt;span id=&#34;cb24-3&#34;&gt;&lt;a href=&#34;#cb24-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb24-4&#34;&gt;&lt;a href=&#34;#cb24-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb24-5&#34;&gt;&lt;a href=&#34;#cb24-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb24-6&#34;&gt;&lt;a href=&#34;#cb24-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb24-7&#34;&gt;&lt;a href=&#34;#cb24-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    reverse(a, a + n);&lt;/span&gt;
&lt;span id=&#34;cb24-8&#34;&gt;&lt;a href=&#34;#cb24-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;19&lt;/span&gt;) FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;amp; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)) a[i] ^= a[i ^ (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)];&lt;/span&gt;
&lt;span id=&#34;cb24-9&#34;&gt;&lt;a href=&#34;#cb24-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) print(a[(k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ^ ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)], &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb24-10&#34;&gt;&lt;a href=&#34;#cb24-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-11&#34;&gt;&lt;a href=&#34;#cb24-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc137e---bakery&#34;&gt;ARC137E - Bakery&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šè§„åˆ’é¢åŒ…åº—ï¼Œå¤©æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1,2,\cdots, N\)&lt;/span&gt;ã€‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ä¸ªé¢åŒ…å¸ˆï¼Œç¼–å·ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œé›‡ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å¼€æ”¯æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(C_i\)&lt;/span&gt;ï¼Œç„¶åå…¶ä¼šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(L_i,\cdots, R_i\)&lt;/span&gt; æ¯å¤©åšä¸€ä¸ªé¢åŒ…ã€‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©é¢åŒ…å¸ˆä¸€å…±åšäº† &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; ä¸ªé¢åŒ…çš„è¯ï¼Œå”®å‡ºçš„å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\min(A_i,x_i)\)&lt;/span&gt; ä¸ªé¢åŒ…ã€‚æ¯ä¸ªé¢åŒ…è·åˆ© &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt;ï¼Œæ±‚æœ€å¤§åˆ©æ¶¦ï¼ˆå”®å‡ºé¢åŒ…çš„è·åˆ©å‡å»é›‡ä½£é¢åŒ…å¸ˆçš„å¼€æ”¯ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le N,M\le 2000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le D,C_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€çœ¼è€ƒè™‘å»ºè´¹ç”¨æµï¼Œç„¶è€Œç”¨é¢åŒ…æ¥æµä¼¼ä¹ä¸å¥½å¤„ç†é¢åŒ…å¸ˆçš„å¼€æ”¯ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆåªèƒ½æ‹¿é¢åŒ…å¸ˆæ¥æµäº†ï¼Œå¯¹äºé¢åŒ…çš„è´¡çŒ®ï¼Œå°±è€ƒè™‘åœ¨å¤©æ•°ä¹‹é—´æµã€‚å…·ä½“åœ°ï¼šå»ºç«‹å›¾ï¼Œç¼–å·ä» &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(j\to(j - 1)\)&lt;/span&gt;ï¼Œæµé‡ &lt;span class=&#34;math inline&#34;&gt;\(A_j\)&lt;/span&gt;ï¼Œè´¹ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(-D\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†å¤„ç†äº§ç”Ÿè´¡çŒ®çš„é¢åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(j\to (j-1)\)&lt;/span&gt;ï¼Œæµé‡ &lt;span class=&#34;math inline&#34;&gt;\(M - A_j\)&lt;/span&gt;ï¼Œè´¹ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†è¦è®©å‰©ä¸‹äº§ç”Ÿä¸äº†è´¡çŒ®çš„æµè¿‡å»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((L_{i} - 1)\to R_i\)&lt;/span&gt;ï¼Œæµé‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œè´¹ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(C_i\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†å¤„ç†é¢åŒ…å¸ˆçš„è´¹ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šå›¾çš„&lt;strong&gt;æœ€å°è´¹ç”¨å¾ªç¯æµ&lt;/strong&gt;çš„è´¹ç”¨å°±æ˜¯ç­”æ¡ˆã€‚ç„¶è€Œæˆ‘ä»¬ä¸ä¼šç›´çƒåšè´¹ç”¨å¾ªç¯æµï¼Œæ‰€ä»¥è€ƒè™‘ä¸€ä¸‹æ€ä¹ˆè½¬åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œé€‰ä¸€ä¸ªé¢åŒ…å¸ˆç›¸å½“äºé€‰äº†ä¸€ä¸ªç¯ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯ä¼šé€‰&lt;strong&gt;è´Ÿç¯&lt;/strong&gt;ï¼ˆå¦åˆ™ä¸å¦‚ä¸é€‰ï¼‰ã€‚é‚£ä¹ˆå°±å¯¹æ‰€æœ‰çš„è´Ÿæƒè¾¹ &lt;span class=&#34;math inline&#34;&gt;\((u,v,w,c)\)&lt;/span&gt; è¿›è¡Œå¦‚ä¸‹å¤„ç†ï¼šåŠ è¾¹ &lt;span class=&#34;math inline&#34;&gt;\((s, v, w, 0)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((u, t, w, 0)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((v, u, w, -c)\)&lt;/span&gt;ï¼Œç„¶åè´¹ç”¨é¢„å…ˆåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ã€‚å‰©ä¸‹çš„æ­£æƒå’Œ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æƒè¾¹ç…§æ—§ä¸å˜ï¼Œç„¶åè·‘ä¸€ä¸ª&lt;strong&gt;æµé‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; çš„æœ€å°è´¹ç”¨æµ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·åšçš„æ­£ç¡®æ€§æ˜¯ï¼šå…ˆå‡è®¾è´Ÿæƒè¾¹å…¨éƒ¨æµæ»¡ï¼Œç„¶åè‹¥æµäº† &lt;span class=&#34;math inline&#34;&gt;\(s\to v\to u\to t\)&lt;/span&gt; ç›¸å½“äºé€€æ‰åŸæ¥çš„æµã€‚å‰©ä¸‹å°±æ˜¯å’Œæ­£æƒè¾¹è¿ç¯è®¡ç®—äº†ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œåœ¨æœ¬é¢˜é‡Œé¢ï¼Œç”±äºå›¾ç»“æ„çš„ç‰¹æ®Šæ€§ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((s,v,w,0)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((u,t,w,0)\)&lt;/span&gt; æ˜¯æ²¡å¿…è¦åŠ çš„ï¼Œå› ä¸ºå¯¹äºä¸€ä¸ªç‚¹ï¼Œå…¶ä¸€å®šä¼šåŒæ—¶è¿ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œæœ€å°è´¹ç”¨æœ€å¤§æµå‘Šè¯‰æˆ‘ä»¬ä¼šä¼˜å…ˆæµæ»¡ &lt;span class=&#34;math inline&#34;&gt;\(s\to u\to t\)&lt;/span&gt;ï¼Œå¯¹è´¹ç”¨ä¸äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥æˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸¢æ‰è¶…çº§æºæ±‡ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œè¿è¾¹æ–¹å¼å¦‚ä¸‹ï¼šå¯¹æ¯ä¸ªå¤©è¿ &lt;span class=&#34;math inline&#34;&gt;\((j-1,j,A_j,D)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((j-1,j,M - A_j,0)\)&lt;/span&gt;ï¼Œå†å¯¹æ¯ä¸ªé¢åŒ…å¸ˆè¿ &lt;span class=&#34;math inline&#34;&gt;\((L_i - 1, R_i, 1, C_i)\)&lt;/span&gt;ï¼Œè·‘ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æµé‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; çš„æœ€å°è´¹ç”¨æµå³å¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬é¢˜å¡æœ´ç´ çš„ EK + SPFA è´¹ç”¨æµï¼Œæ­£è§£æ˜¯åŸå§‹å¯¹å¶ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(N^2\log N)\)&lt;/span&gt;ï¼Œè§† &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; åŒé˜¶ã€‚å¦‚æœä½ æ˜¯å’Œæˆ‘ä¸€æ ·çš„æ‡’ç‹—çš„è¯å¯ä»¥ç”¨ä¸€ä¸‹ ACL å®˜æ–¹çš„è´¹ç”¨æµï¼Œç”¨çš„å°±æ˜¯åŸå§‹å¯¹å¶ï¼Œå¾ˆå¿«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb25&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb25-1&#34;&gt;&lt;a href=&#34;#cb25-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-2&#34;&gt;&lt;a href=&#34;#cb25-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;2005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-3&#34;&gt;&lt;a href=&#34;#cb25-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; N, M, D;&lt;/span&gt;
&lt;span id=&#34;cb25-4&#34;&gt;&lt;a href=&#34;#cb25-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb25-5&#34;&gt;&lt;a href=&#34;#cb25-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb25-6&#34;&gt;&lt;a href=&#34;#cb25-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(N, M, D);&lt;/span&gt;
&lt;span id=&#34;cb25-7&#34;&gt;&lt;a href=&#34;#cb25-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    atcoder::mcf_graph&amp;lt;ll, ll&amp;gt; G(N + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb25-8&#34;&gt;&lt;a href=&#34;#cb25-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-9&#34;&gt;&lt;a href=&#34;#cb25-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, N) {&lt;/span&gt;
&lt;span id=&#34;cb25-10&#34;&gt;&lt;a href=&#34;#cb25-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a; read(a);&lt;/span&gt;
&lt;span id=&#34;cb25-11&#34;&gt;&lt;a href=&#34;#cb25-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G.add_edge(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i, a, D), G.add_edge(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i, M - a, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb25-12&#34;&gt;&lt;a href=&#34;#cb25-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * D * a;&lt;/span&gt;
&lt;span id=&#34;cb25-13&#34;&gt;&lt;a href=&#34;#cb25-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb25-14&#34;&gt;&lt;a href=&#34;#cb25-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, M) {&lt;/span&gt;
&lt;span id=&#34;cb25-15&#34;&gt;&lt;a href=&#34;#cb25-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, r, c; read(l, r, c);&lt;/span&gt;
&lt;span id=&#34;cb25-16&#34;&gt;&lt;a href=&#34;#cb25-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G.add_edge(l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, c);&lt;/span&gt;
&lt;span id=&#34;cb25-17&#34;&gt;&lt;a href=&#34;#cb25-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb25-18&#34;&gt;&lt;a href=&#34;#cb25-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans - G.flow(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, N, M).second);&lt;/span&gt;
&lt;span id=&#34;cb25-19&#34;&gt;&lt;a href=&#34;#cb25-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-20&#34;&gt;&lt;a href=&#34;#cb25-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc138&#34;&gt;ARC138&lt;/h3&gt;
&lt;h4 id=&#34;arc138c---rotate-and-play-game&#34;&gt;ARC138C - Rotate and Play Game&lt;/h4&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥é€šè¿‡è§‚å¯Ÿå¤§æ ·ä¾‹å‘ç°ï¼ŒSnuke ä¸€å®šä¼šå–èµ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(n / 2\)&lt;/span&gt; ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘å¯¹äºä¸€ä¸ªé™æ€çš„åºåˆ—ï¼ŒSnuke å¦‚ä½•èƒ½å¤ŸæˆåŠŸå–èµ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(n/2\)&lt;/span&gt; ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è‹¥è§†æœ€å¤§çš„ï¼ˆè¦å–èµ°çš„ï¼‰ &lt;span class=&#34;math inline&#34;&gt;\(n/2\)&lt;/span&gt; ä¸ªå…ƒç´ ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œå‰©ä½™çš„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„è¯ï¼Œç›¸å½“äºå¯¹äºæ¯ä¸€ä¸ªä½ç½®ï¼Œå‰ç¼€å’Œéƒ½ä¸èƒ½ä¸ºè´Ÿï¼ˆè™½ç„¶åªæ˜¯å……åˆ†ï¼Œä½†ä¸å¿…è¦ï¼‰ã€‚è¯æ˜ï¼šæ¯ä¸€è½®ä¸­ï¼ŒSnuke å–èµ°æœ€é å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼ˆè‚¯å®šè¦é¿å…ä»–è¢«æŠ¢èµ°ï¼‰ï¼Œç„¶å Mr.Â Min ç…§å¸¸å–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(+1\)&lt;/span&gt;ï¼Œäºæ˜¯ä¹åŸåºåˆ—å‰ç¼€å’Œçš„æ€§è´¨è‚¯å®šè¿˜æ˜¯æ»¡è¶³çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨é—®é¢˜å°±å˜ä¸ºå¦‚ä½•æ±‚å¾ªç¯ä½ç§»çš„åç§»é‡ã€‚æ³¨æ„åˆ°æ ¹æ®æ‹¬å·åºåˆ—çš„æ€§è´¨ï¼Œå…¶ä¸€å®šæœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå°±å°†è¿™ä¸ªåºåˆ—å¤åˆ¶ä¸€ä»½ï¼Œç„¶åçœ‹ &lt;span class=&#34;math inline&#34;&gt;\([i, i + n - 1]\)&lt;/span&gt; ä¸­çš„å‰ç¼€å’Œæœ€å°å€¼æ˜¯å¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge S_i\)&lt;/span&gt; å³å¯ã€‚å¯ä»¥ä½¿ç”¨ ST è¡¨æˆ–è€…æ»‘åŠ¨çª—å£ä¸€ç±»çš„æ¥åšã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb26&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb26-1&#34;&gt;&lt;a href=&#34;#cb26-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-2&#34;&gt;&lt;a href=&#34;#cb26-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-3&#34;&gt;&lt;a href=&#34;#cb26-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb26-4&#34;&gt;&lt;a href=&#34;#cb26-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb26-5&#34;&gt;&lt;a href=&#34;#cb26-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-6&#34;&gt;&lt;a href=&#34;#cb26-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-7&#34;&gt;&lt;a href=&#34;#cb26-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-8&#34;&gt;&lt;a href=&#34;#cb26-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, st[&lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;][maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], lg[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb26-9&#34;&gt;&lt;a href=&#34;#cb26-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-10&#34;&gt;&lt;a href=&#34;#cb26-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;
&lt;span id=&#34;cb26-11&#34;&gt;&lt;a href=&#34;#cb26-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll val; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; id;&lt;/span&gt;
&lt;span id=&#34;cb26-12&#34;&gt;&lt;a href=&#34;#cb26-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} a[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb26-13&#34;&gt;&lt;a href=&#34;#cb26-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-14&#34;&gt;&lt;a href=&#34;#cb26-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb26-15&#34;&gt;&lt;a href=&#34;#cb26-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb26-16&#34;&gt;&lt;a href=&#34;#cb26-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; a[i].val, a[i].id = i;&lt;/span&gt;
&lt;span id=&#34;cb26-17&#34;&gt;&lt;a href=&#34;#cb26-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, [](&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a.val &amp;gt; b.val;});&lt;/span&gt;
&lt;span id=&#34;cb26-18&#34;&gt;&lt;a href=&#34;#cb26-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll sum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, tmp = a[n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;].val;&lt;/span&gt;
&lt;span id=&#34;cb26-19&#34;&gt;&lt;a href=&#34;#cb26-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sum += a[i].val, a[i].val = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-20&#34;&gt;&lt;a href=&#34;#cb26-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, (n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i].val = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-21&#34;&gt;&lt;a href=&#34;#cb26-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, [](&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a.id &amp;lt; b.id;});&lt;/span&gt;
&lt;span id=&#34;cb26-22&#34;&gt;&lt;a href=&#34;#cb26-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[n + i] = a[i];&lt;/span&gt;
&lt;span id=&#34;cb26-23&#34;&gt;&lt;a href=&#34;#cb26-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lg[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-24&#34;&gt;&lt;a href=&#34;#cb26-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i] = st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + a[i].val, lg[i] = lg[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-25&#34;&gt;&lt;a href=&#34;#cb26-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;19&lt;/span&gt;) FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, (n &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) st[j][i] = max(st[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i], st[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i + (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))]);&lt;/span&gt;
&lt;span id=&#34;cb26-26&#34;&gt;&lt;a href=&#34;#cb26-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;31&lt;/span&gt; - &lt;span class=&#34;fu&#34;&gt;__builtin_clz&lt;/span&gt;(n);&lt;/span&gt;
&lt;span id=&#34;cb26-27&#34;&gt;&lt;a href=&#34;#cb26-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[i].val == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb26-28&#34;&gt;&lt;a href=&#34;#cb26-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ret = max(st[s][i], st[s][i + n - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; s)]);&lt;/span&gt;
&lt;span id=&#34;cb26-29&#34;&gt;&lt;a href=&#34;#cb26-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ret &amp;lt;= st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cout &amp;lt;&amp;lt; i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; sum &amp;lt;&amp;lt; endl, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-30&#34;&gt;&lt;a href=&#34;#cb26-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb26-31&#34;&gt;&lt;a href=&#34;#cb26-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-32&#34;&gt;&lt;a href=&#34;#cb26-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ³¨æ„ä»£ç é‡Œé¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(\pm 1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\min/\max\)&lt;/span&gt; æ€§ä¼¼ä¹å’Œé¢˜è§£ç›¸åï¼ˆåæ­£æ˜¯å¯¹ç§°çš„ï¼Œä¸ç®¡äº†ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc138d---differ-by-k-bits&#34;&gt;ARC138D - Differ by K bits&lt;/h4&gt;
&lt;p&gt;æ’äº†æ´›è°·åŸé¢˜ &lt;a href=&#34;https://www.luogu.com.cn/problem/P7949&#34;&gt;P7949&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜ä¸­ï¼Œæš´åŠ›çš„å¤æ‚åº¦è²Œä¼¼æ˜¯å¯¹çš„ï¼Œå…·ä½“åŸå› ä¸è¯¦ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb27&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb27-1&#34;&gt;&lt;a href=&#34;#cb27-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-2&#34;&gt;&lt;a href=&#34;#cb27-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb27-3&#34;&gt;&lt;a href=&#34;#cb27-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-4&#34;&gt;&lt;a href=&#34;#cb27-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb27-5&#34;&gt;&lt;a href=&#34;#cb27-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-6&#34;&gt;&lt;a href=&#34;#cb27-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt; | &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-7&#34;&gt;&lt;a href=&#34;#cb27-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb27-8&#34;&gt;&lt;a href=&#34;#cb27-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; a, b;&lt;/span&gt;
&lt;span id=&#34;cb27-9&#34;&gt;&lt;a href=&#34;#cb27-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-10&#34;&gt;&lt;a href=&#34;#cb27-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x) {&lt;/span&gt;
&lt;span id=&#34;cb27-11&#34;&gt;&lt;a href=&#34;#cb27-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a.push_back(x); vis[x] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-12&#34;&gt;&lt;a href=&#34;#cb27-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a.size() == (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n)) {&lt;/span&gt;
&lt;span id=&#34;cb27-13&#34;&gt;&lt;a href=&#34;#cb27-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;Yes&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-14&#34;&gt;&lt;a href=&#34;#cb27-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;x : a)&lt;/span&gt;
&lt;span id=&#34;cb27-15&#34;&gt;&lt;a href=&#34;#cb27-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot; &amp;quot;&lt;/span&gt;; exit(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-16&#34;&gt;&lt;a href=&#34;#cb27-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb27-17&#34;&gt;&lt;a href=&#34;#cb27-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;c : b) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[c ^ x]) dfs(c ^ x);&lt;/span&gt;
&lt;span id=&#34;cb27-18&#34;&gt;&lt;a href=&#34;#cb27-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-19&#34;&gt;&lt;a href=&#34;#cb27-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb27-20&#34;&gt;&lt;a href=&#34;#cb27-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-21&#34;&gt;&lt;a href=&#34;#cb27-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb27-22&#34;&gt;&lt;a href=&#34;#cb27-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb27-23&#34;&gt;&lt;a href=&#34;#cb27-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k % &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-24&#34;&gt;&lt;a href=&#34;#cb27-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;fu&#34;&gt;__builtin_popcount&lt;/span&gt;(i) == k) b.push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb27-25&#34;&gt;&lt;a href=&#34;#cb27-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-26&#34;&gt;&lt;a href=&#34;#cb27-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-27&#34;&gt;&lt;a href=&#34;#cb27-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è€ƒè™‘æ­£è§£ï¼šé¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œå…¶ä¸€å®šæ— è§£ã€‚å› ä¸ºä¸å¯èƒ½æ‰€æœ‰æ•°çš„ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{popcount}\)&lt;/span&gt; éƒ½æ˜¯å¶æ•°ã€‚ä¸” &lt;span class=&#34;math inline&#34;&gt;\(k = n\)&lt;/span&gt; çš„æƒ…å†µä¹Ÿæ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬è‹¥æ˜¯å°† &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{popcount}(x) = k\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ’å…¥çº¿æ€§åŸº &lt;span class=&#34;math inline&#34;&gt;\(\mathfrak B\)&lt;/span&gt;ï¼Œåˆ™å¯ä»¥å°†æˆåŠŸæ’å…¥çš„æ•°çœ‹ä½œä¸€ç»„åŸºåº•ï¼Œè€Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(|\mathfrak B|&amp;lt;n\)&lt;/span&gt; æ˜¾ç„¶ä¹Ÿæ— è§£ã€‚å¦åˆ™æˆ‘ä»¬æ€»èƒ½æ„é€ å‡ºç­”æ¡ˆï¼šåªéœ€è¦æ»¡è¶³æ„æˆç›¸é‚»ä¸¤ä¸ªæ•°çš„çº¿æ€§ç»„åˆä¸­ï¼Œæœ‰ä¸€é¡¹ä¸ä¸€æ ·å³å¯ï¼Œå…·ä½“è¿™ä¸ªå¯ä»¥ç”¨æ ¼é›·ç å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb28&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb28-1&#34;&gt;&lt;a href=&#34;#cb28-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-2&#34;&gt;&lt;a href=&#34;#cb28-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb28-3&#34;&gt;&lt;a href=&#34;#cb28-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb28-4&#34;&gt;&lt;a href=&#34;#cb28-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-5&#34;&gt;&lt;a href=&#34;#cb28-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb28-6&#34;&gt;&lt;a href=&#34;#cb28-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-7&#34;&gt;&lt;a href=&#34;#cb28-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, a[&lt;span class=&#34;dv&#34;&gt;22&lt;/span&gt;], p[&lt;span class=&#34;dv&#34;&gt;22&lt;/span&gt;], cnt;&lt;/span&gt;
&lt;span id=&#34;cb28-8&#34;&gt;&lt;a href=&#34;#cb28-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-9&#34;&gt;&lt;a href=&#34;#cb28-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; insert(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x0) {&lt;/span&gt;
&lt;span id=&#34;cb28-10&#34;&gt;&lt;a href=&#34;#cb28-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = x0;&lt;/span&gt;
&lt;span id=&#34;cb28-11&#34;&gt;&lt;a href=&#34;#cb28-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(j, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((x &amp;gt;&amp;gt; j) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb28-12&#34;&gt;&lt;a href=&#34;#cb28-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!p[j]) {&lt;/span&gt;
&lt;span id=&#34;cb28-13&#34;&gt;&lt;a href=&#34;#cb28-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            p[j] = x, a[cnt++] = x0;&lt;/span&gt;
&lt;span id=&#34;cb28-14&#34;&gt;&lt;a href=&#34;#cb28-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-15&#34;&gt;&lt;a href=&#34;#cb28-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; x ^= p[j];&lt;/span&gt;
&lt;span id=&#34;cb28-16&#34;&gt;&lt;a href=&#34;#cb28-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb28-17&#34;&gt;&lt;a href=&#34;#cb28-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-18&#34;&gt;&lt;a href=&#34;#cb28-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb28-19&#34;&gt;&lt;a href=&#34;#cb28-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-20&#34;&gt;&lt;a href=&#34;#cb28-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb28-21&#34;&gt;&lt;a href=&#34;#cb28-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb28-22&#34;&gt;&lt;a href=&#34;#cb28-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;fu&#34;&gt;__builtin_popcount&lt;/span&gt;(i) == k) insert(i);&lt;/span&gt;
&lt;span id=&#34;cb28-23&#34;&gt;&lt;a href=&#34;#cb28-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt &amp;lt; n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-24&#34;&gt;&lt;a href=&#34;#cb28-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb28-25&#34;&gt;&lt;a href=&#34;#cb28-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb28-26&#34;&gt;&lt;a href=&#34;#cb28-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; g = i ^ (i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), now = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-27&#34;&gt;&lt;a href=&#34;#cb28-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((g &amp;gt;&amp;gt; j) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) now ^= a[j];&lt;/span&gt;
&lt;span id=&#34;cb28-28&#34;&gt;&lt;a href=&#34;#cb28-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; now &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-29&#34;&gt;&lt;a href=&#34;#cb28-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb28-30&#34;&gt;&lt;a href=&#34;#cb28-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-31&#34;&gt;&lt;a href=&#34;#cb28-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>P3321 [SDOI2015]åºåˆ—ç»Ÿè®¡</title>
        <link>https://oi.imyangty.com/sol-luogu-p3321/</link>
        <pubDate>Sat, 04 Sep 2021 23:13:03 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-luogu-p3321/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg59.webp" alt="Featured image of post P3321 [SDOI2015]åºåˆ—ç»Ÿè®¡" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™å®šé›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä¿è¯é‡Œé¢å…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0\le x &amp;lt; m\)&lt;/span&gt;ã€‚ç°è¦ç”Ÿæˆé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\forall i\in [1, n],A_i\in S\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(\prod A_i\bmod m = x\)&lt;/span&gt;ã€‚æ±‚æ–¹æ¡ˆæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(1004535809\)&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ˜¯é—® &lt;span class=&#34;math inline&#34;&gt;\(\sum A_i\bmod m = x\)&lt;/span&gt; æ˜¯å¥½åšçš„ï¼Œå¤šé¡¹å¼å¿«é€Ÿå¹‚å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™ä¸ªä¹˜ç§¯ä¸å¤ªå¥½æå•Šï¼&lt;/p&gt;
&lt;p&gt;åŒ–ä¹˜ä¸ºåŠ æœ‰ä¸ªç‰¹åˆ«å¸¸ç”¨çš„æŠ€å·§å°±æ˜¯ä¸¤è¾¹åŒæ—¶å–å¯¹æ•°ã€‚æˆ‘ä»¬è¿™æ ·å®šä¹‰å¯¹æ•°ï¼šéšä¾¿æ‰¾ä¸€ä¸ªåº•æ•° &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(a^x, x\in[1, m - 1]\)&lt;/span&gt;ï¼Œç„¶åå°±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\log_a(a^x\bmod m) = x\)&lt;/span&gt;ã€‚æ—¢ç„¶è¦ &lt;span class=&#34;math inline&#34;&gt;\(a^x\)&lt;/span&gt; ä¸¤ä¸¤ä¸åŒï¼Œé‚£ä¹ˆè¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æ˜¾ç„¶å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„åŸæ ¹ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\prod_{i = 1}^nA_i \bmod m &amp;amp;= x\\
\sum_{i = 1}^n\log_gA_i &amp;amp;=\log_gx
\end{aligned}
\]&lt;/span&gt; æ‰€ä»¥æˆ‘ä»¬æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å–å¯¹æ•°ï¼ŒæŠŠç”Ÿæˆå‡½æ•°è¡¨ç¤ºå‡ºæ¥åå¤šé¡¹å¼å¿«é€Ÿå¹‚å°±è¡Œäº†ï¼ˆå¸¸æ•°é¡¹ä¸æ»¡è¶³èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt; çš„è¦æ±‚æ‰€ä»¥ä¸å¤ªèƒ½ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log m)\)&lt;/span&gt; çš„å¿«é€Ÿå¹‚ï¼‰ã€‚ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ä¼šå¯¹ç­”æ¡ˆäº§ç”Ÿè´¡çŒ®æ‰€ä»¥å¯ä»¥å¿½ç•¥ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ³¨æ„ä¸€ä¸‹æ˜¯æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(m - 1\)&lt;/span&gt; çš„å¾ªç¯å·ç§¯ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log^2m)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define VEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;v)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)v.size();&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define clr&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memset(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(n))&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define cpy&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;g,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memcpy(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;g,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(n))&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; il T min(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;lt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; il T max(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;gt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ull;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mod = &lt;span class=&#34;dv&#34;&gt;1004535809&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;17&lt;/span&gt; | &lt;span class=&#34;dv&#34;&gt;500&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll qPow(ll a, ll b = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; b; b &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a = a * a % mod)&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (b &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret = a * ret % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], revLim;&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; getTr(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (revLim == n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    revLim = n;&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i] = (&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; G = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, invG = qPow(G);&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; DFT(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *g, &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; op, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    getTr(n);&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; ull f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], w[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-41&#34;&gt;&lt;a href=&#34;#cb1-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    w[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-42&#34;&gt;&lt;a href=&#34;#cb1-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = (((ll)mod &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) + g[&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i]]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-43&#34;&gt;&lt;a href=&#34;#cb1-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; l &amp;lt; n; l &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-44&#34;&gt;&lt;a href=&#34;#cb1-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ull tG = qPow(op ? G : invG, (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / (l &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb1-45&#34;&gt;&lt;a href=&#34;#cb1-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) w[i] = w[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * tG % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-46&#34;&gt;&lt;a href=&#34;#cb1-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; n; k += (l &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb1-47&#34;&gt;&lt;a href=&#34;#cb1-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; p &amp;lt; l; ++p) {&lt;/span&gt;
&lt;span id=&#34;cb1-48&#34;&gt;&lt;a href=&#34;#cb1-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tt = w[p] * f[k | l | p] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-49&#34;&gt;&lt;a href=&#34;#cb1-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[k | l | p] = f[k | p] + mod - tt;&lt;/span&gt;
&lt;span id=&#34;cb1-50&#34;&gt;&lt;a href=&#34;#cb1-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[k | p] += tt;&lt;/span&gt;
&lt;span id=&#34;cb1-51&#34;&gt;&lt;a href=&#34;#cb1-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-52&#34;&gt;&lt;a href=&#34;#cb1-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb1-53&#34;&gt;&lt;a href=&#34;#cb1-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] %= mod;&lt;/span&gt;
&lt;span id=&#34;cb1-54&#34;&gt;&lt;a href=&#34;#cb1-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-55&#34;&gt;&lt;a href=&#34;#cb1-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!op) {&lt;/span&gt;
&lt;span id=&#34;cb1-56&#34;&gt;&lt;a href=&#34;#cb1-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ull invn = qPow(n);&lt;/span&gt;
&lt;span id=&#34;cb1-57&#34;&gt;&lt;a href=&#34;#cb1-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = f[i] % mod * invn % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-58&#34;&gt;&lt;a href=&#34;#cb1-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = f[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-59&#34;&gt;&lt;a href=&#34;#cb1-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-60&#34;&gt;&lt;a href=&#34;#cb1-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-61&#34;&gt;&lt;a href=&#34;#cb1-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; fastIO {&lt;/span&gt;
&lt;span id=&#34;cb1-62&#34;&gt;&lt;a href=&#34;#cb1-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxc = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;23&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-63&#34;&gt;&lt;a href=&#34;#cb1-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; ibuf[maxc], *__p1 = ibuf, *__p2 = ibuf;&lt;/span&gt;
&lt;span id=&#34;cb1-64&#34;&gt;&lt;a href=&#34;#cb1-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-65&#34;&gt;&lt;a href=&#34;#cb1-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; getchar() {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; __p1 == __p2 &amp;amp;&amp;amp; (__p2 = (__p1 = ibuf) + fread(ibuf, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, maxc, stdin), __p1 == __p2) ? EOF : *__p1++;}&lt;/span&gt;
&lt;span id=&#34;cb1-66&#34;&gt;&lt;a href=&#34;#cb1-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-67&#34;&gt;&lt;a href=&#34;#cb1-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; read(T &amp;amp;n) {&lt;/span&gt;
&lt;span id=&#34;cb1-68&#34;&gt;&lt;a href=&#34;#cb1-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; n = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-69&#34;&gt;&lt;a href=&#34;#cb1-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-70&#34;&gt;&lt;a href=&#34;#cb1-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb1-71&#34;&gt;&lt;a href=&#34;#cb1-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x |= (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-72&#34;&gt;&lt;a href=&#34;#cb1-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb1-73&#34;&gt;&lt;a href=&#34;#cb1-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        n = n * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-74&#34;&gt;&lt;a href=&#34;#cb1-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = x ? -n : n;&lt;/span&gt;
&lt;span id=&#34;cb1-75&#34;&gt;&lt;a href=&#34;#cb1-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-76&#34;&gt;&lt;a href=&#34;#cb1-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-77&#34;&gt;&lt;a href=&#34;#cb1-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; read(&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; *s) {&lt;/span&gt;
&lt;span id=&#34;cb1-78&#34;&gt;&lt;a href=&#34;#cb1-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-79&#34;&gt;&lt;a href=&#34;#cb1-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-80&#34;&gt;&lt;a href=&#34;#cb1-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c) &amp;amp;&amp;amp; !isalpha(c)) c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-81&#34;&gt;&lt;a href=&#34;#cb1-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isalpha(c) || isdigit(c)) s[p++] = c, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-82&#34;&gt;&lt;a href=&#34;#cb1-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-83&#34;&gt;&lt;a href=&#34;#cb1-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-84&#34;&gt;&lt;a href=&#34;#cb1-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-85&#34;&gt;&lt;a href=&#34;#cb1-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; obuf[maxc], *__pO = obuf;&lt;/span&gt;
&lt;span id=&#34;cb1-86&#34;&gt;&lt;a href=&#34;#cb1-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-87&#34;&gt;&lt;a href=&#34;#cb1-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; putchar(&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c) {*__pO++ = c;}&lt;/span&gt;
&lt;span id=&#34;cb1-88&#34;&gt;&lt;a href=&#34;#cb1-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-89&#34;&gt;&lt;a href=&#34;#cb1-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; print(T x) {&lt;/span&gt;
&lt;span id=&#34;cb1-90&#34;&gt;&lt;a href=&#34;#cb1-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), print(-x);&lt;/span&gt;
&lt;span id=&#34;cb1-91&#34;&gt;&lt;a href=&#34;#cb1-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb1-92&#34;&gt;&lt;a href=&#34;#cb1-92&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;gt; &lt;span class=&#34;dv&#34;&gt;9&lt;/span&gt;) print(x / &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-93&#34;&gt;&lt;a href=&#34;#cb1-93&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        putchar(x % &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-94&#34;&gt;&lt;a href=&#34;#cb1-94&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-95&#34;&gt;&lt;a href=&#34;#cb1-95&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-96&#34;&gt;&lt;a href=&#34;#cb1-96&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-97&#34;&gt;&lt;a href=&#34;#cb1-97&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-98&#34;&gt;&lt;a href=&#34;#cb1-98&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; output() {fwrite(obuf, __pO - obuf, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, stdout);}&lt;/span&gt;
&lt;span id=&#34;cb1-99&#34;&gt;&lt;a href=&#34;#cb1-99&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} &lt;span class=&#34;co&#34;&gt;// namespace fastIO&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-100&#34;&gt;&lt;a href=&#34;#cb1-100&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-101&#34;&gt;&lt;a href=&#34;#cb1-101&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; fastIO;&lt;/span&gt;
&lt;span id=&#34;cb1-102&#34;&gt;&lt;a href=&#34;#cb1-102&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-103&#34;&gt;&lt;a href=&#34;#cb1-103&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, x, S;&lt;/span&gt;
&lt;span id=&#34;cb1-104&#34;&gt;&lt;a href=&#34;#cb1-104&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[&lt;span class=&#34;dv&#34;&gt;8005&lt;/span&gt;], Log[&lt;span class=&#34;dv&#34;&gt;8005&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-105&#34;&gt;&lt;a href=&#34;#cb1-105&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[maxn], ans[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-106&#34;&gt;&lt;a href=&#34;#cb1-106&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-107&#34;&gt;&lt;a href=&#34;#cb1-107&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; g, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;/span&gt;
&lt;span id=&#34;cb1-108&#34;&gt;&lt;a href=&#34;#cb1-108&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[&lt;span class=&#34;dv&#34;&gt;8005&lt;/span&gt;] = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb1-109&#34;&gt;&lt;a href=&#34;#cb1-109&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, tmp = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt; m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; ++i, tmp = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * tmp * g % m) {&lt;/span&gt;
&lt;span id=&#34;cb1-110&#34;&gt;&lt;a href=&#34;#cb1-110&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++vis[tmp];&lt;/span&gt;
&lt;span id=&#34;cb1-111&#34;&gt;&lt;a href=&#34;#cb1-111&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[tmp] &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-112&#34;&gt;&lt;a href=&#34;#cb1-112&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-113&#34;&gt;&lt;a href=&#34;#cb1-113&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-114&#34;&gt;&lt;a href=&#34;#cb1-114&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-115&#34;&gt;&lt;a href=&#34;#cb1-115&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-116&#34;&gt;&lt;a href=&#34;#cb1-116&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; getG(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;/span&gt;
&lt;span id=&#34;cb1-117&#34;&gt;&lt;a href=&#34;#cb1-117&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; g;&lt;/span&gt;
&lt;span id=&#34;cb1-118&#34;&gt;&lt;a href=&#34;#cb1-118&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-119&#34;&gt;&lt;a href=&#34;#cb1-119&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (check(i, m)) {&lt;/span&gt;
&lt;span id=&#34;cb1-120&#34;&gt;&lt;a href=&#34;#cb1-120&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            g = i;&lt;/span&gt;
&lt;span id=&#34;cb1-121&#34;&gt;&lt;a href=&#34;#cb1-121&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-122&#34;&gt;&lt;a href=&#34;#cb1-122&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-123&#34;&gt;&lt;a href=&#34;#cb1-123&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-124&#34;&gt;&lt;a href=&#34;#cb1-124&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, tmp = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt; m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; ++i, tmp = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * tmp * g % m)&lt;/span&gt;
&lt;span id=&#34;cb1-125&#34;&gt;&lt;a href=&#34;#cb1-125&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Log[tmp] = i;&lt;/span&gt;
&lt;span id=&#34;cb1-126&#34;&gt;&lt;a href=&#34;#cb1-126&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-127&#34;&gt;&lt;a href=&#34;#cb1-127&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-128&#34;&gt;&lt;a href=&#34;#cb1-128&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-129&#34;&gt;&lt;a href=&#34;#cb1-129&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim;&lt;/span&gt;
&lt;span id=&#34;cb1-130&#34;&gt;&lt;a href=&#34;#cb1-130&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-131&#34;&gt;&lt;a href=&#34;#cb1-131&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-132&#34;&gt;&lt;a href=&#34;#cb1-132&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m), read(x), read(S);&lt;/span&gt;
&lt;span id=&#34;cb1-133&#34;&gt;&lt;a href=&#34;#cb1-133&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; lim &amp;lt; m; lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-134&#34;&gt;&lt;a href=&#34;#cb1-134&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    getG(m);&lt;/span&gt;
&lt;span id=&#34;cb1-135&#34;&gt;&lt;a href=&#34;#cb1-135&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, S) {&lt;/span&gt;
&lt;span id=&#34;cb1-136&#34;&gt;&lt;a href=&#34;#cb1-136&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a; read(a), a %= m;&lt;/span&gt;
&lt;span id=&#34;cb1-137&#34;&gt;&lt;a href=&#34;#cb1-137&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!a) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-138&#34;&gt;&lt;a href=&#34;#cb1-138&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[Log[a]] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-139&#34;&gt;&lt;a href=&#34;#cb1-139&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-140&#34;&gt;&lt;a href=&#34;#cb1-140&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-141&#34;&gt;&lt;a href=&#34;#cb1-141&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; n; n &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-142&#34;&gt;&lt;a href=&#34;#cb1-142&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DFT(f, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, lim);&lt;/span&gt;
&lt;span id=&#34;cb1-143&#34;&gt;&lt;a href=&#34;#cb1-143&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-144&#34;&gt;&lt;a href=&#34;#cb1-144&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DFT(ans, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, lim);&lt;/span&gt;
&lt;span id=&#34;cb1-145&#34;&gt;&lt;a href=&#34;#cb1-145&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * ans[i] * f[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-146&#34;&gt;&lt;a href=&#34;#cb1-146&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DFT(ans, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim);&lt;/span&gt;
&lt;span id=&#34;cb1-147&#34;&gt;&lt;a href=&#34;#cb1-147&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DEC(i, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans[i - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = (ans[i] + ans[i - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) % mod, ans[i] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-148&#34;&gt;&lt;a href=&#34;#cb1-148&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-149&#34;&gt;&lt;a href=&#34;#cb1-149&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i] * f[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-150&#34;&gt;&lt;a href=&#34;#cb1-150&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DFT(f, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim);&lt;/span&gt;
&lt;span id=&#34;cb1-151&#34;&gt;&lt;a href=&#34;#cb1-151&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = (f[i] + f[i - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) % mod, f[i] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-152&#34;&gt;&lt;a href=&#34;#cb1-152&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-153&#34;&gt;&lt;a href=&#34;#cb1-153&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans[Log[x]]);&lt;/span&gt;
&lt;span id=&#34;cb1-154&#34;&gt;&lt;a href=&#34;#cb1-154&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-155&#34;&gt;&lt;a href=&#34;#cb1-155&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>P5641 ã€CSGRound2ã€‘å¼€æ‹“è€…çš„å“è¯†</title>
        <link>https://oi.imyangty.com/sol-luogu-p5641/</link>
        <pubDate>Sun, 15 Aug 2021 16:06:25 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-luogu-p5641/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg16.webp" alt="Featured image of post P5641 ã€CSGRound2ã€‘å¼€æ‹“è€…çš„å“è¯†" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™å®šåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt;ï¼Œå®šä¹‰ &lt;span class=&#34;math display&#34;&gt;\[
sum_{k,l, r} =
\begin{cases}
\displaystyle\sum_{i = l}^ra_i&amp;amp;k = 1\\
\displaystyle\sum_{i = l}^r\sum_{j = i}^rsum_{k - 1, i, j}&amp;amp;k&amp;gt;1
\end{cases}
\]&lt;/span&gt; å¯¹äºç»™å®šçš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œæ±‚å‡ºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(sum_{k, 1, i}\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le i\le n\)&lt;/span&gt;ï¼‰ã€‚ç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¾ç„¶ä¸º &lt;span class=&#34;math display&#34;&gt;\[
sum_{k, 1, r} = \sum_{i = 1}^r cnt_i\times a_i
\]&lt;/span&gt; è€ƒè™‘å¦‚ä½•è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(cnt_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€è€ƒ &lt;span class=&#34;math inline&#34;&gt;\(cnt_i\)&lt;/span&gt; çš„ç»„åˆæ„ä¹‰ï¼Œå‘ç°å…¶å°±æ˜¯é€‰å– &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; ä¸ªåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l_j, r_j]\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¢«è¿™äº›åŒºé—´è¦†ç›–ä¸” &lt;span class=&#34;math inline&#34;&gt;\([l_j, r_j]\subseteq[l_{j + 1}, r_{j + 1}]\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚è‡³äºä¸ºä»€ä¹ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; ä¸ªæ˜¯å› ä¸ºæœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\([1, r]\)&lt;/span&gt; æ˜¯å·²ç»ç¡®å®šäº†çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬äºæ˜¯æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\le l_1\le l_2\le l_{k - 1}\le i\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(d_{k} = i - l_{k - 1}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d_{k - 1} = l_{k - 1} - l_{k - 2}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d_2 = l_2 - l_1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d_1 = l_1 - 1\)&lt;/span&gt;ï¼Œç„¶åå°±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(d_1 + d_2 + \cdots + d_k = i - 1\)&lt;/span&gt;ï¼Œ è¿™ä¸ªä¸œè¥¿æ’æ¿æ³•ä¸€ä¸‹å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{i + k - 2}{k - 1}\)&lt;/span&gt;ï¼Œè€Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„æƒ…å†µæ˜¯ä¸€ä¸ªé“ç†ï¼Œæ’å®Œæ¿å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{r - i + k - 1}{k - 1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å°±æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
sum_{k, 1, r} = \sum_{i = 1}^r\binom{i + k - 2}{k - 1}\binom{r - i + k - 1}{k - 1}a_i
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(i + r - i = r\)&lt;/span&gt;ï¼‰ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(F_i = a_i\dbinom{i + k - 2}{k - 1}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(G_i = \dbinom{i + k + 1}{k - 1}\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(sum_{k, 1, r} = \displaystyle\sum_{i = 1}^rF_iG_{r - i}\)&lt;/span&gt; æ‰€ä»¥å¯ä»¥å¤§åŠ› NTTã€‚ç°åœ¨æœ€å…³é”®çš„æ˜¯å¦‚ä½•æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{i + k - 2}{k - 1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{i + k - 1}{k - 1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çº¿æ€§é€’æ¨ï¼æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(G_i\)&lt;/span&gt; å¤„ç†å‡ºæ¥ä¹‹åç›´æ¥ &lt;span class=&#34;math inline&#34;&gt;\(F_i = a_iG_{i - 1}\)&lt;/span&gt;ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
G_i &amp;amp;= \binom{i + k - 1}{k - 1} = \frac{(i + k - 2)!(i + k - 1)}{i(i - 1)!(k - 1)!}\\
G_{i - 1} &amp;amp;= \binom{i + k - 2}{k - 1} = \frac{(i + k - 2)!}{(i - 1)!(k - 1)!}
\end{aligned}
\]&lt;/span&gt; æ‰€ä»¥æœ‰å¦‚ä¸‹ç»“è®º &lt;span class=&#34;math display&#34;&gt;\[
G_i = \frac{i + k - 1}{i}G_{i - 1}
\]&lt;/span&gt; æ³¨æ„ä¸€ä¸‹è¾¹ç•Œï¼Œè¾¹ç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(G_0 = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;p&gt;äºæ˜¯ä¸€ä¸å°å¿ƒæˆäº†æ´›è°·æœ€ä¼˜è§£ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f, g;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(k);&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g.resize(n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), f.resize(n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), lim = n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, initInv();&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) g[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * g[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * inv[i] % mod * (i + k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * g[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * a[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f = f * g;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) print(f[i]), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>P4451 [å›½å®¶é›†è®­é˜Ÿ]æ•´æ•°çš„lqpæ‹†åˆ†</title>
        <link>https://oi.imyangty.com/sol-luogu-p4451/</link>
        <pubDate>Sun, 15 Aug 2021 14:54:01 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-luogu-p4451/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg5.webp" alt="Featured image of post P4451 [å›½å®¶é›†è®­é˜Ÿ]æ•´æ•°çš„lqpæ‹†åˆ†" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;è®¾æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\{F_n\}\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math display&#34;&gt;\[
g(n) = \sum_{m&amp;gt;0,a_i &amp;gt; 0,\sum a_i = n}\prod_{i = 1}^mF_{a_i}
\]&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 7\)&lt;/span&gt; å–æ¨¡çš„ç»“æœã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;å¾ˆå®¹æ˜“å‘ç°ï¼š &lt;span class=&#34;math display&#34;&gt;\[
g(0) = 1\\
g(n) = \sum_{i \ge 1} g(n - i)F_i
\]&lt;/span&gt; è®¾ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; çš„ OGF ä¸º &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt;ï¼Œæ–æ³¢é‚£å¥‘ç†Ÿåˆ—çš„ OGF ä¸º &lt;span class=&#34;math inline&#34;&gt;\(F(x)\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
G(x) = G(x)F(x) + 1
\]&lt;/span&gt; ä»£å…¥ &lt;span class=&#34;math inline&#34;&gt;\(F(x) = \dfrac{x}{1 - x - x^2}\)&lt;/span&gt;ï¼Œå¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
G(x) &amp;amp;= \frac{1}{1 - F(x)}\\
G(x) &amp;amp;= \frac{1}{1 - \frac{x}{1 - x - x^2}}\\
G(x) &amp;amp;= \frac{1 - x - x^2}{1 - 2x - x^2}\\
G(x) &amp;amp;= 1 + \frac{x}{1 - 2x - x^2}\\
\end{aligned}
\]&lt;/span&gt; ç°åœ¨çš„ç›®æ ‡å°±æ˜¯å±•å¼€ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{x}{1 - 2x - x^2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æˆ‘ä»¬ä¼šåšçš„æ˜¯ç±»ä¼¼äº &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{1}{1 - cx}\)&lt;/span&gt; çš„å½¢å¼ï¼Œç±»ä¼¼æ–æ³¢é‚£å¥‘é‚£æ ·ï¼Œå› å¼åˆ†è§£ä¸€ä¸‹ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(x^2 + 2x - 1 = 0\)&lt;/span&gt; çš„ä¸¤è§£åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\pm\sqrt2\)&lt;/span&gt;ï¼Œä»£å…¥ä¸€ä¸‹å‘ç° &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\frac{x}{1 - 2x - x^2} &amp;amp;= \frac{x}{(x_1 - x)(x_2 -  x)}\\
&amp;amp;= \frac{x}{x_2 - x_1}\left(\frac{1}{x_1 - x} - \frac{1}{x_2 - x}\right)\\
&amp;amp;= \frac{x}{x_2 - x_1}\left(\frac{1}{x_1}\frac{1}{1 - \frac{1}{x_1}x} - \frac{1}{x_2}\frac{1}{1 - \frac{1}{x_2}x}\right)\\
&amp;amp;= \frac{x}{x_2 - x_1}\left(\frac{1}{x_1}\sum_{i\ge 0}\frac{x^{i}}{x_1^i} - \frac{1}{x_2}\sum_{i \ge 0}\frac{x^i}{x_2^i}\right)\\
&amp;amp;= \frac{1}{x_2 - x_1}\left(\sum_{i\ge 0}\frac{x^{i + 1}}{x_1^{i + 1}} - \sum_{i\ge 0}\frac{x^{i + 1}}{x_2^{i + 1}}\right)\\
\end{aligned}
\]&lt;/span&gt; äºæ˜¯å°±æœ‰äº† &lt;span class=&#34;math display&#34;&gt;\[
g(n) = \frac{1}{x_2 - x_1}\left(\frac{1}{x_1^n} - \frac{1}{x_2^n} \right)
\]&lt;/span&gt; å°† &lt;span class=&#34;math inline&#34;&gt;\(x_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x_2\)&lt;/span&gt; ä»£å…¥ä¾¿æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
g(n) = \frac{\sqrt2}{4}\left[(1 + \sqrt2)^n - (1 - \sqrt2)^n\right]
\]&lt;/span&gt; å– &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 7\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„äºŒæ¬¡å‰©ä½™ &lt;span class=&#34;math inline&#34;&gt;\(59713600\)&lt;/span&gt; ç›´æ¥è®¡ç®—å³å¯ã€‚ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å¾ˆå¤§ï¼Œæ ¹æ®æ¬§æ‹‰å®šç†å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 6\)&lt;/span&gt; å–æ¨¡å³å¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;p&gt;ä»£ç å¾ˆçŸ­å¾ˆå¥½å†™ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mod = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;7&lt;/span&gt;, sqrt2 = &lt;span class=&#34;dv&#34;&gt;59713600&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; qPow(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = mod) {&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; b; b &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * a * a % p)&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (b &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * ret * a % p;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; str[&lt;span class=&#34;dv&#34;&gt;10005&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, str + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; str[i]; ++i)&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        n = (&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * n + str[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) % (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * sqrt2 * qPow(&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) % mod * (qPow(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; + sqrt2, n) - qPow(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - sqrt2 + mod, n) + mod) % mod);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>CF438E The Child and Binary Tree</title>
        <link>https://oi.imyangty.com/sol-cf438e/</link>
        <pubDate>Sat, 14 Aug 2021 22:04:40 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-cf438e/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg67.webp" alt="Featured image of post CF438E The Child and Binary Tree" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç°æœ‰ä¸€é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„äº’å¼‚æ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{c_1, c_2, \cdots, c_n\}\)&lt;/span&gt;ã€‚ä»¤äºŒå‰æ ‘çš„æƒå€¼éƒ½ä»è¯¥åºåˆ—ä¸­äº§ç”Ÿã€‚å¯¹ä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(1\le s\le m\)&lt;/span&gt;ï¼Œæ±‚å‡ºæƒå€¼å’Œæ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„ä¸åŒäºŒå‰æ ‘çš„ä¸ªæ•°ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸ªæœ´ç´ çš„ DPã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸ºæƒå€¼å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„äºŒå‰æ ‘çš„ä¸ªæ•°ã€‚åˆ™æœ‰å¦‚ä¸‹è½¬ç§»ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{cases}
f_0 = 1\\
f_n = \sum_{i = 1}^n[i\in C]\sum_{j = 0}^{n - i}f_jf_{n - i - j}&amp;amp; n &amp;gt; 0
\end{cases}
\]&lt;/span&gt; ç„¶åè®¾ç”Ÿæˆå‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle G(x) = \sum_{i \ge 0}[i\in C]x^i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(F(x) = \displaystyle\sum_{i\ge0} f_ix^i\)&lt;/span&gt;ã€‚ç„¶åæˆ‘ä»¬å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n&amp;gt;0\)&lt;/span&gt; æœ‰ä¸‹é¢è¿™ä¸ªå¼å­ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_n = \sum_{i = 1}^n g_i\sum_{j = 0}^{n - i}f_jf_{n - i - j}
\]&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(i + j + (n - i - j) = n\)&lt;/span&gt;ï¼Œæ‰€ä»¥è¿™å…¶å®å°±æ˜¯ä¸‰ä¸ªå¤šé¡¹å¼å·åˆ°ä¸€èµ·ï¼Œå³ &lt;span class=&#34;math display&#34;&gt;\[
F(x) = 1 + G(x)F^2(x)
\]&lt;/span&gt; è¿™ä¸ªå¤šå‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ˜¯æŒ‡ &lt;span class=&#34;math inline&#34;&gt;\(f_0 = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨åˆä¸­çŸ¥è¯†ç®—ä¸€ä¸‹å‘ç° &lt;span class=&#34;math display&#34;&gt;\[
F(x) = \frac{1\pm\sqrt{1 - 4G(x)}}{2G(x)}
\]&lt;/span&gt; é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(+\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(-\)&lt;/span&gt; åº”è¯¥å–å“ªä¸ªå‘¢ï¼Ÿè€ƒè™‘å– &lt;span class=&#34;math inline&#34;&gt;\(+\)&lt;/span&gt; çš„æƒ…å†µï¼Œä¸‹é¢è¿ç”¨ä¸€ä¸ªå«åˆ†æ¯æ— ç†åŒ–çš„å°æŠ€å·§ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
F(x) &amp;amp;= \frac{1 + \sqrt{1 - 4G(x)}}{2G(x)}\\
&amp;amp;= \frac{4G(x)}{2G(x)(1 - \sqrt{1 - 4G(x)})}\\
&amp;amp;= \frac{2}{1 - \sqrt{1 - 4G(x)}}
\end{aligned}
\]&lt;/span&gt; ç„¶åä¼šæƒŠå¥‡çš„å‘ç°å½“ &lt;span class=&#34;math inline&#34;&gt;\(x = 0\)&lt;/span&gt; æ—¶æ•´å¨å¼å­å°†ä¸æ”¶æ•›ï¼ˆåˆ†æ¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å– &lt;span class=&#34;math inline&#34;&gt;\(-\)&lt;/span&gt; å‘¢ï¼Ÿ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
F(x) &amp;amp;= \frac{1 - \sqrt{1 - 4G(x)}}{2G(x)}\\
&amp;amp;= \frac{2}{1 + \sqrt{1 - 4G(x)}}
\end{aligned}
\]&lt;/span&gt; å¼€æ ¹ï¼Œæ±‚é€†ï¼Œåšå®Œäº†ã€‚å…¶æ€æƒ³å°±æ˜¯å°†å·ç§¯å½¢å¼çš„ dp å¥—ä¸Šç”Ÿæˆå‡½æ•°ç„¶åè¿›è¡Œæ¨å¯¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;p&gt;çŠ¯å›°ï¼ŒçŠ¯äº†äº›æ†¨æ†¨é”™è¯¯ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly g, one(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m);&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g.resize(lim = m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c; read(c);&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (c &amp;lt;= m) g[c] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * polyInv(one + polySqrt(one - &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt; * g));&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) print(g[i]), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>P5488 å·®åˆ†ä¸å‰ç¼€å’Œ</title>
        <link>https://oi.imyangty.com/sol-luogu-p5488/</link>
        <pubDate>Wed, 11 Aug 2021 21:40:51 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-luogu-p5488/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg13.webp" alt="Featured image of post P5488 å·®åˆ†ä¸å‰ç¼€å’Œ" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ—ï¼Œæ±‚å‡ºå…¶ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; é˜¶å·®åˆ†æˆ–å‰ç¼€å’Œã€‚&lt;/p&gt;
&lt;p&gt;ç³»æ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(1004535809\)&lt;/span&gt; å–æ¨¡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 10^{2333}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;part.-1&#34;&gt;Part. 1&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘åšä¸€é˜¶å‰ç¼€å’Œçš„æ—¶å€™æˆ‘ä»¬å¹²äº†äº›ä»€ä¹ˆï¼Œå‘ç°æ¯ä¸ªé¡¹éƒ½è¢«å…¶å‰é¢çš„æ¯ä¸ªé¡¹éƒ½è´¡çŒ®äº†ä¸€æ¬¡ã€‚å°†åºåˆ—çš„ç”Ÿæˆå‡½æ•°å»ºå‡ºæ¥ï¼Œä¸éš¾å‘ç°ç­”æ¡ˆçš„ç”Ÿæˆå‡½æ•°å³ä¸º &lt;span class=&#34;math display&#34;&gt;\[
f(x)\times\sum_{i = 0}^{+\infty}x^i = \frac{f(x)}{1 - x}
\]&lt;/span&gt; åš &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡å°±æ˜¯ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{1}{1 - x}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;è€Œå·®åˆ†å‘¢ï¼Ÿç±»æ¯”ä¸Šé¢çš„æ€è·¯ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; é˜¶å·®åˆ†å³ä¸ºä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(1 - x\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¸œè¥¿æ˜æ˜¾å¯ä»¥ç”¨å¤šé¡¹å¼å¿«é€Ÿå¹‚æ¥åšï¼Œåªä¸è¿‡å¸¸æ•°ä¼šå‡å¤©ã€‚æ´›è°·ä¸Šå¼€ O2 å¯è¿‡ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, t;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[&lt;span class=&#34;dv&#34;&gt;3000&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f, g;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n, s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; s[i]; ++i)&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        k = (&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k + s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = n, initInv();&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(n), g.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;f[i]);&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, g[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g = polyExp(k * polyLn(g));&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!t) g = polyInv(g);&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f = f * g;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f);&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;part.-2&#34;&gt;Part. 2&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘ä¸é‚£ä¹ˆæš´åŠ›å»åšï¼Œè€Œæ˜¯å»æ€è€ƒé‚£ä¸¤ä¸ªå½¢å¼å¹‚çº§æ•°æœ‰ä»€ä¹ˆæ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å·®åˆ†ï¼š&lt;span class=&#34;math inline&#34;&gt;\((1 - x)^k\)&lt;/span&gt;ï¼Œä¸ŠäºŒé¡¹å¼å®šç†ï¼š &lt;span class=&#34;math display&#34;&gt;\[
(1 - x)^k = \sum_{i = 0}^{+\infty}(-1)^i\binom k ix^i
\]&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿™ä¹ˆå¤§ï¼Œæä»€ä¹ˆå±ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œè¿™é¢˜çš„ç»„åˆæ•°æ˜¯å¯ä»¥é€’æ¨çš„ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\binom k i = \binom{k}{i - 1}\times\frac{k - i + 1}{i}
\]&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å°±å¯ä»¥ç›´æ¥å¯¹æ¨¡æ•°å–æ¨¡äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä¸å¤ªå¥½æƒ³çš„æ˜¯å‰ç¼€å’Œï¼š&lt;span class=&#34;math inline&#34;&gt;\(\dfrac{1}{(1 - x)^k}\)&lt;/span&gt;ã€‚æˆ‘ä»¬æŠŠå®ƒçœ‹æˆ &lt;span class=&#34;math inline&#34;&gt;\((1 - x)^{-k}\)&lt;/span&gt; ç„¶åä¸Šå¹¿ä¹‰äºŒé¡¹å¼å®šç†ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
(1 - x)^{-k} &amp;amp;= \sum_{i = 0}^{\infty}(-1)^i\binom{-k}i x^i\\
&amp;amp;= \sum_{i = 0}^\infty(-1)^i\frac{(-k)^{\underline{i}}}{i!}x^i\\
&amp;amp;= \sum_{i = 0}^\infty\frac{(k + i - 1)^{\underline{i}}}{i!}x^i\\
&amp;amp;= \sum_{i = 0}^\infty\binom{k + i - 1}i x^i
\end{aligned}
\]&lt;/span&gt; ç„¶åæˆ‘ä»¬ç¨å¾®æ¨ä¸€ä¸‹å°±å‘ç°è¿™ä¸ªç»„åˆæ•°ä¹Ÿå¯ä»¥é€’æ¨ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\binom{k + i - 1}{i} = \binom{k + i - 2}{i - 1}\times\frac{k + i - 1}{i}
\]&lt;/span&gt; äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æ›´åŠ ä¼˜ç§€åœ°é€šè¿‡æ­¤é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb2-1&#34;&gt;&lt;a href=&#34;#cb2-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, t;&lt;/span&gt;
&lt;span id=&#34;cb2-2&#34;&gt;&lt;a href=&#34;#cb2-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[&lt;span class=&#34;dv&#34;&gt;3000&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-3&#34;&gt;&lt;a href=&#34;#cb2-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f, g;&lt;/span&gt;
&lt;span id=&#34;cb2-4&#34;&gt;&lt;a href=&#34;#cb2-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-5&#34;&gt;&lt;a href=&#34;#cb2-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb2-6&#34;&gt;&lt;a href=&#34;#cb2-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n, s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &amp;amp;t);&lt;/span&gt;
&lt;span id=&#34;cb2-7&#34;&gt;&lt;a href=&#34;#cb2-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; s[i]; ++i)&lt;/span&gt;
&lt;span id=&#34;cb2-8&#34;&gt;&lt;a href=&#34;#cb2-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        k = (&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k + s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb2-9&#34;&gt;&lt;a href=&#34;#cb2-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = n, initInv();&lt;/span&gt;
&lt;span id=&#34;cb2-10&#34;&gt;&lt;a href=&#34;#cb2-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(n), g.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb2-11&#34;&gt;&lt;a href=&#34;#cb2-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;f[i]);&lt;/span&gt;
&lt;span id=&#34;cb2-12&#34;&gt;&lt;a href=&#34;#cb2-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!t) {&lt;/span&gt;
&lt;span id=&#34;cb2-13&#34;&gt;&lt;a href=&#34;#cb2-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-14&#34;&gt;&lt;a href=&#34;#cb2-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * g[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * (k + i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) % mod * inv[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb2-15&#34;&gt;&lt;a href=&#34;#cb2-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb2-16&#34;&gt;&lt;a href=&#34;#cb2-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-17&#34;&gt;&lt;a href=&#34;#cb2-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * (k - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) % mod * inv[i] % mod * g[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod;&lt;/span&gt;
&lt;span id=&#34;cb2-18&#34;&gt;&lt;a href=&#34;#cb2-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-19&#34;&gt;&lt;a href=&#34;#cb2-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f * g);&lt;/span&gt;
&lt;span id=&#34;cb2-20&#34;&gt;&lt;a href=&#34;#cb2-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-21&#34;&gt;&lt;a href=&#34;#cb2-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;p&gt;é™„ä¸Šå‰é¢çš„æ¿å­åŸå”±ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb3&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb3-1&#34;&gt;&lt;a href=&#34;#cb3-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-2&#34;&gt;&lt;a href=&#34;#cb3-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-3&#34;&gt;&lt;a href=&#34;#cb3-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-4&#34;&gt;&lt;a href=&#34;#cb3-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-5&#34;&gt;&lt;a href=&#34;#cb3-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-6&#34;&gt;&lt;a href=&#34;#cb3-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb3-7&#34;&gt;&lt;a href=&#34;#cb3-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb3-8&#34;&gt;&lt;a href=&#34;#cb3-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define VEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;v)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)v.size();&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb3-9&#34;&gt;&lt;a href=&#34;#cb3-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-10&#34;&gt;&lt;a href=&#34;#cb3-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define ll &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-11&#34;&gt;&lt;a href=&#34;#cb3-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define ull &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;unsigned&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-12&#34;&gt;&lt;a href=&#34;#cb3-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define clr&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memset(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(n))&lt;/span&gt;
&lt;span id=&#34;cb3-13&#34;&gt;&lt;a href=&#34;#cb3-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define cpy&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;g,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memcpy(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;g,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(n))&lt;/span&gt;
&lt;span id=&#34;cb3-14&#34;&gt;&lt;a href=&#34;#cb3-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define MOD &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1004535809&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-15&#34;&gt;&lt;a href=&#34;#cb3-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-16&#34;&gt;&lt;a href=&#34;#cb3-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; il T min(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;lt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb3-17&#34;&gt;&lt;a href=&#34;#cb3-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; il T max(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;gt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb3-18&#34;&gt;&lt;a href=&#34;#cb3-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-19&#34;&gt;&lt;a href=&#34;#cb3-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; poly {&lt;/span&gt;
&lt;span id=&#34;cb3-20&#34;&gt;&lt;a href=&#34;#cb3-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define int &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-21&#34;&gt;&lt;a href=&#34;#cb3-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; G = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, mod = MOD, maxn = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;17&lt;/span&gt; | &lt;span class=&#34;dv&#34;&gt;500&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-22&#34;&gt;&lt;a href=&#34;#cb3-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; Poly;&lt;/span&gt;
&lt;span id=&#34;cb3-23&#34;&gt;&lt;a href=&#34;#cb3-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll qPow(ll a, ll b = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb3-24&#34;&gt;&lt;a href=&#34;#cb3-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-25&#34;&gt;&lt;a href=&#34;#cb3-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; b; b &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a = a * a % mod)&lt;/span&gt;
&lt;span id=&#34;cb3-26&#34;&gt;&lt;a href=&#34;#cb3-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (b &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret = a * ret % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-27&#34;&gt;&lt;a href=&#34;#cb3-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb3-28&#34;&gt;&lt;a href=&#34;#cb3-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-29&#34;&gt;&lt;a href=&#34;#cb3-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; invG = qPow(G);&lt;/span&gt;
&lt;span id=&#34;cb3-30&#34;&gt;&lt;a href=&#34;#cb3-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-31&#34;&gt;&lt;a href=&#34;#cb3-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], revLim, lim;&lt;/span&gt;
&lt;span id=&#34;cb3-32&#34;&gt;&lt;a href=&#34;#cb3-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-33&#34;&gt;&lt;a href=&#34;#cb3-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; getTr(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb3-34&#34;&gt;&lt;a href=&#34;#cb3-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (revLim == n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-35&#34;&gt;&lt;a href=&#34;#cb3-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        revLim = n;&lt;/span&gt;
&lt;span id=&#34;cb3-36&#34;&gt;&lt;a href=&#34;#cb3-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb3-37&#34;&gt;&lt;a href=&#34;#cb3-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i] = (&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-38&#34;&gt;&lt;a href=&#34;#cb3-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-39&#34;&gt;&lt;a href=&#34;#cb3-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-40&#34;&gt;&lt;a href=&#34;#cb3-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; NTT(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *g, &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; op, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb3-41&#34;&gt;&lt;a href=&#34;#cb3-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        getTr(n);&lt;/span&gt;
&lt;span id=&#34;cb3-42&#34;&gt;&lt;a href=&#34;#cb3-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; ull f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], w[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb3-43&#34;&gt;&lt;a href=&#34;#cb3-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        w[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-44&#34;&gt;&lt;a href=&#34;#cb3-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = (((ll)mod &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) + g[&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i]]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-45&#34;&gt;&lt;a href=&#34;#cb3-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; l &amp;lt; n; l &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb3-46&#34;&gt;&lt;a href=&#34;#cb3-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ull tG = qPow(op ? G : invG, (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / (l &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb3-47&#34;&gt;&lt;a href=&#34;#cb3-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) w[i] = w[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * tG % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-48&#34;&gt;&lt;a href=&#34;#cb3-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; n; k += (l &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb3-49&#34;&gt;&lt;a href=&#34;#cb3-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; p &amp;lt; l; ++p) {&lt;/span&gt;
&lt;span id=&#34;cb3-50&#34;&gt;&lt;a href=&#34;#cb3-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tt = w[p] * f[k | l | p] % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-51&#34;&gt;&lt;a href=&#34;#cb3-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[k | l | p] = f[k | p] + mod - tt;&lt;/span&gt;
&lt;span id=&#34;cb3-52&#34;&gt;&lt;a href=&#34;#cb3-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[k | p] += tt;&lt;/span&gt;
&lt;span id=&#34;cb3-53&#34;&gt;&lt;a href=&#34;#cb3-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb3-54&#34;&gt;&lt;a href=&#34;#cb3-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb3-55&#34;&gt;&lt;a href=&#34;#cb3-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] %= mod;&lt;/span&gt;
&lt;span id=&#34;cb3-56&#34;&gt;&lt;a href=&#34;#cb3-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb3-57&#34;&gt;&lt;a href=&#34;#cb3-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!op) {&lt;/span&gt;
&lt;span id=&#34;cb3-58&#34;&gt;&lt;a href=&#34;#cb3-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ull invn = qPow(n);&lt;/span&gt;
&lt;span id=&#34;cb3-59&#34;&gt;&lt;a href=&#34;#cb3-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = f[i] % mod * invn % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-60&#34;&gt;&lt;a href=&#34;#cb3-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = f[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-61&#34;&gt;&lt;a href=&#34;#cb3-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-62&#34;&gt;&lt;a href=&#34;#cb3-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-63&#34;&gt;&lt;a href=&#34;#cb3-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; mul(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *g, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb3-64&#34;&gt;&lt;a href=&#34;#cb3-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-65&#34;&gt;&lt;a href=&#34;#cb3-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-66&#34;&gt;&lt;a href=&#34;#cb3-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-67&#34;&gt;&lt;a href=&#34;#cb3-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-68&#34;&gt;&lt;a href=&#34;#cb3-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb3-69&#34;&gt;&lt;a href=&#34;#cb3-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C = A; C.resize(max(A.size(), B.size()));&lt;/span&gt;
&lt;span id=&#34;cb3-70&#34;&gt;&lt;a href=&#34;#cb3-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, B) C[i] = (C[i] + B[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-71&#34;&gt;&lt;a href=&#34;#cb3-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-72&#34;&gt;&lt;a href=&#34;#cb3-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-73&#34;&gt;&lt;a href=&#34;#cb3-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb3-74&#34;&gt;&lt;a href=&#34;#cb3-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C = A; C.resize(max(A.size(), B.size()));&lt;/span&gt;
&lt;span id=&#34;cb3-75&#34;&gt;&lt;a href=&#34;#cb3-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, B) C[i] = (C[i] + mod - B[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-76&#34;&gt;&lt;a href=&#34;#cb3-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-77&#34;&gt;&lt;a href=&#34;#cb3-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-78&#34;&gt;&lt;a href=&#34;#cb3-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb3-79&#34;&gt;&lt;a href=&#34;#cb3-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C = A;&lt;/span&gt;
&lt;span id=&#34;cb3-80&#34;&gt;&lt;a href=&#34;#cb3-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, A) C[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * c * C[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-81&#34;&gt;&lt;a href=&#34;#cb3-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-82&#34;&gt;&lt;a href=&#34;#cb3-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-83&#34;&gt;&lt;a href=&#34;#cb3-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb3-84&#34;&gt;&lt;a href=&#34;#cb3-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly ret; ret.resize(A.size());&lt;/span&gt;
&lt;span id=&#34;cb3-85&#34;&gt;&lt;a href=&#34;#cb3-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, A) ret[i] = mod - A[i];&lt;/span&gt;
&lt;span id=&#34;cb3-86&#34;&gt;&lt;a href=&#34;#cb3-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb3-87&#34;&gt;&lt;a href=&#34;#cb3-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-88&#34;&gt;&lt;a href=&#34;#cb3-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-89&#34;&gt;&lt;a href=&#34;#cb3-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb3-90&#34;&gt;&lt;a href=&#34;#cb3-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], b[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb3-91&#34;&gt;&lt;a href=&#34;#cb3-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cpy(a, &amp;amp;A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], A.size());&lt;/span&gt;
&lt;span id=&#34;cb3-92&#34;&gt;&lt;a href=&#34;#cb3-92&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cpy(b, &amp;amp;B[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], B.size());&lt;/span&gt;
&lt;span id=&#34;cb3-93&#34;&gt;&lt;a href=&#34;#cb3-93&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C; C.resize(min(lim, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(A.size() + B.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)));&lt;/span&gt;
&lt;span id=&#34;cb3-94&#34;&gt;&lt;a href=&#34;#cb3-94&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (n = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; n &amp;lt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(A.size() + B.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); n &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-95&#34;&gt;&lt;a href=&#34;#cb3-95&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        NTT(a, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n), NTT(b, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb3-96&#34;&gt;&lt;a href=&#34;#cb3-96&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        mul(a, b, n), NTT(a, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb3-97&#34;&gt;&lt;a href=&#34;#cb3-97&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cpy(&amp;amp;C[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], a, C.size());&lt;/span&gt;
&lt;span id=&#34;cb3-98&#34;&gt;&lt;a href=&#34;#cb3-98&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        clr(a, n), clr(b, n);&lt;/span&gt;
&lt;span id=&#34;cb3-99&#34;&gt;&lt;a href=&#34;#cb3-99&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-100&#34;&gt;&lt;a href=&#34;#cb3-100&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-101&#34;&gt;&lt;a href=&#34;#cb3-101&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-102&#34;&gt;&lt;a href=&#34;#cb3-102&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polyInv(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, Poly &amp;amp;B, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb3-103&#34;&gt;&lt;a href=&#34;#cb3-103&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-104&#34;&gt;&lt;a href=&#34;#cb3-104&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) B.push_back(qPow(A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]));&lt;/span&gt;
&lt;span id=&#34;cb3-105&#34;&gt;&lt;a href=&#34;#cb3-105&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb3-106&#34;&gt;&lt;a href=&#34;#cb3-106&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            polyInv(A, B, --n);&lt;/span&gt;
&lt;span id=&#34;cb3-107&#34;&gt;&lt;a href=&#34;#cb3-107&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sav = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-108&#34;&gt;&lt;a href=&#34;#cb3-108&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sav = (sav + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * B[i] * A[n - i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-109&#34;&gt;&lt;a href=&#34;#cb3-109&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            B.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * sav * qPow(mod - A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]) % mod);&lt;/span&gt;
&lt;span id=&#34;cb3-110&#34;&gt;&lt;a href=&#34;#cb3-110&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb3-111&#34;&gt;&lt;a href=&#34;#cb3-111&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            polyInv(A, B, n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-112&#34;&gt;&lt;a href=&#34;#cb3-112&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            Poly sA; sA.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb3-113&#34;&gt;&lt;a href=&#34;#cb3-113&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cpy(&amp;amp;sA[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], &amp;amp;A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], n);&lt;/span&gt;
&lt;span id=&#34;cb3-114&#34;&gt;&lt;a href=&#34;#cb3-114&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            B = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * B - B * B * sA;&lt;/span&gt;
&lt;span id=&#34;cb3-115&#34;&gt;&lt;a href=&#34;#cb3-115&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            B.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb3-116&#34;&gt;&lt;a href=&#34;#cb3-116&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb3-117&#34;&gt;&lt;a href=&#34;#cb3-117&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-118&#34;&gt;&lt;a href=&#34;#cb3-118&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-119&#34;&gt;&lt;a href=&#34;#cb3-119&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly polyInv(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb3-120&#34;&gt;&lt;a href=&#34;#cb3-120&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C; polyInv(A, C, A.size());&lt;/span&gt;
&lt;span id=&#34;cb3-121&#34;&gt;&lt;a href=&#34;#cb3-121&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-122&#34;&gt;&lt;a href=&#34;#cb3-122&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-123&#34;&gt;&lt;a href=&#34;#cb3-123&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-124&#34;&gt;&lt;a href=&#34;#cb3-124&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; inv[maxn];&lt;/span&gt;
&lt;span id=&#34;cb3-125&#34;&gt;&lt;a href=&#34;#cb3-125&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; initInv() {&lt;/span&gt;
&lt;span id=&#34;cb3-126&#34;&gt;&lt;a href=&#34;#cb3-126&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        inv[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-127&#34;&gt;&lt;a href=&#34;#cb3-127&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, lim) inv[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * inv[mod % i] * (mod - mod / i) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-128&#34;&gt;&lt;a href=&#34;#cb3-128&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-129&#34;&gt;&lt;a href=&#34;#cb3-129&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-130&#34;&gt;&lt;a href=&#34;#cb3-130&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-131&#34;&gt;&lt;a href=&#34;#cb3-131&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly deri(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb3-132&#34;&gt;&lt;a href=&#34;#cb3-132&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C = A;&lt;/span&gt;
&lt;span id=&#34;cb3-133&#34;&gt;&lt;a href=&#34;#cb3-133&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)C.size(); ++i) C[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * C[i] * i % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-134&#34;&gt;&lt;a href=&#34;#cb3-134&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!C.empty()) C.pop_back();&lt;/span&gt;
&lt;span id=&#34;cb3-135&#34;&gt;&lt;a href=&#34;#cb3-135&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-136&#34;&gt;&lt;a href=&#34;#cb3-136&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-137&#34;&gt;&lt;a href=&#34;#cb3-137&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-138&#34;&gt;&lt;a href=&#34;#cb3-138&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly ints(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb3-139&#34;&gt;&lt;a href=&#34;#cb3-139&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C = A;&lt;/span&gt;
&lt;span id=&#34;cb3-140&#34;&gt;&lt;a href=&#34;#cb3-140&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)C.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; --i)&lt;/span&gt;
&lt;span id=&#34;cb3-141&#34;&gt;&lt;a href=&#34;#cb3-141&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            C[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * C[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * inv[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-142&#34;&gt;&lt;a href=&#34;#cb3-142&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!C.empty()) C[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-143&#34;&gt;&lt;a href=&#34;#cb3-143&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb3-144&#34;&gt;&lt;a href=&#34;#cb3-144&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-145&#34;&gt;&lt;a href=&#34;#cb3-145&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-146&#34;&gt;&lt;a href=&#34;#cb3-146&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly polyLn(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb3-147&#34;&gt;&lt;a href=&#34;#cb3-147&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ints(deri(A) * polyInv(A));&lt;/span&gt;
&lt;span id=&#34;cb3-148&#34;&gt;&lt;a href=&#34;#cb3-148&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-149&#34;&gt;&lt;a href=&#34;#cb3-149&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-150&#34;&gt;&lt;a href=&#34;#cb3-150&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polyExp(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, Poly &amp;amp;B, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb3-151&#34;&gt;&lt;a href=&#34;#cb3-151&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-152&#34;&gt;&lt;a href=&#34;#cb3-152&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) B.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-153&#34;&gt;&lt;a href=&#34;#cb3-153&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb3-154&#34;&gt;&lt;a href=&#34;#cb3-154&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            polyExp(A, B, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); n -= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-155&#34;&gt;&lt;a href=&#34;#cb3-155&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sav = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-156&#34;&gt;&lt;a href=&#34;#cb3-156&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) sav = (sav + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * A[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod * B[n - i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-157&#34;&gt;&lt;a href=&#34;#cb3-157&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            B.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * sav * inv[n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod);&lt;/span&gt;
&lt;span id=&#34;cb3-158&#34;&gt;&lt;a href=&#34;#cb3-158&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb3-159&#34;&gt;&lt;a href=&#34;#cb3-159&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            polyExp(A, B, n / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-160&#34;&gt;&lt;a href=&#34;#cb3-160&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            Poly lnB = B;&lt;/span&gt;
&lt;span id=&#34;cb3-161&#34;&gt;&lt;a href=&#34;#cb3-161&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            lnB.resize(n); lnB = polyLn(lnB);&lt;/span&gt;
&lt;span id=&#34;cb3-162&#34;&gt;&lt;a href=&#34;#cb3-162&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            VEC(i, lnB) lnB[i] = (mod + A[i] - lnB[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb3-163&#34;&gt;&lt;a href=&#34;#cb3-163&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ++lnB[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb3-164&#34;&gt;&lt;a href=&#34;#cb3-164&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            B = B * lnB;&lt;/span&gt;
&lt;span id=&#34;cb3-165&#34;&gt;&lt;a href=&#34;#cb3-165&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            B.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb3-166&#34;&gt;&lt;a href=&#34;#cb3-166&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb3-167&#34;&gt;&lt;a href=&#34;#cb3-167&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-168&#34;&gt;&lt;a href=&#34;#cb3-168&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-169&#34;&gt;&lt;a href=&#34;#cb3-169&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-170&#34;&gt;&lt;a href=&#34;#cb3-170&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly polyExp(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;f) {&lt;/span&gt;
&lt;span id=&#34;cb3-171&#34;&gt;&lt;a href=&#34;#cb3-171&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly ret;&lt;/span&gt;
&lt;span id=&#34;cb3-172&#34;&gt;&lt;a href=&#34;#cb3-172&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        polyExp(f, ret, f.size());&lt;/span&gt;
&lt;span id=&#34;cb3-173&#34;&gt;&lt;a href=&#34;#cb3-173&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb3-174&#34;&gt;&lt;a href=&#34;#cb3-174&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-175&#34;&gt;&lt;a href=&#34;#cb3-175&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef int&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-176&#34;&gt;&lt;a href=&#34;#cb3-176&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; poly;&lt;/span&gt;
&lt;span id=&#34;cb3-177&#34;&gt;&lt;a href=&#34;#cb3-177&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-178&#34;&gt;&lt;a href=&#34;#cb3-178&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; fastIO {&lt;/span&gt;
&lt;span id=&#34;cb3-179&#34;&gt;&lt;a href=&#34;#cb3-179&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxc = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;23&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-180&#34;&gt;&lt;a href=&#34;#cb3-180&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; obuf[maxc], *__pO = obuf;&lt;/span&gt;
&lt;span id=&#34;cb3-181&#34;&gt;&lt;a href=&#34;#cb3-181&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; putchar(&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c) {*__pO++ = c;}&lt;/span&gt;
&lt;span id=&#34;cb3-182&#34;&gt;&lt;a href=&#34;#cb3-182&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; print(T x) {&lt;/span&gt;
&lt;span id=&#34;cb3-183&#34;&gt;&lt;a href=&#34;#cb3-183&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), print(-x);&lt;/span&gt;
&lt;span id=&#34;cb3-184&#34;&gt;&lt;a href=&#34;#cb3-184&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb3-185&#34;&gt;&lt;a href=&#34;#cb3-185&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;gt; &lt;span class=&#34;dv&#34;&gt;9&lt;/span&gt;) print(x / &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-186&#34;&gt;&lt;a href=&#34;#cb3-186&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            putchar(x % &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-187&#34;&gt;&lt;a href=&#34;#cb3-187&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb3-188&#34;&gt;&lt;a href=&#34;#cb3-188&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-189&#34;&gt;&lt;a href=&#34;#cb3-189&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-190&#34;&gt;&lt;a href=&#34;#cb3-190&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; print(Poly A) {&lt;/span&gt;
&lt;span id=&#34;cb3-191&#34;&gt;&lt;a href=&#34;#cb3-191&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, A) print(A[i]), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-192&#34;&gt;&lt;a href=&#34;#cb3-192&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-193&#34;&gt;&lt;a href=&#34;#cb3-193&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-194&#34;&gt;&lt;a href=&#34;#cb3-194&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-195&#34;&gt;&lt;a href=&#34;#cb3-195&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; output() {fwrite(obuf, __pO - obuf, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, stdout);}&lt;/span&gt;
&lt;span id=&#34;cb3-196&#34;&gt;&lt;a href=&#34;#cb3-196&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; fastIO;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>å¤šé¡¹å¼å…¨å®¶æ¡¶ç¬”è®°</title>
        <link>https://oi.imyangty.com/note-poly/</link>
        <pubDate>Sat, 13 Mar 2021 12:41:09 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/note-poly/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg23.webp" alt="Featured image of post å¤šé¡¹å¼å…¨å®¶æ¡¶ç¬”è®°" /&gt;&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;updï¼šç¬”è€…å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™æ°´å¹³ä¸è¶³ï¼Œåœ¨çœé€‰åå¯èƒ½ä¼šè€ƒè™‘é‡æ„ï¼Œå¹¶å°†ç”Ÿæˆå‡½æ•°è®¡æ•°å’Œå½¢å¼å¹‚çº§æ•°ç§‘æŠ€åˆ†å¼€ã€‚&lt;/p&gt;
&lt;p&gt;å¤šé¡¹å¼å…¨å®¶æ¡¶çš„æ€»ç»“ç¬”è®°ã€‚ç¯‡å¹…æé•¿ï¼Œå–„ç”¨ TOC è¿›è¡Œè·³è½¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ‰é”™æ¼ä¹‹å¤„çƒ¦è¯·æŒ‡å‡ºã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¼€å§‹å…¨å®¶æ¡¶ä¹‹å‰&#34;&gt;å¼€å§‹å…¨å®¶æ¡¶ä¹‹å‰&lt;/h2&gt;
&lt;h3 id=&#34;å½¢å¼åŒ–å®šä¹‰&#34;&gt;å½¢å¼åŒ–å®šä¹‰&lt;/h3&gt;
&lt;p&gt;çº¦å®šï¼š&lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt;ï¼ˆæˆ–è€… &lt;span class=&#34;math inline&#34;&gt;\([x^i]f(x)\)&lt;/span&gt;ï¼‰è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x^i\)&lt;/span&gt; å¤„çš„ç³»æ•°ï¼Œå³ä¸€ä¸ªå¤šé¡¹å¼å¯ä»¥è¡¨ç¤ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle\sum_{i = 0} f_ix^i\)&lt;/span&gt; çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ä¸ªå¤šé¡¹å¼çš„åŠ å‡æ³•å®šä¹‰ä¸º&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x) \pm g(x) = \sum_{i = 0}(f_i \pm g_i)x^i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸¤ä¸ªå¤šé¡¹å¼çš„ä¹˜æ³•ï¼ˆåŠ æ³•å·ç§¯ï¼‰å®šä¹‰ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x)*g(x) = \sum_{i = 0}x^i\sum_{j = 0}f_jg_{i - j}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°å…¶æ­£ç¡®æ€§ã€‚å¯ä»¥æ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸‹å¤šé¡¹å¼çš„ä¹˜æ³•çœ‹çœ‹æ˜¯ä¸æ˜¯è¿™æ ·å­çš„ã€‚å…¶æœ¬è´¨ä¹Ÿå°±æ˜¯å·å®Œä¹‹ååˆå¹¶åŒç±»é¡¹ã€‚æœ´ç´ çš„åšçš„è¯å¤æ‚åº¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„ï¼Œä¸‹é¢è¦è®²çš„ FFT/NTT å¯ä»¥åŠ é€Ÿåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç•Œ&#34;&gt;ç•Œ&lt;/h3&gt;
&lt;p&gt;æœ‰äº›æ—¶å€™ï¼Œé¢˜ç›®åªå¯¹å¤šé¡¹å¼çš„å‰è‹¥å¹²é¡¹æ„Ÿå…´è¶£ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™è¿ç®—è®¾å®šä¸€ä¸ªä¸Šç•Œï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(\pmod{x^n}\)&lt;/span&gt;ã€‚æ„æ€å°±æ˜¯&lt;strong&gt;åªè€ƒè™‘è¿™ä¸ªå¤šé¡¹å¼çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; é¡¹&lt;/strong&gt;ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(x^n\)&lt;/span&gt; å¼€å§‹ä»¥åçš„å…¨éƒ¨èˆæ‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°ç”±åŠ æ³•å’Œä¹˜æ³•æ˜¯ä»ä½ä½åˆ°é«˜ä½è´¡çŒ®çš„ï¼Œæ‰€ä»¥&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
(f(x) \bmod{x^n} \pm g(x)\bmod{x^n})\bmod{x^n} &amp;amp;= (f(x) \pm g(x))\bmod{x^n}\\
(f(x) \bmod{x^n}) * (g(x)\bmod{x^n})\bmod{x^n} &amp;amp;= (f(x) * g(x))\bmod{x^n}\\
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å­¦ä¹ å¤šé¡¹å¼çš„å„ç§æ“ä½œå§&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå‚…é‡Œå¶å˜æ¢fft&#34;&gt;å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFFT)&lt;/h2&gt;
&lt;p&gt;FFT å¯ä»¥åŠ é€Ÿå·ç§¯ï¼Œè®©æ—¶é—´å¤æ‚åº¦ä» &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; é™åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ï¼Œå­¦ä¹  FFT çš„åŸºç¡€æ“ä½œå‰ï¼Œéœ€è¦å…ˆäº†è§£å¤æ•°ï¼Œå› ä¸º FFT å°±æ˜¯åŸºäºå•ä½å¤æ•°æ ¹çš„è‰¯å¥½æ€§è´¨å®ç°çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤æ•°åŸºç¡€&#34;&gt;å¤æ•°åŸºç¡€&lt;/h3&gt;
&lt;p&gt;ï¼ˆæ•°å­¦æ—§äººæ•™é€‰ä¿® 2-2 å†…å®¹ï¼‰&lt;/p&gt;
&lt;p&gt;å®šä¹‰è™šæ•°å•ä½ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm i = \sqrt{-1}\)&lt;/span&gt;ï¼ŒæŠŠå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(a + b\mathrm i\:(a,b\in\mathbb R)\)&lt;/span&gt; çš„æ•°ç§°ä¸ºå¤æ•°ï¼Œæ‰€æœ‰å¤æ•°çš„é›†åˆç§°ä¸ºå¤æ•°é›† &lt;span class=&#34;math inline&#34;&gt;\(\mathbb C\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ•°ä¸€èˆ¬ä½¿ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(z\)&lt;/span&gt; è¡¨ç¤ºï¼Œè¡¨ç¤ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(z = a + b\mathrm i\)&lt;/span&gt;ï¼Œè¿™ç§å½¢å¼ç§°ä¸ºå¤æ•°çš„ä»£æ•°å½¢å¼ã€‚&lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; è¢«ç§°ä¸ºå¤æ•°çš„å®éƒ¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ç§°ä¸ºå¤æ•°çš„è™šéƒ¨ï¼ŒæœªåŠ è¯´æ˜çš„æƒ…å†µä¸‹ä¸€èˆ¬è®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\in\mathbb R\)&lt;/span&gt;ã€‚å¾ˆæ˜æ˜¾åœ°ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(a = 0\land b\not=0\)&lt;/span&gt; æ—¶ï¼Œè¿™ä¸ªå¤æ•°ä¸ºçº¯è™šæ•°ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(b=0\)&lt;/span&gt; æ—¶ï¼Œè¿™ä¸ªå¤æ•°ä¸ºå®æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå¤æ•° &lt;span class=&#34;math inline&#34;&gt;\(a + b\mathrm i\)&lt;/span&gt; éƒ½èƒ½å¯¹åº”å¹³é¢ç›´è§’åæ ‡ç³»é‡Œé¢çš„ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((a,b)\)&lt;/span&gt;ï¼ŒåŒæ ·çš„ä¹Ÿå¯ä»¥å¯¹åº”ä¸€ä¸ªå‘é‡ &lt;span class=&#34;math inline&#34;&gt;\((a,b)\)&lt;/span&gt;ã€‚æ•…å®šä¹‰å¤æ•°çš„æ¨¡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{a^2 + b^2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰å¤æ•°çš„åŠ æ³•ä¸ä¹˜æ³•ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
&amp;amp;(a + b\mathrm i) + (c + d\mathrm i)\\
=&amp;amp;(a + c) + (b + d)\mathrm i
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
&amp;amp;(a+b\mathrm i)(c + d\mathrm i)\\
=&amp;amp;ac + ad\mathrm i + cb\mathrm i + bd\mathrm i^2\\
=&amp;amp;(ac - bd) + (ad + bc)\mathrm i
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è¿™éƒ½æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ã€‚&lt;/p&gt;
&lt;p&gt;å®¹æ˜“çœ‹å‡ºå¤æ•°æ»¡è¶³å¾ˆå¤šå®æ•°çš„è¿ç®—å¾‹ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰å¤æ•° &lt;span class=&#34;math inline&#34;&gt;\(z=a+b\mathrm i\)&lt;/span&gt; çš„å…±è½­å¤æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\overline{z} = a - b\mathrm i\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(z\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(\overline{z}\)&lt;/span&gt; å…³äºå®è½´å¯¹ç§°ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
z\overline z=(a+b\mathrm i)(a-b\mathrm i) = a^2 + b^2=|z|^2
\]&lt;/span&gt; å¤æ•°æ—¢ç„¶å¯ä»¥å¯¹åº”å¹³é¢ç›´è§’åæ ‡ç³»ä¸­çš„å‘é‡ï¼Œä¸éš¾å‘ç°å…¶å¯ä»¥ä½¿ç”¨å…¶æ¨¡é•¿ä¸è¾è§’æ¥è¡¨ç¤ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
z=a+b\mathrm i\iff z = r(\cos\theta+\mathrm i\sin\theta)
\]&lt;/span&gt; å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(z\)&lt;/span&gt; çš„æ¨¡é•¿ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\theta\)&lt;/span&gt; ä¸ºå…¶è¾è§’ã€‚å³æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå¤æ•°è¡¨ç¤ºæˆäºŒå…ƒç»„ &lt;span class=&#34;math inline&#34;&gt;\((r,\theta)\)&lt;/span&gt; çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨è€ƒè™‘ä¸¤ä¸ªå¤æ•° &lt;span class=&#34;math inline&#34;&gt;\((r_1,\theta_1)\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\((r_2,\theta_2)\)&lt;/span&gt; ç›¸ä¹˜å¾—åˆ°çš„ç»“æœï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
(r_1,\theta_1)\times(r_2,\theta_2) &amp;amp;= r_1(\cos\theta_1 + \mathrm i\sin\theta_1)r_2(\cos\theta_2 + \mathrm i\sin\theta_2)\\
&amp;amp;=r_1r_2(\cos\theta_1\cos\theta_2 - \sin\theta_1\sin\theta_2 + \mathrm i\sin\theta_1\cos\theta_2 + \mathrm i\sin\theta_2\cos\theta_1)\\
&amp;amp;=r_1r_2\left(\cos(\theta_1 + \theta_2) + \mathrm i\sin(\theta_1 + \theta_2)\right)\\
&amp;amp;=(r_1r_2,\theta_1 + \theta_2)
\end{aligned}
\]&lt;/span&gt; äºæ˜¯æˆ‘ä»¬å¯ä»¥æ¦‚æ‹¬å¤æ•°ä¹˜æ³•çš„æ³•åˆ™ï¼šæ¨¡é•¿ç›¸ä¹˜ï¼Œè¾è§’ç›¸åŠ ã€‚ï¼ˆä¸Šè¿°æ¨å¯¼éœ€è¦æŒæ¡åŸºæœ¬çš„ä¸‰è§’æ’ç­‰å˜æ¢ï¼‰&lt;/p&gt;
&lt;h3 id=&#34;ä»æ¬§æ‹‰å…¬å¼åˆ°å•ä½åœ†&#34;&gt;ä»æ¬§æ‹‰å…¬å¼åˆ°å•ä½åœ†&lt;/h3&gt;
&lt;p&gt;ç»™å‡ºå¤æ•°æŒ‡æ•°å¹‚çš„å®šä¹‰ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\mathrm e^{x +y\mathrm i} = e^x(\cos y + \mathrm i\sin y)
\]&lt;/span&gt; è¿™ä¸ªå…¬å¼æ˜¯åŸºäºå¦‚ä¸‹äº‹å®ï¼ˆå¯ä»¥ç†è§£ä¸ºè¿™å‡ ä¸ªå‡½æ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x = 0\)&lt;/span&gt; å¤„çš„æ³°å‹’å±•å¼€ï¼‰ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\sin(x) &amp;amp;= x - \frac{x^3}{3!}+\frac{x^5}{5!} - \frac{x^7}{7!} + \frac{x^9}{9!} + \cdots = \sum_{k = 1}^\infty\frac{(-1)^{k - 1}x^{2k - 1}}{(2k-1)!}\\
\cos(x) &amp;amp;= 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \frac{x^8}{8!} + \cdots = \sum_{k = 0}^\infty\frac{(-1)^{k} x^{2k}}{(2k)!}\\
\mathrm e^x &amp;amp;= 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots = \sum_{k = 0}^\infty\frac{x^k}{k!}
\end{aligned}
\]&lt;/span&gt; å°† &lt;span class=&#34;math inline&#34;&gt;\(x + y\mathrm i\)&lt;/span&gt; ä»£å…¥è¿›å»å³å¯æ¨å¯¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(x = 0\)&lt;/span&gt;ï¼Œæˆ‘ä»¬å°±å¾—åˆ°å¤§åé¼é¼çš„æ¬§æ‹‰å…¬å¼ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\mathrm e^{x\mathrm i} = \cos x + \mathrm i\sin x
\]&lt;/span&gt; æ›´ç‰¹æ®Šåœ°ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(x = \pi\)&lt;/span&gt;ï¼Œå¾—åˆ°çš„å°±æ˜¯ä¸‹é¢è¿™ä¸ªç¥å¥‡çš„å¼å­ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\mathrm e^{\pi\mathrm i} = -1
\]&lt;/span&gt; å¤å¹³é¢ä¸Šæˆ‘ä»¬å¯ä»¥å®šä¹‰ç±»ä¼¼äºå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„å•ä½åœ†ï¼Œå•ä½åœ†ä¸Šçš„æ‰€æœ‰å¤æ•°æ„æˆé›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(\{z: |z| = 1\}\)&lt;/span&gt;ã€‚è¿™äº›å¤æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(\cos\theta + \mathrm i\sin\theta\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(e^{\theta \mathrm i}\)&lt;/span&gt; çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼çš„è¡¨ç¤ºæ³•&#34;&gt;å¤šé¡¹å¼çš„è¡¨ç¤ºæ³•&lt;/h3&gt;
&lt;p&gt;ç³»æ•°è¡¨ç¤ºæ³•ï¼šé¡¾åæ€ä¹‰ &lt;span class=&#34;math display&#34;&gt;\[
f(x) = a_0 + a_1x + a_2x^2 + \cdots + a_nx^n\iff f(x) = \{a_0,a_1,a_2,\cdots,a_n\} = 
\begin{bmatrix}
x^0 &amp;amp; x^1 &amp;amp; x^2 &amp;amp;\cdots &amp;amp; x^n
\end{bmatrix}
\begin{bmatrix}
a_0\\a_1\\a_2\\\vdots\\a_n
\end{bmatrix}
\]&lt;/span&gt; ç‚¹å€¼è¡¨ç¤ºæ³•ï¼š&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ç”±ä¸€ä¸ªå¤šé¡¹å¼åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(n + 1\)&lt;/span&gt; ä¸ªç‚¹ä¸Šçš„å–å€¼æ˜¯å¯ä»¥å”¯ä¸€ç¡®å®šä¸€ä¸ªå¤šé¡¹å¼çš„ï¼Œå…¶æœ¬è´¨ä¹Ÿå°±æ˜¯çº¿æ€§æ–¹ç¨‹ç»„çš„è§£ã€‚æ‰€ä»¥ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(n + 1\)&lt;/span&gt; ä¸ªç‚¹è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x) = \{(x_0,y_0),(x_1,y_1),\cdots,(x_n,y_n)\}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{bmatrix}
x_0^0 &amp;amp; x_0^1 &amp;amp; x_0^2 &amp;amp;\cdots &amp;amp;x_0^n\\
x_1^0 &amp;amp; x_1^1 &amp;amp; x_1^2 &amp;amp;\cdots &amp;amp; x_1^n\\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp;\vdots\\
x_n^0 &amp;amp; x_n^1 &amp;amp; x_n^2 &amp;amp; \cdots &amp;amp; x_n^n
\end{bmatrix}\begin{bmatrix}
a_0\\a_1\\ \vdots \\ a_n
\end{bmatrix}
=\begin{bmatrix}
y_0\\y_1\\ \vdots\\ y_n
\end{bmatrix}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä¸‹é¢çš„è¿™ä¸ªå½¢å¼æˆ‘ä»¬çœ‹å¾—å‡ºæ¥å…¶å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„çº¿æ€§æ–¹ç¨‹ç»„çš„å½¢å¼ï¼Œä¸éš¾è¯æ˜å…¶è§£çš„å”¯ä¸€æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”æˆ‘ä»¬å‘ç°ç‚¹å€¼è¡¨ç¤ºæ³•æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ä¼˜åŠ¿ï¼šå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„æ—¶é—´å†…å°†ä¸¤ä¸ªå¤šé¡¹å¼ä¹˜èµ·æ¥ï¼Œåªéœ€æŠŠå¯¹åº”ç‚¹çš„ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; ä¹˜èµ·æ¥å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;é€šä¿—çš„æ¥è¯´ï¼ŒFFT å®ç°çš„å°±æ˜¯å¿«é€Ÿæ±‚å¤šé¡¹å¼ä¹˜æ³•çš„è¿‡ç¨‹ï¼šå…ˆæŠŠç³»æ•°è¡¨ç¤ºæ³•è½¬æˆç‚¹å€¼è¡¨ç¤ºæ³•ï¼ˆDFTï¼Œç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼‰ï¼Œä¹˜å®Œä¹‹åå†æŠŠç‚¹å€¼è¿˜åŸä¸ºæ’å€¼ï¼ˆIDFTï¼Œç¦»æ•£å‚…é‡Œå¶é€†å˜æ¢ï¼‰ã€‚å¯æ˜¯æœ´ç´ çš„ DFT éœ€è¦çš„æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ï¼ŒIDFT è¿˜å›å…¶ç³»æ•°éœ€è¦é«˜æ–¯æ¶ˆå…ƒæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; çš„ã€‚è€Œ FFT åˆ©ç”¨äº†ä¸€äº›å¾ˆç‰¹æ®Šå¾ˆç‰¹æ®Šçš„å€¼åŠ é€Ÿäº† DFT å’Œ IDFT çš„è¿‡ç¨‹ï¼Œä½¿å¾—æ€»æ—¶é—´å¤æ‚åº¦é™ä½åˆ°äº† &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å•ä½å¤æ•°æ ¹&#34;&gt;å•ä½å¤æ•°æ ¹&lt;/h3&gt;
&lt;p&gt;è§£è¿™ä¸ªæ–¹ç¨‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
x^n = 1
\]&lt;/span&gt; æˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªæ–¹ç¨‹åœ¨å®æ•°èŒƒå›´å†…åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æˆ–è€… &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä¸ªè§£ã€‚ç„¶è€Œä»£æ•°åŸºæœ¬å®šç†å‘Šè¯‰æˆ‘ä»¬è¿™æ ·çš„æ–¹ç¨‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå¤æ•°åŸŸä¸Šçš„è§£ã€‚ç”±æ¨¡é•¿ç›¸ä¹˜è¾è§’ç›¸åŠ æˆ‘ä»¬çŸ¥é“å› ä¸ºæœ€ç»ˆ &lt;span class=&#34;math inline&#34;&gt;\(x^n = 1\)&lt;/span&gt;ï¼Œæ‰€ä»¥è¿™äº›æ»¡è¶³æ¡ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æ¨¡é•¿å¿…å®šä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚ç„¶åéœ€è¦æ»¡è¶³ä»–ä»¬çš„è¾è§’çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å€èƒ½è¢« &lt;span class=&#34;math inline&#34;&gt;\(2\pi\)&lt;/span&gt; æ•´é™¤ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°å…¶å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ç­‰åˆ†å•ä½åœ†ï¼š&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;https://oi-wiki.org/math/poly/images/fft2.jpg&#34; alt=&#34;&#34; /&gt;&lt;figcaption&gt;img&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬è®° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å•ä½æ ¹çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\omega_n^k\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\omega_k^n = \mathrm e^{\frac{2k\pi i}{n}}\)&lt;/span&gt;ã€‚ç”±æ­¤å¯è§ï¼Œå•ä½å¤æ•°æ ¹å…·æœ‰ä¸€äº›éå¸¸å¥½çš„æ€§è´¨æ¯”å¦‚ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\omega_n^0 = \omega_n^n &amp;amp;= 1\\
\omega_n^k &amp;amp;= \omega_{2n}^{2k}\\
\omega_{2n}^{k + n} &amp;amp;= -\omega_{2n}^k\\
\left(\omega_{2n}^{k + n}\right)^2 &amp;amp;=\omega_n^k 
\end{aligned}
\]&lt;/span&gt; åˆ©ç”¨è¿™äº›æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥åŠ é€Ÿ DFT çš„è¿‡ç¨‹ã€‚FFT å°±æ˜¯åˆ©ç”¨åˆ†æ²»æ€æƒ³åŠ é€Ÿæ±‚æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f(\omega_n^k)\)&lt;/span&gt; çš„å€¼&lt;/p&gt;
&lt;h3 id=&#34;dft&#34;&gt;DFT&lt;/h3&gt;
&lt;p&gt;æ­¤æ—¶ DFT çš„åˆ†æ²»æ€æƒ³å°±æ˜¯åˆ†å¼€è€ƒè™‘å¥‡æ¬¡é¡¹å’Œå¶æ¬¡é¡¹ï¼š&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math display&#34;&gt;\[
f(x) = a_0x^0 + a_1x^1 + a_2x^2 + \cdots
\]&lt;/span&gt; å°†å…¶åˆ†ä¸ºä¸¤ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f(x) &amp;amp;= a_0x^0 + a_2x^2 + a_4x^4 + a_6x^6 + a_8x^8 + \cdots +a_1x^1 + a_3x^3 + a_5x^5 + a_7x^7 + a_9x^9 + \cdots\\
&amp;amp;= a_0x^0 + a_2x^2 + a_4x^4 + a_6x^6 + a_8x^8+\cdots +x(a_1x^0 + a_3x^2 + a_5x^4 + a_7x^6 + \cdots)
\end{aligned}
\]&lt;/span&gt; è€ƒè™‘ä¸¤ä¸ªæ–°å¤šé¡¹å¼ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_0(x) &amp;amp;= a_0x^0 + a_2x^1 + a_4x^2 + a_6x^3 + \cdots\\
f_1(x) &amp;amp;= a_1x^0 + a_3x^1 + a_5x^2 + a_7x^3 + \cdots
\end{aligned}
\]&lt;/span&gt; ä¸éš¾å‘ç° &lt;span class=&#34;math display&#34;&gt;\[
f(x) = f_0(x^2) + xf_1(x^2)
\]&lt;/span&gt; åˆ©ç”¨å•ä½å¤æ•°æ ¹çš„æ€§è´¨ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\mathrm{DFT}(f(\omega_n^k)) &amp;amp;= \mathrm{DFT}(f_0(\omega_n^{2k})) + \omega_n^k\mathrm{DFT}(f_1(\omega_n^{2k}))\\
&amp;amp;=\mathrm{DFT}(f_0(\omega_{\frac n2^k})) + \omega_n^k\mathrm{DFT}(f_1(\omega_{\frac n2^k}))
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\mathrm{DFT}(f(\omega_n^{k + \frac n2})) &amp;amp;= \mathrm{DFT}(f_0(\omega_n^{2k + n})) + \omega_{n}^{k + \frac n2}\mathrm{DFT}(f_1(\omega_n^{2k + n}))\\
&amp;amp;=\mathrm{DFT}(f_0(\omega_n^n\omega_n^{2k})) - \omega_n^k\mathrm{DFT}(f_1(\omega_n^n\omega_n^{2k}))\\
&amp;amp;=\mathrm{DFT}(f_0(\omega_{\frac n2^k})) - \omega_n^k\mathrm{DFT}(f_1(\omega_{\frac n2^k}))
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(k &amp;lt; \displaystyle\frac n2\)&lt;/span&gt;ã€‚ä¸éš¾å‘ç°åªè¦æˆ‘ä»¬æ±‚å¾—å‡º &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{DFT}(f_0(\omega_{\frac n2^k}))\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{DFT}(f_1(\omega_{\frac n2^k}))\)&lt;/span&gt; çš„è¯ï¼Œå°±å¯ä»¥åŒæ—¶æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{DFT}(f(\omega_n^k))\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{DFT}(f(\omega_n^{k + \frac n2}))\)&lt;/span&gt;ã€‚æ¥ä¸‹æ¥å†å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(f_0\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(f_1\)&lt;/span&gt; é€’å½’ DFT å³å¯ã€‚å…¶æ—¶é—´å¤æ‚åº¦å‡½æ•°æ˜¯å½¢å¦‚ä¸‹é¢è¿™æ ·çš„ï¼š &lt;span class=&#34;math display&#34;&gt;\[
T(n) = T(n/2) + O(n)
\]&lt;/span&gt; æ‰€ä»¥æ€»å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Theta(n\log n)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å®é™…å®ç°çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ä¼ è¿›å»çš„ç³»æ•°ä¸€å®šè¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2^m\)&lt;/span&gt; ä¸ªçš„ï¼Œä¸ç„¶åˆ†æ²»çš„è¿‡ç¨‹ä¸­å·¦å³ä¸ä¸€æ ·ä¼šå‡ºé—®é¢˜ã€‚ç¬¬ä¸€æ¬¡ä¼ è¿›å»çš„æ—¶å€™å°±é«˜ä½è¡¥ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œè¡¥æˆæœ€é«˜é¡¹æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^{m - 1}\)&lt;/span&gt; çš„å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dft(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, complex *a)&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (lim == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//å¸¸æ•°é¡¹ç›´æ¥è¿”å›&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    complex a1[lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], a2[lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt; lim; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a1[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = a[i], a2[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;span class=&#34;co&#34;&gt;//æŠŠç³»æ•°æŒ‰ç…§å¥‡å¶åˆ†å¼€&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a1, type);&lt;span class=&#34;co&#34;&gt;//æ±‚ DFT(f_0())&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a2, type);&lt;span class=&#34;co&#34;&gt;//æ±‚ DFT(f_1())&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    complex Wn = complex(cos(&lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; * pi / lim), sin(&lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; * pi / lim)), w = complex(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt; (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); ++i, w = w * Wn)&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a1[i] + w * a2[i];&lt;span class=&#34;co&#34;&gt;//æ±‚ DFT(f(\omega_n^k))&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i + (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)] = a1[i] - w * a2[i];&lt;span class=&#34;co&#34;&gt;//æ±‚ DFT(f(\omega_n^{k+\fracn2}))&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;idft&#34;&gt;IDFT&lt;/h3&gt;
&lt;p&gt;å¥½äº†ç°åœ¨å‡è£…æˆ‘ä»¬å·²ç»æ±‚å‡ºäº†ä¸¤ä¸ªå¤šé¡¹å¼çš„ç‚¹å€¼è¡¨è¾¾å¹¶å·²ç»å°†ä»–ä»¬ä¹˜èµ·æ¥ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆè¿˜æ˜¯è¦æŠŠä»–è¿˜åŸå›å»åˆ°ç³»æ•°è¡¨ç¤ºçš„ã€‚è¿™ä¸ªè¿‡ç¨‹å°±å«åš IDFTã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®å°±æ˜¯æˆ‘ä»¬éœ€è¦æ±‚è§£ä¸‹é¢å…³äº &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{bmatrix}
(\omega_n^0)^0 &amp;amp; (\omega_n^0)^1 &amp;amp; (\omega_n^0)^2 &amp;amp;\cdots &amp;amp;(\omega_n^0)^n\\
(\omega_n^1)^0 &amp;amp; (\omega_n^1)^1 &amp;amp; (\omega_n^1)^2 &amp;amp;\cdots &amp;amp; (\omega_n^1)^n\\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp;\vdots\\
(\omega_n^{n})^0 &amp;amp; (\omega_n^{n})^1 &amp;amp; (\omega_n^{n})^2 &amp;amp; \cdots &amp;amp; (\omega_n^n)^n
\end{bmatrix}
\begin{bmatrix}
a_0\\a_1\\ \vdots \\ a_n
\end{bmatrix}=\begin{bmatrix}
y_0\\y_1\\ \vdots\\ y_n
\end{bmatrix}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†å…¶ä¹˜ä¸Šå·¦è¾¹çŸ©é˜µçš„é€†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{bmatrix}
a_0\\a_1\\ \vdots \\ a_n
\end{bmatrix}=\begin{bmatrix}
(\omega_n^0)^0 &amp;amp; (\omega_n^0)^1 &amp;amp; (\omega_n^0)^2 &amp;amp;\cdots &amp;amp;(\omega_n^0)^n\\
(\omega_n^1)^0 &amp;amp; (\omega_n^1)^1 &amp;amp; (\omega_n^1)^2 &amp;amp;\cdots &amp;amp; (\omega_n^1)^n\\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp;\vdots\\
(\omega_n^{n})^0 &amp;amp; (\omega_n^{n})^1 &amp;amp; (\omega_n^{n})^2 &amp;amp; \cdots &amp;amp; (\omega_n^n)^n
\end{bmatrix}^{-1}
\begin{bmatrix}
y_0\\y_1\\ \vdots\\ y_n
\end{bmatrix}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ¨¡ç›¸åŒçš„æ­£äº¤åˆ—å‘é‡æ„æˆçš„çŸ©é˜µçš„é€†æ˜¯è½¬ç½®çš„æ¨¡åˆ†ä¹‹ä¸€å€ï¼Œæ‰€ä»¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{bmatrix}
(\omega_n^0)^0 &amp;amp; (\omega_n^0)^1 &amp;amp; (\omega_n^0)^2 &amp;amp;\cdots &amp;amp;(\omega_n^0)^n\\
(\omega_n^1)^0 &amp;amp; (\omega_n^1)^1 &amp;amp; (\omega_n^1)^2 &amp;amp;\cdots &amp;amp; (\omega_n^1)^n\\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp;\vdots\\
(\omega_n^{n})^0 &amp;amp; (\omega_n^{n})^1 &amp;amp; (\omega_n^{n})^2 &amp;amp; \cdots &amp;amp; (\omega_n^n)^n
\end{bmatrix}^{-1} =\frac {1}{n+1} \begin{bmatrix}
(\omega_n^{-0})^0 &amp;amp; (\omega_n^{-0})^1 &amp;amp; (\omega_n^{-0})^2 &amp;amp;\cdots &amp;amp;(\omega_n^{-0})^n\\
(\omega_n^{-1})^0 &amp;amp; (\omega_n^{-1})^1 &amp;amp; (\omega_n^{-1})^2 &amp;amp;\cdots &amp;amp; (\omega_n^{-1})^n\\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp;\vdots\\
(\omega_n^{-n})^0 &amp;amp; (\omega_n^{-n})^1 &amp;amp; (\omega_n^{-n})^2 &amp;amp; \cdots &amp;amp; (\omega_n^{-n})^n
\end{bmatrix}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä¸éš¾å‘ç°ï¼ŒIDFT å…¶å®å°±æ˜¯å†åšäº†ä¸€é DFTï¼Œåªä¸è¿‡æ˜¯åèµ·æ¥çš„ã€‚åªæ˜¯ç®—å‡ºæ¥æœ€åçš„ç³»æ•°ç»“æœéƒ½è¦é™¤ä»¥ç‚¹å€¼çš„ä¸ªæ•°ï¼Œåæ˜ åœ¨ä»£ç é‡Œé¢å°±æ˜¯é‚£ä¸ª &lt;code&gt;lim&lt;/code&gt; å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\omega_n^k\)&lt;/span&gt; çš„å…±è½­å°±æ˜¯è™šéƒ¨å–åï¼Œæ‰€ä»¥å¯ä»¥åœ¨ DFT å‡½æ•°é‡Œé¢ä¼ ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦ä¸º IDFTã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·å­ä¸€ä¸ªé€’å½’ç‰ˆçš„ FFT å°±å†™å®Œäº†ï¼Œæ€»ä½“çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb2-1&#34;&gt;&lt;a href=&#34;#cb2-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-2&#34;&gt;&lt;a href=&#34;#cb2-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-3&#34;&gt;&lt;a href=&#34;#cb2-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-4&#34;&gt;&lt;a href=&#34;#cb2-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb2-5&#34;&gt;&lt;a href=&#34;#cb2-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-6&#34;&gt;&lt;a href=&#34;#cb2-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-7&#34;&gt;&lt;a href=&#34;#cb2-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; pi = acos(-&lt;span class=&#34;fl&#34;&gt;1.0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-8&#34;&gt;&lt;a href=&#34;#cb2-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-9&#34;&gt;&lt;a href=&#34;#cb2-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb2-10&#34;&gt;&lt;a href=&#34;#cb2-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-11&#34;&gt;&lt;a href=&#34;#cb2-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb2-12&#34;&gt;&lt;a href=&#34;#cb2-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-13&#34;&gt;&lt;a href=&#34;#cb2-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb2-14&#34;&gt;&lt;a href=&#34;#cb2-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb2-15&#34;&gt;&lt;a href=&#34;#cb2-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb2-16&#34;&gt;&lt;a href=&#34;#cb2-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * s + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb2-17&#34;&gt;&lt;a href=&#34;#cb2-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; s;&lt;/span&gt;
&lt;span id=&#34;cb2-18&#34;&gt;&lt;a href=&#34;#cb2-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-19&#34;&gt;&lt;a href=&#34;#cb2-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-20&#34;&gt;&lt;a href=&#34;#cb2-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; complex&lt;/span&gt;
&lt;span id=&#34;cb2-21&#34;&gt;&lt;a href=&#34;#cb2-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-22&#34;&gt;&lt;a href=&#34;#cb2-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; x, y;&lt;/span&gt;
&lt;span id=&#34;cb2-23&#34;&gt;&lt;a href=&#34;#cb2-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    complex(&lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; xx = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; yy = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb2-24&#34;&gt;&lt;a href=&#34;#cb2-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb2-25&#34;&gt;&lt;a href=&#34;#cb2-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x = xx, y = yy;&lt;/span&gt;
&lt;span id=&#34;cb2-26&#34;&gt;&lt;a href=&#34;#cb2-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-27&#34;&gt;&lt;a href=&#34;#cb2-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb2-28&#34;&gt;&lt;a href=&#34;#cb2-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-29&#34;&gt;&lt;a href=&#34;#cb2-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;complex &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; complex(a.x + b.x, a.y + b.y);}&lt;/span&gt;
&lt;span id=&#34;cb2-30&#34;&gt;&lt;a href=&#34;#cb2-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;complex &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; complex(a.x - b.x, a.y - b.y);}&lt;/span&gt;
&lt;span id=&#34;cb2-31&#34;&gt;&lt;a href=&#34;#cb2-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;complex &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; complex(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);}&lt;/span&gt;
&lt;span id=&#34;cb2-32&#34;&gt;&lt;a href=&#34;#cb2-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-33&#34;&gt;&lt;a href=&#34;#cb2-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dft(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, complex *a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;span class=&#34;co&#34;&gt;//type = 1 DFTï¼›type = -1 IDFT&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-34&#34;&gt;&lt;a href=&#34;#cb2-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-35&#34;&gt;&lt;a href=&#34;#cb2-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (lim == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//è¿”å›å¸¸æ•°é¡¹&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-36&#34;&gt;&lt;a href=&#34;#cb2-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    complex a1[lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], a2[lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-37&#34;&gt;&lt;a href=&#34;#cb2-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt; lim; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb2-38&#34;&gt;&lt;a href=&#34;#cb2-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a1[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = a[i], a2[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-39&#34;&gt;&lt;a href=&#34;#cb2-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a1, type);&lt;/span&gt;
&lt;span id=&#34;cb2-40&#34;&gt;&lt;a href=&#34;#cb2-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a2, type);&lt;/span&gt;
&lt;span id=&#34;cb2-41&#34;&gt;&lt;a href=&#34;#cb2-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    complex Wn = complex(cos(&lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; * pi / lim), type * sin(&lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; * pi / lim)), w = complex(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-42&#34;&gt;&lt;a href=&#34;#cb2-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt; (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); ++i, w = w * Wn)&lt;/span&gt;
&lt;span id=&#34;cb2-43&#34;&gt;&lt;a href=&#34;#cb2-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb2-44&#34;&gt;&lt;a href=&#34;#cb2-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a1[i] + w * a2[i];&lt;/span&gt;
&lt;span id=&#34;cb2-45&#34;&gt;&lt;a href=&#34;#cb2-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i + (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)] = a1[i] - w * a2[i];&lt;/span&gt;
&lt;span id=&#34;cb2-46&#34;&gt;&lt;a href=&#34;#cb2-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-47&#34;&gt;&lt;a href=&#34;#cb2-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-48&#34;&gt;&lt;a href=&#34;#cb2-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-49&#34;&gt;&lt;a href=&#34;#cb2-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-50&#34;&gt;&lt;a href=&#34;#cb2-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb2-51&#34;&gt;&lt;a href=&#34;#cb2-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-52&#34;&gt;&lt;a href=&#34;#cb2-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb2-53&#34;&gt;&lt;a href=&#34;#cb2-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) a[i].x = read();&lt;/span&gt;
&lt;span id=&#34;cb2-54&#34;&gt;&lt;a href=&#34;#cb2-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, m) b[i].x = read();&lt;/span&gt;
&lt;span id=&#34;cb2-55&#34;&gt;&lt;a href=&#34;#cb2-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-56&#34;&gt;&lt;a href=&#34;#cb2-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//limä¸€å®šè¦å¤§äº n + m&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-57&#34;&gt;&lt;a href=&#34;#cb2-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim, a, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-58&#34;&gt;&lt;a href=&#34;#cb2-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim, b, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-59&#34;&gt;&lt;a href=&#34;#cb2-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb2-60&#34;&gt;&lt;a href=&#34;#cb2-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i] * b[i];&lt;span class=&#34;co&#34;&gt;//ç‚¹å€¼ä¹˜èµ·æ¥&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-61&#34;&gt;&lt;a href=&#34;#cb2-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dft(lim, a, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;span class=&#34;co&#34;&gt;//IDFTè¿˜å›å»&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-62&#34;&gt;&lt;a href=&#34;#cb2-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n + m)&lt;/span&gt;
&lt;span id=&#34;cb2-63&#34;&gt;&lt;a href=&#34;#cb2-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(a[i].x / lim + &lt;span class=&#34;fl&#34;&gt;0.5&lt;/span&gt;));&lt;span class=&#34;co&#34;&gt;//æœ€åè¦é™¤é‚£ä¸ªæ•°ç„¶åè¿˜åŸå›å»ï¼Œå››èˆäº”å…¥&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-64&#34;&gt;&lt;a href=&#34;#cb2-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-65&#34;&gt;&lt;a href=&#34;#cb2-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;ä½é€†åºç½®æ¢&#34;&gt;ä½é€†åºç½®æ¢&lt;/h3&gt;
&lt;p&gt;ç„¶è€Œï¼Œä¸Šé¢çš„ä»£ç è¿æ¨¡æ¿éƒ½è·‘ä¸è¿‡å»â€¦â€¦&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç»§ç»­ä¼˜åŒ– DFT çš„è¿‡ç¨‹ã€‚é€’å½’çš„è¿‡ç¨‹ä¸­å¼€äº†å¤§é‡çš„ç©ºé—´å¹¶ä¸”å¸¸æ•°å·¨å¤§ï¼Œè€ƒè™‘éé€’å½’å†™æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åªè€ƒè™‘æˆ‘ä»¬å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(7\)&lt;/span&gt; æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;é€’å½’çš„è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;pre class=&#34;plain&#34;&gt;&lt;code&gt;original        0   1   2   3   4   5   6   7
recursion#1     0   2   4   6   1   3   5   7
recursion#2     0   4   2   6   1   5   3   7
recursion#3     0   4   2   6   1   5   3   7
original bin    000 001 010 011 100 101 110 111
now bin         000 100 010 110 001 101 011 111&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯è§é€’å½’åˆ°æœ€åçš„ç»“æœæ— éå°±æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè½¬ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘éé€’å½’ï¼Œä¸€å¼€å§‹å°±å…ˆæŠŠæ‰€æœ‰çš„æ•°æ”¾åˆ°æœ€åçš„ä½ç½®ï¼Œç„¶åè¿­ä»£çš„æ—¶å€™ä¸€æ­¥æ­¥è¿˜å›å»å³å¯ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä½é€†åºç½®æ¢ï¼ˆè´è¶å˜æ¢ï¼‰&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¤„ç†å‡º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; äºŒè¿›åˆ¶ä½ç¿»è½¬ä¹‹åçš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt;ã€‚æ˜“çŸ¥ &lt;span class=&#34;math inline&#34;&gt;\(R(0) = 0\)&lt;/span&gt;ã€‚æˆ‘ä»¬å¯ä»¥ä»å°åˆ°å¤§æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt;ã€‚å¾ˆæ˜æ˜¾ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\lfloor x/2\rfloor\)&lt;/span&gt; çš„äºŒè¿›åˆ¶ä½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å³ç§»ä¸€ä½ï¼Œé‚£ä¹ˆå¦‚æœçŸ¥é“äº† &lt;span class=&#34;math inline&#34;&gt;\(R(\lfloor x/2\rfloor)\)&lt;/span&gt; å°±å¯ä»¥å¾ˆå®¹æ˜“çš„æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt;ï¼Œå†åˆ† &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å¥‡å¶æ€§åˆ¤æ–­å°±å¯ä»¥äº†ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
R(x) = \left\lfloor\frac{R(\lfloor x/2\rfloor)}{2}\right\rfloor + (x\bmod 2)\times\frac{len}2
\]&lt;/span&gt; ä¸¾ä¸ªä¾‹å­ï¼šç¿»è½¬ &lt;span class=&#34;math inline&#34;&gt;\((10101110)_2\)&lt;/span&gt;ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“å®ƒçš„äºŒåˆ†ä¹‹ä¸€å€ä¸º &lt;span class=&#34;math inline&#34;&gt;\((01010111)_2\)&lt;/span&gt;ï¼Œå…¶ç¿»è½¬ç»“æœä¸º &lt;span class=&#34;math inline&#34;&gt;\((11101010)_2\)&lt;/span&gt;ï¼Œé™¤ä»¥äºŒå˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\((01110101)_2\)&lt;/span&gt;ï¼Œç”±äºå®ƒæ˜¯å¶æ•°æ‰€ä»¥å‰é¢ä¸ç”¨è¡¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚ä¸éš¾å‘ç°å…¶å°±æ˜¯ä¸€å¼€å§‹è¦æ±‚çš„ç¿»è½¬ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;é¢„å¤„ç†ç¿»è½¬ç»“æœçš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb4&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb4-1&#34;&gt;&lt;a href=&#34;#cb4-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-2&#34;&gt;&lt;a href=&#34;#cb4-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb4-3&#34;&gt;&lt;a href=&#34;#cb4-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    rev[i] = ((rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | (((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)));&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶ååœ¨å¤„ç†ç¿»è½¬çš„æ—¶å€™åªéœ€è¦ä¸‹é¢å‡ è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb5&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb5-1&#34;&gt;&lt;a href=&#34;#cb5-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb5-2&#34;&gt;&lt;a href=&#34;#cb5-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb5-3&#34;&gt;&lt;a href=&#34;#cb5-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        myswap(a[i], a[rev[i]]);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸éš¾éªŒè¯å…¶æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸”è§‚å¯Ÿæˆ‘ä»¬åœ¨æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{DFT}(f(\omega_n^k))\)&lt;/span&gt; æ—¶æˆ‘ä»¬éœ€è¦ç®—ä¸¤é &lt;span class=&#34;math inline&#34;&gt;\(\omega_n^k\mathrm{DFT}(f_1(\omega_{\frac n2^k}))\)&lt;/span&gt;ï¼Œå¤æ•°çš„ä¹˜æ³•å¸¸æ•°å¾ˆå¤§ï¼Œè€ƒè™‘ä½¿ç”¨ä¸´æ—¶å˜é‡è®°å½•ä»¥é™ä½å¸¸æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·å­çš„è¯è¿­ä»£ç‰ˆçš„ DFT è¿‡ç¨‹å°±å¾ˆå¥½å†™äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb6&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb6-1&#34;&gt;&lt;a href=&#34;#cb6-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; DFT(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, complex *a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb6-2&#34;&gt;&lt;a href=&#34;#cb6-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb6-3&#34;&gt;&lt;a href=&#34;#cb6-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb6-4&#34;&gt;&lt;a href=&#34;#cb6-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb6-5&#34;&gt;&lt;a href=&#34;#cb6-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            myswap(a[i], a[rev[i]]);&lt;span class=&#34;co&#34;&gt;//å…ˆé¢„å¤„ç†ç¿»è½¬å®Œäº†çš„ç»“æœ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-6&#34;&gt;&lt;a href=&#34;#cb6-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;span class=&#34;co&#34;&gt;//æ¨¡æ‹Ÿåˆå¹¶ç­”æ¡ˆçš„è¿‡ç¨‹ï¼Œå³ä¸ºæ‰€è°“çš„ n&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-7&#34;&gt;&lt;a href=&#34;#cb6-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb6-8&#34;&gt;&lt;a href=&#34;#cb6-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//å³ä¸Šé¢çš„ n / 2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-9&#34;&gt;&lt;a href=&#34;#cb6-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        complex Wp = complex(cos(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * pi / p), type * sin(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * pi / p));&lt;span class=&#34;co&#34;&gt;//å¤„ç†å‡º p æ¬¡å•ä½æ ¹&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-10&#34;&gt;&lt;a href=&#34;#cb6-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;span class=&#34;co&#34;&gt;//å¯¹æ¯ä¸€ä¸ªè¿›è¡Œåˆå¹¶&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-11&#34;&gt;&lt;a href=&#34;#cb6-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb6-12&#34;&gt;&lt;a href=&#34;#cb6-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            complex w = complex(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;span class=&#34;co&#34;&gt;//å¤„ç† \omega_p^0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-13&#34;&gt;&lt;a href=&#34;#cb6-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, w = w * Wp)&lt;span class=&#34;co&#34;&gt;//å¼€å§‹åˆå¹¶&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-14&#34;&gt;&lt;a href=&#34;#cb6-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb6-15&#34;&gt;&lt;a href=&#34;#cb6-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;co&#34;&gt;//æ­¤æ—¶çš„ a[l] å°±æ˜¯ä¹‹å‰çš„ a1[i]ï¼Œa[len + l] å°±æ˜¯ä¹‹å‰çš„ a2[i]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-16&#34;&gt;&lt;a href=&#34;#cb6-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                complex tmp = w * a[len + l];&lt;/span&gt;
&lt;span id=&#34;cb6-17&#34;&gt;&lt;a href=&#34;#cb6-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[len + l] = a[l] - tmp;&lt;span class=&#34;co&#34;&gt;//ç›¸å½“äºä¸Šé¢çš„ a[i + (lim &amp;gt;&amp;gt; 1)] = a1[i] - w * a2[i]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-18&#34;&gt;&lt;a href=&#34;#cb6-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[l] = a[l] + tmp;&lt;span class=&#34;co&#34;&gt;//ç›¸å½“äºä¸Šé¢çš„ a[i] = a1[i] + w * a2[i]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-19&#34;&gt;&lt;a href=&#34;#cb6-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb6-20&#34;&gt;&lt;a href=&#34;#cb6-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb6-21&#34;&gt;&lt;a href=&#34;#cb6-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb6-22&#34;&gt;&lt;a href=&#34;#cb6-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼ä¹˜æ³•çš„å®ç°&#34;&gt;å¤šé¡¹å¼ä¹˜æ³•çš„å®ç°&lt;/h3&gt;
&lt;p&gt;æ€»çš„ä¸€ä¸ªéé€’å½’ç‰ˆ FFT çš„å®ç°å¦‚ä¸‹ï¼ˆ&lt;a href=&#34;https://www.luogu.com.cn/problem/P3803&#34;&gt;æ´›è°· P3803&lt;/a&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb7&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb7-1&#34;&gt;&lt;a href=&#34;#cb7-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-2&#34;&gt;&lt;a href=&#34;#cb7-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-3&#34;&gt;&lt;a href=&#34;#cb7-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-4&#34;&gt;&lt;a href=&#34;#cb7-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb7-5&#34;&gt;&lt;a href=&#34;#cb7-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-6&#34;&gt;&lt;a href=&#34;#cb7-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-7&#34;&gt;&lt;a href=&#34;#cb7-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; pi = acos(-&lt;span class=&#34;fl&#34;&gt;1.0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb7-8&#34;&gt;&lt;a href=&#34;#cb7-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-9&#34;&gt;&lt;a href=&#34;#cb7-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb7-10&#34;&gt;&lt;a href=&#34;#cb7-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb7-11&#34;&gt;&lt;a href=&#34;#cb7-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb7-12&#34;&gt;&lt;a href=&#34;#cb7-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-13&#34;&gt;&lt;a href=&#34;#cb7-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb7-14&#34;&gt;&lt;a href=&#34;#cb7-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb7-15&#34;&gt;&lt;a href=&#34;#cb7-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb7-16&#34;&gt;&lt;a href=&#34;#cb7-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * s + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb7-17&#34;&gt;&lt;a href=&#34;#cb7-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; s;&lt;/span&gt;
&lt;span id=&#34;cb7-18&#34;&gt;&lt;a href=&#34;#cb7-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb7-19&#34;&gt;&lt;a href=&#34;#cb7-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-20&#34;&gt;&lt;a href=&#34;#cb7-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; myswap(T &amp;amp;a, T &amp;amp;b)&lt;/span&gt;
&lt;span id=&#34;cb7-21&#34;&gt;&lt;a href=&#34;#cb7-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb7-22&#34;&gt;&lt;a href=&#34;#cb7-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    T t = a;&lt;/span&gt;
&lt;span id=&#34;cb7-23&#34;&gt;&lt;a href=&#34;#cb7-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a = b;&lt;/span&gt;
&lt;span id=&#34;cb7-24&#34;&gt;&lt;a href=&#34;#cb7-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    b = t;&lt;/span&gt;
&lt;span id=&#34;cb7-25&#34;&gt;&lt;a href=&#34;#cb7-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-26&#34;&gt;&lt;a href=&#34;#cb7-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb7-27&#34;&gt;&lt;a href=&#34;#cb7-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-28&#34;&gt;&lt;a href=&#34;#cb7-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; complex&lt;/span&gt;
&lt;span id=&#34;cb7-29&#34;&gt;&lt;a href=&#34;#cb7-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb7-30&#34;&gt;&lt;a href=&#34;#cb7-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; x, y;&lt;/span&gt;
&lt;span id=&#34;cb7-31&#34;&gt;&lt;a href=&#34;#cb7-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    complex(&lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; xx = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; yy = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb7-32&#34;&gt;&lt;a href=&#34;#cb7-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb7-33&#34;&gt;&lt;a href=&#34;#cb7-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x = xx, y = yy;&lt;/span&gt;
&lt;span id=&#34;cb7-34&#34;&gt;&lt;a href=&#34;#cb7-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb7-35&#34;&gt;&lt;a href=&#34;#cb7-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb7-36&#34;&gt;&lt;a href=&#34;#cb7-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-37&#34;&gt;&lt;a href=&#34;#cb7-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rev[maxn];&lt;/span&gt;
&lt;span id=&#34;cb7-38&#34;&gt;&lt;a href=&#34;#cb7-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-39&#34;&gt;&lt;a href=&#34;#cb7-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;complex &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; complex(a.x + b.x, a.y + b.y);}&lt;/span&gt;
&lt;span id=&#34;cb7-40&#34;&gt;&lt;a href=&#34;#cb7-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;complex &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; complex(a.x - b.x, a.y - b.y);}&lt;/span&gt;
&lt;span id=&#34;cb7-41&#34;&gt;&lt;a href=&#34;#cb7-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;complex &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; complex &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; complex(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);}&lt;/span&gt;
&lt;span id=&#34;cb7-42&#34;&gt;&lt;a href=&#34;#cb7-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-43&#34;&gt;&lt;a href=&#34;#cb7-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; DFT(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, complex *a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb7-44&#34;&gt;&lt;a href=&#34;#cb7-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb7-45&#34;&gt;&lt;a href=&#34;#cb7-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb7-46&#34;&gt;&lt;a href=&#34;#cb7-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb7-47&#34;&gt;&lt;a href=&#34;#cb7-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            myswap(a[i], a[rev[i]]);&lt;span class=&#34;co&#34;&gt;//å…ˆé¢„å¤„ç†ç¿»è½¬å®Œäº†çš„ç»“æœ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-48&#34;&gt;&lt;a href=&#34;#cb7-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;span class=&#34;co&#34;&gt;//æ¨¡æ‹Ÿåˆå¹¶ç­”æ¡ˆçš„è¿‡ç¨‹ï¼Œå³ä¸ºæ‰€è°“çš„ n&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-49&#34;&gt;&lt;a href=&#34;#cb7-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb7-50&#34;&gt;&lt;a href=&#34;#cb7-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//å³ä¸Šé¢çš„ n / 2&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-51&#34;&gt;&lt;a href=&#34;#cb7-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        complex Wp = complex(cos(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * pi / p), type * sin(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * pi / p));&lt;span class=&#34;co&#34;&gt;//å¤„ç†å‡º p æ¬¡å•ä½æ ¹&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-52&#34;&gt;&lt;a href=&#34;#cb7-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;span class=&#34;co&#34;&gt;//å¯¹æ¯ä¸€ä¸ªè¿›è¡Œåˆå¹¶&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-53&#34;&gt;&lt;a href=&#34;#cb7-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb7-54&#34;&gt;&lt;a href=&#34;#cb7-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            complex w = complex(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;span class=&#34;co&#34;&gt;//å¤„ç† \omega_p^0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-55&#34;&gt;&lt;a href=&#34;#cb7-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, w = w * Wp)&lt;span class=&#34;co&#34;&gt;//å¼€å§‹åˆå¹¶&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-56&#34;&gt;&lt;a href=&#34;#cb7-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb7-57&#34;&gt;&lt;a href=&#34;#cb7-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;co&#34;&gt;//æ­¤æ—¶çš„ a[l] å°±æ˜¯ä¹‹å‰çš„ a1[i]ï¼Œa[len + l] å°±æ˜¯ä¹‹å‰çš„ a2[i]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-58&#34;&gt;&lt;a href=&#34;#cb7-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                complex tmp = w * a[len + l];&lt;/span&gt;
&lt;span id=&#34;cb7-59&#34;&gt;&lt;a href=&#34;#cb7-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[len + l] = a[l] - tmp;&lt;span class=&#34;co&#34;&gt;//ç›¸å½“äºä¸Šé¢çš„ a[i + (lim &amp;gt;&amp;gt; 1)] = a1[i] - w * a2[i]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-60&#34;&gt;&lt;a href=&#34;#cb7-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[l] = a[l] + tmp;&lt;span class=&#34;co&#34;&gt;//ç›¸å½“äºä¸Šé¢çš„ a[i] = a1[i] + w * a2[i]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-61&#34;&gt;&lt;a href=&#34;#cb7-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb7-62&#34;&gt;&lt;a href=&#34;#cb7-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb7-63&#34;&gt;&lt;a href=&#34;#cb7-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb7-64&#34;&gt;&lt;a href=&#34;#cb7-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb7-65&#34;&gt;&lt;a href=&#34;#cb7-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-66&#34;&gt;&lt;a href=&#34;#cb7-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb7-67&#34;&gt;&lt;a href=&#34;#cb7-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb7-68&#34;&gt;&lt;a href=&#34;#cb7-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb7-69&#34;&gt;&lt;a href=&#34;#cb7-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) a[i].x = read();&lt;/span&gt;
&lt;span id=&#34;cb7-70&#34;&gt;&lt;a href=&#34;#cb7-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, m) b[i].x = read();&lt;/span&gt;
&lt;span id=&#34;cb7-71&#34;&gt;&lt;a href=&#34;#cb7-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-72&#34;&gt;&lt;a href=&#34;#cb7-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//è¡¥é½é«˜ä½&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-73&#34;&gt;&lt;a href=&#34;#cb7-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb7-74&#34;&gt;&lt;a href=&#34;#cb7-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = ((rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | (((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)));&lt;span class=&#34;co&#34;&gt;//å…ˆå¤„ç†ç¿»è½¬å®Œçš„ç»“æœ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-75&#34;&gt;&lt;a href=&#34;#cb7-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(lim, a, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;span class=&#34;co&#34;&gt;//DFT&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-76&#34;&gt;&lt;a href=&#34;#cb7-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(lim, b, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;span class=&#34;co&#34;&gt;//DFT&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-77&#34;&gt;&lt;a href=&#34;#cb7-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb7-78&#34;&gt;&lt;a href=&#34;#cb7-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i] * b[i];&lt;span class=&#34;co&#34;&gt;//å¯¹å¤„ç†å‡ºæ¥çš„ç‚¹å€¼è¿›è¡Œä¹˜æ³•&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-79&#34;&gt;&lt;a href=&#34;#cb7-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(lim, a, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;span class=&#34;co&#34;&gt;//IDFT&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-80&#34;&gt;&lt;a href=&#34;#cb7-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n + m)&lt;/span&gt;
&lt;span id=&#34;cb7-81&#34;&gt;&lt;a href=&#34;#cb7-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(a[i].x / lim + &lt;span class=&#34;fl&#34;&gt;0.5&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb7-82&#34;&gt;&lt;a href=&#34;#cb7-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-83&#34;&gt;&lt;a href=&#34;#cb7-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½¿ç”¨ FFT æ¥æ±‚é«˜ç²¾åº¦æ•´æ•°ä¹˜æ³•çš„å®ç°ï¼ˆ&lt;a href=&#34;https://www.luogu.com.cn/problem/P1919&#34;&gt;æ´›è°· P1919&lt;/a&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb8&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb8-1&#34;&gt;&lt;a href=&#34;#cb8-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-2&#34;&gt;&lt;a href=&#34;#cb8-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-3&#34;&gt;&lt;a href=&#34;#cb8-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-4&#34;&gt;&lt;a href=&#34;#cb8-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb8-5&#34;&gt;&lt;a href=&#34;#cb8-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb8-6&#34;&gt;&lt;a href=&#34;#cb8-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-7&#34;&gt;&lt;a href=&#34;#cb8-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; myswap(T &amp;amp;a, T &amp;amp;b) {T t = a; a = b; b = t; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;}&lt;/span&gt;
&lt;span id=&#34;cb8-8&#34;&gt;&lt;a href=&#34;#cb8-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-9&#34;&gt;&lt;a href=&#34;#cb8-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; db;&lt;/span&gt;
&lt;span id=&#34;cb8-10&#34;&gt;&lt;a href=&#34;#cb8-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-11&#34;&gt;&lt;a href=&#34;#cb8-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;3000000&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-12&#34;&gt;&lt;a href=&#34;#cb8-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; db pi = acos(-&lt;span class=&#34;fl&#34;&gt;1.0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-13&#34;&gt;&lt;a href=&#34;#cb8-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-14&#34;&gt;&lt;a href=&#34;#cb8-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; cmplx&lt;/span&gt;
&lt;span id=&#34;cb8-15&#34;&gt;&lt;a href=&#34;#cb8-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb8-16&#34;&gt;&lt;a href=&#34;#cb8-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    db x, y;&lt;/span&gt;
&lt;span id=&#34;cb8-17&#34;&gt;&lt;a href=&#34;#cb8-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cmplx(db xx = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, db yy = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {x = xx, y = yy;}&lt;/span&gt;
&lt;span id=&#34;cb8-18&#34;&gt;&lt;a href=&#34;#cb8-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-19&#34;&gt;&lt;a href=&#34;#cb8-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-20&#34;&gt;&lt;a href=&#34;#cb8-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x + b.x, a.y + b.y);}&lt;/span&gt;
&lt;span id=&#34;cb8-21&#34;&gt;&lt;a href=&#34;#cb8-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x - b.x, a.y - b.y);}&lt;/span&gt;
&lt;span id=&#34;cb8-22&#34;&gt;&lt;a href=&#34;#cb8-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);}&lt;/span&gt;
&lt;span id=&#34;cb8-23&#34;&gt;&lt;a href=&#34;#cb8-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-24&#34;&gt;&lt;a href=&#34;#cb8-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s1[maxn], s2[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-25&#34;&gt;&lt;a href=&#34;#cb8-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rev[maxn], ans[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-26&#34;&gt;&lt;a href=&#34;#cb8-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-27&#34;&gt;&lt;a href=&#34;#cb8-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; DFT(cmplx *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb8-28&#34;&gt;&lt;a href=&#34;#cb8-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb8-29&#34;&gt;&lt;a href=&#34;#cb8-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb8-30&#34;&gt;&lt;a href=&#34;#cb8-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb8-31&#34;&gt;&lt;a href=&#34;#cb8-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            myswap(f[i], f[rev[i]]);&lt;/span&gt;
&lt;span id=&#34;cb8-32&#34;&gt;&lt;a href=&#34;#cb8-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb8-33&#34;&gt;&lt;a href=&#34;#cb8-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb8-34&#34;&gt;&lt;a href=&#34;#cb8-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-35&#34;&gt;&lt;a href=&#34;#cb8-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cmplx Wp(cos(&lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; * pi / p), type * sin(&lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; * pi / p));&lt;/span&gt;
&lt;span id=&#34;cb8-36&#34;&gt;&lt;a href=&#34;#cb8-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;/span&gt;
&lt;span id=&#34;cb8-37&#34;&gt;&lt;a href=&#34;#cb8-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb8-38&#34;&gt;&lt;a href=&#34;#cb8-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cmplx w(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-39&#34;&gt;&lt;a href=&#34;#cb8-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, w = w * Wp)&lt;/span&gt;
&lt;span id=&#34;cb8-40&#34;&gt;&lt;a href=&#34;#cb8-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb8-41&#34;&gt;&lt;a href=&#34;#cb8-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                cmplx tmp = w * f[l + len];&lt;/span&gt;
&lt;span id=&#34;cb8-42&#34;&gt;&lt;a href=&#34;#cb8-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l + len] = f[l] - tmp;&lt;/span&gt;
&lt;span id=&#34;cb8-43&#34;&gt;&lt;a href=&#34;#cb8-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l] = f[l] + tmp;&lt;/span&gt;
&lt;span id=&#34;cb8-44&#34;&gt;&lt;a href=&#34;#cb8-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb8-45&#34;&gt;&lt;a href=&#34;#cb8-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb8-46&#34;&gt;&lt;a href=&#34;#cb8-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-47&#34;&gt;&lt;a href=&#34;#cb8-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-48&#34;&gt;&lt;a href=&#34;#cb8-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb8-49&#34;&gt;&lt;a href=&#34;#cb8-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-50&#34;&gt;&lt;a href=&#34;#cb8-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb8-51&#34;&gt;&lt;a href=&#34;#cb8-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb8-52&#34;&gt;&lt;a href=&#34;#cb8-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s\n%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, s1, s2);&lt;/span&gt;
&lt;span id=&#34;cb8-53&#34;&gt;&lt;a href=&#34;#cb8-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n1 = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n2 = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-54&#34;&gt;&lt;a href=&#34;#cb8-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, strlen(s1) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) a[++n1].x = s1[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-55&#34;&gt;&lt;a href=&#34;#cb8-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, strlen(s2) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) b[++n2].x = s2[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-56&#34;&gt;&lt;a href=&#34;#cb8-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-57&#34;&gt;&lt;a href=&#34;#cb8-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n1 + n2) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-58&#34;&gt;&lt;a href=&#34;#cb8-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb8-59&#34;&gt;&lt;a href=&#34;#cb8-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = ((rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | (((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)));&lt;/span&gt;
&lt;span id=&#34;cb8-60&#34;&gt;&lt;a href=&#34;#cb8-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(a, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-61&#34;&gt;&lt;a href=&#34;#cb8-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(b, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-62&#34;&gt;&lt;a href=&#34;#cb8-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb8-63&#34;&gt;&lt;a href=&#34;#cb8-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i] * b[i];&lt;/span&gt;
&lt;span id=&#34;cb8-64&#34;&gt;&lt;a href=&#34;#cb8-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(a, lim, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-65&#34;&gt;&lt;a href=&#34;#cb8-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb8-66&#34;&gt;&lt;a href=&#34;#cb8-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] = (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(a[i].x / lim + &lt;span class=&#34;fl&#34;&gt;0.5&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-67&#34;&gt;&lt;a href=&#34;#cb8-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb8-68&#34;&gt;&lt;a href=&#34;#cb8-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ans[i] &amp;gt;= &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;) ans[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] += ans[i] / &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;, ans[i] %= &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;, lim += (i == lim);&lt;/span&gt;
&lt;span id=&#34;cb8-69&#34;&gt;&lt;a href=&#34;#cb8-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!ans[lim] &amp;amp;&amp;amp; lim &amp;gt; -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) --lim;&lt;/span&gt;
&lt;span id=&#34;cb8-70&#34;&gt;&lt;a href=&#34;#cb8-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (lim == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;0&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-71&#34;&gt;&lt;a href=&#34;#cb8-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; DEC(i, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans[i]);&lt;/span&gt;
&lt;span id=&#34;cb8-72&#34;&gt;&lt;a href=&#34;#cb8-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-73&#34;&gt;&lt;a href=&#34;#cb8-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;å½“ç„¶ï¼Œåƒä¸‡è¦è®°å¾— IDFT è¿˜å›å»çš„æ—¶å€™è¦é™¤ä»¥ &lt;code&gt;lim&lt;/code&gt;ï¼Œå®åœ¨æ€•è®°ä¸ä½å°±åœ¨ DFT å‡½æ•°é‡Œé¢åŠ å‡ å¥è¯ç›´æ¥å¤„ç†å¥½&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb9&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb9-1&#34;&gt;&lt;a href=&#34;#cb9-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (type == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb9-2&#34;&gt;&lt;a href=&#34;#cb9-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb9-3&#34;&gt;&lt;a href=&#34;#cb9-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i].x /= lim;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;é’ˆå¯¹å¤šé¡¹å¼ä¹˜æ³•ä¸‰æ¬¡å˜ä¸¤æ¬¡ä¼˜åŒ–&#34;&gt;é’ˆå¯¹å¤šé¡¹å¼ä¹˜æ³•ï¼šä¸‰æ¬¡å˜ä¸¤æ¬¡ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°æˆ‘ä»¬åœ¨åšå¤šé¡¹å¼ä¹˜æ³•çš„æ—¶å€™ï¼Œéœ€è¦å…ˆ DFT &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt;ï¼Œä¹˜åœ¨ä¸€èµ·ä¹‹åå† IDFT è¿˜å›æ¥ &lt;span class=&#34;math inline&#34;&gt;\(C(x)\)&lt;/span&gt;ï¼Œä¸€å…±è¿›è¡Œäº†ä¸‰æ¬¡è¿™æ ·çš„æ“ä½œã€‚è€ƒè™‘å¦‚ä½•å‡å°‘æˆ‘ä»¬è°ƒç”¨ DFT çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; çš„ç³»æ•°æ”¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt; ç³»æ•°çš„è™šéƒ¨ä¸Šé¢ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(a + b\mathrm i\)&lt;/span&gt;ï¼Œç„¶å DFT ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt; å†æ±‚ä¸ªå¹³æ–¹ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(A^2(x)\)&lt;/span&gt;ï¼Œå† IDFT å›å»ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°å¾—åˆ°çš„ç³»æ•°éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((a + b\mathrm i)^2 = a^2 - b^2 + 2ab\mathrm i\)&lt;/span&gt; çš„å½¢å¼çš„ï¼Œæ‰€ä»¥åªéœ€è¦å–å‡ºè™šéƒ¨å†é™¤ä»¥äºŒå°±å¾—åˆ°ç­”æ¡ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çš„å†™æ³•å¯ä»¥å‡å°å¸¸æ•°ï¼Œè·‘çš„æ¯” NTT è¿˜å¿«ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb10&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb10-1&#34;&gt;&lt;a href=&#34;#cb10-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-2&#34;&gt;&lt;a href=&#34;#cb10-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-3&#34;&gt;&lt;a href=&#34;#cb10-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cmath&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-4&#34;&gt;&lt;a href=&#34;#cb10-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb10-5&#34;&gt;&lt;a href=&#34;#cb10-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-6&#34;&gt;&lt;a href=&#34;#cb10-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;double&lt;/span&gt; db;&lt;/span&gt;
&lt;span id=&#34;cb10-7&#34;&gt;&lt;a href=&#34;#cb10-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-8&#34;&gt;&lt;a href=&#34;#cb10-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-9&#34;&gt;&lt;a href=&#34;#cb10-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; db pi = acos(-&lt;span class=&#34;fl&#34;&gt;1.0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb10-10&#34;&gt;&lt;a href=&#34;#cb10-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-11&#34;&gt;&lt;a href=&#34;#cb10-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb10-12&#34;&gt;&lt;a href=&#34;#cb10-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb10-13&#34;&gt;&lt;a href=&#34;#cb10-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb10-14&#34;&gt;&lt;a href=&#34;#cb10-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-15&#34;&gt;&lt;a href=&#34;#cb10-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb10-16&#34;&gt;&lt;a href=&#34;#cb10-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb10-17&#34;&gt;&lt;a href=&#34;#cb10-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb10-18&#34;&gt;&lt;a href=&#34;#cb10-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * s + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb10-19&#34;&gt;&lt;a href=&#34;#cb10-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; s;&lt;/span&gt;
&lt;span id=&#34;cb10-20&#34;&gt;&lt;a href=&#34;#cb10-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb10-21&#34;&gt;&lt;a href=&#34;#cb10-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-22&#34;&gt;&lt;a href=&#34;#cb10-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; myswap(T &amp;amp;a, T &amp;amp;b)&lt;/span&gt;
&lt;span id=&#34;cb10-23&#34;&gt;&lt;a href=&#34;#cb10-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb10-24&#34;&gt;&lt;a href=&#34;#cb10-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    T t = a;&lt;/span&gt;
&lt;span id=&#34;cb10-25&#34;&gt;&lt;a href=&#34;#cb10-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a = b;&lt;/span&gt;
&lt;span id=&#34;cb10-26&#34;&gt;&lt;a href=&#34;#cb10-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    b = t;&lt;/span&gt;
&lt;span id=&#34;cb10-27&#34;&gt;&lt;a href=&#34;#cb10-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-28&#34;&gt;&lt;a href=&#34;#cb10-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb10-29&#34;&gt;&lt;a href=&#34;#cb10-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-30&#34;&gt;&lt;a href=&#34;#cb10-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; cmplx&lt;/span&gt;
&lt;span id=&#34;cb10-31&#34;&gt;&lt;a href=&#34;#cb10-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb10-32&#34;&gt;&lt;a href=&#34;#cb10-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    db x, y;&lt;/span&gt;
&lt;span id=&#34;cb10-33&#34;&gt;&lt;a href=&#34;#cb10-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cmplx(db xx = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, db yy = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-34&#34;&gt;&lt;a href=&#34;#cb10-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb10-35&#34;&gt;&lt;a href=&#34;#cb10-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x = xx, y = yy;&lt;/span&gt;
&lt;span id=&#34;cb10-36&#34;&gt;&lt;a href=&#34;#cb10-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-37&#34;&gt;&lt;a href=&#34;#cb10-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb10-38&#34;&gt;&lt;a href=&#34;#cb10-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-39&#34;&gt;&lt;a href=&#34;#cb10-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rev[maxn];&lt;/span&gt;
&lt;span id=&#34;cb10-40&#34;&gt;&lt;a href=&#34;#cb10-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-41&#34;&gt;&lt;a href=&#34;#cb10-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x + b.x, a.y + b.y);}&lt;/span&gt;
&lt;span id=&#34;cb10-42&#34;&gt;&lt;a href=&#34;#cb10-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x - b.x, a.y - b.y);}&lt;/span&gt;
&lt;span id=&#34;cb10-43&#34;&gt;&lt;a href=&#34;#cb10-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);}&lt;/span&gt;
&lt;span id=&#34;cb10-44&#34;&gt;&lt;a href=&#34;#cb10-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-45&#34;&gt;&lt;a href=&#34;#cb10-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; DFT(cmplx *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb10-46&#34;&gt;&lt;a href=&#34;#cb10-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb10-47&#34;&gt;&lt;a href=&#34;#cb10-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-48&#34;&gt;&lt;a href=&#34;#cb10-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb10-49&#34;&gt;&lt;a href=&#34;#cb10-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            myswap(f[i], f[rev[i]]);&lt;/span&gt;
&lt;span id=&#34;cb10-50&#34;&gt;&lt;a href=&#34;#cb10-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-51&#34;&gt;&lt;a href=&#34;#cb10-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb10-52&#34;&gt;&lt;a href=&#34;#cb10-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-53&#34;&gt;&lt;a href=&#34;#cb10-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cmplx Wp(cos(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * pi / p), type * sin(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * pi / p));&lt;/span&gt;
&lt;span id=&#34;cb10-54&#34;&gt;&lt;a href=&#34;#cb10-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;/span&gt;
&lt;span id=&#34;cb10-55&#34;&gt;&lt;a href=&#34;#cb10-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb10-56&#34;&gt;&lt;a href=&#34;#cb10-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cmplx w(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb10-57&#34;&gt;&lt;a href=&#34;#cb10-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, w = w * Wp)&lt;/span&gt;
&lt;span id=&#34;cb10-58&#34;&gt;&lt;a href=&#34;#cb10-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb10-59&#34;&gt;&lt;a href=&#34;#cb10-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                cmplx tmp = w * f[len + l];&lt;/span&gt;
&lt;span id=&#34;cb10-60&#34;&gt;&lt;a href=&#34;#cb10-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[len + l] = f[l] - tmp;&lt;/span&gt;
&lt;span id=&#34;cb10-61&#34;&gt;&lt;a href=&#34;#cb10-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l] = f[l] + tmp;&lt;/span&gt;
&lt;span id=&#34;cb10-62&#34;&gt;&lt;a href=&#34;#cb10-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb10-63&#34;&gt;&lt;a href=&#34;#cb10-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb10-64&#34;&gt;&lt;a href=&#34;#cb10-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-65&#34;&gt;&lt;a href=&#34;#cb10-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb10-66&#34;&gt;&lt;a href=&#34;#cb10-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-67&#34;&gt;&lt;a href=&#34;#cb10-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb10-68&#34;&gt;&lt;a href=&#34;#cb10-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb10-69&#34;&gt;&lt;a href=&#34;#cb10-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb10-70&#34;&gt;&lt;a href=&#34;#cb10-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) a[i].x = read();&lt;/span&gt;
&lt;span id=&#34;cb10-71&#34;&gt;&lt;a href=&#34;#cb10-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, m) a[i].y = read();&lt;/span&gt;
&lt;span id=&#34;cb10-72&#34;&gt;&lt;a href=&#34;#cb10-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-73&#34;&gt;&lt;a href=&#34;#cb10-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-74&#34;&gt;&lt;a href=&#34;#cb10-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-75&#34;&gt;&lt;a href=&#34;#cb10-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = ((rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb10-76&#34;&gt;&lt;a href=&#34;#cb10-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(a, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb10-77&#34;&gt;&lt;a href=&#34;#cb10-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-78&#34;&gt;&lt;a href=&#34;#cb10-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i] * a[i];&lt;/span&gt;
&lt;span id=&#34;cb10-79&#34;&gt;&lt;a href=&#34;#cb10-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(a, lim, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb10-80&#34;&gt;&lt;a href=&#34;#cb10-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n + m)&lt;/span&gt;
&lt;span id=&#34;cb10-81&#34;&gt;&lt;a href=&#34;#cb10-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(a[i].y / lim / &lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; + &lt;span class=&#34;fl&#34;&gt;0.5&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb10-82&#34;&gt;&lt;a href=&#34;#cb10-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-83&#34;&gt;&lt;a href=&#34;#cb10-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;å¿«é€Ÿæ•°è®ºå˜æ¢ntt&#34;&gt;å¿«é€Ÿæ•°è®ºå˜æ¢ï¼ˆNTTï¼‰&lt;/h2&gt;
&lt;p&gt;æœ‰äº† FFTï¼Œæˆ‘ä»¬å·²ç»æœ‰èƒ½åŠ›åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; çš„æ—¶é—´å†…æ±‚å‡ºä¸¤ä¸ªå¤šé¡¹å¼çš„å·ç§¯äº†ã€‚ä½†æ˜¯ FFT ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼šå¤æ•°é‡‡ç”¨çš„æµ®ç‚¹è¿ç®—ä¸ä»…é€ æˆç²¾åº¦çš„é—®é¢˜ï¼Œè¿˜ä¼šå¢å¤§å¸¸æ•°ã€‚é—æ†¾çš„æ˜¯æ•°å­¦å®¶ä»¬å·²ç»è¯æ˜äº† &lt;span class=&#34;math inline&#34;&gt;\(\mathbb C\)&lt;/span&gt; ä¸­åªæœ‰å•ä½å¤æ•°æ ¹æ»¡è¶³ FFT çš„è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ°åˆ©ç”¨å¤šé¡¹å¼çš„è®¡æ•°é¢˜å¾ˆå¤šéƒ½æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„ï¼Œæ‰€ä»¥è‡ªç„¶å¸Œæœ›ä¸ºå•ä½å¤æ•°æ ¹æ‰¾ä¸€ä¸ªæ¨¡æ„ä¹‰ä¸‹çš„æ›¿ä»£å“ã€‚æ­¤æ—¶å°±è¿›å…¥ä¸‹é¢çš„å‰ç½®çŸ¥è¯†ï¼šåŸæ ¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŸæ ¹&#34;&gt;åŸæ ¹&lt;/h3&gt;
&lt;p&gt;è®¾æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(r,n\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(r\perp n\land r \not= 0 \land n &amp;gt; 0\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(r^x \equiv 1\pmod n\)&lt;/span&gt; çš„&lt;strong&gt;æœ€å°æ­£æ•´æ•°&lt;/strong&gt; &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç§°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„&lt;strong&gt;é˜¶&lt;/strong&gt;ï¼Œè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{ord}_nr\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(\delta_n(r)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(r,n\in\mathbb N^+\land r\perp n\)&lt;/span&gt;ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{ord}_nr = \phi(n)\)&lt;/span&gt; æ—¶ï¼Œç§° &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; æ˜¯æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åŸæ ¹æˆ–è€… &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åŸæ ¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ntt&#34;&gt;NTT&lt;/h3&gt;
&lt;p&gt;å¯¹äºè´¨æ•° &lt;span class=&#34;math inline&#34;&gt;\(p = qn + 1\:(n = 2^m)\)&lt;/span&gt;ï¼ŒåŸæ ¹ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(g^{qn}\equiv 1\pmod p\)&lt;/span&gt;ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(g_n = g^q\pmod p\)&lt;/span&gt; çœ‹ä½œ &lt;span class=&#34;math inline&#34;&gt;\(\omega_n\)&lt;/span&gt; çš„ç­‰ä»·ï¼Œå…¶æ»¡è¶³ç›¸ä¼¼çš„æ€§è´¨ï¼Œæ¯”å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(g_n^n\equiv 1\pmod p,g_n^{n/2} \equiv -1\pmod p\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§çš„è´¨æ•° &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
p &amp;amp;= 998244353 = 7\times17\times2^{23} + 1,&amp;amp;g = 3\\
p &amp;amp;= 1004535809 = 479\times 2^{21} + 1,&amp;amp;g =  3
\end{aligned}
\]&lt;/span&gt; è¿­ä»£åˆ°é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g_l = g^{\frac{p - 1}{l}}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥çœ‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb11&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb11-1&#34;&gt;&lt;a href=&#34;#cb11-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-2&#34;&gt;&lt;a href=&#34;#cb11-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-3&#34;&gt;&lt;a href=&#34;#cb11-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb11-4&#34;&gt;&lt;a href=&#34;#cb11-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-5&#34;&gt;&lt;a href=&#34;#cb11-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb11-6&#34;&gt;&lt;a href=&#34;#cb11-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-7&#34;&gt;&lt;a href=&#34;#cb11-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll G = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-8&#34;&gt;&lt;a href=&#34;#cb11-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll mod = &lt;span class=&#34;dv&#34;&gt;998244353&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-9&#34;&gt;&lt;a href=&#34;#cb11-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-10&#34;&gt;&lt;a href=&#34;#cb11-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-11&#34;&gt;&lt;a href=&#34;#cb11-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb11-12&#34;&gt;&lt;a href=&#34;#cb11-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb11-13&#34;&gt;&lt;a href=&#34;#cb11-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb11-14&#34;&gt;&lt;a href=&#34;#cb11-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-15&#34;&gt;&lt;a href=&#34;#cb11-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb11-16&#34;&gt;&lt;a href=&#34;#cb11-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb11-17&#34;&gt;&lt;a href=&#34;#cb11-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb11-18&#34;&gt;&lt;a href=&#34;#cb11-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * s + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb11-19&#34;&gt;&lt;a href=&#34;#cb11-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; s;&lt;/span&gt;
&lt;span id=&#34;cb11-20&#34;&gt;&lt;a href=&#34;#cb11-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb11-21&#34;&gt;&lt;a href=&#34;#cb11-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-22&#34;&gt;&lt;a href=&#34;#cb11-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; myswap(T &amp;amp;a, T &amp;amp;b)&lt;/span&gt;
&lt;span id=&#34;cb11-23&#34;&gt;&lt;a href=&#34;#cb11-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb11-24&#34;&gt;&lt;a href=&#34;#cb11-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    T t = a;&lt;/span&gt;
&lt;span id=&#34;cb11-25&#34;&gt;&lt;a href=&#34;#cb11-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a = b;&lt;/span&gt;
&lt;span id=&#34;cb11-26&#34;&gt;&lt;a href=&#34;#cb11-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    b = t;&lt;/span&gt;
&lt;span id=&#34;cb11-27&#34;&gt;&lt;a href=&#34;#cb11-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-28&#34;&gt;&lt;a href=&#34;#cb11-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb11-29&#34;&gt;&lt;a href=&#34;#cb11-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-30&#34;&gt;&lt;a href=&#34;#cb11-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll pow(ll base, ll p = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-31&#34;&gt;&lt;a href=&#34;#cb11-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb11-32&#34;&gt;&lt;a href=&#34;#cb11-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-33&#34;&gt;&lt;a href=&#34;#cb11-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; p; p &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-34&#34;&gt;&lt;a href=&#34;#cb11-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb11-35&#34;&gt;&lt;a href=&#34;#cb11-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (p &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-36&#34;&gt;&lt;a href=&#34;#cb11-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ret = ret * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb11-37&#34;&gt;&lt;a href=&#34;#cb11-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        base = base * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb11-38&#34;&gt;&lt;a href=&#34;#cb11-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-39&#34;&gt;&lt;a href=&#34;#cb11-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb11-40&#34;&gt;&lt;a href=&#34;#cb11-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb11-41&#34;&gt;&lt;a href=&#34;#cb11-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-42&#34;&gt;&lt;a href=&#34;#cb11-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rev[maxn];&lt;/span&gt;
&lt;span id=&#34;cb11-43&#34;&gt;&lt;a href=&#34;#cb11-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll f[maxn], g[maxn];&lt;/span&gt;
&lt;span id=&#34;cb11-44&#34;&gt;&lt;a href=&#34;#cb11-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll invG = pow(G);&lt;/span&gt;
&lt;span id=&#34;cb11-45&#34;&gt;&lt;a href=&#34;#cb11-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-46&#34;&gt;&lt;a href=&#34;#cb11-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; NTT(ll *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb11-47&#34;&gt;&lt;a href=&#34;#cb11-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb11-48&#34;&gt;&lt;a href=&#34;#cb11-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-49&#34;&gt;&lt;a href=&#34;#cb11-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb11-50&#34;&gt;&lt;a href=&#34;#cb11-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            myswap(f[i], f[rev[i]]);&lt;/span&gt;
&lt;span id=&#34;cb11-51&#34;&gt;&lt;a href=&#34;#cb11-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-52&#34;&gt;&lt;a href=&#34;#cb11-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb11-53&#34;&gt;&lt;a href=&#34;#cb11-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-54&#34;&gt;&lt;a href=&#34;#cb11-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll tG = pow(type ? G : invG, (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / p);&lt;/span&gt;
&lt;span id=&#34;cb11-55&#34;&gt;&lt;a href=&#34;#cb11-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;/span&gt;
&lt;span id=&#34;cb11-56&#34;&gt;&lt;a href=&#34;#cb11-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb11-57&#34;&gt;&lt;a href=&#34;#cb11-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll buf = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-58&#34;&gt;&lt;a href=&#34;#cb11-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, buf = buf * tG % mod)&lt;/span&gt;
&lt;span id=&#34;cb11-59&#34;&gt;&lt;a href=&#34;#cb11-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb11-60&#34;&gt;&lt;a href=&#34;#cb11-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll tmp = buf * f[len + l] % mod;&lt;/span&gt;
&lt;span id=&#34;cb11-61&#34;&gt;&lt;a href=&#34;#cb11-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[len + l] = f[l] - tmp;&lt;/span&gt;
&lt;span id=&#34;cb11-62&#34;&gt;&lt;a href=&#34;#cb11-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[len + l] &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) f[len + l] += mod;&lt;span class=&#34;co&#34;&gt;//åŠæ—¶å–æ¨¡&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-63&#34;&gt;&lt;a href=&#34;#cb11-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l] = f[l] + tmp;&lt;/span&gt;
&lt;span id=&#34;cb11-64&#34;&gt;&lt;a href=&#34;#cb11-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[l] &amp;gt; mod) f[l] -= mod;&lt;span class=&#34;co&#34;&gt;//åŠæ—¶å–æ¨¡&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-65&#34;&gt;&lt;a href=&#34;#cb11-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb11-66&#34;&gt;&lt;a href=&#34;#cb11-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb11-67&#34;&gt;&lt;a href=&#34;#cb11-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-68&#34;&gt;&lt;a href=&#34;#cb11-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll invlim = pow(lim);&lt;span class=&#34;co&#34;&gt;//æœ€åè¿˜å›å»ï¼Œé™¤ä»¥limç›¸å½“äºä¹˜ä¸Šlimçš„é€†å…ƒ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-69&#34;&gt;&lt;a href=&#34;#cb11-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!type)&lt;/span&gt;
&lt;span id=&#34;cb11-70&#34;&gt;&lt;a href=&#34;#cb11-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-71&#34;&gt;&lt;a href=&#34;#cb11-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i] = (f[i] * invlim % mod);&lt;/span&gt;
&lt;span id=&#34;cb11-72&#34;&gt;&lt;a href=&#34;#cb11-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-73&#34;&gt;&lt;a href=&#34;#cb11-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb11-74&#34;&gt;&lt;a href=&#34;#cb11-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-75&#34;&gt;&lt;a href=&#34;#cb11-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb11-76&#34;&gt;&lt;a href=&#34;#cb11-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb11-77&#34;&gt;&lt;a href=&#34;#cb11-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb11-78&#34;&gt;&lt;a href=&#34;#cb11-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) f[i] = read();&lt;/span&gt;
&lt;span id=&#34;cb11-79&#34;&gt;&lt;a href=&#34;#cb11-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, m) g[i] = read();&lt;/span&gt;
&lt;span id=&#34;cb11-80&#34;&gt;&lt;a href=&#34;#cb11-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-81&#34;&gt;&lt;a href=&#34;#cb11-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-82&#34;&gt;&lt;a href=&#34;#cb11-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-83&#34;&gt;&lt;a href=&#34;#cb11-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = (rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-84&#34;&gt;&lt;a href=&#34;#cb11-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-85&#34;&gt;&lt;a href=&#34;#cb11-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb11-86&#34;&gt;&lt;a href=&#34;#cb11-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = f[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb11-87&#34;&gt;&lt;a href=&#34;#cb11-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-88&#34;&gt;&lt;a href=&#34;#cb11-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n + m)&lt;/span&gt;
&lt;span id=&#34;cb11-89&#34;&gt;&lt;a href=&#34;#cb11-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)f[i]);&lt;/span&gt;
&lt;span id=&#34;cb11-90&#34;&gt;&lt;a href=&#34;#cb11-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-91&#34;&gt;&lt;a href=&#34;#cb11-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•&#34;&gt;ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•&lt;/h2&gt;
&lt;h3 id=&#34;é—®é¢˜æè¿°&#34;&gt;é—®é¢˜æè¿°&lt;/h3&gt;
&lt;p&gt;æœ‰äº›æ¯’ç˜¤é¢˜ç›®é‡Œé¢ï¼Œæ¨¡æ•°ä¸ä¸€å®šæ˜¯æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(p = a\times2^k + 1\)&lt;/span&gt; çš„å½¢å¼ï¼Œè¿™å°±æ„å‘³ç€ NTT æ˜¯ä¸èƒ½ç”¨çš„ï¼Œè€Œæ™®é€šçš„ FFT ç²¾åº¦åˆä¸å¤Ÿï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬çš„é—®é¢˜å½¢å¼ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(h(x) = f(x)\times g(x)\)&lt;/span&gt;ï¼Œç³»æ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 7\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ³•-1ä¸‰æ¨¡-ntt&#34;&gt;æ³• 1ï¼šä¸‰æ¨¡ NTT&lt;/h3&gt;
&lt;p&gt;åˆ†æå¯å¾—æœ€å¤§çš„æ•°åº”è¯¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(p^2\times\max\{\deg f, \deg g\}\)&lt;/span&gt;ï¼Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(10^{23}\)&lt;/span&gt; çº§åˆ«çš„ã€‚æ‰€ä»¥é€‰ä¸‰ä¸ªæ¨¡æ•°åˆ†åˆ«åš NTT ç„¶åç”¨ CRT åˆå¹¶å³å¯ã€‚éœ€è¦åš &lt;span class=&#34;math inline&#34;&gt;\(9\)&lt;/span&gt; æ¬¡ DFTï¼Œå¸¸æ•°è¾ƒå¤§ï¼Œæš‚ä¸è€ƒè™‘ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ³•-2æ‹†ç³»æ•°-fftmtt&#34;&gt;æ³• 2ï¼šæ‹†ç³»æ•° FFTï¼ˆMTTï¼‰&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘æŠŠå¤šé¡¹å¼çš„ç³»æ•°æ‹†æˆå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(a\times 2^{15} + b\)&lt;/span&gt; çš„å½¢å¼ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(a, b\le 2^{15}\)&lt;/span&gt;ã€‚è¿™æ ·å­ç›¸ä¹˜çš„å€¼åŸŸå¤§æ¦‚æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(10^{14}\)&lt;/span&gt; çº§åˆ«çš„ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(c_1c_2 = (a_1\times 2^{15} + b_1)(a_2\times 2^{15}+b_2) = a_1a_2\times 2^{30} + (a_1b_2 + a_2b_1)2^{15} + b_1b_2\)&lt;/span&gt;ã€‚ç„¶è€Œè¿™æ ·çœ‹ä¼¼è¦æ±‚å››æ¬¡å¤šé¡¹å¼ä¹˜æ³•ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(12\)&lt;/span&gt; æ¬¡ DFTï¼Œä¼¼ä¹æ›´åŠ å±‘äº†ã€‚&lt;/p&gt;
&lt;p&gt;å†·é™åˆ†æä¸€ä¸‹ï¼šç°åœ¨çš„é—®é¢˜æ˜¯æœ‰å››ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(A_1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(A_2\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B_2\)&lt;/span&gt;ï¼Œè¦æ±‚è¿™äº›å¤šé¡¹å¼çš„ä¸¤ä¸¤ä¹˜ç§¯ã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨å¤æ•°çš„æ€§è´¨ï¼šè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\((a + bi)(c + di) = ac - bd + (ad + bc)i\)&lt;/span&gt;ã€‚é‚£ä¹ˆä»¤å¤å¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(P = A_1 + iA_2\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(Q = B_1 + iB_2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(T_1 = P\times Q = A_1B_1 - A_2B_2 + (A_1B_2 + A_2B_1)i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å†è®¾ &lt;span class=&#34;math inline&#34;&gt;\(P&amp;#39; = A_1 - iA_2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(T_2 = P&amp;#39;\times Q = A_1B_1 + A_2B_2 + (A_1B_2 - A_2B_1)i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤å¼ç›¸åŠ å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(2A_1B_1 + 2A_1B_2i\)&lt;/span&gt;ï¼Œä¸¤å¼ç›¸å‡å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(2A_2B_2 - 2A_2B_1i\)&lt;/span&gt;ã€‚æŠŠè¿™ä¸¤ä¸ªå¤šé¡¹å¼çš„å®éƒ¨è™šéƒ¨æ‹†å‡ºæ¥å°±å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœäº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·å­éœ€è¦åš &lt;span class=&#34;math inline&#34;&gt;\(5\)&lt;/span&gt; æ¬¡ DFTï¼Œå¸¸æ•°ä¸å°ä½†æ¯” &lt;span class=&#34;math inline&#34;&gt;\(9\)&lt;/span&gt; æ¬¡ NTT ä¼˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°&#34;&gt;å®ç°&lt;/h3&gt;
&lt;p&gt;å¯ä»¥ç›´æ¥é…åˆåé¢çš„ &lt;code&gt;vector&lt;/code&gt; ç‰ˆå¤šé¡¹å¼æ¿å­é£Ÿç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb12&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb12-1&#34;&gt;&lt;a href=&#34;#cb12-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; complex {&lt;/span&gt;
&lt;span id=&#34;cb12-2&#34;&gt;&lt;a href=&#34;#cb12-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; cmplx {&lt;/span&gt;
&lt;span id=&#34;cb12-3&#34;&gt;&lt;a href=&#34;#cb12-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        db x, y;&lt;/span&gt;
&lt;span id=&#34;cb12-4&#34;&gt;&lt;a href=&#34;#cb12-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cmplx(db xx = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, db yy = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) : x(xx), y(yy) {}&lt;/span&gt;
&lt;span id=&#34;cb12-5&#34;&gt;&lt;a href=&#34;#cb12-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    };&lt;/span&gt;
&lt;span id=&#34;cb12-6&#34;&gt;&lt;a href=&#34;#cb12-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x + b.x, a.y + b.y);}&lt;/span&gt;
&lt;span id=&#34;cb12-7&#34;&gt;&lt;a href=&#34;#cb12-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x - b.x, a.y - b.y);}&lt;/span&gt;
&lt;span id=&#34;cb12-8&#34;&gt;&lt;a href=&#34;#cb12-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il cmplx &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; cmplx &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cmplx(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);}&lt;/span&gt;
&lt;span id=&#34;cb12-9&#34;&gt;&lt;a href=&#34;#cb12-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; complex;&lt;/span&gt;
&lt;span id=&#34;cb12-10&#34;&gt;&lt;a href=&#34;#cb12-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-11&#34;&gt;&lt;a href=&#34;#cb12-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; MTT {&lt;/span&gt;
&lt;span id=&#34;cb12-12&#34;&gt;&lt;a href=&#34;#cb12-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;sin;&lt;/span&gt;
&lt;span id=&#34;cb12-13&#34;&gt;&lt;a href=&#34;#cb12-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;cos;&lt;/span&gt;
&lt;span id=&#34;cb12-14&#34;&gt;&lt;a href=&#34;#cb12-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;acos;&lt;/span&gt;
&lt;span id=&#34;cb12-15&#34;&gt;&lt;a href=&#34;#cb12-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;floor;&lt;/span&gt;
&lt;span id=&#34;cb12-16&#34;&gt;&lt;a href=&#34;#cb12-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; db PI = acos(-&lt;span class=&#34;fl&#34;&gt;1.0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-17&#34;&gt;&lt;a href=&#34;#cb12-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; DIV = &lt;span class=&#34;dv&#34;&gt;32768&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-18&#34;&gt;&lt;a href=&#34;#cb12-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mod;&lt;/span&gt;
&lt;span id=&#34;cb12-19&#34;&gt;&lt;a href=&#34;#cb12-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-20&#34;&gt;&lt;a href=&#34;#cb12-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;pp&#34;&gt;#define clr2&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memset(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(cmplx))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;/span&gt;
&lt;span id=&#34;cb12-21&#34;&gt;&lt;a href=&#34;#cb12-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-22&#34;&gt;&lt;a href=&#34;#cb12-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; DFT(cmplx *g, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim) {&lt;/span&gt;
&lt;span id=&#34;cb12-23&#34;&gt;&lt;a href=&#34;#cb12-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; cmplx f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb12-24&#34;&gt;&lt;a href=&#34;#cb12-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        getTr(lim);&lt;/span&gt;
&lt;span id=&#34;cb12-25&#34;&gt;&lt;a href=&#34;#cb12-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = g[&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i]];&lt;/span&gt;
&lt;span id=&#34;cb12-26&#34;&gt;&lt;a href=&#34;#cb12-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb12-27&#34;&gt;&lt;a href=&#34;#cb12-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-28&#34;&gt;&lt;a href=&#34;#cb12-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cmplx Wp(&lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;cos(PI / len), type * &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;sin(PI / len));&lt;/span&gt;
&lt;span id=&#34;cb12-29&#34;&gt;&lt;a href=&#34;#cb12-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p) {&lt;/span&gt;
&lt;span id=&#34;cb12-30&#34;&gt;&lt;a href=&#34;#cb12-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                cmplx w(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-31&#34;&gt;&lt;a href=&#34;#cb12-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, w = w * Wp) {&lt;/span&gt;
&lt;span id=&#34;cb12-32&#34;&gt;&lt;a href=&#34;#cb12-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    cmplx tmp = w * f[len + l];&lt;/span&gt;
&lt;span id=&#34;cb12-33&#34;&gt;&lt;a href=&#34;#cb12-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[len + l] = f[l] - tmp;&lt;/span&gt;
&lt;span id=&#34;cb12-34&#34;&gt;&lt;a href=&#34;#cb12-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[l] = f[l] + tmp;&lt;/span&gt;
&lt;span id=&#34;cb12-35&#34;&gt;&lt;a href=&#34;#cb12-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb12-36&#34;&gt;&lt;a href=&#34;#cb12-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb12-37&#34;&gt;&lt;a href=&#34;#cb12-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb12-38&#34;&gt;&lt;a href=&#34;#cb12-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb12-39&#34;&gt;&lt;a href=&#34;#cb12-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (type == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = cmplx(f[i].x / lim, f[i].y / lim);&lt;/span&gt;
&lt;span id=&#34;cb12-40&#34;&gt;&lt;a href=&#34;#cb12-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; g[i] = f[i];&lt;/span&gt;
&lt;span id=&#34;cb12-41&#34;&gt;&lt;a href=&#34;#cb12-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-42&#34;&gt;&lt;a href=&#34;#cb12-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-43&#34;&gt;&lt;a href=&#34;#cb12-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-44&#34;&gt;&lt;a href=&#34;#cb12-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb12-45&#34;&gt;&lt;a href=&#34;#cb12-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; cmplx p1[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], p2[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], q[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], t1[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], t2[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb12-46&#34;&gt;&lt;a href=&#34;#cb12-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, A) p1[i] = cmplx(A[i] / DIV, A[i] % DIV), p2[i] = cmplx(A[i] / DIV, -p1[i].y);&lt;/span&gt;
&lt;span id=&#34;cb12-47&#34;&gt;&lt;a href=&#34;#cb12-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, B) q[i] = cmplx(B[i] / DIV, B[i] % DIV);&lt;/span&gt;
&lt;span id=&#34;cb12-48&#34;&gt;&lt;a href=&#34;#cb12-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly C; C.resize(min(lim, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)A.size() + (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)B.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb12-49&#34;&gt;&lt;a href=&#34;#cb12-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (n = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; n &amp;lt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(A.size() + B.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); n &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-50&#34;&gt;&lt;a href=&#34;#cb12-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-51&#34;&gt;&lt;a href=&#34;#cb12-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DFT(p1, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n), DFT(p2, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n), DFT(q, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb12-52&#34;&gt;&lt;a href=&#34;#cb12-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) t1[i] = p1[i] * q[i], t2[i] = p2[i] * q[i];&lt;/span&gt;
&lt;span id=&#34;cb12-53&#34;&gt;&lt;a href=&#34;#cb12-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DFT(t1, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n), DFT(t2, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb12-54&#34;&gt;&lt;a href=&#34;#cb12-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-55&#34;&gt;&lt;a href=&#34;#cb12-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, C) {&lt;/span&gt;
&lt;span id=&#34;cb12-56&#34;&gt;&lt;a href=&#34;#cb12-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll a1b1, a1b2, a2b1, a2b2;&lt;/span&gt;
&lt;span id=&#34;cb12-57&#34;&gt;&lt;a href=&#34;#cb12-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a1b1 = (ll)floor((t1[i].x + t2[i].x) / &lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; + &lt;span class=&#34;fl&#34;&gt;0.49&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb12-58&#34;&gt;&lt;a href=&#34;#cb12-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a1b2 = (ll)floor((t1[i].y + t2[i].y) / &lt;span class=&#34;fl&#34;&gt;2.0&lt;/span&gt; + &lt;span class=&#34;fl&#34;&gt;0.49&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb12-59&#34;&gt;&lt;a href=&#34;#cb12-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a2b1 = ((ll)floor(t1[i].y + &lt;span class=&#34;fl&#34;&gt;0.49&lt;/span&gt;) - a1b2) % mod;&lt;/span&gt;
&lt;span id=&#34;cb12-60&#34;&gt;&lt;a href=&#34;#cb12-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a2b2 = ((ll)floor(t2[i].x + &lt;span class=&#34;fl&#34;&gt;0.49&lt;/span&gt;) - a1b1) % mod;&lt;/span&gt;
&lt;span id=&#34;cb12-61&#34;&gt;&lt;a href=&#34;#cb12-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            C[i] = ((((a1b1 &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;) + (a1b2 + a2b1)) &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;) + a2b2) % mod;&lt;/span&gt;
&lt;span id=&#34;cb12-62&#34;&gt;&lt;a href=&#34;#cb12-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            C[i] = (C[i] + mod) % mod;&lt;/span&gt;
&lt;span id=&#34;cb12-63&#34;&gt;&lt;a href=&#34;#cb12-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb12-64&#34;&gt;&lt;a href=&#34;#cb12-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-65&#34;&gt;&lt;a href=&#34;#cb12-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        clr2(p1, n), clr2(p2, n), clr2(q, n), clr2(t1, n), clr2(t2, n);&lt;/span&gt;
&lt;span id=&#34;cb12-66&#34;&gt;&lt;a href=&#34;#cb12-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb12-67&#34;&gt;&lt;a href=&#34;#cb12-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-68&#34;&gt;&lt;a href=&#34;#cb12-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} &lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; MTT;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;fftntt-ä¼˜åŒ–å·ç§¯çš„ä¸€äº›ä¾‹å­&#34;&gt;FFT/NTT ä¼˜åŒ–å·ç§¯çš„ä¸€äº›ä¾‹å­&lt;/h2&gt;
&lt;p&gt;åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ FFT/NTT çš„ä¸€äº›åº”ç”¨ã€‚ï¼ˆé«˜ç²¾åº¦ä¹˜æ³•å°±ä¸è¯´äº†ï¼Œè®°å¾—æœ€åè¿›ä½å°±å¯ä»¥äº†ï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜åŒ–ä¸€èˆ¬çš„å·ç§¯&lt;/li&gt;
&lt;li&gt;å’Œç”Ÿæˆå‡½æ•°ä¸€èµ·é£Ÿç”¨&lt;/li&gt;
&lt;li&gt;å­—ç¬¦ä¸²åŒ¹é…ï¼ˆä½ æ²¡çœ‹é”™ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ´›è°·-p3338-zjoi2014åŠ›&#34;&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3338&#34;&gt;æ´›è°· P3338 [ZJOI2014]åŠ›&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{q\}\)&lt;/span&gt;ï¼Œå®šä¹‰ &lt;span class=&#34;math display&#34;&gt;\[
F_i = \sum_{j = 1}^{i - 1}\frac{q_iq_j}{(i - j)^2} - \sum_{j = i + 1}^n\frac{q_iq_j}{(i - j)^2}
\]&lt;/span&gt; æ±‚ &lt;span class=&#34;math display&#34;&gt;\[
E_i=\frac{F_i}{q_i}
\]&lt;/span&gt; è€ƒè™‘æš´åŠ›çš„è¯ï¼Œè¿™é“é¢˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„ï¼Œè¿‡ä¸å»ï¼Œè€ƒè™‘è½¬åŒ–å¼å­ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
E_i &amp;amp;= \frac{F_i}{q_i}\\
&amp;amp;=\sum_{j = 1}^{i - 1}\frac{q_j}{(i - j)^2} - \sum_{j = i + 1}^n\frac{q_j}{(i - j)^2}\\
\end{aligned}
\]&lt;/span&gt; æˆ‘ä»¬å°è¯•å°†å…¶åŒ–ä¸ºå·ç§¯çš„å½¢å¼ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i = q_i\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(f_0 = 0\)&lt;/span&gt;ï¼›&lt;span class=&#34;math inline&#34;&gt;\(g_i =\dfrac{1}{i^2}\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(g_0 = 0\)&lt;/span&gt;ï¼Œå›ä»£ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
E_i &amp;amp;= \sum_{j = 0}^{i}f_jg_{i - j} - \sum_{j = i}^nf_jg_{j - i}
\end{aligned}
\]&lt;/span&gt; å·¦è¾¹çš„éƒ¨åˆ†å·²ç»æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼äº†ï¼Œè€ƒè™‘ç»§ç»­åŒ–ç®€å³è¾¹ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç¿»è½¬çš„æŠ€å·§ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_i = f_{n - i}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(t = n - i\)&lt;/span&gt;ï¼Œåˆ™å³åŠè¾¹çš„å¼å­å¯ä»¥åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle\sum_{j = 0}^{t}f&amp;#39;_{t - j}g_j\)&lt;/span&gt;ã€‚ç°åœ¨ä¸¤è¾¹éƒ½åŒ–ä¸ºå·ç§¯çš„å½¢å¼äº†ï¼Œå¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ FFT åŠ é€Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;å³æˆ‘ä»¬è®¾å¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(A(x) =\displaystyle\sum_{i = 0}^nf_ix^n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B(x) = \displaystyle\sum_{i = 0}^ng_ix^n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(C(x) = \displaystyle\sum_{i = 0}^nf&amp;#39;_i\)&lt;/span&gt;ã€‚å†ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(L(x) = A(x)B(x)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(R(x) = B(x)C(x)\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç°ç­”æ¡ˆ &lt;span class=&#34;math inline&#34;&gt;\(E_i = l_i - r_{n - i}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(l_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(r_i\)&lt;/span&gt; åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt; ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x^i\)&lt;/span&gt; çš„ç³»æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb13&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb13-1&#34;&gt;&lt;a href=&#34;#cb13-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb13-2&#34;&gt;&lt;a href=&#34;#cb13-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb13-3&#34;&gt;&lt;a href=&#34;#cb13-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;
&lt;span id=&#34;cb13-4&#34;&gt;&lt;a href=&#34;#cb13-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb13-5&#34;&gt;&lt;a href=&#34;#cb13-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb13-6&#34;&gt;&lt;a href=&#34;#cb13-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lf&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;a[i].x);&lt;/span&gt;
&lt;span id=&#34;cb13-7&#34;&gt;&lt;a href=&#34;#cb13-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        b[i].x = (&lt;span class=&#34;fl&#34;&gt;1.0&lt;/span&gt; / i / i);&lt;/span&gt;
&lt;span id=&#34;cb13-8&#34;&gt;&lt;a href=&#34;#cb13-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c[n - i].x = a[i].x;&lt;/span&gt;
&lt;span id=&#34;cb13-9&#34;&gt;&lt;a href=&#34;#cb13-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-10&#34;&gt;&lt;a href=&#34;#cb13-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-11&#34;&gt;&lt;a href=&#34;#cb13-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= (n &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-12&#34;&gt;&lt;a href=&#34;#cb13-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb13-13&#34;&gt;&lt;a href=&#34;#cb13-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = ((rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb13-14&#34;&gt;&lt;a href=&#34;#cb13-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(a, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), DFT(b, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), DFT(c, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb13-15&#34;&gt;&lt;a href=&#34;#cb13-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb13-16&#34;&gt;&lt;a href=&#34;#cb13-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i] * b[i], c[i] = b[i] * c[i];&lt;/span&gt;
&lt;span id=&#34;cb13-17&#34;&gt;&lt;a href=&#34;#cb13-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DFT(a, lim, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), DFT(c, lim, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb13-18&#34;&gt;&lt;a href=&#34;#cb13-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb13-19&#34;&gt;&lt;a href=&#34;#cb13-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%.3lf\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, a[i].x - c[n - i].x);&lt;/span&gt;
&lt;span id=&#34;cb13-20&#34;&gt;&lt;a href=&#34;#cb13-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-21&#34;&gt;&lt;a href=&#34;#cb13-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;æ´›è°·-p3723-ah2017hnoi2017ç¤¼ç‰©&#34;&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3723&#34;&gt;æ´›è°· P3723 [AH2017/HNOI2017]ç¤¼ç‰©&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸¤ä¸ªåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{x\}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{y\}\)&lt;/span&gt;ï¼Œå¯ä»¥æ•´ä½“å¹³ç§»åºåˆ—æˆ–è€…æ•´ä½“åŠ /å‡æŸä¸ªæ•°ï¼Œæ±‚æœ€ç»ˆåºåˆ—&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^n(x_i - y_i)^2
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;çš„æœ€å°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†æï¼šè®¾æ•´ä½“åŠ å‡çš„æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å¯æ­£å¯è´Ÿï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æœ€å°åŒ–çš„å°±æ˜¯ä¸‹é¢è¿™ä¸ªå¼å­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^n(x_i - y_i + c)^2
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å±•å¼€ä¸Šé¢çš„å¼å­ï¼Œç”± &lt;span class=&#34;math inline&#34;&gt;\((x_i - y_i +c)^2 = x_i^2 + y_i^2 + c^2 + 2x_ic - 2y_ic - 2x_iy_i\)&lt;/span&gt; å¯ä»¥å¾—åˆ°åŸå¼å¯åŒ–ç®€ä¸º&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum x_i^2 + \sum y_i^2 + nc^2 + 2c\sum x_i - 2c\sum y_i - 2\sum x_iy_i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆä¸‹æ ‡çœç•¥ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°æˆ‘ä»¬åªéœ€è¦æœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\sum x_iy_i\)&lt;/span&gt; å°±å¯ä»¥å•¦ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_k\)&lt;/span&gt; ä¸ºæ—‹è½¬äº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå•ä½å &lt;span class=&#34;math inline&#34;&gt;\(\sum x_iy_i\)&lt;/span&gt; çš„å–å€¼ï¼Œå…ˆæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\{x\}\)&lt;/span&gt; å€é•¿ä¸€æ³¢ï¼Œåˆ™&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_k = \sum_{i = 1}^nx_{i + k}y_k
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç¿»è½¬ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_k = \sum_{i = 1}^nx_{i + k}y_{n - i + 1}&amp;#39;
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(f(t) = \sum_{i = 1}^n x_it^i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g(t) = \sum_{i = 1}^n y_it^i\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(h(t) = f(t) * g(t)\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç°å…¶ &lt;span class=&#34;math inline&#34;&gt;\(t^{n + k + 1}\)&lt;/span&gt; çš„ç³»æ•°å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_k\)&lt;/span&gt;ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨ FFT/NTT å°†å€é•¿è¿‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(\{x\}\)&lt;/span&gt; ä¸ç¿»è½¬è¿‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(\{y\}\)&lt;/span&gt; å·èµ·æ¥ï¼Œç„¶åæŠŠç»“æœä»ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(n + 1\)&lt;/span&gt; åˆ°ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; å¤„æ‰¾æœ€å€¼å°±å¯ä»¥äº†&lt;/p&gt;
&lt;p&gt;NTT çš„å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb14&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb14-1&#34;&gt;&lt;a href=&#34;#cb14-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb14-2&#34;&gt;&lt;a href=&#34;#cb14-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll suma, sumb, suma2, sumb2, n, m;&lt;/span&gt;
&lt;span id=&#34;cb14-3&#34;&gt;&lt;a href=&#34;#cb14-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rev[maxn];&lt;/span&gt;
&lt;span id=&#34;cb14-4&#34;&gt;&lt;a href=&#34;#cb14-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-5&#34;&gt;&lt;a href=&#34;#cb14-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; NTT(ll *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb14-6&#34;&gt;&lt;a href=&#34;#cb14-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb14-7&#34;&gt;&lt;a href=&#34;#cb14-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb14-8&#34;&gt;&lt;a href=&#34;#cb14-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb14-9&#34;&gt;&lt;a href=&#34;#cb14-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            swap(f[i], f[rev[i]]);&lt;/span&gt;
&lt;span id=&#34;cb14-10&#34;&gt;&lt;a href=&#34;#cb14-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb14-11&#34;&gt;&lt;a href=&#34;#cb14-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb14-12&#34;&gt;&lt;a href=&#34;#cb14-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-13&#34;&gt;&lt;a href=&#34;#cb14-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll Gp = pow(type ? G : invG, (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / p);&lt;/span&gt;
&lt;span id=&#34;cb14-14&#34;&gt;&lt;a href=&#34;#cb14-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;/span&gt;
&lt;span id=&#34;cb14-15&#34;&gt;&lt;a href=&#34;#cb14-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb14-16&#34;&gt;&lt;a href=&#34;#cb14-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll buf = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-17&#34;&gt;&lt;a href=&#34;#cb14-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, buf = buf * Gp % mod)&lt;/span&gt;
&lt;span id=&#34;cb14-18&#34;&gt;&lt;a href=&#34;#cb14-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb14-19&#34;&gt;&lt;a href=&#34;#cb14-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll tmp = buf * f[l + len] % mod;&lt;/span&gt;
&lt;span id=&#34;cb14-20&#34;&gt;&lt;a href=&#34;#cb14-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l + len] = f[l] - tmp;&lt;/span&gt;
&lt;span id=&#34;cb14-21&#34;&gt;&lt;a href=&#34;#cb14-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[l + len] &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) f[l + len] += mod;&lt;/span&gt;
&lt;span id=&#34;cb14-22&#34;&gt;&lt;a href=&#34;#cb14-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l] = f[l] + tmp;&lt;/span&gt;
&lt;span id=&#34;cb14-23&#34;&gt;&lt;a href=&#34;#cb14-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[l] &amp;gt; mod) f[l] -= mod;&lt;/span&gt;
&lt;span id=&#34;cb14-24&#34;&gt;&lt;a href=&#34;#cb14-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb14-25&#34;&gt;&lt;a href=&#34;#cb14-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb14-26&#34;&gt;&lt;a href=&#34;#cb14-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb14-27&#34;&gt;&lt;a href=&#34;#cb14-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll invlim = pow(lim);&lt;/span&gt;
&lt;span id=&#34;cb14-28&#34;&gt;&lt;a href=&#34;#cb14-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!type)&lt;/span&gt;
&lt;span id=&#34;cb14-29&#34;&gt;&lt;a href=&#34;#cb14-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb14-30&#34;&gt;&lt;a href=&#34;#cb14-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i] = f[i] * invlim % mod;&lt;/span&gt;
&lt;span id=&#34;cb14-31&#34;&gt;&lt;a href=&#34;#cb14-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-32&#34;&gt;&lt;a href=&#34;#cb14-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb14-33&#34;&gt;&lt;a href=&#34;#cb14-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-34&#34;&gt;&lt;a href=&#34;#cb14-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb14-35&#34;&gt;&lt;a href=&#34;#cb14-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb14-36&#34;&gt;&lt;a href=&#34;#cb14-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb14-37&#34;&gt;&lt;a href=&#34;#cb14-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb14-38&#34;&gt;&lt;a href=&#34;#cb14-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i + n] = read(), suma += a[i], suma2 += a[i] * a[i];&lt;/span&gt;
&lt;span id=&#34;cb14-39&#34;&gt;&lt;a href=&#34;#cb14-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb14-40&#34;&gt;&lt;a href=&#34;#cb14-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        b[n - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = read(), sumb += b[n - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], sumb2 += b[n - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * b[n - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb14-41&#34;&gt;&lt;a href=&#34;#cb14-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-42&#34;&gt;&lt;a href=&#34;#cb14-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; * n) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-43&#34;&gt;&lt;a href=&#34;#cb14-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb14-44&#34;&gt;&lt;a href=&#34;#cb14-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = (rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb14-45&#34;&gt;&lt;a href=&#34;#cb14-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(a, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(b, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb14-46&#34;&gt;&lt;a href=&#34;#cb14-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim)&lt;/span&gt;
&lt;span id=&#34;cb14-47&#34;&gt;&lt;a href=&#34;#cb14-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i] = a[i] * b[i] % mod;&lt;span class=&#34;co&#34;&gt;//åƒä¸‡ä¸è¦å¿˜è®°å–æ¨¡&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-48&#34;&gt;&lt;a href=&#34;#cb14-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(a, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb14-49&#34;&gt;&lt;a href=&#34;#cb14-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;fl&#34;&gt;1e18&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-50&#34;&gt;&lt;a href=&#34;#cb14-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb14-51&#34;&gt;&lt;a href=&#34;#cb14-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, -m, m)&lt;/span&gt;
&lt;span id=&#34;cb14-52&#34;&gt;&lt;a href=&#34;#cb14-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans = min(ans, suma2 + sumb2 + j * j * n + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j * (suma - sumb) - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * a[i + n]);&lt;/span&gt;
&lt;span id=&#34;cb14-53&#34;&gt;&lt;a href=&#34;#cb14-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb14-54&#34;&gt;&lt;a href=&#34;#cb14-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-55&#34;&gt;&lt;a href=&#34;#cb14-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;bzoj3771-triple&#34;&gt;BZOJ3771 Triple&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æŠŠä»·å€¼åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„æ–§å­ï¼Œæ²³ç¥å¯èƒ½æ‹¿èµ° 1 - 3 æŠŠï¼Œé—®æ¯ç§å¯èƒ½çš„æŸå¤±ä»·å€¼åŠå…¶å¯¹åº”æ–¹æ¡ˆæ•°ã€‚ï¼ˆä¸è®¡é¡ºåºï¼‰&lt;/p&gt;
&lt;p&gt;æ€è·¯ï¼šè¿™æ˜¯ä¸€é“ç”Ÿæˆå‡½æ•°çš„å…¥é—¨é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è®¾å‡ºå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œå…¶ç³»æ•°æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A[a_i] = 1\)&lt;/span&gt;ï¼Œä»£è¡¨é€‰ä¸€æŠŠçš„ã€‚åˆ™ä½ å¯èƒ½ä¼šè§‰å¾—ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(A(x) + A^2(x) + A^3(x)\)&lt;/span&gt;ã€‚ä½†æ˜¯è¿™æ ·æ˜¯æ˜¾ç„¶ä¸å¯¹çš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;å› ä¸ºè¿™æ ·çš„è¯åŒä¸€ä¸ªå…ƒç´ å¯èƒ½è¢«é€‰ä¸¤æ¬¡æˆ–ä¸‰æ¬¡ï¼Œå¯¹äºè¿™ç§æƒ…å†µå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(C(x)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(B[2a_i] = 1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(C[3a_i] = 1\)&lt;/span&gt;ï¼Œä»£è¡¨åŒæ—¶é€‰ä¸¤æ¬¡/ä¸‰æ¬¡çš„ï¼Œå‡æ‰è¿™äº›æ–¹æ¡ˆæ•°å°±å¯ä»¥äº†ã€‚ç„¶åéœ€è¦æ³¨æ„é¡ºåºé—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;é€‰ä¸€æŠŠçš„ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç°é€‰ä¸¤ç§çš„å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{A^2(x) - B(x)}{2}\)&lt;/span&gt;ï¼Œé€‰ä¸‰ç§çš„æ¯”è¾ƒéº»çƒ¦ï¼šä¸èƒ½åŒæ—¶é€‰ä¸¤ç§ä¸€æ ·çš„ï¼Œå³å‡å» &lt;span class=&#34;math inline&#34;&gt;\(3A(x)B(x)\)&lt;/span&gt;ï¼Œï¼Œä½†æ˜¯é€‰ä¸‰ç§åŒæ ·çš„åˆä¼šè¢«å¤šå‡ä¸¤æ¬¡ï¼Œæœ€åé™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(3!\)&lt;/span&gt; å»æ‰é¡ºåºé—®é¢˜ï¼Œæ‰€ä»¥æœ€ç»ˆç­”æ¡ˆä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
A(x) + \frac{A^2(x) - B(x)}{2} + \frac{A^3(x) - 3A(x)B(x) + 2C(x)}{6}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆå‡½æ•°çš„å·ç§¯ä½¿ç”¨ NTT æˆ– FFT ä¼˜åŒ–å³å¯ã€‚æ³¨æ„æ­¤æ—¶ NTT æ¨¡æ•°è¦å–ä¸€ä¸ªæ›´å¤§çš„è´¨æ•°ã€‚&lt;strong&gt;ä¸çŸ¥é“ä¸ºä»€ä¹ˆç”Ÿæˆå‡½æ•°èƒ½è¿™æ ·å¯¹åº”çš„å¯ä»¥æ„ä¼šä¸€ä¸‹å¤šé¡¹å¼å·ç§¯çš„å®šä¹‰å¼ä»¥åŠè¿™äº›ç³»æ•°çš„ç»„åˆæ„ä¹‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb15&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb15-1&#34;&gt;&lt;a href=&#34;#cb15-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll f1[maxn], f2[maxn], f3[maxn], ans[maxn];&lt;/span&gt;
&lt;span id=&#34;cb15-2&#34;&gt;&lt;a href=&#34;#cb15-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll g[maxn], t[maxn];&lt;/span&gt;
&lt;span id=&#34;cb15-3&#34;&gt;&lt;a href=&#34;#cb15-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-4&#34;&gt;&lt;a href=&#34;#cb15-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb15-5&#34;&gt;&lt;a href=&#34;#cb15-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-6&#34;&gt;&lt;a href=&#34;#cb15-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = read();&lt;/span&gt;
&lt;span id=&#34;cb15-7&#34;&gt;&lt;a href=&#34;#cb15-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (n--)&lt;/span&gt;
&lt;span id=&#34;cb15-8&#34;&gt;&lt;a href=&#34;#cb15-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-9&#34;&gt;&lt;a href=&#34;#cb15-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp = read();&lt;/span&gt;
&lt;span id=&#34;cb15-10&#34;&gt;&lt;a href=&#34;#cb15-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++f1[tmp], ++g[tmp], ++ans[tmp];&lt;/span&gt;
&lt;span id=&#34;cb15-11&#34;&gt;&lt;a href=&#34;#cb15-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++f2[tmp &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], ++f3[tmp * &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb15-12&#34;&gt;&lt;a href=&#34;#cb15-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-13&#34;&gt;&lt;a href=&#34;#cb15-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-14&#34;&gt;&lt;a href=&#34;#cb15-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= (&lt;span class=&#34;dv&#34;&gt;40000&lt;/span&gt; * &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;)) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-15&#34;&gt;&lt;a href=&#34;#cb15-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb15-16&#34;&gt;&lt;a href=&#34;#cb15-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = (rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-17&#34;&gt;&lt;a href=&#34;#cb15-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f1, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-18&#34;&gt;&lt;a href=&#34;#cb15-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb15-19&#34;&gt;&lt;a href=&#34;#cb15-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[i] = f1[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb15-20&#34;&gt;&lt;a href=&#34;#cb15-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-21&#34;&gt;&lt;a href=&#34;#cb15-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb15-22&#34;&gt;&lt;a href=&#34;#cb15-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] += (g[i] - f2[i]) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-23&#34;&gt;&lt;a href=&#34;#cb15-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-24&#34;&gt;&lt;a href=&#34;#cb15-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb15-25&#34;&gt;&lt;a href=&#34;#cb15-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[i] = f1[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb15-26&#34;&gt;&lt;a href=&#34;#cb15-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-27&#34;&gt;&lt;a href=&#34;#cb15-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f2, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-28&#34;&gt;&lt;a href=&#34;#cb15-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb15-29&#34;&gt;&lt;a href=&#34;#cb15-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f2[i] = f2[i] * f1[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb15-30&#34;&gt;&lt;a href=&#34;#cb15-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f2, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-31&#34;&gt;&lt;a href=&#34;#cb15-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb15-32&#34;&gt;&lt;a href=&#34;#cb15-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-33&#34;&gt;&lt;a href=&#34;#cb15-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] += (g[i] - &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; * f2[i] + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * f3[i]) / &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-34&#34;&gt;&lt;a href=&#34;#cb15-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ans[i]) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, i, ans[i]);&lt;/span&gt;
&lt;span id=&#34;cb15-35&#34;&gt;&lt;a href=&#34;#cb15-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-36&#34;&gt;&lt;a href=&#34;#cb15-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-37&#34;&gt;&lt;a href=&#34;#cb15-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;fftntt-ä¸å­—ç¬¦ä¸²åŒ¹é…&#34;&gt;FFT/NTT ä¸å­—ç¬¦ä¸²åŒ¹é…&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å­—ç¬¦ä¸²ä¸‹æ ‡ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;æœ€ä¸€èˆ¬çš„æƒ…å†µ&#34;&gt;æœ€ä¸€èˆ¬çš„æƒ…å†µ&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘æ–‡æœ¬ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œæ¨¡å¼ä¸² &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œä¸²é•¿ &lt;span class=&#34;math inline&#34;&gt;\(n = |S|\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m = |T|\)&lt;/span&gt;ï¼Œä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(n \ge m\)&lt;/span&gt;ï¼Œç°åœ¨éœ€è¦æ‰¾å‡º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­å‡ºç°çš„æ¯ä¸ªä½ç½®ã€‚ç›´æ¥è·‘ KMP å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¿™ä¸ªä¸æ˜¯è¦æçš„é‡ç‚¹ã€‚è€ƒè™‘ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå­—ç¬¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S[i]\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåŒ¹é…å°±å¯ä»¥å†™æˆ &lt;span class=&#34;math inline&#34;&gt;\(S[i] - T[j] = 0\)&lt;/span&gt;ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯æ¯”è¾ƒå¥½æƒ³çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½å¼€å§‹æˆåŠŸåŒ¹é…ï¼Œåˆ™æˆ‘ä»¬æœ‰&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{j = 1}^{m} (S[i + j - 1] - T[j])^2 = 0
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢æ­£è´Ÿå·ç›¸äº’æŠµæ¶ˆï¼Œæ‰€ä»¥éœ€è¦å¹³æ–¹ã€‚ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(i + j - 1 + j\)&lt;/span&gt; ä¸æ˜¯å®šå€¼ï¼Œä¸ç¬¦åˆæˆ‘ä»¬éœ€è¦çš„å·ç§¯çš„å½¢å¼ï¼Œæ‰€ä»¥ç¿»è½¬ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; è®©å…¶å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(T&amp;#39;\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{j = 1}^{m} (S[i + j - 1] - T[m - j + 1])^2 = 0
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ‰“å¼€æ¥æˆ‘ä»¬å°±ä¼šå‘ç°&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{j = 1}^{m} (S[i + j - 1]^2 + T[j]^2 - 2S[i + j - 1]T[m - j + 1]) = 0
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(i + j - 1 + m - j + 1 = i + m\)&lt;/span&gt;ï¼Œä¸ºå®šå€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä¸Šé¢çš„å¼å­å°±å¯ä»¥åŒ–æˆ&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{j = 1}^m S[i + j - 1]^2 + \sum_{j = 1}^m T[j]^2 - 2\sum_{x + y = i + m}S[x]T[y]
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€é¡¹ç›´æ¥å‰ç¼€å’Œå°±å¯ä»¥è§£å†³ï¼Œç¬¬äºŒé¡¹å¸¸æ•°ï¼Œç¬¬ä¸‰é¡¹ä½¿ç”¨ FFT/NTTã€‚&lt;/p&gt;
&lt;p&gt;æ›´åŠ å¥½ç†è§£åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f(x) = \sum_{i + j = x + m}S[i]T[j]\)&lt;/span&gt;ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºè¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜æ¥äº†ï¼Œè¿™æ ·éš¾å†™å¤æ‚åº¦é«˜å¸¸æ•°å¤§å…¨æ–¹ä½è¢« KMP åŠæ‰“çš„ç®—æ³•æœ‰ä»€ä¹ˆå­˜åœ¨çš„æ„ä¹‰å—ï¼Ÿå¯¹ä¸èµ·è¿˜çœŸçš„æœ‰ï¼š&lt;/p&gt;
&lt;h4 id=&#34;å¸¦é€šé…ç¬¦çš„å­—ç¬¦ä¸²åŒ¹é…&#34;&gt;å¸¦é€šé…ç¬¦çš„å­—ç¬¦ä¸²åŒ¹é…&lt;/h4&gt;
&lt;p&gt;è¯·çœ‹ä¾‹é¢˜ &lt;a href=&#34;https://www.luogu.com.cn/problem/P4173&#34;&gt;æ´›è°· P4173 æ®‹ç¼ºçš„å­—ç¬¦ä¸²&lt;/a&gt;ã€‚ä»ç„¶æ˜¯å­—ç¬¦ä¸²åŒ¹é…ï¼Œä½†æ˜¯æ¯ä¸ªä¸²éƒ½æœ‰&lt;strong&gt;é€šé…ç¬¦&lt;/strong&gt;ï¼Œè¿™ä¸ªæ—¶å€™ KMP å°±æ˜¾å¾—æ— èƒ½ä¸ºåŠ›äº†ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿå¥½å¥½æ€è€ƒä¸€ä¸‹ä¸¤ä¸ªå­—ç¬¦å¦‚ä½•æ‰èƒ½åŒ¹é…ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¤ä¸ªå­—ç¬¦å®Œå…¨ä¸€æ ·&lt;/li&gt;
&lt;li&gt;å…¶ä¸­è‡³å°‘ä¸€ä¸ªä¸ºé€šé…ç¬¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸¤è€…æ˜¯é€»è¾‘æˆ–çš„å…³ç³»ï¼Œæˆ‘ä»¬é­”æ”¹ä¸€ä¸‹ä¸Šé¢çš„å¼å­ï¼Œä¸éš¾å‘ç°æˆ‘ä»¬åªéœ€è¦æŠŠé€šé…ç¬¦çš„å€¼è®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å°±å¯ä»¥è§£å†³äº†ï¼š&lt;/p&gt;
&lt;p&gt;å®šä¹‰åŒ¹é…å‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(F(x)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä½å¼€å§‹å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; æ˜¯å¦åŒ¹é…ï¼ŒåŒ¹é…çš„è¯ &lt;span class=&#34;math inline&#34;&gt;\(F(x) = 0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
F(x) = \sum_{j = 1}^m(S[x + j - 1] - T[j])^2S[x + j - 1]T[j]
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;åŒ–ç®€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
F(x) &amp;amp;= \sum_{j = 1}^m(S[x + j - 1] - T[j])^2S[x + j - 1]T[j]\\
&amp;amp;= \sum_{j = 1}^m(S[x + j - 1] - T&amp;#39;[m - j + 1])^2S[x + j - 1]T&amp;#39;[m - j + 1]\\
&amp;amp;= \sum_{j = 1}^m(S[x + j - 1]^2 + T&amp;#39;[m - j + 1]^2 - 2S[x + j - 1]T&amp;#39;[m - j + 1])S[x + j - 1]T&amp;#39;[m - j + 1]\\
&amp;amp;= \sum_{j = 1}^m S[x + j - 1]^3T&amp;#39;[m - j + 1] + \sum_{j = 1}^m S[x + j - 1]T&amp;#39;[m - j + 1]^3- 2\sum_{j = 1}^m S[x + j - 1]^2T&amp;#39;[m - j + 1]^2\\
&amp;amp;= \sum_{i + j = x + m}S[i]^3T&amp;#39;[j] + \sum_{i + j = x + m}S[i]T&amp;#39;[j]^3 - 2\sum_{i + j = x + m}S[i]^2T[j]^2
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯é—®é¢˜å°±è§£å†³äº†ï¼Œåªéœ€è¦ç”¨ NTT/FFT è®¡ç®—å‡ºä¸Šé¢ä¸‰é¡¹æ¶å¿ƒçš„ä¸œè¥¿å‡ºæ¥å°± OK äº†ã€‚ä¸€å…±è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(7\)&lt;/span&gt; æ¬¡ NTT å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯æœ€åæšä¸¾ç­”æ¡ˆçš„æ—¶å€™åªèƒ½æšä¸¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n - m + 1\)&lt;/span&gt; å¤„ï¼Œå¦åˆ™åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(35\)&lt;/span&gt; åˆ†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb16&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb16-1&#34;&gt;&lt;a href=&#34;#cb16-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], g[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], f2[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], g2[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], f3[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], g3[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb16-2&#34;&gt;&lt;a href=&#34;#cb16-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], vec[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], tot;&lt;/span&gt;
&lt;span id=&#34;cb16-3&#34;&gt;&lt;a href=&#34;#cb16-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-4&#34;&gt;&lt;a href=&#34;#cb16-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb16-5&#34;&gt;&lt;a href=&#34;#cb16-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb16-6&#34;&gt;&lt;a href=&#34;#cb16-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-7&#34;&gt;&lt;a href=&#34;#cb16-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb16-8&#34;&gt;&lt;a href=&#34;#cb16-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb16-9&#34;&gt;&lt;a href=&#34;#cb16-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    m = readInt(), n = readInt();&lt;/span&gt;
&lt;span id=&#34;cb16-10&#34;&gt;&lt;a href=&#34;#cb16-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb16-11&#34;&gt;&lt;a href=&#34;#cb16-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, b + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb16-12&#34;&gt;&lt;a href=&#34;#cb16-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m)&lt;/span&gt;
&lt;span id=&#34;cb16-13&#34;&gt;&lt;a href=&#34;#cb16-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb16-14&#34;&gt;&lt;a href=&#34;#cb16-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[i] = (a[m - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;) ? &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; : a[m - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-15&#34;&gt;&lt;a href=&#34;#cb16-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g2[i] = g[i] * g[i], g3[i] = g2[i] * g[i];&lt;/span&gt;
&lt;span id=&#34;cb16-16&#34;&gt;&lt;a href=&#34;#cb16-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb16-17&#34;&gt;&lt;a href=&#34;#cb16-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb16-18&#34;&gt;&lt;a href=&#34;#cb16-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb16-19&#34;&gt;&lt;a href=&#34;#cb16-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = (b[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;) ? &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; : b[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-20&#34;&gt;&lt;a href=&#34;#cb16-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f2[i] = f[i] * f[i], f3[i] = f2[i] * f[i];&lt;/span&gt;
&lt;span id=&#34;cb16-21&#34;&gt;&lt;a href=&#34;#cb16-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb16-22&#34;&gt;&lt;a href=&#34;#cb16-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-23&#34;&gt;&lt;a href=&#34;#cb16-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-24&#34;&gt;&lt;a href=&#34;#cb16-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(f2, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(f3, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb16-25&#34;&gt;&lt;a href=&#34;#cb16-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(g2, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(g3, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb16-26&#34;&gt;&lt;a href=&#34;#cb16-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb16-27&#34;&gt;&lt;a href=&#34;#cb16-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f3[i] * g[i] % mod + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i] * g3[i] % mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f2[i] * g2[i] % mod) % mod;&lt;/span&gt;
&lt;span id=&#34;cb16-28&#34;&gt;&lt;a href=&#34;#cb16-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(ans, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb16-29&#34;&gt;&lt;a href=&#34;#cb16-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-30&#34;&gt;&lt;a href=&#34;#cb16-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb16-31&#34;&gt;&lt;a href=&#34;#cb16-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ans[i + m] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb16-32&#34;&gt;&lt;a href=&#34;#cb16-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ++cnt, vec[++tot] = i;&lt;/span&gt;
&lt;span id=&#34;cb16-33&#34;&gt;&lt;a href=&#34;#cb16-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, cnt);&lt;/span&gt;
&lt;span id=&#34;cb16-34&#34;&gt;&lt;a href=&#34;#cb16-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, tot) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, vec[i]);&lt;/span&gt;
&lt;span id=&#34;cb16-35&#34;&gt;&lt;a href=&#34;#cb16-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-36&#34;&gt;&lt;a href=&#34;#cb16-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;å¦å¤–ä¸€é“ä¾‹é¢˜&#34;&gt;å¦å¤–ä¸€é“ä¾‹é¢˜&lt;/h4&gt;
&lt;p&gt;è¯·çœ‹ &lt;a href=&#34;https://www.luogu.com.cn/problem/CF528D&#34;&gt;CF528D Fuzzy Search&lt;/a&gt;ã€‚é¢˜æ„ï¼šå­—ç¬¦ä¸²åŒ¹é…ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le |T| \le |S| \le 2\times 10^5\)&lt;/span&gt;ï¼Œå­—ç¬¦é›†åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\texttt{ATCG}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªä½ç½®å‡ºç°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\forall j\in [1,T]\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\exists p\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(|i + j - 1 - p|\le k \land S[p] = T[j]\)&lt;/span&gt;ã€‚å³åç§»é‡ä¸èƒ½è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å­—ç¬¦é›†å¾ˆå°ï¼Œåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå­—ç¬¦ä¸² 01 åŒ–ï¼Œåˆ†å¼€è€ƒè™‘æ¯ä¸ªå­—æ¯ã€‚æ¯”å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(S = \texttt{ATCGAA}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T = \texttt{ACAA}\)&lt;/span&gt;ï¼Œç°åœ¨åªè€ƒè™‘å­—æ¯ &lt;span class=&#34;math inline&#34;&gt;\(\texttt A\)&lt;/span&gt;ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\texttt A\)&lt;/span&gt; åŒ–æˆ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; è€Œå…¶ä»–çš„åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(S = \texttt{100011}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T= \texttt{1011}\)&lt;/span&gt;ã€‚ç„¶åå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(k = 1\)&lt;/span&gt;ï¼ŒæŠŠèƒ½æ‰©å±•çš„éƒ½å¾€ä¸¤è¾¹æ‰©å±•ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(S = \texttt{110111}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¾åŒ¹é… &lt;span class=&#34;math inline&#34;&gt;\(F(x, c)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä» &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä½å¼€å§‹å­—ç¬¦ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; èƒ½åŒ¹é…çš„æ•°é‡ï¼Œæœ€ç»ˆç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(A(x) = \sum_{c\in\lbrace\texttt{A,T,C,G}\rbrace}F(x,c)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åŒ¹é…æˆåŠŸå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(A(x) = m\)&lt;/span&gt;ï¼Œå³æ‰€æœ‰å­—ç¬¦éƒ½åŒ¹é…åˆ°äº†ï¼Œå¦åˆ™å¤±è´¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(F(x, c) = \sum_{j = 1}^mS[x + j - 1]T[j]\)&lt;/span&gt;ï¼Œè€å¥—è·¯ç¿»è½¬ä¸€ä¸‹å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(F(x, c) = \sum_{j = 1}^m S[x + j - 1]T[m - j + 1] = \sum_{i + j = x + m}S[i]T[j]\)&lt;/span&gt;ã€‚è¿™å°±æ˜¯å–œé—»ä¹è§çš„å·ç§¯å½¢å¼äº†ã€‚NTT ç›´æ¥ä¸Šå°±å®Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb17&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb17-1&#34;&gt;&lt;a href=&#34;#cb17-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], g[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb17-2&#34;&gt;&lt;a href=&#34;#cb17-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb17-3&#34;&gt;&lt;a href=&#34;#cb17-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-4&#34;&gt;&lt;a href=&#34;#cb17-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, k, lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-5&#34;&gt;&lt;a href=&#34;#cb17-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], t[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb17-6&#34;&gt;&lt;a href=&#34;#cb17-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-7&#34;&gt;&lt;a href=&#34;#cb17-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; proc(&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c)&lt;/span&gt;
&lt;span id=&#34;cb17-8&#34;&gt;&lt;a href=&#34;#cb17-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb17-9&#34;&gt;&lt;a href=&#34;#cb17-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    clr(f, lim), clr(g, lim);&lt;/span&gt;
&lt;span id=&#34;cb17-10&#34;&gt;&lt;a href=&#34;#cb17-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, lst = -&lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;; i &amp;lt;= n; ++i)&lt;/span&gt;
&lt;span id=&#34;cb17-11&#34;&gt;&lt;a href=&#34;#cb17-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb17-12&#34;&gt;&lt;a href=&#34;#cb17-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s[i] == c)&lt;/span&gt;
&lt;span id=&#34;cb17-13&#34;&gt;&lt;a href=&#34;#cb17-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            lst = i;&lt;/span&gt;
&lt;span id=&#34;cb17-14&#34;&gt;&lt;a href=&#34;#cb17-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i - lst &amp;lt;= k)&lt;/span&gt;
&lt;span id=&#34;cb17-15&#34;&gt;&lt;a href=&#34;#cb17-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-16&#34;&gt;&lt;a href=&#34;#cb17-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-17&#34;&gt;&lt;a href=&#34;#cb17-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = n, lst = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;; i; --i)&lt;/span&gt;
&lt;span id=&#34;cb17-18&#34;&gt;&lt;a href=&#34;#cb17-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb17-19&#34;&gt;&lt;a href=&#34;#cb17-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s[i] == c)&lt;/span&gt;
&lt;span id=&#34;cb17-20&#34;&gt;&lt;a href=&#34;#cb17-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            lst = i;&lt;/span&gt;
&lt;span id=&#34;cb17-21&#34;&gt;&lt;a href=&#34;#cb17-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (lst - i &amp;lt;= k)&lt;/span&gt;
&lt;span id=&#34;cb17-22&#34;&gt;&lt;a href=&#34;#cb17-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-23&#34;&gt;&lt;a href=&#34;#cb17-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-24&#34;&gt;&lt;a href=&#34;#cb17-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m)&lt;/span&gt;
&lt;span id=&#34;cb17-25&#34;&gt;&lt;a href=&#34;#cb17-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[i] = (t[m - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] == c);&lt;/span&gt;
&lt;span id=&#34;cb17-26&#34;&gt;&lt;a href=&#34;#cb17-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-27&#34;&gt;&lt;a href=&#34;#cb17-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb17-28&#34;&gt;&lt;a href=&#34;#cb17-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb17-29&#34;&gt;&lt;a href=&#34;#cb17-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-30&#34;&gt;&lt;a href=&#34;#cb17-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb17-31&#34;&gt;&lt;a href=&#34;#cb17-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] += f[i + m];&lt;/span&gt;
&lt;span id=&#34;cb17-32&#34;&gt;&lt;a href=&#34;#cb17-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb17-33&#34;&gt;&lt;a href=&#34;#cb17-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-34&#34;&gt;&lt;a href=&#34;#cb17-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb17-35&#34;&gt;&lt;a href=&#34;#cb17-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb17-36&#34;&gt;&lt;a href=&#34;#cb17-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = readInt(), m = readInt(), k = readInt();&lt;/span&gt;
&lt;span id=&#34;cb17-37&#34;&gt;&lt;a href=&#34;#cb17-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-38&#34;&gt;&lt;a href=&#34;#cb17-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, t + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-39&#34;&gt;&lt;a href=&#34;#cb17-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= n + m) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-40&#34;&gt;&lt;a href=&#34;#cb17-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) proc(&lt;span class=&#34;st&#34;&gt;&amp;quot;ATCG&amp;quot;&lt;/span&gt;[i]);&lt;/span&gt;
&lt;span id=&#34;cb17-41&#34;&gt;&lt;a href=&#34;#cb17-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-42&#34;&gt;&lt;a href=&#34;#cb17-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb17-43&#34;&gt;&lt;a href=&#34;#cb17-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cnt += (ans[i] == m);&lt;/span&gt;
&lt;span id=&#34;cb17-44&#34;&gt;&lt;a href=&#34;#cb17-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, cnt);&lt;/span&gt;
&lt;span id=&#34;cb17-45&#34;&gt;&lt;a href=&#34;#cb17-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-46&#34;&gt;&lt;a href=&#34;#cb17-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;å…³äºå°è£…&#34;&gt;å…³äºå°è£…&lt;/h2&gt;
&lt;p&gt;ä»¥åçš„å…¨å®¶æ¡¶ä¼šå¤§é‡ä½¿ç”¨ NTT ç­‰åŸºç¡€æ“ä½œï¼Œè€ƒè™‘å®ç°ä¸€ä¸ªå¸¸æ•°è¾ƒå°çš„ä¸”æ–¹ä¾¿é˜…è¯»çš„å°è£…ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯å„ç§ &lt;code&gt;#define&lt;/code&gt;ã€‚ç”±äºæˆ‘ä»¬åœ¨è¿›è¡Œå¤šé¡¹å¼è¿ç®—çš„æ—¶å€™éœ€è¦è€ƒè™‘ç•Œçš„é—®é¢˜ï¼Œ&lt;strong&gt;å› æ­¤ä¸€å®šè¦æŠŠè¶…è¿‡ç•Œäº†çš„ç»™æ¸…é›¶&lt;/strong&gt;ï¼Œä¸ç„¶å¯èƒ½å‡ºç°å„ç§å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜æ¯”å¦‚å¤šå·äº†ä¹‹ç±»çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb18&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb18-1&#34;&gt;&lt;a href=&#34;#cb18-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-2&#34;&gt;&lt;a href=&#34;#cb18-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-3&#34;&gt;&lt;a href=&#34;#cb18-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-4&#34;&gt;&lt;a href=&#34;#cb18-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-5&#34;&gt;&lt;a href=&#34;#cb18-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb18-6&#34;&gt;&lt;a href=&#34;#cb18-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb18-7&#34;&gt;&lt;a href=&#34;#cb18-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define VEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;v)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)v.size();&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb18-8&#34;&gt;&lt;a href=&#34;#cb18-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-9&#34;&gt;&lt;a href=&#34;#cb18-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define ll &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-10&#34;&gt;&lt;a href=&#34;#cb18-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define ull &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;unsigned&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-11&#34;&gt;&lt;a href=&#34;#cb18-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define clr&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memset(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(n))&lt;/span&gt;
&lt;span id=&#34;cb18-12&#34;&gt;&lt;a href=&#34;#cb18-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define cpy&lt;/span&gt;(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;g,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;n)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memcpy(f,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;g,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;))&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;*&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(n))&lt;/span&gt;
&lt;span id=&#34;cb18-13&#34;&gt;&lt;a href=&#34;#cb18-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define MOD &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;998244353&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;memset&lt;/code&gt; å’Œ &lt;code&gt;memcpy&lt;/code&gt; çš„ç”¨æ³•å»ºè®®è‡ªå·±å»æŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ˜¯ä¸€äº›åŸºæœ¬çš„ä¸œè¥¿ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;vector&lt;/code&gt; æ¥å®ç°å¤šé¡¹å¼ï¼Œè¿™æ ·å­çš„å¥½å¤„æ˜¯å¸¸æ•°ä¸å¤§è€Œä¸”æ–¹ä¾¿å¥½å†™ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb19&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb19-1&#34;&gt;&lt;a href=&#34;#cb19-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; G = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, mod = MOD, maxn = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;17&lt;/span&gt; | &lt;span class=&#34;dv&#34;&gt;500&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-2&#34;&gt;&lt;a href=&#34;#cb19-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; Poly;&lt;/span&gt;
&lt;span id=&#34;cb19-3&#34;&gt;&lt;a href=&#34;#cb19-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll qPow(ll a, ll b = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-4&#34;&gt;&lt;a href=&#34;#cb19-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-5&#34;&gt;&lt;a href=&#34;#cb19-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; b; b &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a = a * a % mod)&lt;/span&gt;
&lt;span id=&#34;cb19-6&#34;&gt;&lt;a href=&#34;#cb19-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (b &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret = a * ret % mod;&lt;/span&gt;
&lt;span id=&#34;cb19-7&#34;&gt;&lt;a href=&#34;#cb19-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb19-8&#34;&gt;&lt;a href=&#34;#cb19-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb19-9&#34;&gt;&lt;a href=&#34;#cb19-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; invG = qPow(G);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;NTT æ—¶éœ€è¦ç”¨åˆ°çš„ä½é€†åºç½®æ¢ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb20&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb20-1&#34;&gt;&lt;a href=&#34;#cb20-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], revLim;&lt;/span&gt;
&lt;span id=&#34;cb20-2&#34;&gt;&lt;a href=&#34;#cb20-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb20-3&#34;&gt;&lt;a href=&#34;#cb20-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; getTr(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb20-4&#34;&gt;&lt;a href=&#34;#cb20-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (revLim == n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-5&#34;&gt;&lt;a href=&#34;#cb20-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    revLim = n;&lt;/span&gt;
&lt;span id=&#34;cb20-6&#34;&gt;&lt;a href=&#34;#cb20-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb20-7&#34;&gt;&lt;a href=&#34;#cb20-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i] = (&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb20-8&#34;&gt;&lt;a href=&#34;#cb20-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·å­å¯ä»¥åœ¨éœ€è¦è¿›è¡Œå¾ˆå¤šæ¬¡ NTT çš„æ—¶å€™æ™ºèƒ½çš„æ±‚å‡ºå¯¹åº”éœ€è¦çš„ &lt;code&gt;tr&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;NTTï¼š&lt;strong&gt;å…³äº &lt;code&gt;static&lt;/code&gt; å…³é”®å­—ç›¸å…³çš„å»ºè®®è‡ªå·±æŸ¥ä¸€ä¸‹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb21&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb21-1&#34;&gt;&lt;a href=&#34;#cb21-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; NTT(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *g, &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; op, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb21-2&#34;&gt;&lt;a href=&#34;#cb21-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    getTr(n);&lt;/span&gt;
&lt;span id=&#34;cb21-3&#34;&gt;&lt;a href=&#34;#cb21-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; ull f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], w[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb21-4&#34;&gt;&lt;a href=&#34;#cb21-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    w[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-5&#34;&gt;&lt;a href=&#34;#cb21-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = (((ll)mod &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) + g[&lt;span class=&#34;fu&#34;&gt;tr&lt;/span&gt;[i]]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb21-6&#34;&gt;&lt;a href=&#34;#cb21-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; l &amp;lt; n; l &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb21-7&#34;&gt;&lt;a href=&#34;#cb21-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ull tG = qPow(op ? G : invG, (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / (l &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb21-8&#34;&gt;&lt;a href=&#34;#cb21-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) w[i] = w[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * tG % mod;&lt;/span&gt;
&lt;span id=&#34;cb21-9&#34;&gt;&lt;a href=&#34;#cb21-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; n; k += (l &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb21-10&#34;&gt;&lt;a href=&#34;#cb21-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; p &amp;lt; l; ++p) {&lt;/span&gt;
&lt;span id=&#34;cb21-11&#34;&gt;&lt;a href=&#34;#cb21-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tt = w[p] * f[k | l | p] % mod;&lt;/span&gt;
&lt;span id=&#34;cb21-12&#34;&gt;&lt;a href=&#34;#cb21-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[k | l | p] = f[k | p] + mod - tt;&lt;/span&gt;
&lt;span id=&#34;cb21-13&#34;&gt;&lt;a href=&#34;#cb21-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[k | p] += tt;&lt;/span&gt;
&lt;span id=&#34;cb21-14&#34;&gt;&lt;a href=&#34;#cb21-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb21-15&#34;&gt;&lt;a href=&#34;#cb21-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb21-16&#34;&gt;&lt;a href=&#34;#cb21-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] %= mod;&lt;/span&gt;
&lt;span id=&#34;cb21-17&#34;&gt;&lt;a href=&#34;#cb21-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-18&#34;&gt;&lt;a href=&#34;#cb21-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!op) {&lt;/span&gt;
&lt;span id=&#34;cb21-19&#34;&gt;&lt;a href=&#34;#cb21-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ull invn = qPow(n);&lt;/span&gt;
&lt;span id=&#34;cb21-20&#34;&gt;&lt;a href=&#34;#cb21-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = f[i] % mod * invn % mod;&lt;/span&gt;
&lt;span id=&#34;cb21-21&#34;&gt;&lt;a href=&#34;#cb21-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) g[i] = f[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb21-22&#34;&gt;&lt;a href=&#34;#cb21-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å…¶ä¸­æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ã€‚ä½¿ç”¨ &lt;code&gt;ull&lt;/code&gt; æ˜¯å› ä¸º &lt;code&gt;ull&lt;/code&gt; å¯ä»¥å¤§å¹…å‡å°‘éœ€è¦çš„å–æ¨¡æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿­ä»£ &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; æ¬¡å†å–æ¨¡ï¼Œå‡å°‘å¸¸æ•°ã€‚è€Œç¬¬äº”è¡Œåˆ™ä¸ºå»æ‰ä¼ è¿›æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\([x^i]g(x)\)&lt;/span&gt; ä¸ºè´Ÿæ•°æ—¶å¯èƒ½äº§ç”Ÿçš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯ &lt;code&gt;poly&lt;/code&gt; çš„å¸¸è§è¿ç®—ï¼Œé‡è½½äº†ä¹‹åä¼šéå¸¸æ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb22&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb22-1&#34;&gt;&lt;a href=&#34;#cb22-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; mul(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *g, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb22-2&#34;&gt;&lt;a href=&#34;#cb22-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb22-3&#34;&gt;&lt;a href=&#34;#cb22-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-4&#34;&gt;&lt;a href=&#34;#cb22-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb22-5&#34;&gt;&lt;a href=&#34;#cb22-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-6&#34;&gt;&lt;a href=&#34;#cb22-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb22-7&#34;&gt;&lt;a href=&#34;#cb22-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C = A; C.resize(max(A.size(), B.size()));&lt;/span&gt;
&lt;span id=&#34;cb22-8&#34;&gt;&lt;a href=&#34;#cb22-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    VEC(i, B) C[i] = (C[i] + B[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb22-9&#34;&gt;&lt;a href=&#34;#cb22-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb22-10&#34;&gt;&lt;a href=&#34;#cb22-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb22-11&#34;&gt;&lt;a href=&#34;#cb22-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb22-12&#34;&gt;&lt;a href=&#34;#cb22-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C = A; C.resize(max(A.size(), B.size()));&lt;/span&gt;
&lt;span id=&#34;cb22-13&#34;&gt;&lt;a href=&#34;#cb22-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    VEC(i, B) C[i] = (C[i] + mod - B[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb22-14&#34;&gt;&lt;a href=&#34;#cb22-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb22-15&#34;&gt;&lt;a href=&#34;#cb22-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb22-16&#34;&gt;&lt;a href=&#34;#cb22-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb22-17&#34;&gt;&lt;a href=&#34;#cb22-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C = A;&lt;/span&gt;
&lt;span id=&#34;cb22-18&#34;&gt;&lt;a href=&#34;#cb22-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    VEC(i, A) C[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * c * C[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb22-19&#34;&gt;&lt;a href=&#34;#cb22-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb22-20&#34;&gt;&lt;a href=&#34;#cb22-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb22-21&#34;&gt;&lt;a href=&#34;#cb22-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-22&#34;&gt;&lt;a href=&#34;#cb22-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim;&lt;span class=&#34;co&#34;&gt;//ä»£è¡¨å¤šé¡¹å¼è¿ç®—æ—¶çš„ç•Œ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-23&#34;&gt;&lt;a href=&#34;#cb22-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-24&#34;&gt;&lt;a href=&#34;#cb22-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B) {&lt;/span&gt;
&lt;span id=&#34;cb22-25&#34;&gt;&lt;a href=&#34;#cb22-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], b[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb22-26&#34;&gt;&lt;a href=&#34;#cb22-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cpy(a, &amp;amp;A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], A.size());&lt;/span&gt;
&lt;span id=&#34;cb22-27&#34;&gt;&lt;a href=&#34;#cb22-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cpy(b, &amp;amp;B[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], B.size());&lt;/span&gt;
&lt;span id=&#34;cb22-28&#34;&gt;&lt;a href=&#34;#cb22-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C; C.resize(min(lim, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(A.size() + B.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)));&lt;/span&gt;
&lt;span id=&#34;cb22-29&#34;&gt;&lt;a href=&#34;#cb22-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (n = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; n &amp;lt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)(A.size() + B.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); n &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-30&#34;&gt;&lt;a href=&#34;#cb22-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(a, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n), NTT(b, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb22-31&#34;&gt;&lt;a href=&#34;#cb22-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    mul(a, b, n), NTT(a, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb22-32&#34;&gt;&lt;a href=&#34;#cb22-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cpy(&amp;amp;C[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], a, C.size());&lt;/span&gt;
&lt;span id=&#34;cb22-33&#34;&gt;&lt;a href=&#34;#cb22-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    clr(a, n), clr(b, n);&lt;/span&gt;
&lt;span id=&#34;cb22-34&#34;&gt;&lt;a href=&#34;#cb22-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb22-35&#34;&gt;&lt;a href=&#34;#cb22-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼ä¹˜æ³•é€†&#34;&gt;å¤šé¡¹å¼ä¹˜æ³•é€†&lt;/h2&gt;
&lt;h3 id=&#34;å®šä¹‰&#34;&gt;å®šä¹‰&lt;/h3&gt;
&lt;p&gt;å½“ä¸¤ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(F(x)\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt; åœ¨æ¯ä¸€é¡¹ç³»æ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; æ—¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(F(x)*G(x)\equiv 1\pmod{x^n}\)&lt;/span&gt; æ—¶ï¼Œç§° &lt;span class=&#34;math inline&#34;&gt;\(F(x)\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt; äº’ä¸ºä¹˜æ³•é€†å…ƒã€‚æ­¤å¤„ &lt;span class=&#34;math inline&#34;&gt;\(\pmod{x^n}\)&lt;/span&gt; ä»£è¡¨æ¬¡æ•°é«˜äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„é¡¹éƒ½ä¸è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦çš„å‰ç½®çŸ¥è¯†ï¼šNTTã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ±‚æ³•&#34;&gt;æ±‚æ³•&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘å€å¢ã€‚å‡è®¾æˆ‘ä»¬è¦æ±‚æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(F(x)*G(x)\equiv 1\pmod{x^k}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt;ï¼Œå¹¶ä¸”å·²ç»æ±‚å‡ºäº†æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(F(x)*G&amp;#39;(x)\equiv1\pmod{x^{\lceil\frac x 2\rceil}}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(G&amp;#39;(x)\)&lt;/span&gt;ã€‚é‚£ä¹ˆæˆ‘ä»¬ç”± &lt;span class=&#34;math display&#34;&gt;\[
F(x)*G&amp;#39;(x)\equiv1\pmod{x^{\lceil\frac x 2\rceil}}
\]&lt;/span&gt; å¿…ç„¶å¯ä»¥æ¨å‡º &lt;span class=&#34;math display&#34;&gt;\[
F(x)*G(x)\equiv1\pmod{x^{\lceil\frac x 2\rceil}}
\]&lt;/span&gt; é‚£ä¹ˆ &lt;span class=&#34;math display&#34;&gt;\[
G(x) \equiv G&amp;#39;(x)\pmod{x^{\lceil\frac x 2\rceil}}
\]&lt;/span&gt; ä½œå·®ï¼Œ &lt;span class=&#34;math display&#34;&gt;\[
G(x) - G&amp;#39;(x)\equiv 0\pmod{x^{\lceil\frac x2\rceil}}
\]&lt;/span&gt; å°†ä¸¤è¾¹åŒæ—¶å¹³æ–¹ï¼Œä¸éš¾å‘ç°ç•Œä¼šä» &lt;span class=&#34;math inline&#34;&gt;\(\lceil\frac n2\rceil\)&lt;/span&gt; å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
G^2(x) - 2G(x)G&amp;#39;(x) + G&amp;#39;^2(x)\equiv 0\pmod{x^n}
\]&lt;/span&gt; ç°åœ¨è¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt;ï¼Œè€Œæˆ‘ä»¬å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(G^2(x)\)&lt;/span&gt; ä¸å¥½å¤„ç†ï¼Œæ€ä¹ˆåŠï¼ŸåŒæ—¶ä¹˜ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(F(x)\)&lt;/span&gt; å°±å¯ä»¥æ¶ˆæ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt;ï¼š &lt;span class=&#34;math display&#34;&gt;\[
G(x) - 2G&amp;#39;(x) + G&amp;#39;^2(x)F(x)\equiv 0\pmod{x^n}
\]&lt;/span&gt; æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº† &lt;span class=&#34;math display&#34;&gt;\[
G(x)\equiv 2G&amp;#39;(x) - G&amp;#39;^2(x)F(x)\pmod{x^n}
\]&lt;/span&gt; æ ¹æ®è¿™ä¸ªï¼Œæˆ‘ä»¬å°±å¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(G&amp;#39;(x)\)&lt;/span&gt; æ¨å‡º &lt;span class=&#34;math inline&#34;&gt;\(G(x)\)&lt;/span&gt; çš„å€¼å‡ºæ¥äº†ã€‚ä»ä¸Šå¾€ä¸‹é€’å½’æ±‚è§£ï¼Œåˆ°å¸¸æ•°é¡¹çš„æ—¶å€™ç›´æ¥è´¹é©¬å°å®šç†æ±‚é€†å…ƒç„¶åä¸€æ­¥æ­¥å›æº¯ä¸Šå»ã€‚ä¸éš¾å‘ç°å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(T(n) = T(n/2) + O(n\log n)\)&lt;/span&gt;ï¼Œç”±ä¸»å®šç†çŸ¥æ€»å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°-1&#34;&gt;å®ç°&lt;/h3&gt;
&lt;p&gt;é€’å½’ç‰ˆå¤šé¡¹å¼æ±‚é€†ï¼Œå¥—ç”¨ä¸Šé¢çš„æ¿å­ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb23&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb23-1&#34;&gt;&lt;a href=&#34;#cb23-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polyInv(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, Poly &amp;amp;B, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb23-2&#34;&gt;&lt;a href=&#34;#cb23-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-3&#34;&gt;&lt;a href=&#34;#cb23-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) B.push_back(qPow(A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]));&lt;/span&gt;
&lt;span id=&#34;cb23-4&#34;&gt;&lt;a href=&#34;#cb23-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb23-5&#34;&gt;&lt;a href=&#34;#cb23-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        polyInv(A, B, --n);&lt;/span&gt;
&lt;span id=&#34;cb23-6&#34;&gt;&lt;a href=&#34;#cb23-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sav = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-7&#34;&gt;&lt;a href=&#34;#cb23-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sav = (sav + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * B[i] * A[n - i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb23-8&#34;&gt;&lt;a href=&#34;#cb23-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * sav * qPow(mod - A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]) % mod);&lt;/span&gt;
&lt;span id=&#34;cb23-9&#34;&gt;&lt;a href=&#34;#cb23-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb23-10&#34;&gt;&lt;a href=&#34;#cb23-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        polyInv(A, B, n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-11&#34;&gt;&lt;a href=&#34;#cb23-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly sA; sA.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb23-12&#34;&gt;&lt;a href=&#34;#cb23-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cpy(&amp;amp;sA[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], &amp;amp;A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], n);&lt;/span&gt;
&lt;span id=&#34;cb23-13&#34;&gt;&lt;a href=&#34;#cb23-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * B - B * B * sA;&lt;/span&gt;
&lt;span id=&#34;cb23-14&#34;&gt;&lt;a href=&#34;#cb23-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb23-15&#34;&gt;&lt;a href=&#34;#cb23-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb23-16&#34;&gt;&lt;a href=&#34;#cb23-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-17&#34;&gt;&lt;a href=&#34;#cb23-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb23-18&#34;&gt;&lt;a href=&#34;#cb23-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polyInv(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb23-19&#34;&gt;&lt;a href=&#34;#cb23-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C; polyInv(A, C, A.size());&lt;/span&gt;
&lt;span id=&#34;cb23-20&#34;&gt;&lt;a href=&#34;#cb23-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb23-21&#34;&gt;&lt;a href=&#34;#cb23-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å…¶ä¸­æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¥‡æ•°çš„æƒ…å†µè¿›è¡Œäº†ç‰¹åˆ¤ä¼˜åŒ–ï¼Œè°ƒç”¨å°±ç›´æ¥å¯¹ä¸‹é¢çš„ &lt;code&gt;polyInv&lt;/code&gt; å‡½æ•°ä¼ å…¥ä¸€ä¸ª &lt;code&gt;vector&lt;/code&gt; å³å¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼çš„å¯¼æ•°ç§¯åˆ†å¤åˆ&#34;&gt;å¤šé¡¹å¼çš„å¯¼æ•°/ç§¯åˆ†/å¤åˆ&lt;/h2&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹ä¸€äº›åŸºç¡€çš„å¯¼æ•°å…¬å¼ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f(x) = e^x&amp;amp;\implies f&amp;#39;(x) = e^x\\
f(x) = \ln x&amp;amp;\implies f&amp;#39;(x) = \frac1x\\
f(x) = ax^k&amp;amp;\implies f&amp;#39;(x) = akx^{k - 1}\\
(f(x)\pm g(x))&amp;#39;&amp;amp;= f&amp;#39;(x)\pm g&amp;#39;(x)\\
(f(g(x)))&amp;#39; &amp;amp;=f&amp;#39;(g(x))\times g&amp;#39;(x)
\end{aligned}
\]&lt;/span&gt; æˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰ä¸€ä¸‹å¤šé¡¹å¼çš„æ±‚å¯¼ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f(x) = \sum_{i = 0}^na_ix^i\implies f&amp;#39;(x) = \sum_{i = 0}^{n - 1}(i + 1)a_{i + 1}x^i
\]&lt;/span&gt; ç§¯åˆ†ä¸ºæ±‚å¯¼çš„é€†è¿ç®—ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f(x) = \sum_{i = 0}^na_ix_i\implies\int f(x) \mathrm dx= \sum_{i = 1}^{n + 1}\frac{a_{i - 1}x^i}{i}
\]&lt;/span&gt; æ‰€ä»¥å¤šé¡¹å¼æ±‚å¯¼å’Œæ±‚ç§¯åˆ†çš„ä»£ç å°±å¾ˆå®¹æ˜“å†™å‡ºæ¥äº†ï¼Œå½“ç„¶éœ€è¦ä¸€å¼€å§‹çº¿æ€§é¢„å¤„ç†ä¸€ä¸‹é€†å…ƒã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb24&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb24-1&#34;&gt;&lt;a href=&#34;#cb24-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; inv[maxn];&lt;/span&gt;
&lt;span id=&#34;cb24-2&#34;&gt;&lt;a href=&#34;#cb24-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; initInv() {&lt;/span&gt;
&lt;span id=&#34;cb24-3&#34;&gt;&lt;a href=&#34;#cb24-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    inv[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-4&#34;&gt;&lt;a href=&#34;#cb24-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, lim) inv[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * inv[mod % i] * (mod - mod / i) % mod;&lt;/span&gt;
&lt;span id=&#34;cb24-5&#34;&gt;&lt;a href=&#34;#cb24-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-6&#34;&gt;&lt;a href=&#34;#cb24-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb24-7&#34;&gt;&lt;a href=&#34;#cb24-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb24-8&#34;&gt;&lt;a href=&#34;#cb24-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly deri(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb24-9&#34;&gt;&lt;a href=&#34;#cb24-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C = A;&lt;/span&gt;
&lt;span id=&#34;cb24-10&#34;&gt;&lt;a href=&#34;#cb24-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)C.size(); ++i) C[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * C[i] * i % mod;&lt;/span&gt;
&lt;span id=&#34;cb24-11&#34;&gt;&lt;a href=&#34;#cb24-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!C.empty()) C.pop_back();&lt;/span&gt;
&lt;span id=&#34;cb24-12&#34;&gt;&lt;a href=&#34;#cb24-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb24-13&#34;&gt;&lt;a href=&#34;#cb24-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb24-14&#34;&gt;&lt;a href=&#34;#cb24-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb24-15&#34;&gt;&lt;a href=&#34;#cb24-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly ints(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb24-16&#34;&gt;&lt;a href=&#34;#cb24-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C = A;&lt;/span&gt;
&lt;span id=&#34;cb24-17&#34;&gt;&lt;a href=&#34;#cb24-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)C.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; --i)&lt;/span&gt;
&lt;span id=&#34;cb24-18&#34;&gt;&lt;a href=&#34;#cb24-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        C[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * C[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * inv[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb24-19&#34;&gt;&lt;a href=&#34;#cb24-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!C.empty()) C[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-20&#34;&gt;&lt;a href=&#34;#cb24-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb24-21&#34;&gt;&lt;a href=&#34;#cb24-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;éœ€è¦éå¸¸æ³¨æ„ä¼ è¿›æ¥çš„å¤šé¡¹å¼ä¸ºç©ºçš„æƒ…å†µï¼Œå¯¹ç©º &lt;code&gt;vector&lt;/code&gt; è¿›è¡Œè°ƒç”¨ &lt;code&gt;pop_back()&lt;/code&gt; å’Œè®¿é—®å…ƒç´ ä¼šç›´æ¥ REï¼Œéœ€è¦æ³¨æ„ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰å¤šé¡¹å¼çš„å¤åˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(g(x)) = \sum_{i = 0}f_i(g(x))^i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;åº”è¯¥æ¯”è¾ƒå¥½ç†è§£ï¼Œç›´æ¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt; ä»£å…¥å³å¯ã€‚åé¢å­¦ä¹ ç‰›é¡¿è¿­ä»£çš„æ—¶å€™éœ€è¦ç”¨åˆ°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç‰›é¡¿è¿­ä»£æ³•&#34;&gt;ç‰›é¡¿è¿­ä»£æ³•&lt;/h2&gt;
&lt;p&gt;è¿™èŠ‚å†…å®¹ç›¸å½“é‡è¦ï¼Œæ˜¯åé¢å­¦ä¹ å¼€æ ¹å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; çš„åŸºç¡€ï¼Œå»ºè®®æŒæ¡å¥½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç‰›è¿­æ±‚å‡½æ•°é›¶ç‚¹&#34;&gt;ç‰›è¿­æ±‚å‡½æ•°é›¶ç‚¹&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆå„ä½å¦‚æœå­¦è¿‡æ—§äººæ•™ç‰ˆé€‰ä¿® 2-2 çš„è¯åº”è¯¥éƒ½æœ‰çœ‹åˆ°è¿‡ç‰›é¡¿è¿­ä»£ã€‚&lt;/p&gt;
&lt;p&gt;ç‰›é¡¿è¿­ä»£æ˜¯ä¸€ç§æ±‚å‡½æ•°é›¶ç‚¹çš„æ–¹æ³•ã€‚è®¾åˆå§‹è¿‘ä¼¼å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x_0\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬æœ‰è¿™ç‚¹çš„åˆ‡çº¿æ–¹ç¨‹ &lt;span class=&#34;math display&#34;&gt;\[
y = f&amp;#39;(x_0)(x - x_0) + f(x_0)
\]&lt;/span&gt; ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(y = 0\)&lt;/span&gt;ï¼Œå¾— &lt;span class=&#34;math inline&#34;&gt;\(x = x_0 - \dfrac{f(x_0)}{f&amp;#39;(x_0)}\)&lt;/span&gt;ã€‚è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥ä¸€ç›´è¿­ä»£ä¸‹å»ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x_0\leftarrow x\)&lt;/span&gt;ï¼Œå°±å¯ä»¥åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å¾ˆæ¥è¿‘åœ°å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„é›¶ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ³°å‹’å±•å¼€&#34;&gt;æ³°å‹’å±•å¼€&lt;/h3&gt;
&lt;p&gt;ç®€å•æ‰¯ä¸€æ‰¯å§ï¼Œå®é™…ä¸Šå°±æ˜¯ä½¿ç”¨å¤šé¡¹å¼å‡½æ•°æ¥æ‹Ÿåˆ &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt; å•Š &lt;span class=&#34;math inline&#34;&gt;\(\sin\)&lt;/span&gt; å•Šè¿™ç±»çš„å‡½æ•°ï¼ˆå› ä¸ºå¤šé¡¹å¼çœŸçš„æ–¹ä¾¿å•Šï¼‰ï¼Œå…¶åŸç†å°±æ˜¯åœ¨è¦æ±‚çš„å‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; ä¸Šæ‰¾ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x_0\)&lt;/span&gt;ï¼Œæ„é€ ä¸€ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt; ä½¿å¾—è¿™ä¸ªå¤šé¡¹å¼åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x_0\)&lt;/span&gt; å¤„çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; é˜¶å¯¼æ•°éƒ½ç›¸ç­‰ï¼Œéšç€ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; è¶Šæ¥è¶Šå¤§ï¼Œæ‹Ÿåˆçš„æ•ˆæœå°±è¶Šæ¥è¶Šå¥½ã€‚&lt;/p&gt;
&lt;p&gt;æ³°å‹’å±•å¼€çš„å…¬å¼æ˜¯é•¿è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x) = \frac{f(x_0)}{0!}(x - x_0)^0 + \frac{f&amp;#39;(x_0)}{1!}(x - x_0)^1 + \frac{f&amp;#39;&amp;#39;(x_0)}{2!}(x - x_0)^2 + \cdots + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n + R_n(x)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…å†™æˆ&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x) \approx \sum_{i = 0}^n\frac{f^{(i)}(x_0)}{i!}(x - x_0)^i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(f^{(i)}(x_0)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x_0\)&lt;/span&gt; å¤„çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; é˜¶å¯¼æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(x_0 = 0\)&lt;/span&gt; æ—¶å¾—åˆ°çš„çº§æ•°å°±æ˜¯éº¦å…‹åŠ³æ—çº§æ•°ï¼Œä¸‹é¢çš„ä¸œè¥¿éœ€è¦ç‰¢è®°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\mathrm e^x &amp;amp;= \sum_{k = 0}^\infty\frac{x^k}{k!}\\
\sin x &amp;amp;= x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots + (-1)^n\frac{x^{2n - 1}}{(2n - 1)!} + \cdots\\
&amp;amp;= \sum_{i = 0}^\infty(-1)^i\frac{x^{2i - 1}}{(2i - 1)!}\\
\cos x &amp;amp;= 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \cdots + (-1)^n\frac{x^{2n}}{(2n)!}+\cdots\\
&amp;amp;= \sum_{i = 0}^\infty(-1)^i\frac{x^{2i}}{(2i)!}\\
\ln(1 + x) &amp;amp;= \sum_{i = 1}^\infty(-1)^{i - 1}\frac{x^i}{i}\\
\ln(1 - x) &amp;amp;= -\sum_{i = 1}^\infty\frac{x^i}{i}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å¤šé¡¹å¼çš„ &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt; æ˜¯å¦‚æ˜¯å®šä¹‰çš„ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\ln(1 - f(x)) = -\sum_{i = 1}^{+\infty}\frac{f^i(x)}{i}\\\ln(1 + f(x)) = \sum_{i = 1}^{+\infty}\frac{(-1)^{i - 1}f^i(x)}{i}
\]&lt;/span&gt; å¤šé¡¹å¼çš„ &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; åˆ™æ˜¯è¿™æ ·ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\exp f(x) = e^{f(x)}=\sum_{i = 0}^{+\infty}\frac{f^i(x)}{i!}
\]&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼ç‰›è¿­&#34;&gt;å¤šé¡¹å¼ç‰›è¿­&lt;/h3&gt;
&lt;p&gt;ç°åœ¨è¦è§£å†³çš„æ˜¯ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt;ï¼Œæ±‚æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(g(f(x))\equiv 0\pmod{x^n}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt;ï¼ˆæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(x^n\)&lt;/span&gt; æ„ä¹‰ä¸‹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å€å¢ã€‚&lt;/p&gt;
&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(n = 1\)&lt;/span&gt; çš„æ—¶å€™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\([x^0]g(f(x)) = 0\)&lt;/span&gt; çš„è§£è¦å•ç‹¬çš„ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å·²ç»æ±‚å‡ºäº†æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(x^{\left\lceil\frac n 2\right\rceil}\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„è§£ &lt;span class=&#34;math inline&#34;&gt;\(f_0(x)\)&lt;/span&gt;ï¼Œè¦æ±‚æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(x^n\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(g(f(x))\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_0(x)\)&lt;/span&gt; å¤„æ³°å‹’å±•å¼€ï¼Œæœ‰ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 0}^{+\infty}\frac{g^{(i)}(f_0(x))}{i!}(f(x) - f_0(x))^i\equiv 0\pmod{x^n}
\]&lt;/span&gt; å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(x) - f_0(x)\)&lt;/span&gt; çš„æœ€ä½éé›¶é¡¹æ¬¡æ•°æœ€ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\left\lceil\frac n 2\right\rceil\)&lt;/span&gt;ï¼Œæ‰€ä»¥å½“ &lt;span class=&#34;math inline&#34;&gt;\(i\ge 2\)&lt;/span&gt; æ—¶æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
(f(x) - f_0(x))^i\equiv 0\pmod{x^n}
\]&lt;/span&gt; æ‰€ä»¥æ³°å‹’å±•å¼€çš„ç»“æœä¸º &lt;span class=&#34;math display&#34;&gt;\[
g(f_0(x)) + g&amp;#39;(f_0(x))(f(x) - f_0(x))\equiv 0\pmod{x^n}
\]&lt;/span&gt; åŒ–ç®€ä¸‹æ¥å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
f(x)\equiv f_0(x) - \frac{g(f_0(x))}{g&amp;#39;(f_0(x))}\pmod{x^n}
\]&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;åº”ç”¨&#34;&gt;åº”ç”¨&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªå½¢å¼å¯èƒ½æš‚æ—¶çœ‹ä¸å‡ºæ¥æœ‰ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯ç­‰ä¸€ä¸‹æ¶‰åŠåˆ° &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; å’Œå¤šé¡¹å¼å¼€æ ¹ç­‰æ“ä½œæ—¶å…¶å°±ä¼šå‘æŒ¥å¤§ä½œç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼å¯¹æŒ‡å¼€æ ¹&#34;&gt;å¤šé¡¹å¼å¯¹æŒ‡å¼€æ ¹&lt;/h2&gt;
&lt;p&gt;å»ºè®®å…ˆäº†è§£æ¸…æ¥šé«˜ä¸­æ•°å­¦å¿…ä¿® 1 ä¸­çš„å¯¹æ•°å‡½æ•°/æŒ‡æ•°å‡½æ•°/å¹‚å‡½æ•°ä»¥åŠä¸€äº›æœ€åŸºç¡€çš„å¾®ç§¯åˆ†çŸ¥è¯†ï¼ˆåŸºç¡€å¯¼æ•°å…¬å¼ï¼Œæ³°å‹’å±•å¼€ï¼‰&lt;/p&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼-ln&#34;&gt;å¤šé¡¹å¼ ln&lt;/h3&gt;
&lt;h4 id=&#34;é—®é¢˜æè¿°-1&#34;&gt;é—®é¢˜æè¿°&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\equiv \ln A(x) \pmod{x^n}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±ä¸Šæ–‡å¤šé¡¹å¼å¯¹æ•°çš„å®šä¹‰ï¼Œ&lt;strong&gt;å¤šé¡¹å¼çš„å¯¹æ•°ä»…åœ¨å¸¸æ•°é¡¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ—¶æ‰æœ‰æ„ä¹‰ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ±‚æ³•-1&#34;&gt;æ±‚æ³•&lt;/h4&gt;
&lt;p&gt;ä¸ç®¡é‚£ä¹ˆå¤šäº†ï¼Œç›´æ¥æ±‚å¯¼å†ç§¯åˆ†ç§¯å›å»å°±å¯ä»¥äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
(\ln A(x))&amp;#39; &amp;amp;= \frac{A&amp;#39;(x)}{A(x)}\\
\ln A(x) &amp;amp;= \int \frac{A&amp;#39;(x)}{A(x)}\mathrm{d}x
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‡åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\pmod{x^n}\)&lt;/span&gt; æ„ä¹‰ä¸‹è¿›è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€æ±‚å¯¼ï¼Œæ±‚é€†ï¼Œä¹˜èµ·æ¥å†ç§¯ä¸ªåˆ†å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å®ç°-2&#34;&gt;å®ç°&lt;/h4&gt;
&lt;p&gt;å°±ä¸€è¡Œï¼Œè¶…çº§çŸ­ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb25&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb25-1&#34;&gt;&lt;a href=&#34;#cb25-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polyLn(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb25-2&#34;&gt;&lt;a href=&#34;#cb25-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ints(deri(A) * polyInv(A));&lt;/span&gt;
&lt;span id=&#34;cb25-3&#34;&gt;&lt;a href=&#34;#cb25-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4725&#34;&gt;æ´›è°· 4725&lt;/a&gt; çš„å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb26&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb26-1&#34;&gt;&lt;a href=&#34;#cb26-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb26-2&#34;&gt;&lt;a href=&#34;#cb26-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f;&lt;/span&gt;
&lt;span id=&#34;cb26-3&#34;&gt;&lt;a href=&#34;#cb26-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-4&#34;&gt;&lt;a href=&#34;#cb26-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb26-5&#34;&gt;&lt;a href=&#34;#cb26-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb26-6&#34;&gt;&lt;a href=&#34;#cb26-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = n; initInv();&lt;/span&gt;
&lt;span id=&#34;cb26-7&#34;&gt;&lt;a href=&#34;#cb26-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb26-8&#34;&gt;&lt;a href=&#34;#cb26-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(f[i]);&lt;/span&gt;
&lt;span id=&#34;cb26-9&#34;&gt;&lt;a href=&#34;#cb26-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f = polyLn(f);&lt;/span&gt;
&lt;span id=&#34;cb26-10&#34;&gt;&lt;a href=&#34;#cb26-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f);&lt;/span&gt;
&lt;span id=&#34;cb26-11&#34;&gt;&lt;a href=&#34;#cb26-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-12&#34;&gt;&lt;a href=&#34;#cb26-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼-exp&#34;&gt;å¤šé¡¹å¼ exp&lt;/h3&gt;
&lt;h4 id=&#34;é—®é¢˜æè¿°-2&#34;&gt;é—®é¢˜æè¿°&lt;/h4&gt;
&lt;p&gt;ç»™å®šå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\equiv \exp A(x)\pmod{x^n}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤šé¡¹å¼çš„æŒ‡æ•°å‡½æ•°ä»…åœ¨å¸¸æ•°é¡¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ—¶æ‰æœ‰æ„ä¹‰ï¼Œ&lt;/strong&gt;å¦åˆ™å¸¸æ•°é¡¹å°†ä¸æ”¶æ•›ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ±‚æ³•-1-ç‰›é¡¿è¿­ä»£&#34;&gt;æ±‚æ³• 1 ç‰›é¡¿è¿­ä»£&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘ä½¿ç”¨ç‰›é¡¿è¿­ä»£ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}B(x)&amp;amp;\equiv \exp A(x)&amp;amp;\pmod{x^n}\\\ln B(x) - A(x)&amp;amp;\equiv 0&amp;amp;\pmod{x^n}\\\end{aligned}
\]&lt;/span&gt; ç°åœ¨æˆ‘ä»¬æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt; çœ‹æˆä¸€ä¸ªå¸¸æ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; çœ‹æˆä¸€ä¸ªå˜é‡ï¼Œåˆ™æˆ‘ä»¬å°±æ˜¯è¦æ±‚è¿™ä¸ªå‹¾å…«ä¸œè¥¿çš„é›¶ç‚¹ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(G(B(x)) \equiv \ln B(x) - A(x)\pmod{x^n}\)&lt;/span&gt;ï¼Œè¿™ä¸ªä¸œè¥¿æ±‚å¯¼æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(G&amp;#39;(B(x))\equiv \dfrac{1}{B(x)}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¥—ç”¨ä¸€ä¸‹ä¸Šé¢çš„ç‰›è¿­å¼å­ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»æå®šäº†æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(x^{\left\lceil\frac n 2\right\rceil}\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„è§£ &lt;span class=&#34;math inline&#34;&gt;\(B_0(x)\)&lt;/span&gt;ï¼Œè¦æ±‚æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(x^n\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt;ã€‚ç„¶åå°±æœ‰äº† &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}B(x) &amp;amp;\equiv B_0(x) - \frac{G(B_0(x))}{G&amp;#39;(B_0(x))}\\&amp;amp;\equiv B_0(x) - (\ln B_0(x) - A(x))B_0(x)\\&amp;amp;\equiv B_0(x)(1 - \ln B_0(x) + A(x))\pmod{x^n}\end{aligned}
\]&lt;/span&gt; è¿™æ ·å­æˆ‘ä»¬å°±æˆåŠŸçš„æŠŠé€’æ¨å¼å†™å‡ºæ¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å®ç°-1-1&#34;&gt;å®ç° 1&lt;/h4&gt;
&lt;p&gt;è¿™ç§é€’å½’å†™èµ·æ–¹ä¾¿çš„å°±å†™é€’å½’å¥½ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb27&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb27-1&#34;&gt;&lt;a href=&#34;#cb27-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polyExp(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, Poly &amp;amp;B, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb27-2&#34;&gt;&lt;a href=&#34;#cb27-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-3&#34;&gt;&lt;a href=&#34;#cb27-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) B.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-4&#34;&gt;&lt;a href=&#34;#cb27-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb27-5&#34;&gt;&lt;a href=&#34;#cb27-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        polyExp(A, B, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;); n -= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-6&#34;&gt;&lt;a href=&#34;#cb27-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sav = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-7&#34;&gt;&lt;a href=&#34;#cb27-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) sav = (sav + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * A[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod * B[n - i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb27-8&#34;&gt;&lt;a href=&#34;#cb27-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * sav * inv[n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod);&lt;/span&gt;
&lt;span id=&#34;cb27-9&#34;&gt;&lt;a href=&#34;#cb27-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb27-10&#34;&gt;&lt;a href=&#34;#cb27-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        polyExp(A, B, n / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-11&#34;&gt;&lt;a href=&#34;#cb27-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Poly lnB = B;&lt;/span&gt;
&lt;span id=&#34;cb27-12&#34;&gt;&lt;a href=&#34;#cb27-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        lnB.resize(n); lnB = polyLn(lnB);&lt;/span&gt;
&lt;span id=&#34;cb27-13&#34;&gt;&lt;a href=&#34;#cb27-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        VEC(i, lnB) lnB[i] = (mod + A[i] - lnB[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb27-14&#34;&gt;&lt;a href=&#34;#cb27-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++lnB[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb27-15&#34;&gt;&lt;a href=&#34;#cb27-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B = B * lnB;&lt;/span&gt;
&lt;span id=&#34;cb27-16&#34;&gt;&lt;a href=&#34;#cb27-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb27-17&#34;&gt;&lt;a href=&#34;#cb27-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb27-18&#34;&gt;&lt;a href=&#34;#cb27-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-19&#34;&gt;&lt;a href=&#34;#cb27-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb27-20&#34;&gt;&lt;a href=&#34;#cb27-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-21&#34;&gt;&lt;a href=&#34;#cb27-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polyExp(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;f) {&lt;/span&gt;
&lt;span id=&#34;cb27-22&#34;&gt;&lt;a href=&#34;#cb27-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly ret;&lt;/span&gt;
&lt;span id=&#34;cb27-23&#34;&gt;&lt;a href=&#34;#cb27-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    polyExp(f, ret, f.size());&lt;/span&gt;
&lt;span id=&#34;cb27-24&#34;&gt;&lt;a href=&#34;#cb27-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb27-25&#34;&gt;&lt;a href=&#34;#cb27-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; çš„å¸¸æ•°è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œéœ€è¦å°½é‡å‡å°‘å…¶è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ±‚æ³•-2-åˆ†æ²»-fft&#34;&gt;æ±‚æ³• 2 åˆ†æ²» FFT&lt;/h4&gt;
&lt;p&gt;åˆ†æ²» FFT å¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; çš„å¤æ‚åº¦ä¸‹ä»¥æä¼˜çš„å¸¸æ•°ï¼ˆæ¯”ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; å¿«ï¼‰æ±‚å‡ºç»“æœã€‚æš‚æ—¶ä¸æƒ³å†™ï¼Œå’•å’•å’•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼å¼€æ ¹&#34;&gt;å¤šé¡¹å¼å¼€æ ¹&lt;/h3&gt;
&lt;h4 id=&#34;é—®é¢˜æè¿°-3&#34;&gt;é—®é¢˜æè¿°&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(B^2(x)\equiv A(x)\pmod{x^n}\)&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ±‚è§£&#34;&gt;æ±‚è§£&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘ä½¿ç”¨ç‰›é¡¿è¿­ä»£ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(B(x)) = B^2(x) - A(x)\pmod{x^n}\)&lt;/span&gt;ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;(B(x)) = 2B(x)\)&lt;/span&gt;ï¼Œå¥—ç‰›è¿­å¼å­ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}B(x) &amp;amp;\equiv B_0(x) - \frac{f(B_0(x))}{f&amp;#39;(B_0(x))}\\&amp;amp;\equiv B_0(x) - \frac{B_0^2(x) - A(x)}{2B_0(x)}\\&amp;amp;\equiv \frac{B_0^2(x) + A(x)}{2B_0(x)}\end{aligned}
\]&lt;/span&gt; æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ä¸€ä¸‹å¦‚æœå¸¸æ•°é¡¹ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„è¯æ˜¯éœ€è¦äºŒæ¬¡å‰©ä½™æ¥æ±‚å‡ºç­”æ¡ˆçš„å¸¸æ•°é¡¹çš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å®ç°-3&#34;&gt;å®ç°&lt;/h4&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb28&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb28-1&#34;&gt;&lt;a href=&#34;#cb28-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polySqrt(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, Poly &amp;amp;B, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;/span&gt;
&lt;span id=&#34;cb28-2&#34;&gt;&lt;a href=&#34;#cb28-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (m == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb28-3&#34;&gt;&lt;a href=&#34;#cb28-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B.push_back(QuadResidue::cipolla(A[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]));&lt;/span&gt;
&lt;span id=&#34;cb28-4&#34;&gt;&lt;a href=&#34;#cb28-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-5&#34;&gt;&lt;a href=&#34;#cb28-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb28-6&#34;&gt;&lt;a href=&#34;#cb28-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    polySqrt(A, B, (m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb28-7&#34;&gt;&lt;a href=&#34;#cb28-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    B.resize(m);&lt;/span&gt;
&lt;span id=&#34;cb28-8&#34;&gt;&lt;a href=&#34;#cb28-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly invB = polyInv(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * B), sA(A.begin(), A.begin() + m);&lt;/span&gt;
&lt;span id=&#34;cb28-9&#34;&gt;&lt;a href=&#34;#cb28-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    B = qPow(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) * B + invB * sA;&lt;/span&gt;
&lt;span id=&#34;cb28-10&#34;&gt;&lt;a href=&#34;#cb28-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-11&#34;&gt;&lt;a href=&#34;#cb28-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb28-12&#34;&gt;&lt;a href=&#34;#cb28-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-13&#34;&gt;&lt;a href=&#34;#cb28-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polySqrt(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb28-14&#34;&gt;&lt;a href=&#34;#cb28-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly C; polySqrt(A, C, A.size());&lt;/span&gt;
&lt;span id=&#34;cb28-15&#34;&gt;&lt;a href=&#34;#cb28-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; C;&lt;/span&gt;
&lt;span id=&#34;cb28-16&#34;&gt;&lt;a href=&#34;#cb28-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;åº”ç”¨-1-å¤šé¡¹å¼å¿«é€Ÿå¹‚&#34;&gt;åº”ç”¨ 1 å¤šé¡¹å¼å¿«é€Ÿå¹‚&lt;/h3&gt;
&lt;p&gt;åˆ†ä¸¤ç§æƒ…å†µã€‚ç¬¬ä¸€ç§ &lt;span class=&#34;math inline&#34;&gt;\([x^0]f(x) = 1\)&lt;/span&gt;ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¸éš¾å‘ç° &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}g(x) &amp;amp;\equiv f^k(x)\\\ln g(x) &amp;amp;\equiv k\ln f(x)\\g(x) &amp;amp;\equiv \exp(k\ln f(x))\pmod{x^n}\end{aligned}
\]&lt;/span&gt; ç„¶åå°±ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt;ï¼Œä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œå† &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; ä¸€ä¸‹ï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb29&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb29-1&#34;&gt;&lt;a href=&#34;#cb29-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f;&lt;/span&gt;
&lt;span id=&#34;cb29-2&#34;&gt;&lt;a href=&#34;#cb29-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k;&lt;/span&gt;
&lt;span id=&#34;cb29-3&#34;&gt;&lt;a href=&#34;#cb29-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb29-4&#34;&gt;&lt;a href=&#34;#cb29-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb29-5&#34;&gt;&lt;a href=&#34;#cb29-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb29-6&#34;&gt;&lt;a href=&#34;#cb29-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(s); f.resize(lim = n);&lt;/span&gt;
&lt;span id=&#34;cb29-7&#34;&gt;&lt;a href=&#34;#cb29-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; s[i]; ++i) k = (&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k + s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb29-8&#34;&gt;&lt;a href=&#34;#cb29-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(f[i]);&lt;/span&gt;
&lt;span id=&#34;cb29-9&#34;&gt;&lt;a href=&#34;#cb29-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initInv();&lt;/span&gt;
&lt;span id=&#34;cb29-10&#34;&gt;&lt;a href=&#34;#cb29-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f = polyExp(k * polyLn(f));&lt;/span&gt;
&lt;span id=&#34;cb29-11&#34;&gt;&lt;a href=&#34;#cb29-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f);&lt;/span&gt;
&lt;span id=&#34;cb29-12&#34;&gt;&lt;a href=&#34;#cb29-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-13&#34;&gt;&lt;a href=&#34;#cb29-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç¬¬äºŒç§æƒ…å†µ &lt;span class=&#34;math inline&#34;&gt;\([x^0]f(x) \not= 1\)&lt;/span&gt;ï¼Œæ­¤æ—¶æˆ‘ä»¬åº”è¯¥åšçš„ï¼Œå°±æ˜¯åˆ›é€ æ¡ä»¶å¼ºä¸Šã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆä¸Šå‘¢ï¼Ÿå½“ &lt;span class=&#34;math inline&#34;&gt;\([x^0]f(x)\not= 0\)&lt;/span&gt; æ—¶ï¼Œæˆ‘ä»¬å°±ç›´æ¥ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f^k(x)\equiv \left(\frac{f(x)}{[x^0]f(x)} \right)^k\times \left([x^0]f(x)\right)^k
\]&lt;/span&gt; å½“ &lt;span class=&#34;math inline&#34;&gt;\([x^0]f(x) = 0\)&lt;/span&gt; æ—¶ï¼Œæˆ‘ä»¬å°±æŠŠå¤šé¡¹å¼å¹³ç§»ä¸€ä¸‹ï¼Œç„¶åå¼ºè¡ŒæŒ‰ä¸Šé¢ä¸Šï¼Œæœ€åå¹³ç§»å›å»å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb30&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb30-1&#34;&gt;&lt;a href=&#34;#cb30-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f;&lt;/span&gt;
&lt;span id=&#34;cb30-2&#34;&gt;&lt;a href=&#34;#cb30-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, k2;&lt;/span&gt;
&lt;span id=&#34;cb30-3&#34;&gt;&lt;a href=&#34;#cb30-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb30-4&#34;&gt;&lt;a href=&#34;#cb30-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-5&#34;&gt;&lt;a href=&#34;#cb30-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb30-6&#34;&gt;&lt;a href=&#34;#cb30-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(s);&lt;/span&gt;
&lt;span id=&#34;cb30-7&#34;&gt;&lt;a href=&#34;#cb30-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(n);&lt;/span&gt;
&lt;span id=&#34;cb30-8&#34;&gt;&lt;a href=&#34;#cb30-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(f[i]);&lt;/span&gt;
&lt;span id=&#34;cb30-9&#34;&gt;&lt;a href=&#34;#cb30-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-10&#34;&gt;&lt;a href=&#34;#cb30-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-11&#34;&gt;&lt;a href=&#34;#cb30-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (f[p] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; p &amp;lt; n) ++p;&lt;/span&gt;
&lt;span id=&#34;cb30-12&#34;&gt;&lt;a href=&#34;#cb30-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-13&#34;&gt;&lt;a href=&#34;#cb30-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; s[i]; ++i) {&lt;/span&gt;
&lt;span id=&#34;cb30-14&#34;&gt;&lt;a href=&#34;#cb30-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        k = (&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k + s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) % mod;&lt;/span&gt;
&lt;span id=&#34;cb30-15&#34;&gt;&lt;a href=&#34;#cb30-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        k2 = (&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k2 + s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) % (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb30-16&#34;&gt;&lt;a href=&#34;#cb30-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k * p &amp;gt; n) {&lt;/span&gt;
&lt;span id=&#34;cb30-17&#34;&gt;&lt;a href=&#34;#cb30-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb30-18&#34;&gt;&lt;a href=&#34;#cb30-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-19&#34;&gt;&lt;a href=&#34;#cb30-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb30-20&#34;&gt;&lt;a href=&#34;#cb30-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-21&#34;&gt;&lt;a href=&#34;#cb30-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-22&#34;&gt;&lt;a href=&#34;#cb30-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = n = n - p * k, initInv();&lt;/span&gt;
&lt;span id=&#34;cb30-23&#34;&gt;&lt;a href=&#34;#cb30-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-24&#34;&gt;&lt;a href=&#34;#cb30-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u = qPow(f[p], MOD - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;), v = qPow(f[p], k2);&lt;/span&gt;
&lt;span id=&#34;cb30-25&#34;&gt;&lt;a href=&#34;#cb30-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i + p] * u % mod;&lt;/span&gt;
&lt;span id=&#34;cb30-26&#34;&gt;&lt;a href=&#34;#cb30-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    clr(&amp;amp;f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] + n, p * k);&lt;/span&gt;
&lt;span id=&#34;cb30-27&#34;&gt;&lt;a href=&#34;#cb30-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f = v * polyExp(k * polyLn(f));&lt;/span&gt;
&lt;span id=&#34;cb30-28&#34;&gt;&lt;a href=&#34;#cb30-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, p * k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb30-29&#34;&gt;&lt;a href=&#34;#cb30-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f);&lt;/span&gt;
&lt;span id=&#34;cb30-30&#34;&gt;&lt;a href=&#34;#cb30-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-31&#34;&gt;&lt;a href=&#34;#cb30-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;åº”ç”¨-2-ln-çš„ç»„åˆæ„ä¹‰&#34;&gt;åº”ç”¨ 2 ln çš„ç»„åˆæ„ä¹‰&lt;/h3&gt;
&lt;p&gt;çœ‹ä¾‹é¢˜ï¼š&lt;a href=&#34;https://www.luogu.com.cn/problem/P4841&#34;&gt;æ´›è°· P4841 [é›†è®­é˜Ÿä½œä¸š2013]åŸå¸‚è§„åˆ’&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹çš„æœ‰æ ‡å·æ— å‘è¿é€šå›¾çš„ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(\bmod 1004535809\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å…ˆä¸è€ƒè™‘æ ‡å·ï¼Œæœ€åå¾—åˆ°çš„ç­”æ¡ˆä¹˜ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(n!\)&lt;/span&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä¸è€ƒè™‘è”é€šçš„è¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g_n = 2^{\binom n 2}\)&lt;/span&gt;ï¼Œå³è€ƒè™‘æ¯æ¡è¾¹é€‰è¿˜æ˜¯ä¸é€‰ï¼Œè®¾è”é€šçš„æƒ…å†µçš„æ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ„é€ ä¸€ä¸‹è”é€šçš„ EGFï¼š&lt;span class=&#34;math inline&#34;&gt;\(F(x) = \displaystyle\sum_{i = 0}^\infty f_i\frac{x^i}{i!}\)&lt;/span&gt;ï¼Œä¸è¿é€šçš„ç±»ä¼¼ï¼š&lt;span class=&#34;math inline&#34;&gt;\(G(x) = \displaystyle\sum_{i = 0}^\infty g_i\frac{x^i}{i!}\)&lt;/span&gt;ã€‚æ ¹æ® EGF çš„æ€§è´¨å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(G(x) = \mathrm e^{F(x)}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ±‚ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;é…åˆå°è£…è¿‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt; æ˜¯è¿™æ ·çš„ï¼šï¼ˆupdï¼šä¸‹é¢çš„ä»£ç æœªæ›´æ–°æ–°çš„å°è£…ï¼Œè¯·çœ‹å‡†äº†é£Ÿç”¨ï¼‰&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb31&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb31-1&#34;&gt;&lt;a href=&#34;#cb31-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polyln(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m)&lt;/span&gt;
&lt;span id=&#34;cb31-2&#34;&gt;&lt;a href=&#34;#cb31-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb31-3&#34;&gt;&lt;a href=&#34;#cb31-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; invf[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb31-4&#34;&gt;&lt;a href=&#34;#cb31-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb31-5&#34;&gt;&lt;a href=&#34;#cb31-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt; m &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb31-6&#34;&gt;&lt;a href=&#34;#cb31-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initinv(lim);&lt;/span&gt;
&lt;span id=&#34;cb31-7&#34;&gt;&lt;a href=&#34;#cb31-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cpy(invf, f, m);&lt;/span&gt;
&lt;span id=&#34;cb31-8&#34;&gt;&lt;a href=&#34;#cb31-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    invpoly(invf, m);&lt;/span&gt;
&lt;span id=&#34;cb31-9&#34;&gt;&lt;a href=&#34;#cb31-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    derivate(f, m);&lt;/span&gt;
&lt;span id=&#34;cb31-10&#34;&gt;&lt;a href=&#34;#cb31-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(invf, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb31-11&#34;&gt;&lt;a href=&#34;#cb31-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb31-12&#34;&gt;&lt;a href=&#34;#cb31-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[i] * invf[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb31-13&#34;&gt;&lt;a href=&#34;#cb31-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb31-14&#34;&gt;&lt;a href=&#34;#cb31-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    intergrate(f, m);&lt;/span&gt;
&lt;span id=&#34;cb31-15&#34;&gt;&lt;a href=&#34;#cb31-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    clr(invf, lim);&lt;/span&gt;
&lt;span id=&#34;cb31-16&#34;&gt;&lt;a href=&#34;#cb31-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    clr(f + m, lim - m);&lt;/span&gt;
&lt;span id=&#34;cb31-17&#34;&gt;&lt;a href=&#34;#cb31-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb31-18&#34;&gt;&lt;a href=&#34;#cb31-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb31-19&#34;&gt;&lt;a href=&#34;#cb31-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], invf[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb31-20&#34;&gt;&lt;a href=&#34;#cb31-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fact[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb31-21&#34;&gt;&lt;a href=&#34;#cb31-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb31-22&#34;&gt;&lt;a href=&#34;#cb31-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb31-23&#34;&gt;&lt;a href=&#34;#cb31-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb31-24&#34;&gt;&lt;a href=&#34;#cb31-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb31-25&#34;&gt;&lt;a href=&#34;#cb31-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb31-26&#34;&gt;&lt;a href=&#34;#cb31-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = readInt();&lt;/span&gt;
&lt;span id=&#34;cb31-27&#34;&gt;&lt;a href=&#34;#cb31-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    fact[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb31-28&#34;&gt;&lt;a href=&#34;#cb31-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb31-29&#34;&gt;&lt;a href=&#34;#cb31-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        fact[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * fact[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * i % mod,&lt;/span&gt;
&lt;span id=&#34;cb31-30&#34;&gt;&lt;a href=&#34;#cb31-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * qpow(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * i * (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) % mod * qpow(fact[i]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb31-31&#34;&gt;&lt;a href=&#34;#cb31-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    polyln(f, n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb31-32&#34;&gt;&lt;a href=&#34;#cb31-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * f[n] * fact[n] % mod);&lt;/span&gt;
&lt;span id=&#34;cb31-33&#34;&gt;&lt;a href=&#34;#cb31-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb31-34&#34;&gt;&lt;a href=&#34;#cb31-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;åº”ç”¨-3-é…åˆç”Ÿæˆå‡½æ•°æ¨å¼å­&#34;&gt;åº”ç”¨ 3 é…åˆç”Ÿæˆå‡½æ•°æ¨å¼å­&lt;/h3&gt;
&lt;p&gt;è¯·çœ‹ &lt;a href=&#34;https://www.luogu.com.cn/problem/P4389&#34;&gt;P4389 ä»˜å…¬ä¸»çš„èƒŒåŒ…&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è®¾å®¹é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ç‰©å“çš„ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k_i\)&lt;/span&gt; ä¸ªï¼Œåˆ™å…¶ç”Ÿæˆå‡½æ•°ä¸º &lt;span class=&#34;math display&#34;&gt;\[
A_i(x) =  \left(\sum_{j = 0}^{+\infty}x^{ji}\right)^{k_i} =\left(\frac{1}{1 - x^i}\right)^{k_i}
\]&lt;/span&gt; æ‰€ä»¥æˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
f(x) = \prod_{i = 1}^n A_i(x)
\]&lt;/span&gt; çš„æ¯é¡¹ç³»æ•°ã€‚æš´åŠ›ä¹˜èµ·æ¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(nm\log n)\)&lt;/span&gt; çš„ï¼Œæ— æ³•é€šè¿‡æœ¬é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¯•ä¸€ä¸‹æ±‚ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f(x) &amp;amp;= \prod_{i = 1}^nA_i(x)\\
\ln f(x) &amp;amp;= \sum_{i = 1}^n\ln A_i(x)\\
\ln f(x) &amp;amp;= \sum_{i = 1}^nk_i(\ln 1 - \ln(1 - x^i))\\
\ln f(x) &amp;amp;= -\sum_{i = 1}^nk_i\ln(1 - x^i)
\end{aligned}
\]&lt;/span&gt; ç„¶åæˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt; çš„å½¢å¼ï¼Œå›é¡¾ä¸€ä¸‹ä¸Šé¢è®²è¿‡çš„ä¸€ä¸ªå¼å­ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\ln(1 - x) = -\sum_{m = 1}^{+\infty}\frac{x^{m}}{m}
\]&lt;/span&gt; æ‰€ä»¥ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\ln f(x) &amp;amp;= \sum_{i = 1}^nk_i\sum_{j = 1}^{+\infty}\frac{x^{ij}}{j}
\end{aligned}
\]&lt;/span&gt; ç„¶åé—®é¢˜å°±è½¬åŒ–ä¸ºäº†æ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\exp\left(\sum_{i = 1}^nk_i\sum_{j = 1}^{+\infty}\frac{x^{ij}}{j} \right)
\]&lt;/span&gt; é‡Œé¢çš„ä¸œè¥¿å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log m)\)&lt;/span&gt; ç®—ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log m)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb32&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb32-1&#34;&gt;&lt;a href=&#34;#cb32-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, cnt[maxn];&lt;/span&gt;
&lt;span id=&#34;cb32-2&#34;&gt;&lt;a href=&#34;#cb32-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f;&lt;/span&gt;
&lt;span id=&#34;cb32-3&#34;&gt;&lt;a href=&#34;#cb32-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb32-4&#34;&gt;&lt;a href=&#34;#cb32-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb32-5&#34;&gt;&lt;a href=&#34;#cb32-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m);&lt;/span&gt;
&lt;span id=&#34;cb32-6&#34;&gt;&lt;a href=&#34;#cb32-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(lim = m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb32-7&#34;&gt;&lt;a href=&#34;#cb32-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initInv();&lt;/span&gt;
&lt;span id=&#34;cb32-8&#34;&gt;&lt;a href=&#34;#cb32-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb32-9&#34;&gt;&lt;a href=&#34;#cb32-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp; read(tmp);&lt;/span&gt;
&lt;span id=&#34;cb32-10&#34;&gt;&lt;a href=&#34;#cb32-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++cnt[tmp];&lt;/span&gt;
&lt;span id=&#34;cb32-11&#34;&gt;&lt;a href=&#34;#cb32-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb32-12&#34;&gt;&lt;a href=&#34;#cb32-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb32-13&#34;&gt;&lt;a href=&#34;#cb32-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt[i]) {&lt;/span&gt;
&lt;span id=&#34;cb32-14&#34;&gt;&lt;a href=&#34;#cb32-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = i; j &amp;lt;= m; j += i) {&lt;/span&gt;
&lt;span id=&#34;cb32-15&#34;&gt;&lt;a href=&#34;#cb32-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[j] += &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * cnt[i] * inv[j / i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb32-16&#34;&gt;&lt;a href=&#34;#cb32-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[j] &amp;gt; mod) f[j] -= mod;&lt;/span&gt;
&lt;span id=&#34;cb32-17&#34;&gt;&lt;a href=&#34;#cb32-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb32-18&#34;&gt;&lt;a href=&#34;#cb32-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb32-19&#34;&gt;&lt;a href=&#34;#cb32-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb32-20&#34;&gt;&lt;a href=&#34;#cb32-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f = polyExp(f);&lt;/span&gt;
&lt;span id=&#34;cb32-21&#34;&gt;&lt;a href=&#34;#cb32-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) print(f[i]), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb32-22&#34;&gt;&lt;a href=&#34;#cb32-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb32-23&#34;&gt;&lt;a href=&#34;#cb32-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼å¸¦ä½™é™¤æ³•&#34;&gt;å¤šé¡¹å¼å¸¦ä½™é™¤æ³•&lt;/h2&gt;
&lt;h3 id=&#34;é—®é¢˜æè¿°-4&#34;&gt;é—®é¢˜æè¿°&lt;/h3&gt;
&lt;p&gt;ç»™å®šå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt;ã€‚æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; é™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt; çš„å•† &lt;span class=&#34;math inline&#34;&gt;\(Q(x)\)&lt;/span&gt; å’Œä½™æ•° &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(n = \deg f\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m = \deg g\)&lt;/span&gt;ï¼Œåˆ™è¦æ±‚æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\deg Q = n - m\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\deg R &amp;lt; m\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é—®é¢˜æ±‚è§£&#34;&gt;é—®é¢˜æ±‚è§£&lt;/h3&gt;
&lt;p&gt;æœ€å…³é”®çš„é—®é¢˜å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt;ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt; çš„å½±å“æ¶ˆå»ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥æ±‚é€†æ¥æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(Q(x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(n = \deg f\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m = \deg g\)&lt;/span&gt;ã€‚ä¸»è¦æ€æƒ³æ˜¯æ„é€  &lt;span class=&#34;math display&#34;&gt;\[
f^R(x) = x^nf\left(\frac1x\right)
\]&lt;/span&gt; ç„¶åä¸éš¾å‘ç°è¿™ä¸ªä¸œè¥¿çš„å®è´¨å°±æ˜¯åè½¬ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„ç³»æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(f(x) = Q(x)g(x) + R(x)\)&lt;/span&gt; ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac 1x\)&lt;/span&gt; è¿›è¡ŒåŒ–ç®€ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}f\left(\frac1x\right) &amp;amp;= Q\left(\frac1x\right)g\left(\frac1x\right) + R\left(\frac1x\right)\\x^nf\left(\frac1x\right) &amp;amp;= x^{n - m}Q\left(\frac1x\right)x^mg\left(\frac1x\right) + x^{n - m + 1}x^{m - 1}R\left(\frac1x\right)\\f^R(x)&amp;amp;=Q^R(x)g^R(x) + x^{n - m + 1}R^R(x)\\f^R(x)&amp;amp;\equiv Q^R(x)g^R(x)\pmod{x^{n - m + 1}}\end{aligned}
\]&lt;/span&gt; æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨æ±‚é€†æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(Q(x)\)&lt;/span&gt;ï¼Œç„¶åå›ä»£å°±å¯ä»¥æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(R(x)\)&lt;/span&gt; äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°-4&#34;&gt;å®ç°&lt;/h3&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb33&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb33-1&#34;&gt;&lt;a href=&#34;#cb33-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; polyDiv(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;B, Poly &amp;amp;Q, Poly &amp;amp;R) {&lt;/span&gt;
&lt;span id=&#34;cb33-2&#34;&gt;&lt;a href=&#34;#cb33-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly rA = A, rB = B;&lt;/span&gt;
&lt;span id=&#34;cb33-3&#34;&gt;&lt;a href=&#34;#cb33-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    reverse(rA), reverse(rB);&lt;/span&gt;
&lt;span id=&#34;cb33-4&#34;&gt;&lt;a href=&#34;#cb33-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = A.size(), m = B.size();&lt;/span&gt;
&lt;span id=&#34;cb33-5&#34;&gt;&lt;a href=&#34;#cb33-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    rA.resize(n - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), rB.resize(n - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb33-6&#34;&gt;&lt;a href=&#34;#cb33-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Q = rA * polyInv(rB), Q.resize(n - m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), reverse(Q);&lt;/span&gt;
&lt;span id=&#34;cb33-7&#34;&gt;&lt;a href=&#34;#cb33-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    R = A - B * Q, R.resize(m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb33-8&#34;&gt;&lt;a href=&#34;#cb33-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb33-9&#34;&gt;&lt;a href=&#34;#cb33-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸»å‡½æ•°è°ƒç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb34&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb34-1&#34;&gt;&lt;a href=&#34;#cb34-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb34-2&#34;&gt;&lt;a href=&#34;#cb34-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f, g, R, Q;&lt;/span&gt;
&lt;span id=&#34;cb34-3&#34;&gt;&lt;a href=&#34;#cb34-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb34-4&#34;&gt;&lt;a href=&#34;#cb34-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb34-5&#34;&gt;&lt;a href=&#34;#cb34-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m);&lt;/span&gt;
&lt;span id=&#34;cb34-6&#34;&gt;&lt;a href=&#34;#cb34-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(++n), g.resize(++m);&lt;/span&gt;
&lt;span id=&#34;cb34-7&#34;&gt;&lt;a href=&#34;#cb34-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = n;&lt;/span&gt;
&lt;span id=&#34;cb34-8&#34;&gt;&lt;a href=&#34;#cb34-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(f[i]);&lt;/span&gt;
&lt;span id=&#34;cb34-9&#34;&gt;&lt;a href=&#34;#cb34-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(g[i]);&lt;/span&gt;
&lt;span id=&#34;cb34-10&#34;&gt;&lt;a href=&#34;#cb34-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    polyDiv(f, g, Q, R);&lt;/span&gt;
&lt;span id=&#34;cb34-11&#34;&gt;&lt;a href=&#34;#cb34-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(Q);&lt;/span&gt;
&lt;span id=&#34;cb34-12&#34;&gt;&lt;a href=&#34;#cb34-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(R);&lt;/span&gt;
&lt;span id=&#34;cb34-13&#34;&gt;&lt;a href=&#34;#cb34-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-14&#34;&gt;&lt;a href=&#34;#cb34-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼ä¸‰è§’å‡½æ•°åä¸‰è§’å‡½æ•°&#34;&gt;å¤šé¡¹å¼ä¸‰è§’å‡½æ•°/åä¸‰è§’å‡½æ•°&lt;/h2&gt;
&lt;p&gt;æ„Ÿè§‰è¿™ä¸œè¥¿æ²¡ä»€ä¹ˆç”¨ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼ä¸‰è§’å‡½æ•°&#34;&gt;å¤šé¡¹å¼ä¸‰è§’å‡½æ•°&lt;/h3&gt;
&lt;h4 id=&#34;é—®é¢˜æè¿°-5&#34;&gt;é—®é¢˜æè¿°&lt;/h4&gt;
&lt;p&gt;ç»™å®šå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt;ï¼Œæ±‚æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(\sin f(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\cos f(x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¼å­æ¨å¯¼&#34;&gt;å¼å­æ¨å¯¼&lt;/h4&gt;
&lt;p&gt;æ¬§æ‹‰å…¬å¼ï¼š &lt;span class=&#34;math display&#34;&gt;\[
e^{i\theta} = \cos \theta + i\sin\theta
\]&lt;/span&gt; ç”¨è¯±å¯¼å…¬å¼æ—¥ä¸€é€šä¹‹åå¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
e^{i(-\theta)} = \cos\theta - i\sin\theta
\]&lt;/span&gt; ç”±ä¸Šé¢ä¸¤ä¸ªå¼å­å°±å¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\sin\theta &amp;amp;= \frac{e^{i\theta} - e^{-i\theta}}{2i}\\
\cos\theta &amp;amp;= \frac{e^{i\theta} + e^{-i\theta}}{2}
\end{aligned}
\]&lt;/span&gt; æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; å¸¦è¿›å»ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\sin f(x) &amp;amp;= \frac{\exp(if(x)) - \exp(-if(x))}{2i}\\
\cos f(x) &amp;amp;= \frac{\exp(if(x)) + \exp(-if(x))}{2}
\end{aligned}
\]&lt;/span&gt; ç°åœ¨çœ‹æ¥ä¼¼ä¹ç›´æ¥ &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; å°±å¯ä»¥åšå®Œäº†ï¼Œç„¶è€Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹åœ¨å¤æ•°åŸŸä¸‹ï¼Œæˆ‘ä»¬æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i^2 = -1\)&lt;/span&gt;ã€‚æ”¾åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\mathbb Z_{998244353}\)&lt;/span&gt; ä¸‹ä¸å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(i^2\equiv 998244352\pmod{998244353}\)&lt;/span&gt;ã€‚å– &lt;span class=&#34;math inline&#34;&gt;\(998244352\)&lt;/span&gt; çš„ä¸€ä¸ªäºŒæ¬¡å‰©ä½™ &lt;span class=&#34;math inline&#34;&gt;\(86583718\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å®ç°-5&#34;&gt;å®ç°&lt;/h4&gt;
&lt;p&gt;æ³¨æ„ä¸€ä¸‹æˆ‘ä»¬èƒ½å°½é‡å°‘æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt; å°±å°‘æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\exp\)&lt;/span&gt;ï¼ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\exp(-if(x)) = (\exp(if(x)))^{-1}\)&lt;/span&gt;ï¼‰ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦åœ°ä¼˜åŒ–å¸¸æ•°&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb35&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb35-1&#34;&gt;&lt;a href=&#34;#cb35-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polySin(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb35-2&#34;&gt;&lt;a href=&#34;#cb35-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly tmp = polyExp(imgunit * A);&lt;/span&gt;
&lt;span id=&#34;cb35-3&#34;&gt;&lt;a href=&#34;#cb35-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; qPow(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * imgunit % mod) * (tmp - polyInv(tmp));&lt;/span&gt;
&lt;span id=&#34;cb35-4&#34;&gt;&lt;a href=&#34;#cb35-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb35-5&#34;&gt;&lt;a href=&#34;#cb35-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb35-6&#34;&gt;&lt;a href=&#34;#cb35-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polyCos(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb35-7&#34;&gt;&lt;a href=&#34;#cb35-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly tmp = polyExp(imgunit * A);&lt;/span&gt;
&lt;span id=&#34;cb35-8&#34;&gt;&lt;a href=&#34;#cb35-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; qPow(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) * (tmp + polyInv(tmp));&lt;/span&gt;
&lt;span id=&#34;cb35-9&#34;&gt;&lt;a href=&#34;#cb35-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¶…çº§çŸ­ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb36&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb36-1&#34;&gt;&lt;a href=&#34;#cb36-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, type;&lt;/span&gt;
&lt;span id=&#34;cb36-2&#34;&gt;&lt;a href=&#34;#cb36-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f;&lt;/span&gt;
&lt;span id=&#34;cb36-3&#34;&gt;&lt;a href=&#34;#cb36-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb36-4&#34;&gt;&lt;a href=&#34;#cb36-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb36-5&#34;&gt;&lt;a href=&#34;#cb36-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(type);&lt;/span&gt;
&lt;span id=&#34;cb36-6&#34;&gt;&lt;a href=&#34;#cb36-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f.resize(lim = n), initInv();&lt;/span&gt;
&lt;span id=&#34;cb36-7&#34;&gt;&lt;a href=&#34;#cb36-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(f[i]);&lt;/span&gt;
&lt;span id=&#34;cb36-8&#34;&gt;&lt;a href=&#34;#cb36-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(type ? polyCos(f) : polySin(f));&lt;/span&gt;
&lt;span id=&#34;cb36-9&#34;&gt;&lt;a href=&#34;#cb36-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-10&#34;&gt;&lt;a href=&#34;#cb36-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;å¤šé¡¹å¼åä¸‰è§’å‡½æ•°&#34;&gt;å¤šé¡¹å¼åä¸‰è§’å‡½æ•°&lt;/h3&gt;
&lt;h4 id=&#34;é—®é¢˜æè¿°-6&#34;&gt;é—®é¢˜æè¿°&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt;ï¼Œæ±‚æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(\arcsin f(x)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\arccos f(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\arctan f(x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¼å­æ¨å¯¼-1&#34;&gt;å¼å­æ¨å¯¼&lt;/h4&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦çŸ¥é“ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\arcsin&amp;#39;x &amp;amp;= \frac{1}{\sqrt{1 - x^2}}\\
\arccos&amp;#39;x &amp;amp;= -\frac{1}{\sqrt{1 - x^2}}\\
\arctan&amp;#39;x &amp;amp;= \frac{1}{1 + x^2}
\end{aligned}
\]&lt;/span&gt; ç„¶åç±»ä¼¼ &lt;span class=&#34;math inline&#34;&gt;\(\ln\)&lt;/span&gt;ï¼Œå…ˆæ±‚æ±‚å¯¼åç§¯åˆ†æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\arcsin f(x) &amp;amp;= \int\frac{f&amp;#39;(x)}{\sqrt{1 - f^2(x)}}\\
\arccos f(x) &amp;amp;= -\int\frac{f&amp;#39;(x)}{\sqrt{1 - f^2(x)}}\\
\arctan f(x) &amp;amp;= \int\frac{f&amp;#39;(x)}{1 + f^2(x)}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;å®ç°-6&#34;&gt;å®ç°&lt;/h4&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb37&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb37-1&#34;&gt;&lt;a href=&#34;#cb37-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polyAsin(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb37-2&#34;&gt;&lt;a href=&#34;#cb37-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly one; one.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb37-3&#34;&gt;&lt;a href=&#34;#cb37-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ints(deri(A) * polyInv(polySqrt(one - A * A)));&lt;/span&gt;
&lt;span id=&#34;cb37-4&#34;&gt;&lt;a href=&#34;#cb37-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb37-5&#34;&gt;&lt;a href=&#34;#cb37-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb37-6&#34;&gt;&lt;a href=&#34;#cb37-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly polyAtan(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Poly &amp;amp;A) {&lt;/span&gt;
&lt;span id=&#34;cb37-7&#34;&gt;&lt;a href=&#34;#cb37-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly one; one.push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb37-8&#34;&gt;&lt;a href=&#34;#cb37-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ints(deri(A) * polyInv(one + A * A));&lt;/span&gt;
&lt;span id=&#34;cb37-9&#34;&gt;&lt;a href=&#34;#cb37-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;vector&lt;/code&gt; å°è£…çš„ä¼˜åŠ¿å¾—åˆ°ä½“ç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‹‰æ ¼æœ—æ—¥æ’å€¼&#34;&gt;æ‹‰æ ¼æœ—æ—¥æ’å€¼&lt;/h2&gt;
&lt;h3 id=&#34;é—®é¢˜èƒŒæ™¯&#34;&gt;é—®é¢˜èƒŒæ™¯&lt;/h3&gt;
&lt;p&gt;ç»™å‡º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x_i,y_i)\)&lt;/span&gt;ï¼Œä»¤è¿™ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ç¡®å®šçš„å¤šé¡¹å¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L(x)\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(L(x)\)&lt;/span&gt; çš„ç³»æ•°è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
L(x) = \sum_{i=1}^n y_il_i(x)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(l_i(x)\)&lt;/span&gt; ä¸ºæ‹‰æ ¼æœ—æ—¥åŸºæœ¬å¤šé¡¹å¼ï¼Œè¡¨è¾¾å¼ä¸º&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
l_i(x) = \prod_{j=1,j\ne i}^n\frac{x-x_j}{x_i-x_j}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ç‰¹ç‚¹æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(l_i(x_i)=1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\forall j\ne i\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(l_i(x_j)=0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¨å¯¼&#34;&gt;æ¨å¯¼&lt;/h3&gt;
&lt;p&gt;æŠ›å¼€æ‹‰æ’ï¼Œè¿™é“é¢˜æ˜æ˜¾å¯ä»¥åˆ—æ–¹ç¨‹ç»„ç„¶åä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ±‚è§£ï¼Œä½†æ˜¯å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; ä¸”ç²¾åº¦é—®é¢˜æ˜æ˜¾ï¼Œæ‰€ä»¥æ‹‰æ ¼æœ—æ—¥æ˜¯è¿™æ ·è€ƒè™‘çš„ï¼š&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(P_i(x_i,y_i)\)&lt;/span&gt;ï¼Œæ„é€ ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n-1\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(l_i(x)\)&lt;/span&gt; ä½¿å…¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; ä¸Šå–å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œåœ¨å…¶ä½™ &lt;span class=&#34;math inline&#34;&gt;\(x_j\)&lt;/span&gt; ä¸Šä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ„é€ çš„ç»“æœå°±æ˜¯ä¸Šé¢çš„ç»“è®ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
l_i(x) = \prod_{j=1,j\ne i}^n\frac{x-x_j}{x_i-x_j}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸åŠ è¯æ˜åœ°ï¼Œä¸Šé¢è¿™ä¸ªå¤šé¡¹å¼æ˜¯æ­£ç¡®ä¸”å”¯ä¸€çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè€ƒè™‘æ„é€ ç­”æ¡ˆï¼šå¾ˆæ˜¾ç„¶å¯¹äºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(P_i(x_i,y_i)\)&lt;/span&gt;ï¼Œåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(l_i(x_i)\)&lt;/span&gt; çš„å–å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå…¶ä»–çš„éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ‰€ä»¥ç­”æ¡ˆçš„æ­£ç¡®æ€§ä¹Ÿæ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ï¼šå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt;ï¼Œåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(y_il_i(x_i)\)&lt;/span&gt; äº§ç”Ÿäº†è´¡çŒ®ï¼Œå…¶ä½™çš„éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ•…è¿™ä¸ªå¤šé¡¹å¼æ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å›åˆ°ä¸€å¼€å§‹ï¼Œè‹¥æˆ‘ä»¬éœ€è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(f(k)\)&lt;/span&gt; çš„å€¼ï¼Œåˆ™æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(k) = \sum_{i=1}^n y_i\prod_{j=1,j\ne i}^n\frac{k-x_j}{x_i-x_j}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºæ¨¡æ•°æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥ä½¿ç”¨è´¹é©¬å°å®šç†æ±‚é€†å…ƒï¼Œè·‘å¾—é£å¿«ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ï¼Œæ±‚é€†å…ƒå°±æ˜¯ä¸ªå¾ˆå°çš„å¸¸æ•°&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb38&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb38-1&#34;&gt;&lt;a href=&#34;#cb38-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-2&#34;&gt;&lt;a href=&#34;#cb38-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-3&#34;&gt;&lt;a href=&#34;#cb38-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-4&#34;&gt;&lt;a href=&#34;#cb38-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-5&#34;&gt;&lt;a href=&#34;#cb38-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb38-6&#34;&gt;&lt;a href=&#34;#cb38-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-7&#34;&gt;&lt;a href=&#34;#cb38-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; ll read()&lt;/span&gt;
&lt;span id=&#34;cb38-8&#34;&gt;&lt;a href=&#34;#cb38-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb38-9&#34;&gt;&lt;a href=&#34;#cb38-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb38-10&#34;&gt;&lt;a href=&#34;#cb38-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-11&#34;&gt;&lt;a href=&#34;#cb38-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-12&#34;&gt;&lt;a href=&#34;#cb38-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb38-13&#34;&gt;&lt;a href=&#34;#cb38-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x = x | (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb38-14&#34;&gt;&lt;a href=&#34;#cb38-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb38-15&#34;&gt;&lt;a href=&#34;#cb38-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * s + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb38-16&#34;&gt;&lt;a href=&#34;#cb38-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x ? -s : s;&lt;/span&gt;
&lt;span id=&#34;cb38-17&#34;&gt;&lt;a href=&#34;#cb38-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb38-18&#34;&gt;&lt;a href=&#34;#cb38-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-19&#34;&gt;&lt;a href=&#34;#cb38-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll maxn = &lt;span class=&#34;fl&#34;&gt;2e3&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;, mod = &lt;span class=&#34;dv&#34;&gt;998244353&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-20&#34;&gt;&lt;a href=&#34;#cb38-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll x[maxn], y[maxn];&lt;/span&gt;
&lt;span id=&#34;cb38-21&#34;&gt;&lt;a href=&#34;#cb38-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-22&#34;&gt;&lt;a href=&#34;#cb38-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll pow(ll base, ll p)&lt;/span&gt;
&lt;span id=&#34;cb38-23&#34;&gt;&lt;a href=&#34;#cb38-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb38-24&#34;&gt;&lt;a href=&#34;#cb38-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-25&#34;&gt;&lt;a href=&#34;#cb38-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    base = (base + mod) % mod;&lt;/span&gt;
&lt;span id=&#34;cb38-26&#34;&gt;&lt;a href=&#34;#cb38-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; p; p &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb38-27&#34;&gt;&lt;a href=&#34;#cb38-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb38-28&#34;&gt;&lt;a href=&#34;#cb38-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (p &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb38-29&#34;&gt;&lt;a href=&#34;#cb38-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans = ans * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb38-30&#34;&gt;&lt;a href=&#34;#cb38-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        base = base * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb38-31&#34;&gt;&lt;a href=&#34;#cb38-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb38-32&#34;&gt;&lt;a href=&#34;#cb38-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb38-33&#34;&gt;&lt;a href=&#34;#cb38-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb38-34&#34;&gt;&lt;a href=&#34;#cb38-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-35&#34;&gt;&lt;a href=&#34;#cb38-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il ll inv(ll n)&lt;/span&gt;
&lt;span id=&#34;cb38-36&#34;&gt;&lt;a href=&#34;#cb38-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb38-37&#34;&gt;&lt;a href=&#34;#cb38-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; pow(n, mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb38-38&#34;&gt;&lt;a href=&#34;#cb38-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb38-39&#34;&gt;&lt;a href=&#34;#cb38-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-40&#34;&gt;&lt;a href=&#34;#cb38-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb38-41&#34;&gt;&lt;a href=&#34;#cb38-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb38-42&#34;&gt;&lt;a href=&#34;#cb38-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll n = read(), k = read();&lt;/span&gt;
&lt;span id=&#34;cb38-43&#34;&gt;&lt;a href=&#34;#cb38-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; ; i &amp;lt;= n; ++i)&lt;/span&gt;
&lt;span id=&#34;cb38-44&#34;&gt;&lt;a href=&#34;#cb38-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x[i] = read(), y[i] = read();&lt;/span&gt;
&lt;span id=&#34;cb38-45&#34;&gt;&lt;a href=&#34;#cb38-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-46&#34;&gt;&lt;a href=&#34;#cb38-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt;= n; ++i)&lt;/span&gt;
&lt;span id=&#34;cb38-47&#34;&gt;&lt;a href=&#34;#cb38-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb38-48&#34;&gt;&lt;a href=&#34;#cb38-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll prod1 = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, prod2 = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-49&#34;&gt;&lt;a href=&#34;#cb38-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; j &amp;lt;= n; ++j)&lt;/span&gt;
&lt;span id=&#34;cb38-50&#34;&gt;&lt;a href=&#34;#cb38-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb38-51&#34;&gt;&lt;a href=&#34;#cb38-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i == j)&lt;/span&gt;
&lt;span id=&#34;cb38-52&#34;&gt;&lt;a href=&#34;#cb38-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-53&#34;&gt;&lt;a href=&#34;#cb38-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            prod1 = prod1 * (k - x[j]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb38-54&#34;&gt;&lt;a href=&#34;#cb38-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            prod2 = prod2 * (x[i] - x[j]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb38-55&#34;&gt;&lt;a href=&#34;#cb38-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb38-56&#34;&gt;&lt;a href=&#34;#cb38-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans = (ans + prod1 * y[i] % mod * inv(prod2) % mod + mod) % mod;&lt;/span&gt;
&lt;span id=&#34;cb38-57&#34;&gt;&lt;a href=&#34;#cb38-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb38-58&#34;&gt;&lt;a href=&#34;#cb38-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb38-59&#34;&gt;&lt;a href=&#34;#cb38-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-60&#34;&gt;&lt;a href=&#34;#cb38-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;é‡å¿ƒå‹æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•&#34;&gt;é‡å¿ƒå‹æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢çš„åšæ³•åœ¨éœ€è¦åŠ¨æ€åŠ ç‚¹/åˆ ç‚¹çš„æƒ…å†µä¸‹æ˜¯æœ‰å¼Šç«¯çš„ï¼Œå› ä¸ºä¸€æ¬¡åŠ ç‚¹å°±éœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; é‡æ–°è®¡ç®—ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸ä¼˜ç§€çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­æ¨å¯¼å¼å­ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}f(k) &amp;amp;= \sum_{i = 1}^nf(x_i)\prod_{j\not=i}\frac{k - x_j}{x_i - x_j}\\&amp;amp;=\sum_{i = 1}^nf(x_i)\frac{\prod_{j = 1}^n(k - x_j)}{(k - x_i)\prod_{j \not= i}(x_i - x_j)}\\&amp;amp;=\prod_{i = 1}^n(k - x_i)\sum_{i = 1}^nf(x_i)\frac{1}{(k - x_i)\prod_{j \not= i}(x_i - x_j)}\end{aligned}
\]&lt;/span&gt; è®¾ &lt;span class=&#34;math inline&#34;&gt;\(w_i = \dfrac{f(x_i)}{\prod_{j\not=i}(x_i - x_j)}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g = \displaystyle\prod_{i = 1}^n(k - x_i)\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math display&#34;&gt;\[
f(k) = g\sum_{i = 1}^n\frac{w_i}{k - x_i}
\]&lt;/span&gt; è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(w_i\)&lt;/span&gt; ç§°ä¸ºé‡å¿ƒæƒã€‚æ¯æ¬¡åŠ ç‚¹æ›´æ–°çš„è¯å…¶å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ï¼ˆæ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(w_i\)&lt;/span&gt;ï¼Œæ±‚é€† &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt;ï¼‰ã€‚è¿™æ ·åšå°±å¯ä»¥å¿«é€ŸåŠ ç‚¹åˆ ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡æ¿é¢˜ï¼š&lt;a href=&#34;https://loj.ac/p/165&#34;&gt;LOJ#165. æ‹‰æ ¼æœ—æ—¥æ’å€¼&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜éœ€è¦ç‰¹åˆ¤ &lt;span class=&#34;math inline&#34;&gt;\(k = x_i\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb39&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb39-1&#34;&gt;&lt;a href=&#34;#cb39-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;3005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-2&#34;&gt;&lt;a href=&#34;#cb39-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint g = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, w[maxn], x[maxn], y[maxn];&lt;/span&gt;
&lt;span id=&#34;cb39-3&#34;&gt;&lt;a href=&#34;#cb39-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt;&lt;/span&gt;
&lt;span id=&#34;cb39-4&#34;&gt;&lt;a href=&#34;#cb39-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-5&#34;&gt;&lt;a href=&#34;#cb39-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; ins(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt) {&lt;/span&gt;
&lt;span id=&#34;cb39-6&#34;&gt;&lt;a href=&#34;#cb39-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    w[cnt] = y[cnt];&lt;/span&gt;
&lt;span id=&#34;cb39-7&#34;&gt;&lt;a href=&#34;#cb39-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) w[i] *= qPow(x[i] - x[cnt], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;), w[cnt] *= qPow(x[cnt] - x[i], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb39-8&#34;&gt;&lt;a href=&#34;#cb39-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-9&#34;&gt;&lt;a href=&#34;#cb39-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb39-10&#34;&gt;&lt;a href=&#34;#cb39-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-11&#34;&gt;&lt;a href=&#34;#cb39-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint calc(modint k) {&lt;/span&gt;
&lt;span id=&#34;cb39-12&#34;&gt;&lt;a href=&#34;#cb39-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == x[i]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; y[i];&lt;/span&gt;
&lt;span id=&#34;cb39-13&#34;&gt;&lt;a href=&#34;#cb39-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint g = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-14&#34;&gt;&lt;a href=&#34;#cb39-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt) g *= (k - x[i]);&lt;/span&gt;
&lt;span id=&#34;cb39-15&#34;&gt;&lt;a href=&#34;#cb39-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ret = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-16&#34;&gt;&lt;a href=&#34;#cb39-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt) ret += w[i] * qPow(k - x[i], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb39-17&#34;&gt;&lt;a href=&#34;#cb39-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret * g;&lt;/span&gt;
&lt;span id=&#34;cb39-18&#34;&gt;&lt;a href=&#34;#cb39-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb39-19&#34;&gt;&lt;a href=&#34;#cb39-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-20&#34;&gt;&lt;a href=&#34;#cb39-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb39-21&#34;&gt;&lt;a href=&#34;#cb39-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; read(n);&lt;/span&gt;
&lt;span id=&#34;cb39-22&#34;&gt;&lt;a href=&#34;#cb39-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (n--) {&lt;/span&gt;
&lt;span id=&#34;cb39-23&#34;&gt;&lt;a href=&#34;#cb39-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; op;&lt;/span&gt;
&lt;span id=&#34;cb39-24&#34;&gt;&lt;a href=&#34;#cb39-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(op);&lt;/span&gt;
&lt;span id=&#34;cb39-25&#34;&gt;&lt;a href=&#34;#cb39-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (op == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb39-26&#34;&gt;&lt;a href=&#34;#cb39-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            read(x[++cnt]), read(y[cnt]);&lt;/span&gt;
&lt;span id=&#34;cb39-27&#34;&gt;&lt;a href=&#34;#cb39-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ins(cnt);&lt;/span&gt;
&lt;span id=&#34;cb39-28&#34;&gt;&lt;a href=&#34;#cb39-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb39-29&#34;&gt;&lt;a href=&#34;#cb39-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x; read(x);&lt;/span&gt;
&lt;span id=&#34;cb39-30&#34;&gt;&lt;a href=&#34;#cb39-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            print(calc(x));&lt;/span&gt;
&lt;span id=&#34;cb39-31&#34;&gt;&lt;a href=&#34;#cb39-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb39-32&#34;&gt;&lt;a href=&#34;#cb39-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb39-33&#34;&gt;&lt;a href=&#34;#cb39-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb39-34&#34;&gt;&lt;a href=&#34;#cb39-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-35&#34;&gt;&lt;a href=&#34;#cb39-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;æ­£æ•´æ•°çš„-k-æ¬¡æ–¹ä¹‹å’Œ&#34;&gt;æ­£æ•´æ•°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ–¹ä¹‹å’Œ&lt;/h3&gt;
&lt;h4 id=&#34;é—®é¢˜æè¿°-7&#34;&gt;é—®é¢˜æè¿°&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF622F&#34;&gt;CF622F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n,k\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^9,0\le k\le 10^6\)&lt;/span&gt;ï¼‰ï¼Œæ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^ni^k = 1^k + 2^k + 3^k +\cdots + n^k
\]&lt;/span&gt; æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 7\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é¢˜è§£&#34;&gt;é¢˜è§£&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢çš„è¯æ˜ä¼šè®²åˆ°ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥çœ‹ä½œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå˜é‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(k + 1\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(k\log k)\)&lt;/span&gt; çš„æ—¶é—´å†…æ±‚å‡ºæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f(1),f(2),\cdots,f(k+ 1)\)&lt;/span&gt;ï¼Œæˆ‘ä»¬éœ€è¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f(n)\)&lt;/span&gt;ï¼Œæ•…è€ƒè™‘æ‹‰æ ¼æœ—æ—¥æ’å€¼ï¼Œå¾—å‡ºå¦‚ä¸‹å…¬å¼ &lt;span class=&#34;math display&#34;&gt;\[
f(n) = \sum_{i = 1}^{k + 2}f(i)\prod_{j\neq i}\frac{n - j}{i - j}
\]&lt;/span&gt; å¦‚æœæœ´ç´ åœ°åšçš„è¯ï¼Œå¤æ‚åº¦æ˜¾ç„¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(k^2)\)&lt;/span&gt; çš„ï¼Œä½†æ˜¯æ³¨æ„åˆ°æˆ‘ä»¬ç”¨äºå–ç‚¹å€¼çš„æ•°éƒ½æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(\prod\)&lt;/span&gt; è¿™ä¸€å †æ˜¯å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; é¢„å¤„ç†ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ±‚çš„ã€‚æ€ä¹ˆé¢„å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬è€ƒè™‘æŠŠä»–æ‰“å¼€çœ‹çœ‹è§„å¾‹ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\prod_{j = 1,j\neq i}^{k + 2}\frac{n - j}{i - j} &amp;amp;= \frac{(n - 1)(n - 2)\cdots(n - j + 1)(n - j - 1)\cdots(n - k - 1)(n - k - 2)}{(i - 1)(i - 2)\cdots(i - j + 1)(i - j - 1)\cdots(i - k - 2)}\\
&amp;amp;=\frac{\prod_{j = 1}^{i - 1}(n - j)\times\prod_{j = i + 1}^{k + 2}(n - j)}{(-1)^{k -i}\times i!\times (k + 2 - i)!}
\end{aligned}
\]&lt;/span&gt; æ‰€ä»¥ç»´æŠ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\((n - j)\)&lt;/span&gt; çš„å‰/åç¼€ç§¯å’Œ &lt;span class=&#34;math inline&#34;&gt;\([1, k + 1]\)&lt;/span&gt; çš„é˜¶ä¹˜é€†å…ƒï¼Œè¿™é“é¢˜å°±å¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(k\log k)\)&lt;/span&gt; çš„æ—¶é—´å†…åšå‡ºæ¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb40&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb40-1&#34;&gt;&lt;a href=&#34;#cb40-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-2&#34;&gt;&lt;a href=&#34;#cb40-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb40-3&#34;&gt;&lt;a href=&#34;#cb40-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb40-4&#34;&gt;&lt;a href=&#34;#cb40-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-5&#34;&gt;&lt;a href=&#34;#cb40-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb40-6&#34;&gt;&lt;a href=&#34;#cb40-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll mod = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;7&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-7&#34;&gt;&lt;a href=&#34;#cb40-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-8&#34;&gt;&lt;a href=&#34;#cb40-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-9&#34;&gt;&lt;a href=&#34;#cb40-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll n, k;&lt;/span&gt;
&lt;span id=&#34;cb40-10&#34;&gt;&lt;a href=&#34;#cb40-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-11&#34;&gt;&lt;a href=&#34;#cb40-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll fac[maxn], pre[maxn], suf[maxn];&lt;/span&gt;
&lt;span id=&#34;cb40-12&#34;&gt;&lt;a href=&#34;#cb40-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-13&#34;&gt;&lt;a href=&#34;#cb40-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll qpow(ll base, ll p = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb40-14&#34;&gt;&lt;a href=&#34;#cb40-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb40-15&#34;&gt;&lt;a href=&#34;#cb40-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-16&#34;&gt;&lt;a href=&#34;#cb40-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; p; p &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, base = base * base % mod)&lt;/span&gt;
&lt;span id=&#34;cb40-17&#34;&gt;&lt;a href=&#34;#cb40-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (p &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb40-18&#34;&gt;&lt;a href=&#34;#cb40-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ret = ret * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb40-19&#34;&gt;&lt;a href=&#34;#cb40-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb40-20&#34;&gt;&lt;a href=&#34;#cb40-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb40-21&#34;&gt;&lt;a href=&#34;#cb40-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-22&#34;&gt;&lt;a href=&#34;#cb40-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb40-23&#34;&gt;&lt;a href=&#34;#cb40-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb40-24&#34;&gt;&lt;a href=&#34;#cb40-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n, &amp;amp;k);&lt;/span&gt;
&lt;span id=&#34;cb40-25&#34;&gt;&lt;a href=&#34;#cb40-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!k)&lt;/span&gt;
&lt;span id=&#34;cb40-26&#34;&gt;&lt;a href=&#34;#cb40-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb40-27&#34;&gt;&lt;a href=&#34;#cb40-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, n);&lt;/span&gt;
&lt;span id=&#34;cb40-28&#34;&gt;&lt;a href=&#34;#cb40-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-29&#34;&gt;&lt;a href=&#34;#cb40-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb40-30&#34;&gt;&lt;a href=&#34;#cb40-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, y = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-31&#34;&gt;&lt;a href=&#34;#cb40-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pre[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, fac[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-32&#34;&gt;&lt;a href=&#34;#cb40-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb40-33&#34;&gt;&lt;a href=&#34;#cb40-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        pre[i] = pre[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * (n - i) % mod, fac[i] = fac[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * i % mod;&lt;/span&gt;
&lt;span id=&#34;cb40-34&#34;&gt;&lt;a href=&#34;#cb40-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    suf[k + &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-35&#34;&gt;&lt;a href=&#34;#cb40-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, k + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb40-36&#34;&gt;&lt;a href=&#34;#cb40-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        suf[i] = suf[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * (n - i) % mod;&lt;/span&gt;
&lt;span id=&#34;cb40-37&#34;&gt;&lt;a href=&#34;#cb40-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb40-38&#34;&gt;&lt;a href=&#34;#cb40-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb40-39&#34;&gt;&lt;a href=&#34;#cb40-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        y = (y + qpow(i, k)) % mod;&lt;/span&gt;
&lt;span id=&#34;cb40-40&#34;&gt;&lt;a href=&#34;#cb40-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll tmp = y * pre[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod * suf[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] % mod * (((k - i) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * qpow(fac[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * fac[k + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; - i] % mod) % mod;&lt;/span&gt;
&lt;span id=&#34;cb40-41&#34;&gt;&lt;a href=&#34;#cb40-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans = (ans + tmp + mod) % mod;&lt;/span&gt;
&lt;span id=&#34;cb40-42&#34;&gt;&lt;a href=&#34;#cb40-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb40-43&#34;&gt;&lt;a href=&#34;#cb40-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb40-44&#34;&gt;&lt;a href=&#34;#cb40-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-45&#34;&gt;&lt;a href=&#34;#cb40-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;è¯æ˜&#34;&gt;è¯æ˜&lt;/h4&gt;
&lt;p&gt;è¿™é‡Œçš„è¯æ˜ä½¿ç”¨å·®åˆ†ï¼ˆå‚è€ƒæ•°ç«å°è“æœ¬æ•°åˆ—é‚£ä¸€å†Œï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰å¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„ä¸€é˜¶å·®åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Delta f(x) = f(x + 1) - f(x)\)&lt;/span&gt;ï¼ŒæŠŠå¾—åˆ°çš„å¤šé¡¹å¼å†ä½œæ¬¡å·®åˆ†å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„äºŒé˜¶å·®åˆ† &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\Delta^2f(x) &amp;amp;= \Delta (\Delta f(x))\\
&amp;amp;= \Delta (f(x + 1) - f(x))\\
&amp;amp;= (f(x + 2) - f(x + 1)) - (f(x + 1) - f(x))\\
&amp;amp;= f(x + 2) - 2f(x + 1) + f(x)
\end{aligned}
\]&lt;/span&gt; ç±»ä¼¼çš„å¯ä»¥å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; é˜¶å·®åˆ†ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(\Delta^p f(x) = \Delta(\Delta^{p - 1}f(x))\)&lt;/span&gt;ã€‚ç±»ä¼¼çš„æˆ‘ä»¬å¯¹æ•°åˆ—ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œå·®åˆ†æ“ä½œçš„ã€‚å¦‚æœä¸€ä¸ªæ•°åˆ—çš„ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; é˜¶å·®åˆ†ä¸ºä¸€ä¸ªéé›¶å¸¸æ•°åˆ—ï¼Œåˆ™ç§°å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; é˜¶ç­‰å·®æ•°åˆ—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®šç†ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(\lbrace a_n\rbrace\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; é˜¶ç­‰å·®æ•°åˆ—çš„å……è¦æ¡ä»¶æ˜¯å…¶é€šé¡¹å…¬å¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¯æ˜ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å·²çŸ¥æ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(\lbrace a_n\rbrace\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; é˜¶ç­‰å·®æ•°åˆ—ï¼Œè®¾æ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(\lbrace a_n\rbrace\)&lt;/span&gt; çš„é€šé¡¹ä¸ºä¸€ä¸ªå…³äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(f(n) = \sum_{i = 0}^vu_ix^i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\lbrace a_n\rbrace\)&lt;/span&gt; çš„å·®åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\lbrace b_n\rbrace\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(\lbrace b_n\rbrace\)&lt;/span&gt; çš„é€šé¡¹å…¬å¼ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\Delta f(x) &amp;amp;= f(x + 1) - f(x)\\
&amp;amp;= \sum_{i = 0}^v u_i(x + 1)^i - \sum_{i = 0}^vu_ix_i
\end{aligned}
\]&lt;/span&gt; æ‰“å¼€åæˆ‘ä»¬å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(x^v\)&lt;/span&gt; çš„ç³»æ•°å˜ä¸ºäº† &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œè¯´æ˜å·®åˆ†ä¹‹åé€šé¡¹å…¬å¼çš„æ¬¡æ•°å‡äº† &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œä»å…¶ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; é˜¶å·®åˆ†ä¸ºä¸€ä¸ªéé›¶å¸¸æ•°åˆ—å¯åæ¨çŸ¥å…¶é€šé¡¹å…¬å¼çš„æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°æœ¬é¢˜ï¼Œå®šä¹‰å‡ºæ•°åˆ— &lt;span class=&#34;math display&#34;&gt;\[
\lbrace a_n\rbrace = \sum_{i = 1}^1i^k, \sum_{i = 1}^2i^k,\cdots,\sum_{i = 1}^ni^k
\]&lt;/span&gt; å¯¹è¿™ä¸ªæ•°åˆ—ä½œå·®åˆ†å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1^k,2^k,3^k,\cdots, n^k\)&lt;/span&gt;ï¼Œå‘ç°å…¶é€šé¡¹å…¬å¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(n) = n^k\)&lt;/span&gt;ï¼Œæ‰€ä»¥åŸæ•°åˆ—çš„é€šé¡¹å°±æ˜¯å…³äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k + 1\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼&#34;&gt;å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼&lt;/h2&gt;
&lt;p&gt;å‰ç½®çŸ¥è¯†ï¼šå¤šé¡¹å¼å¸¦ä½™é™¤æ³•ã€ç®€å•çš„åˆ†æ²»æ€æƒ³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é—®é¢˜æè¿°-8&#34;&gt;é—®é¢˜æè¿°&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªå¤šé¡¹å¼å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(\{a_1,\cdots, a_m\}\)&lt;/span&gt;ï¼Œè¦æ±‚åˆ†åˆ«æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f(a_1),f(a_2),\cdots, f(a_m)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é—®é¢˜æ±‚è§£-1&#34;&gt;é—®é¢˜æ±‚è§£&lt;/h3&gt;
&lt;p&gt;æ ¸å¿ƒæ€æƒ³æ˜¯æ„é€  + åˆ†æ²»ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç°åœ¨æ­£åœ¨å¤„ç†å­é—®é¢˜ &lt;span class=&#34;math display&#34;&gt;\[
\{a_1, a_2, \cdots, a_m\}
\]&lt;/span&gt; å°†å…¶åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ† &lt;span class=&#34;math display&#34;&gt;\[
\{a_1, a_2,\cdots, a_{\left\lfloor\frac m2\right\rfloor}\}\quad \{a_{\left\lfloor\frac m2\right\rfloor + 1}, \cdots, a_m\}
\]&lt;/span&gt; ç„¶åæ„é€ ä¸¤ä¸ªå¤šé¡¹å¼ &lt;span class=&#34;math display&#34;&gt;\[
g_0(x) = \prod_{i = 1}^{\lfloor\frac m2\rfloor}(x - a_i)\\g_1(x) = \prod_{i = \lfloor\frac m2\rfloor + 1}^m(x - a_i)
\]&lt;/span&gt; ç„¶åæˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(x) = g_0(x)Q(x) + f_0(x)\)&lt;/span&gt;ï¼Œåˆ™æ˜¾ç„¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\forall i\in[1, \lfloor\frac m2\rfloor]\)&lt;/span&gt;ï¼Œä¸€å®šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(g_0(a_i) = 0\)&lt;/span&gt;ã€‚æ‰€ä»¥æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\equiv f_0(x)\pmod {g_0(x)}\)&lt;/span&gt;ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå¤šé¡¹å¼å–æ¨¡çš„äº‹æƒ…ã€‚å¯¹äºå³è¾¹åˆ™åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·å­æˆ‘ä»¬å°±æˆåŠŸå°†é—®é¢˜çš„è§„æ¨¡å‡åŠã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°-7&#34;&gt;å®ç°&lt;/h3&gt;
&lt;p&gt;ä¸€å¼€å§‹å°±éœ€è¦æ±‚å‡ºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt;ï¼Œè¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºçº¿æ®µæ ‘ï¼Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; çš„ã€‚ç„¶åæ¯ä¸€å±‚ä¹Ÿè¦ç»™ä»–ä¸ªå¤šé¡¹å¼å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åé‰´äºå¤šé¡¹å¼å–æ¨¡çš„å·¨å¤§å¸¸æ•°ï¼Œå½“åŒºé—´æ¯”è¾ƒå°çš„æ—¶å€™å¯ä»¥è€ƒè™‘ç›´æ¥æš´ç®—ï¼Œä¼˜åŒ–å¸¸æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb41&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb41-1&#34;&gt;&lt;a href=&#34;#cb41-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define L &lt;/span&gt;(k&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb41-2&#34;&gt;&lt;a href=&#34;#cb41-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define R &lt;/span&gt;(L&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;|&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb41-3&#34;&gt;&lt;a href=&#34;#cb41-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define M &lt;/span&gt;((l&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;+&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;r)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb41-4&#34;&gt;&lt;a href=&#34;#cb41-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly g[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], Q;&lt;/span&gt;
&lt;span id=&#34;cb41-5&#34;&gt;&lt;a href=&#34;#cb41-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-6&#34;&gt;&lt;a href=&#34;#cb41-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; initG(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *a) {&lt;/span&gt;
&lt;span id=&#34;cb41-7&#34;&gt;&lt;a href=&#34;#cb41-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == r) {&lt;/span&gt;
&lt;span id=&#34;cb41-8&#34;&gt;&lt;a href=&#34;#cb41-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[k].push_back(a[l] ? mod - a[l] : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb41-9&#34;&gt;&lt;a href=&#34;#cb41-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[k].push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb41-10&#34;&gt;&lt;a href=&#34;#cb41-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-11&#34;&gt;&lt;a href=&#34;#cb41-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb41-12&#34;&gt;&lt;a href=&#34;#cb41-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initG(L, l, M, a);&lt;/span&gt;
&lt;span id=&#34;cb41-13&#34;&gt;&lt;a href=&#34;#cb41-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initG(R, M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r, a);&lt;/span&gt;
&lt;span id=&#34;cb41-14&#34;&gt;&lt;a href=&#34;#cb41-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    g[k] = g[L] * g[R];&lt;/span&gt;
&lt;span id=&#34;cb41-15&#34;&gt;&lt;a href=&#34;#cb41-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-16&#34;&gt;&lt;a href=&#34;#cb41-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb41-17&#34;&gt;&lt;a href=&#34;#cb41-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-18&#34;&gt;&lt;a href=&#34;#cb41-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; work(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r, Poly A, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *ans) {&lt;/span&gt;
&lt;span id=&#34;cb41-19&#34;&gt;&lt;a href=&#34;#cb41-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt; &lt;span class=&#34;dv&#34;&gt;100&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb41-20&#34;&gt;&lt;a href=&#34;#cb41-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, l, r) {&lt;/span&gt;
&lt;span id=&#34;cb41-21&#34;&gt;&lt;a href=&#34;#cb41-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-22&#34;&gt;&lt;a href=&#34;#cb41-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DEC(j, A.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb41-23&#34;&gt;&lt;a href=&#34;#cb41-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                s = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * s * a[i] % mod + A[j]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb41-24&#34;&gt;&lt;a href=&#34;#cb41-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans[i] = s;&lt;/span&gt;
&lt;span id=&#34;cb41-25&#34;&gt;&lt;a href=&#34;#cb41-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb41-26&#34;&gt;&lt;a href=&#34;#cb41-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-27&#34;&gt;&lt;a href=&#34;#cb41-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb41-28&#34;&gt;&lt;a href=&#34;#cb41-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Poly B;&lt;/span&gt;
&lt;span id=&#34;cb41-29&#34;&gt;&lt;a href=&#34;#cb41-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    polyDiv(A, g[L], Q, B);&lt;/span&gt;
&lt;span id=&#34;cb41-30&#34;&gt;&lt;a href=&#34;#cb41-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    work(L, l, M, B, a, ans);&lt;/span&gt;
&lt;span id=&#34;cb41-31&#34;&gt;&lt;a href=&#34;#cb41-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    polyDiv(A, g[R], Q, B);&lt;/span&gt;
&lt;span id=&#34;cb41-32&#34;&gt;&lt;a href=&#34;#cb41-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    work(R, M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r, B, a, ans);&lt;/span&gt;
&lt;span id=&#34;cb41-33&#34;&gt;&lt;a href=&#34;#cb41-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-34&#34;&gt;&lt;a href=&#34;#cb41-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb41-35&#34;&gt;&lt;a href=&#34;#cb41-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-36&#34;&gt;&lt;a href=&#34;#cb41-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; evaluate(Poly f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *ans) {&lt;/span&gt;
&lt;span id=&#34;cb41-37&#34;&gt;&lt;a href=&#34;#cb41-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initG(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m, a);&lt;/span&gt;
&lt;span id=&#34;cb41-38&#34;&gt;&lt;a href=&#34;#cb41-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    work(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m, f, a, ans);&lt;/span&gt;
&lt;span id=&#34;cb41-39&#34;&gt;&lt;a href=&#34;#cb41-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-40&#34;&gt;&lt;a href=&#34;#cb41-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb41-41&#34;&gt;&lt;a href=&#34;#cb41-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef L&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-42&#34;&gt;&lt;a href=&#34;#cb41-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef R&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-43&#34;&gt;&lt;a href=&#34;#cb41-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef M&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;å¤šé¡¹å¼å¿«é€Ÿæ’å€¼&#34;&gt;å¤šé¡¹å¼å¿«é€Ÿæ’å€¼&lt;/h2&gt;
&lt;p&gt;å‰ç½®çŸ¥è¯†ï¼šå¤šç‚¹æ±‚å€¼ï¼Œæ´›å¿…è¾¾æ³•åˆ™&lt;/p&gt;
&lt;h3 id=&#34;é—®é¢˜æè¿°-9&#34;&gt;é—®é¢˜æè¿°&lt;/h3&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x_i, y_i)\)&lt;/span&gt;ï¼Œæ±‚å‡ºç»è¿‡è¿™ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹çš„ &lt;span class=&#34;math inline&#34;&gt;\(n - 1\)&lt;/span&gt; æ¬¡å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é—®é¢˜æ±‚è§£-2&#34;&gt;é—®é¢˜æ±‚è§£&lt;/h3&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹æ‹‰æ ¼æœ—æ—¥æ’å€¼å…¬å¼ï¼š &lt;span class=&#34;math display&#34;&gt;\[
F(x) = \sum_{i = 1}^n y_i\prod_{j \not=i}\frac{x - x_j}{x_i - x_j}
\]&lt;/span&gt; å…ˆæŠŠåé¢çš„åˆ†æ¯æåˆ°å‰é¢æ¥ï¼š &lt;span class=&#34;math display&#34;&gt;\[
F(x) = \sum_{i = 1}^n\frac{y_i}{\prod_{j\not=i}(x_i - x_j)}\prod_{j \not= i}(x - x_j)
\]&lt;/span&gt; é¦–å…ˆå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{y_i}{\prod_{j\not=i}(x_i - x_j)}\)&lt;/span&gt;ï¼Œè€ƒè™‘å…ˆè®¡ç®—è¿™ä¸ªå¸¸æ•°ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\delta(x) = \displaystyle\prod_{j = 1}^n(x - x_j)\)&lt;/span&gt;ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥åˆ†æ²» &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2 n)\)&lt;/span&gt; æ±‚ã€‚ç„¶åçœ‹ &lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; çš„åˆ†æ¯ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\prod_{j\not= i}(x_i - x_j) = \lim_{x\to x_i}\frac{\delta(x)}{x - x_i}
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿å°±æ˜¯å¯¼æ•°çš„å®šä¹‰å¼ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math display&#34;&gt;\[
\lim_{x\to x_i}\frac{\delta(x)}{x - x_i} = \delta&amp;#39;(x_i)
\]&lt;/span&gt; æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(\delta(x)\)&lt;/span&gt; ä¹‹åæ±‚ä¸ªå¯¼å†å†™ä¸ªå¤šç‚¹æ±‚å€¼å°±å¯ä»¥æå®šäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åé—®é¢˜å°±åŒ–ç®€åˆ°äº† &lt;span class=&#34;math display&#34;&gt;\[
F(x) = \sum_{i = 1}^n\frac{y_i}{\delta&amp;#39;(x_i)}\prod_{j\not=i}(x - x_j)
\]&lt;/span&gt; è¿˜æ˜¯ç”¨åˆ†æ²»å¤§æ³•ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle F_{l, r}(x) = \sum_{i = l}^r\frac{y_i}{\delta&amp;#39;(x_i)}\prod_{j\not=i}(x - x_j)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\delta_{l,r}(x) = \displaystyle\prod_{j = l}^r(x - x_j)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m = \left\lfloor\dfrac {i+ j}2\right\rfloor\)&lt;/span&gt;ï¼Œå¼€å§‹åŒ–ç®€ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}F_{l, r}(x) &amp;amp;= \sum_{i = l}^r\frac{y_i}{\delta&amp;#39;(x_i)}\prod_{j\not=i}(x - x_j)\\&amp;amp;=\sum_{i = l}^m\frac{y_i}{\delta&amp;#39;(x_i)}\prod_{j = l, j\not=i}^m(x - x_j)\prod_{j = m + 1, j\not= i}^r(x - x_j) + \sum_{i = m + 1}^r\frac{y_i}{\delta&amp;#39;(x_i)}\prod_{j = l, j\not=i}^m(x - x_j)\prod_{j = m + 1, j\not= i}^r(x - x_j)\\&amp;amp;=F_{l,m}(x)\delta_{m + 1, r}(x) + F_{m + 1, r}(x)\delta_{l, m}(x)\end{aligned}
\]&lt;/span&gt; è¾¹ç•Œè‚¯å®šå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(l = r\)&lt;/span&gt; çš„æ—¶å€™ &lt;span class=&#34;math inline&#34;&gt;\(F_{l,l}(x) = \dfrac{y_l}{\delta&amp;#39;(x_l)}\)&lt;/span&gt;ã€‚æ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°-8&#34;&gt;å®ç°&lt;/h3&gt;
&lt;p&gt;é…åˆä¸Šé¢çš„å°è£…ï¼Œå…¶å®ä¸éš¾å†™ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb42&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb42-1&#34;&gt;&lt;a href=&#34;#cb42-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly delta[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], ddelta;&lt;/span&gt;
&lt;span id=&#34;cb42-2&#34;&gt;&lt;a href=&#34;#cb42-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dval[maxn];&lt;/span&gt;
&lt;span id=&#34;cb42-3&#34;&gt;&lt;a href=&#34;#cb42-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-4&#34;&gt;&lt;a href=&#34;#cb42-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; initDelta(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *x) {&lt;/span&gt;
&lt;span id=&#34;cb42-5&#34;&gt;&lt;a href=&#34;#cb42-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == r) {&lt;/span&gt;
&lt;span id=&#34;cb42-6&#34;&gt;&lt;a href=&#34;#cb42-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        delta[k].push_back(x[l] ? mod - x[l] : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb42-7&#34;&gt;&lt;a href=&#34;#cb42-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        delta[k].push_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb42-8&#34;&gt;&lt;a href=&#34;#cb42-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-9&#34;&gt;&lt;a href=&#34;#cb42-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-10&#34;&gt;&lt;a href=&#34;#cb42-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initDelta(L, l, M, x);&lt;/span&gt;
&lt;span id=&#34;cb42-11&#34;&gt;&lt;a href=&#34;#cb42-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initDelta(R, M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r, x);&lt;/span&gt;
&lt;span id=&#34;cb42-12&#34;&gt;&lt;a href=&#34;#cb42-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    delta[k] = delta[L] * delta[R];&lt;/span&gt;
&lt;span id=&#34;cb42-13&#34;&gt;&lt;a href=&#34;#cb42-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-14&#34;&gt;&lt;a href=&#34;#cb42-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb42-15&#34;&gt;&lt;a href=&#34;#cb42-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-16&#34;&gt;&lt;a href=&#34;#cb42-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly interpolation(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *y) {&lt;/span&gt;
&lt;span id=&#34;cb42-17&#34;&gt;&lt;a href=&#34;#cb42-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == r)&lt;/span&gt;
&lt;span id=&#34;cb42-18&#34;&gt;&lt;a href=&#34;#cb42-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Poly(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * y[l] * qPow(dval[l]) % mod);&lt;/span&gt;
&lt;span id=&#34;cb42-19&#34;&gt;&lt;a href=&#34;#cb42-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; interpolation(L, l, M, x, y) * delta[R] + interpolation(R, M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r, x, y) * delta[L];&lt;/span&gt;
&lt;span id=&#34;cb42-20&#34;&gt;&lt;a href=&#34;#cb42-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb42-21&#34;&gt;&lt;a href=&#34;#cb42-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-22&#34;&gt;&lt;a href=&#34;#cb42-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly interpolation(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; *y) {&lt;/span&gt;
&lt;span id=&#34;cb42-23&#34;&gt;&lt;a href=&#34;#cb42-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    initDelta(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, x);&lt;/span&gt;
&lt;span id=&#34;cb42-24&#34;&gt;&lt;a href=&#34;#cb42-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ddelta = deri(delta[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb42-25&#34;&gt;&lt;a href=&#34;#cb42-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    evaluate(ddelta, n, x, dval);&lt;/span&gt;
&lt;span id=&#34;cb42-26&#34;&gt;&lt;a href=&#34;#cb42-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; interpolation(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, x, y);&lt;/span&gt;
&lt;span id=&#34;cb42-27&#34;&gt;&lt;a href=&#34;#cb42-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>BZOJ3771. Triple</title>
        <link>https://oi.imyangty.com/sol-bzoj3771/</link>
        <pubDate>Fri, 19 Feb 2021 17:47:07 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-bzoj3771/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg50.webp" alt="Featured image of post BZOJ3771. Triple" /&gt;&lt;h2 id=&#34;é¢˜æ„&#34;&gt;é¢˜æ„&lt;/h2&gt;
&lt;p&gt;æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æŠŠä»·å€¼åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„æ–§å­ï¼Œæ²³ç¥å¯èƒ½æ‹¿èµ° 1 - 3 æŠŠï¼Œé—®æ¯ç§å¯èƒ½çš„æŸå¤±ä»·å€¼åŠå…¶å¯¹åº”æ–¹æ¡ˆæ•°ã€‚ï¼ˆä¸è®¡é¡ºåºï¼‰&lt;/p&gt;
&lt;h2 id=&#34;æ€è·¯&#34;&gt;æ€è·¯&lt;/h2&gt;
&lt;p&gt;ç”Ÿæˆå‡½æ•°å…¥é—¨é¢˜ã€‚ è€ƒè™‘è®¾å‡ºå¤šé¡¹å¼ &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œå…¶ç³»æ•°æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A[a_i] = 1\)&lt;/span&gt;ï¼Œä»£è¡¨é€‰ä¸€æŠŠçš„ã€‚åˆ™ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(A(x) + A^2(x) + A^3(x)\)&lt;/span&gt;ã€‚ä½†æ˜¯è¿™æ ·æ˜¯æ˜¾ç„¶ä¸å¯¹çš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿ å› ä¸ºè¿™æ ·çš„è¯åŒä¸€ä¸ªå…ƒç´ å¯èƒ½è¢«é€‰ä¸¤æ¬¡æˆ–ä¸‰æ¬¡ï¼Œå¯¹äºè¿™ç§æƒ…å†µå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(B(x)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(C(x)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(B[2a_i] = 1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(C[3a_i] = 1\)&lt;/span&gt;ï¼Œä»£è¡¨åŒæ—¶é€‰ä¸¤æ¬¡/ä¸‰æ¬¡çš„ï¼Œå‡æ‰è¿™äº›æ–¹æ¡ˆæ•°å°±å¯ä»¥äº†ã€‚ç„¶åéœ€è¦æ³¨æ„é¡ºåºé—®é¢˜ï¼š é€‰ä¸€æŠŠçš„ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(A(x)\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç°é€‰ä¸¤ç§çš„å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{A^2(x) - B(x)}{2}\)&lt;/span&gt;ï¼Œé€‰ä¸‰ç§çš„æ¯”è¾ƒéº»çƒ¦ï¼šä¸èƒ½åŒæ—¶é€‰ä¸¤ç§ä¸€æ ·çš„ï¼Œå³å‡å» &lt;span class=&#34;math inline&#34;&gt;\(3A(x)B(x)\)&lt;/span&gt;ï¼Œï¼Œä½†æ˜¯é€‰ä¸‰ç§åŒæ ·çš„åˆä¼šè¢«å¤šå‡ä¸¤æ¬¡ï¼Œæœ€åé™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(3!\)&lt;/span&gt; å»æ‰é¡ºåºé—®é¢˜ï¼Œæ‰€ä»¥æœ€ç»ˆç­”æ¡ˆä¸ºï¼š &lt;span class=&#34;math inline&#34;&gt;\(A(x) + \frac{A^2(x) - B(x)}{2} + \frac{A^3(x) - 3A(x)B(x) + 2C(x)}{6}\)&lt;/span&gt; ç”Ÿæˆå‡½æ•°çš„å·ç§¯ä½¿ç”¨ NTT æˆ– FFT ä¼˜åŒ–å³å¯ã€‚æ³¨æ„æ­¤æ—¶ NTT æ¨¡æ•°è¦å–ä¸€ä¸ªæ›´å¤§çš„è´¨æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * s + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; s;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;5e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll G = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, mod = &lt;span class=&#34;dv&#34;&gt;2281701377&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; myswap(T &amp;amp;a, T &amp;amp;b)&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    T t = a;&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a = b;&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    b = t;&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll pow(ll base, ll p = mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; p; p &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (p &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ret = ret * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        base = base * base % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-41&#34;&gt;&lt;a href=&#34;#cb1-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rev[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-42&#34;&gt;&lt;a href=&#34;#cb1-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll invG = pow(G);&lt;/span&gt;
&lt;span id=&#34;cb1-43&#34;&gt;&lt;a href=&#34;#cb1-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-44&#34;&gt;&lt;a href=&#34;#cb1-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; NTT(ll *f, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; type)&lt;/span&gt;
&lt;span id=&#34;cb1-45&#34;&gt;&lt;a href=&#34;#cb1-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb1-46&#34;&gt;&lt;a href=&#34;#cb1-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-47&#34;&gt;&lt;a href=&#34;#cb1-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt; rev[i])&lt;/span&gt;
&lt;span id=&#34;cb1-48&#34;&gt;&lt;a href=&#34;#cb1-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            myswap(f[i], f[rev[i]]);&lt;/span&gt;
&lt;span id=&#34;cb1-49&#34;&gt;&lt;a href=&#34;#cb1-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; p &amp;lt;= lim; p &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-50&#34;&gt;&lt;a href=&#34;#cb1-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb1-51&#34;&gt;&lt;a href=&#34;#cb1-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = p &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-52&#34;&gt;&lt;a href=&#34;#cb1-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll tG = pow(type ? G : invG, (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / p);&lt;/span&gt;
&lt;span id=&#34;cb1-53&#34;&gt;&lt;a href=&#34;#cb1-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; lim; k += p)&lt;/span&gt;
&lt;span id=&#34;cb1-54&#34;&gt;&lt;a href=&#34;#cb1-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb1-55&#34;&gt;&lt;a href=&#34;#cb1-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll buf = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-56&#34;&gt;&lt;a href=&#34;#cb1-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = k; l &amp;lt; k + len; ++l, buf = buf * tG % mod)&lt;/span&gt;
&lt;span id=&#34;cb1-57&#34;&gt;&lt;a href=&#34;#cb1-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            {&lt;/span&gt;
&lt;span id=&#34;cb1-58&#34;&gt;&lt;a href=&#34;#cb1-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll tmp = buf * f[len + l] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-59&#34;&gt;&lt;a href=&#34;#cb1-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[len + l] = f[l] - tmp;&lt;/span&gt;
&lt;span id=&#34;cb1-60&#34;&gt;&lt;a href=&#34;#cb1-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[len + l] &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) f[len + l] += mod;&lt;/span&gt;
&lt;span id=&#34;cb1-61&#34;&gt;&lt;a href=&#34;#cb1-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[l] = f[l] + tmp;&lt;/span&gt;
&lt;span id=&#34;cb1-62&#34;&gt;&lt;a href=&#34;#cb1-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[l] &amp;gt; mod) f[l] -= mod;&lt;/span&gt;
&lt;span id=&#34;cb1-63&#34;&gt;&lt;a href=&#34;#cb1-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-64&#34;&gt;&lt;a href=&#34;#cb1-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-65&#34;&gt;&lt;a href=&#34;#cb1-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-66&#34;&gt;&lt;a href=&#34;#cb1-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll invlim = pow(lim);&lt;/span&gt;
&lt;span id=&#34;cb1-67&#34;&gt;&lt;a href=&#34;#cb1-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!type)&lt;/span&gt;
&lt;span id=&#34;cb1-68&#34;&gt;&lt;a href=&#34;#cb1-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-69&#34;&gt;&lt;a href=&#34;#cb1-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i] = f[i] * invlim % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-70&#34;&gt;&lt;a href=&#34;#cb1-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-71&#34;&gt;&lt;a href=&#34;#cb1-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-72&#34;&gt;&lt;a href=&#34;#cb1-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-73&#34;&gt;&lt;a href=&#34;#cb1-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll f1[maxn], f2[maxn], f3[maxn], ans[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-74&#34;&gt;&lt;a href=&#34;#cb1-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll g[maxn], t[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-75&#34;&gt;&lt;a href=&#34;#cb1-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-76&#34;&gt;&lt;a href=&#34;#cb1-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb1-77&#34;&gt;&lt;a href=&#34;#cb1-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb1-78&#34;&gt;&lt;a href=&#34;#cb1-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = read();&lt;/span&gt;
&lt;span id=&#34;cb1-79&#34;&gt;&lt;a href=&#34;#cb1-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (n--)&lt;/span&gt;
&lt;span id=&#34;cb1-80&#34;&gt;&lt;a href=&#34;#cb1-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb1-81&#34;&gt;&lt;a href=&#34;#cb1-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp = read();&lt;/span&gt;
&lt;span id=&#34;cb1-82&#34;&gt;&lt;a href=&#34;#cb1-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++f1[tmp], ++g[tmp], ++ans[tmp];&lt;/span&gt;
&lt;span id=&#34;cb1-83&#34;&gt;&lt;a href=&#34;#cb1-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++f2[tmp &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], ++f3[tmp * &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-84&#34;&gt;&lt;a href=&#34;#cb1-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-85&#34;&gt;&lt;a href=&#34;#cb1-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-86&#34;&gt;&lt;a href=&#34;#cb1-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (lim &amp;lt;= (&lt;span class=&#34;dv&#34;&gt;40000&lt;/span&gt; * &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;)) lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-87&#34;&gt;&lt;a href=&#34;#cb1-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-88&#34;&gt;&lt;a href=&#34;#cb1-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        rev[i] = (rev[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)  ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? (lim &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-89&#34;&gt;&lt;a href=&#34;#cb1-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f1, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-90&#34;&gt;&lt;a href=&#34;#cb1-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-91&#34;&gt;&lt;a href=&#34;#cb1-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[i] = f1[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-92&#34;&gt;&lt;a href=&#34;#cb1-92&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-93&#34;&gt;&lt;a href=&#34;#cb1-93&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-94&#34;&gt;&lt;a href=&#34;#cb1-94&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] += (g[i] - f2[i]) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-95&#34;&gt;&lt;a href=&#34;#cb1-95&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-96&#34;&gt;&lt;a href=&#34;#cb1-96&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-97&#34;&gt;&lt;a href=&#34;#cb1-97&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        g[i] = f1[i] * g[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-98&#34;&gt;&lt;a href=&#34;#cb1-98&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(g, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-99&#34;&gt;&lt;a href=&#34;#cb1-99&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f2, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-100&#34;&gt;&lt;a href=&#34;#cb1-100&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-101&#34;&gt;&lt;a href=&#34;#cb1-101&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f2[i] = f2[i] * f1[i] % mod;&lt;/span&gt;
&lt;span id=&#34;cb1-102&#34;&gt;&lt;a href=&#34;#cb1-102&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    NTT(f2, lim, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-103&#34;&gt;&lt;a href=&#34;#cb1-103&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-104&#34;&gt;&lt;a href=&#34;#cb1-104&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb1-105&#34;&gt;&lt;a href=&#34;#cb1-105&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans[i] += (g[i] - &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; * f2[i] + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * f3[i]) / &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-106&#34;&gt;&lt;a href=&#34;#cb1-106&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ans[i]) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, i, ans[i]);&lt;/span&gt;
&lt;span id=&#34;cb1-107&#34;&gt;&lt;a href=&#34;#cb1-107&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-108&#34;&gt;&lt;a href=&#34;#cb1-108&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-109&#34;&gt;&lt;a href=&#34;#cb1-109&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        
    </channel>
</rss>

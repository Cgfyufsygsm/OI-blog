<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>æ„é€  on æ¸…çƒ›çš„åšå®¢</title>
        <link>https://oi.imyangty.com/tags/constructive/</link>
        <description>Recent content in æ„é€  on æ¸…çƒ›çš„åšå®¢</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-CN</language>
        <lastBuildDate>Wed, 17 Aug 2022 22:52:06 +0800</lastBuildDate><atom:link href="https://oi.imyangty.com/tags/constructive/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>AtCoder æ¯”èµ›æ—¥è®°</title>
        <link>https://oi.imyangty.com/summary-atcoder/</link>
        <pubDate>Fri, 23 Apr 2021 12:38:59 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/summary-atcoder/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg70.webp" alt="Featured image of post AtCoder æ¯”èµ›æ—¥è®°" /&gt;&lt;h2 id=&#34;abc&#34;&gt;ABC&lt;/h2&gt;
&lt;h3 id=&#34;è¡¥é¢˜è¡¨&#34;&gt;è¡¥é¢˜è¡¨&lt;/h3&gt;
&lt;p&gt;è¿‘æœŸç›®æ ‡ï¼šABC ç¨³å®š 30min è¿‡ 4 é¢˜ï¼Œäº‰å–èµ›æ—¶è¿‡ Gï¼Œå°½é‡è¡¥å…¨å¥— ABCã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Round&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Rank&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Perf&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Sol&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;th&gt;E&lt;/th&gt;
&lt;th&gt;F&lt;/th&gt;
&lt;th&gt;G&lt;/th&gt;
&lt;th&gt;H&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC202&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc202/standings?watching=YangTY&#34;&gt;1095&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1437&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC207&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc207/standings?watching=YangTY&#34;&gt;956&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1484&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC210&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc210/standings?watching=YangTY&#34;&gt;485&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1823&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC212&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc212/standings?watching=YangTY&#34;&gt;856&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1536&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC213&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc213/standings?watching=YangTY&#34;&gt;1031&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1485&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC214&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc214/standings?watching=YangTY&#34;&gt;742&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1647&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC217&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc217/standings?watching=Cgfyufsygsm&#34;&gt;1320&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1383&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC219&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc219/standings?watching=YangTY&#34;&gt;1153&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1375&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC222&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc222/standings?watching=YangTY&#34;&gt;425&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1880&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC223&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc223/standings?watching=Cgfyufsygsm&#34;&gt;1573&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1074&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC224&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc224/standings?watching=YangTY&#34;&gt;426&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1828&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC231&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc231/standings?watching=Cgfyufsygsm&#34;&gt;571&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1665&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC232&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc232/standings?watching=YangTY&#34;&gt;762&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1518&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC233&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc233/standings?watching=YangTY&#34;&gt;659&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1660&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC234&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc234/standings?watching=YangTY&#34;&gt;1553&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1224&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC235&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc235/standings?watching=YangTY&#34;&gt;913&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1525&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC237&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc237/standings?watching=YangTY&#34;&gt;534&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1790&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC244&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc244/standings?watching=YangTY&#34;&gt;333&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1788&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;6&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ABC246&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc246/standings?watching=YangTY&#34;&gt;703&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1656&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;5&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ABC247&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc247/standings?watching=YangTY&#34;&gt;640&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1703&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;6&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;ä¸€äº›æ–°è§åˆ°çš„-trick&#34;&gt;ä¸€äº›æ–°è§åˆ°çš„ trick&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ABC212Eï¼šè¡¥é›†æ€æƒ³ä¼˜åŒ– dpã€‚&lt;/li&gt;
&lt;li&gt;ABC212Hï¼šFWT çš„çº¿æ€§æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ABC219Eï¼šç½‘æ ¼å¾ˆå°æ‰€ä»¥ç›´æ¥å°†æŠ¤åŸæ²³çš„çŠ¶æ€å’Œæ ¼å­åŒå°„ã€‚&lt;/li&gt;
&lt;li&gt;ABC231Gï¼šæœŸæœ›çº¿æ€§æ€§æ¨å¤§å¼å­ã€‚&lt;/li&gt;
&lt;li&gt;ABC232Gï¼šå¯¹äºæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ç±»é—®é¢˜å»ºç¯ã€‚&lt;/li&gt;
&lt;li&gt;ABC233Exï¼šæ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«ç„¶åä¸»å¸­æ ‘äºŒç»´æ•°ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;ABC235Gï¼šé€†å‘è€ƒè™‘é—®é¢˜â†’äºŒé¡¹å¼åæ¼”â†’&lt;strong&gt;æ£‹ç›˜è·¯å¾„è®¡æ•°çš„é€’æ¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ABC237Eï¼šç‚¹é«˜åº¦ç›´æ¥æ»¡è¶³åŠ¿èƒ½æ€§è´¨â†’ç›´æ¥ Dijkstraã€‚&lt;/li&gt;
&lt;li&gt;ABC237Exï¼šä¸²çš„åŒ…å«å…³ç³»è½¬ä¸ºååºå…³ç³»ğŸ‘‰æ±‚æœ€å¤§åé“¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;abc212&#34;&gt;ABC212&lt;/h3&gt;
&lt;p&gt;A + B + C + D + Eã€‚A - D ç•¥ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc212e---safety-journey&#34;&gt;ABC212E - Safety Journey&lt;/h4&gt;
&lt;p&gt;è¡¥é›†æ€æƒ³ä¼˜åŒ– DP ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = \sum_{j&amp;#39;\text{ is connected with j}}f_{i - 1, j&amp;#39;}
\]&lt;/span&gt; å¯ä»¥è½¬åŒ–ä¸º &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = \sum_{j&amp;#39; = 1}^n f_{i - 1, j&amp;#39;} - \sum_{j&amp;#39;\text{ isn&amp;#39;t connected with j}}f_{i - 1, j&amp;#39;}
\]&lt;/span&gt; æ²¡è¿è¾¹çš„æ•°é‡æ˜¯æ€»å…± &lt;span class=&#34;math inline&#34;&gt;\(O(m)\)&lt;/span&gt; çš„ï¼Œæ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O((n + m)k)\)&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;abc212f---greedy-takahashi&#34;&gt;ABC212F - Greedy Takahashi&lt;/h4&gt;
&lt;p&gt;å»ºæ¨¡æˆæ£®æ—ç„¶åç›´æ¥æ ‘ä¸Šå€å¢æ±‚è§£ã€‚ç åŠ›è¦æ±‚è¾ƒé«˜ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc212g---power-pair&#34;&gt;ABC212G - Power Pair&lt;/h4&gt;
&lt;p&gt;ç»™å®šè´¨æ•° &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œé—®æ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; çš„ä¸ªæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(0\le x, y\le p - 1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\exists n, x^n\equiv y\pmod p\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le p\le 10^{12}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å›é¡¾åŸæ ¹çš„æ¦‚å¿µã€‚&lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ºæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„åŸæ ¹å½“ä¸”ä»…å½“æœ€å°çš„ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(r^e\equiv 1\pmod p\)&lt;/span&gt; çš„æ­£æ•´æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(e = p - 1\)&lt;/span&gt;ã€‚æœ¬é¢˜éœ€è¦ç”¨åˆ°çš„æ€§è´¨ï¼š&lt;span class=&#34;math inline&#34;&gt;\(r^i\bmod p, i\in[0, p - 1]\)&lt;/span&gt; çš„å€¼ä¸¤ä¸¤ä¸åŒï¼Œä¸”å¯¹äºä¸€ä¸ªè´¨æ•°ï¼Œä¸€å®šæœ‰åŸæ ¹å­˜åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(x\equiv r^a\pmod p\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(y\equiv r^b\pmod p\)&lt;/span&gt;ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; æ€»èƒ½æœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; ä¸ä¹‹å¯¹åº”ã€‚äºæ˜¯å°±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(an\equiv b\pmod{p - 1}\)&lt;/span&gt;ã€‚ç°åœ¨å°±æ˜¯éœ€è¦æ‰¾æ»¡è¶³ä¸Šå¼çš„ &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œåˆ™ä¸Šå¼æœ‰è§£çš„æ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a, p - 1)\mid b\)&lt;/span&gt;ï¼ˆè£´èœ€å®šç†ï¼‰ã€‚é‚£å¯¹äºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å°±å¯ä»¥å†™æˆï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{a = 1}^{p - 1}\frac{p - 1}{\gcd(a, p - 1)}
\]&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(O(p)\)&lt;/span&gt; æ˜¯è¿‡ä¸å»çš„ï¼Œè¦è€ƒè™‘ä¼˜åŒ–ã€‚ä¼˜åŒ–å®ƒçš„æ–¹æ³•æ˜æ˜¾æ˜¯å¯»æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a, p - 1)\)&lt;/span&gt; ç›¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä¸ªæ•°ã€‚æ ¹æ® &lt;span class=&#34;math inline&#34;&gt;\(p - 1\)&lt;/span&gt; çš„å› æ•°ä¸ªæ•° ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt p)\)&lt;/span&gt; çš„ï¼Œæ•…è¿™äº› &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; ä¹Ÿåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt p)\)&lt;/span&gt; ä¸ªã€‚æˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a, p - 1) = g\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{g\mid p - 1}\frac{p - 1}{g}\times\phi\left(\frac{p - 1}{g}\right)
\]&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(\phi(n)\)&lt;/span&gt; å¯ä»¥æš´åŠ›è®¡ç®—ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt p\log p)\)&lt;/span&gt;ï¼Œå› ä¸º $$ çš„ä¸Šç•Œå¾ˆæ¾ï¼Œè½»æ¾é€šè¿‡ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc212h---nim-counting&#34;&gt;ABC212H - Nim Counting&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((A_1, \cdots, A_k)\)&lt;/span&gt;ã€‚å¯ä»¥å¦‚ä¸‹å®‰æ’çŸ³å­ï¼šæ¯å †çŸ³å­æ•°é‡å¿…é¡»æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä¹‹ä¸€ï¼Œä¸”çŸ³å­å †æ•°é‡å°ç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚é—®å®‰æ’çŸ³å­ä½¿å¾—å…ˆæ‰‹ Nim å¿…èƒœçš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k, A_i\le 2^{17}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä¸¤ä¸¤ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°é—®é¢˜è½¬åŒ–ä¸ºæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\bigoplus_{i = 1}^m B_i\not=0\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ºçŸ³å­ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè€ƒè™‘å›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚åˆ™æ„é€ åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(C_i = [\exist j, A_j = i]\)&lt;/span&gt;ï¼Œå®šä¹‰å·ç§¯ &lt;span class=&#34;math inline&#34;&gt;\(*\)&lt;/span&gt; ä¸ºå¼‚æˆ–å·ç§¯ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(C * C * \cdots * C\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt;ï¼‰çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; é¡¹ç³»æ•°å³ä¸ºå¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯ä»¥ FWT åšçš„ï¼Œå…·ä½“åœ°ï¼Œç»™ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{FWT}(C)_i\)&lt;/span&gt; çš„æ¯ä¸€é¡¹åšä¸€ä¸‹å¿«é€Ÿå¹‚å† IFWT å›å»ï¼ŒæŠŠé™¤äº†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; é¡¹ä¹‹å¤–çš„æ±‚ä¸ªå’Œï¼Œå°±å¾—åˆ°äº†çŸ³å­å †æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œä¸å›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ€ä¹ˆåšå‘¢ï¼Ÿå› ä¸º FWT æ˜¯çº¿æ€§å˜æ¢ï¼Œè€Œæˆ‘ä»¬éœ€è¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{IFWT}(\operatorname{FWT}(C)_i + \operatorname{FWT}(C)_i^2 + \operatorname{FWT}(C)_i^3 + \cdots \operatorname{FWT}(C)_i^n)\)&lt;/span&gt;ï¼Œæ‰€ä»¥å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(C&amp;#39;_i = \operatorname{FWT}(C)_i\)&lt;/span&gt;ï¼Œç„¶åæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(D_i = C_i&amp;#39; + C_i&amp;#39;^2 + \cdots + C_i&amp;#39;^n\)&lt;/span&gt; å†æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{IFWT}(D)\)&lt;/span&gt; æŠŠé™¤äº†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; é¡¹å¤–çš„ç³»æ•°ç´¯åŠ å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint calc(modint x, modint n) {&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x * (qPow(x, n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * qPow(x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(k);&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) read(tmp), maxa = tmp &amp;gt; maxa ? tmp : maxa, f[tmp] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ++maxa;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (lim = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; lim &amp;lt;= maxa; lim &amp;lt;&amp;lt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    XOR(f, lim, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f[i] = calc(f[i], n);&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    XOR(f, lim, inv2);&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, lim - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans += f[i];&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;abc213&#34;&gt;ABC213&lt;/h3&gt;
&lt;p&gt;A + B + C + D + F&lt;/p&gt;
&lt;h4 id=&#34;abc213e---stronger-takahashi&#34;&gt;ABC213E - Stronger Takahashi&lt;/h4&gt;
&lt;p&gt;0-1 bfsï¼Œå› ä¸ºè¾¹æƒåªä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc213f---common-prefixes&#34;&gt;ABC213F - Common Prefixes&lt;/h4&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{LCP}(S_i, S_j)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¼€å¤´å­ä¸²å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¼€å¤´å­ä¸²çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\in[1, n]\)&lt;/span&gt; æ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^n\operatorname{LCP}(S_k, S_i)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;SA æ¿å­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc213g---connectivity-2&#34;&gt;ABC213G - Connectivity 2&lt;/h4&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è”é€šçš„å­å›¾ä¸ªæ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 17\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å¾ˆå°ã€‚&lt;/p&gt;
&lt;p&gt;çŠ¶å‹ dpã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g(S)\)&lt;/span&gt; è¡¨ç¤ºç‚¹é›† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­æœ‰è¿è¾¹çš„æ•°é‡ã€‚è¿™å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(2^nm)\)&lt;/span&gt; çš„æ—¶é—´å†…å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f(S)\)&lt;/span&gt; ä¸ºä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…ç‚¹è”é€šçš„è¿è¾¹æ–¹æ¡ˆæ•°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è€ƒè™‘å®¹æ–¥ï¼Œéšä¾¿é€‰ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œç„¶åè€ƒè™‘è¿™ä¸ªç‚¹æ‰€åœ¨çš„è¿é€šåˆ†é‡ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(T\subset S\)&lt;/span&gt;ã€‚åˆ™æœ‰å¦‚ä¸‹è½¬ç§» &lt;span class=&#34;math display&#34;&gt;\[
f(S) = g(S) - \sum_{x\in T, T\subset S} f(T)
\]&lt;/span&gt; ç„¶åå¯¹äºç­”æ¡ˆï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å·ç‚¹çš„ç­”æ¡ˆå³ä¸ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{1\in S, k\in S} f(S)
\]&lt;/span&gt; è¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc213h---stroll&#34;&gt;ABC213H - Stroll&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å¯¹ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((a_i, b_i)\)&lt;/span&gt; é—´æœ‰è¿è¾¹ï¼Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(p_{i, d}\)&lt;/span&gt; æ¡ã€‚é—®ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹å‡ºå‘ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ç»“æŸçš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„è·¯å¾„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæŠŠæœ€æœ´ç´ çš„ DP æ–¹ç¨‹å†™å‡ºæ¥ï¼šè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u, s}\)&lt;/span&gt; ä¸ºç»“æŸç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„è·¯å¾„æ¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åˆ™æœ€æœ´ç´ çš„æ–¹ç¨‹ï¼šå¯¹äºæ¯æ¡è¾¹è¿›è¡Œè½¬ç§» &lt;span class=&#34;math display&#34;&gt;\[
f_{u_i, s} := f_{u_i, s} + \sum_{t = 0}^sf_{v_i, t}p_{i, t}
\]&lt;/span&gt; å†™æˆç”Ÿæˆå‡½æ•°çš„å½¢å¼å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
F_{u_i}(x) := F_{u_i}(x) + F_{v_i}(x)P_i(x)
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿çœ‹ä¼¼å¯ä»¥ NTT ä¼˜åŒ–ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°å­˜åœ¨åå¤æ¨ªè·³çš„æƒ…å†µã€‚æ‰€ä»¥ç›´æ¥å»åšè‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åœ¨é•¿åº¦çš„ç»´åº¦åˆ†æ²»ã€‚è€ƒè™‘å½“å‰åˆ†æ²»åŒºé—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt;ï¼Œç„¶åé¦–å…ˆå¤„ç†ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\([l, mid]\)&lt;/span&gt; å†…éƒ¨ï¼ŒæŠŠè¿™äº›ç®—å®Œï¼Œç„¶åå¤„ç† &lt;span class=&#34;math inline&#34;&gt;\([l, mid]\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\([mid + 1, r]\)&lt;/span&gt; çš„è´¡çŒ®ã€‚å³ &lt;span class=&#34;math display&#34;&gt;\[
f_{u_i, s} := f_{u_i, s} + \sum_{t = l}^{mid}f_{v_i, t}p_{i, s - t}\quad s\in[mid + 1, r]
\]&lt;/span&gt; ç±»ä¼¼åˆ†æ²» NTT å¤„ç†å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb2-1&#34;&gt;&lt;a href=&#34;#cb2-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Poly f[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], p[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], t1, t2;&lt;/span&gt;
&lt;span id=&#34;cb2-2&#34;&gt;&lt;a href=&#34;#cb2-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, T, u[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], v[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-3&#34;&gt;&lt;a href=&#34;#cb2-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-4&#34;&gt;&lt;a href=&#34;#cb2-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve(Poly &amp;amp;f, Poly &amp;amp;g, Poly &amp;amp;ret, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r) {&lt;/span&gt;
&lt;span id=&#34;cb2-5&#34;&gt;&lt;a href=&#34;#cb2-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-6&#34;&gt;&lt;a href=&#34;#cb2-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t1 = {f.begin() + l, f.begin() + mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb2-7&#34;&gt;&lt;a href=&#34;#cb2-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t2 = {g.begin() + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, g.begin() + r - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb2-8&#34;&gt;&lt;a href=&#34;#cb2-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t1 = t1 * t2;&lt;/span&gt;
&lt;span id=&#34;cb2-9&#34;&gt;&lt;a href=&#34;#cb2-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r) ret[i] = (ret[i] + t1[i - l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) % mod;&lt;/span&gt;
&lt;span id=&#34;cb2-10&#34;&gt;&lt;a href=&#34;#cb2-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-11&#34;&gt;&lt;a href=&#34;#cb2-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-12&#34;&gt;&lt;a href=&#34;#cb2-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-13&#34;&gt;&lt;a href=&#34;#cb2-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r) {&lt;/span&gt;
&lt;span id=&#34;cb2-14&#34;&gt;&lt;a href=&#34;#cb2-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-15&#34;&gt;&lt;a href=&#34;#cb2-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l == r) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-16&#34;&gt;&lt;a href=&#34;#cb2-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    solve(l, mid);&lt;/span&gt;
&lt;span id=&#34;cb2-17&#34;&gt;&lt;a href=&#34;#cb2-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb2-18&#34;&gt;&lt;a href=&#34;#cb2-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        solve(f[u[i]], p[i], f[v[i]], l, r);&lt;/span&gt;
&lt;span id=&#34;cb2-19&#34;&gt;&lt;a href=&#34;#cb2-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        solve(f[v[i]], p[i], f[u[i]], l, r);&lt;/span&gt;
&lt;span id=&#34;cb2-20&#34;&gt;&lt;a href=&#34;#cb2-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-21&#34;&gt;&lt;a href=&#34;#cb2-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    solve(mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r);&lt;/span&gt;
&lt;span id=&#34;cb2-22&#34;&gt;&lt;a href=&#34;#cb2-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-23&#34;&gt;&lt;a href=&#34;#cb2-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-24&#34;&gt;&lt;a href=&#34;#cb2-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-25&#34;&gt;&lt;a href=&#34;#cb2-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb2-26&#34;&gt;&lt;a href=&#34;#cb2-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m), read(T);&lt;/span&gt;
&lt;span id=&#34;cb2-27&#34;&gt;&lt;a href=&#34;#cb2-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lim = T + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-28&#34;&gt;&lt;a href=&#34;#cb2-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb2-29&#34;&gt;&lt;a href=&#34;#cb2-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(u[i]), read(v[i]);&lt;/span&gt;
&lt;span id=&#34;cb2-30&#34;&gt;&lt;a href=&#34;#cb2-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        p[i].resize(T + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-31&#34;&gt;&lt;a href=&#34;#cb2-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, T) read(p[i][j]);&lt;/span&gt;
&lt;span id=&#34;cb2-32&#34;&gt;&lt;a href=&#34;#cb2-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-33&#34;&gt;&lt;a href=&#34;#cb2-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) f[i].resize(T + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-34&#34;&gt;&lt;a href=&#34;#cb2-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-35&#34;&gt;&lt;a href=&#34;#cb2-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    solve(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, T);&lt;/span&gt;
&lt;span id=&#34;cb2-36&#34;&gt;&lt;a href=&#34;#cb2-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][T]);&lt;/span&gt;
&lt;span id=&#34;cb2-37&#34;&gt;&lt;a href=&#34;#cb2-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-38&#34;&gt;&lt;a href=&#34;#cb2-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;abc217&#34;&gt;ABC217&lt;/h3&gt;
&lt;p&gt;A + B + C + D + E&lt;/p&gt;
&lt;h4 id=&#34;abc217f---make-pair&#34;&gt;ABC217F - Make Pair&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; ä¸ªå­¦ç”Ÿï¼Œå…¶ä¸­åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å¯¹å…³ç³»å¥½ã€‚æ¯æ¬¡é€‰æ‹©ç›¸é‚»ä¸¤ä¸ªå…³ç³»å¥½çš„è¿›è¡Œé…å¯¹å¹¶ä»åºåˆ—ä¸­åˆ é™¤ï¼Œé—®æŠŠæ‰€æœ‰å­¦ç”Ÿé…å¯¹çš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸€çœ¼å°±æ˜¯åŒºé—´ dpã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{l, r}\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; é‡Œé¢çš„äººé…å¯¹çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè‡³äºè½¬ç§»ï¼Œè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; ä¸è°é…å¯¹ï¼Œè®¾å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚åˆ™é¦–å…ˆï¼Œ &lt;span class=&#34;math inline&#34;&gt;\([l, x]\)&lt;/span&gt; çš„é•¿åº¦ä¸€å®šæ˜¯å¶æ•°ï¼Œå¹¶ä¸” &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å…³ç³»å¥½ã€‚ç„¶åæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{l + 1, x - 1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_{x + 1, r}\)&lt;/span&gt;ã€‚æ³¨æ„åˆ°ç§»é™¤ &lt;span class=&#34;math inline&#34;&gt;\([l + 1, x - 1]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([x + 1, r]\)&lt;/span&gt; æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼Œå¹¶ä¸” &lt;span class=&#34;math inline&#34;&gt;\([l + 1, x - 1]\)&lt;/span&gt; å¿…é¡»åœ¨é…å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¹‹å‰å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼Œåˆå¹¶ &lt;span class=&#34;math inline&#34;&gt;\([l, x]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([x + 1, r]\)&lt;/span&gt; æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è€ƒè™‘ä¸€å…±è¿›è¡Œäº† &lt;span class=&#34;math inline&#34;&gt;\((r - l + 1) / 2\)&lt;/span&gt; æ¬¡åˆå¹¶ï¼Œè€Œæˆ‘ä»¬éœ€è¦ç¡®å®šæœ‰å“ªå‡ æ¬¡æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\([x + 1, r]\)&lt;/span&gt; é‡Œé¢çš„åœ¨åšï¼Œä¸éš¾å‘ç°å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
\binom{(r - l + 1) / 2}{(r - x) / 2}
\]&lt;/span&gt; è½¬ç§»çš„æ—¶å€™ä¹˜ä¸Šè¿™ä¸ªç³»æ•°å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc217/submissions/25628059&#34;&gt;ä»£ç &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc217g---groups&#34;&gt;ABC217G - Groups&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªæ•°ï¼Œè¦æ±‚åˆ’åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªéç©ºç»„ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(i\equiv j\pmod m\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸èƒ½åœ¨ä¸€ç»„ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k = 1,\cdots, n\)&lt;/span&gt; è¾“å‡ºæ–¹æ¡ˆæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;åŸæ¥çš„ç»„æ˜¯éç©ºä¸”æ— æ ‡å·çš„ï¼Œæ–¹æ¡ˆæ•°è®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(k)\)&lt;/span&gt;ï¼Œå…ˆè€ƒè™‘å¯ä»¥ä¸ºç©ºå¹¶ä¸”æœ‰æ ‡å·çš„æƒ…å†µï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(g(k)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; ä¸­æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„ä½™æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„æ•°å­—æ„æˆçš„é›†åˆï¼Œåˆ™å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt;ï¼Œæˆ‘ä»¬éƒ½è¦å°†å…¶åˆ’åˆ†åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªä¸åŒçš„ç»„é‡Œé¢å»ï¼Œæ¯ä¸ªç»„é‡Œé¢æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(P(n, m) = \displaystyle\frac{n!}{(n - m)!}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; é€‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„æ’åˆ—æ•°ï¼š &lt;span class=&#34;math display&#34;&gt;\[
g(k) = \prod_{i = 0}^{m - 1 }P(k, |S_i|)
\]&lt;/span&gt; è¿™æ˜¯ä¸è¦æ±‚æ”¾æ»¡çš„ã€‚è€Œå¦‚æœçŸ¥é“æ°å¥½æ”¾æ»¡çš„ï¼Œé™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(k!\)&lt;/span&gt; å°±æ˜¯ä¸å¸¦æ ‡å·çš„äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ°å¥½æ”¾æ»¡å¯ä»¥ç”¨å®¹æ–¥ã€‚å»æ‰çš„æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{p = 0}^{k - 1}\binom kpf(p)p!
\]&lt;/span&gt; å³ä¸ºæœ‰åºéç©ºç»„æ•°ä¸åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ï¼Œæ‰€ä»¥ &lt;span class=&#34;math display&#34;&gt;\[
f(k) = \frac{\prod_{i = 0}^{m - 1}P(k, |S_i|) - \sum_{p = 0}^{k - 1}\binom k p f(p)p!}{k!}
\]&lt;/span&gt; é€’æ¨å¯åšï¼Œå‰é¢é‚£ä¸€æ®µå¯ä»¥å¿«é€Ÿé¢„å¤„ç†ç„¶åç”¨å¿«é€Ÿå¹‚ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; æ¥ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc217/submissions/25641347/&#34;&gt;ä»£ç &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc219&#34;&gt;ABC219&lt;/h3&gt;
&lt;p&gt;çŠ¶æ€å·®ã€‚A + B + C + Dã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc219e---moat&#34;&gt;ABC219E - Moat&lt;/h4&gt;
&lt;p&gt;ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(4\times 4\)&lt;/span&gt; çš„ç½‘æ ¼ï¼Œè¦æ±‚åœ¨ç½‘æ ¼è¾¹ä¸Šä¿®ä¸€ä¸ªæŠ¤åŸæ²³ï¼Œä½¿å¾—æŠ¤åŸæ²³æ˜¯ä¸€ä¸ªåˆæ³•å¤šè¾¹å½¢å¹¶ä¸”åŒ…å«äº†æ‰€æœ‰çš„æ‘åº„ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒç¥å¥‡çš„æ€è·¯ï¼Œé‰´äºç½‘æ ¼åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(16\)&lt;/span&gt; ä¸ªï¼Œè€Œä¸”ä¸€ä¸ªæŠ¤åŸæ²³å¿…å®šå’Œä¸€ç§çŠ¶æ€ï¼ˆä¸€ä¸ªæ ¼å­æœ‰æ²¡æœ‰è¢«åŒ…å«ï¼‰ä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æšä¸¾è¿™ &lt;span class=&#34;math inline&#34;&gt;\(O(2^{16})\)&lt;/span&gt; ä¸ªçŠ¶æ€ç„¶ååˆ¤æ–­ç½‘æ ¼æ˜¯å¦åˆæ³•ã€‚&lt;/p&gt;
&lt;p&gt;åˆ¤æ–­ç½‘æ ¼æ˜¯å¦åˆæ³•è¿™ä¸ªï¼Œé¦–å…ˆéœ€è¦åˆ¤æ–­æ¯ä¸ªæ‘åº„æ˜¯ä¸æ˜¯è¢«åŒ…å«ï¼Œå…¶æ¬¡éœ€è¦é¿å…ä¸­é—´è¢«æŒ–ç©ºçš„æƒ…å†µï¼Œç„¶åè¦é¿å… &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„æ ¼å­è¢«å‰²è£‚å¼€çš„æƒ…å†µï¼Œç»¼ä¸Šå³æ•´å¼ å›¾ï¼ˆæŠŠè¾¹ç•Œå¤–çš„è€ƒè™‘è¿›å»ï¼‰åªèƒ½æœ‰ä¸¤ä¸ªè¿é€šå—ï¼Œdfs æŸ“è‰²å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc222&#34;&gt;ABC222&lt;/h3&gt;
&lt;p&gt;A + B + C + D + Gï¼Œrk 425ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc222e---red-and-blue-tree&#34;&gt;ABC222E - Red and Blue Tree&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¡æ ‘ä¸Šè·¯å¾„ï¼Œæ¯æ¬¡ä¼šè¦†ç›–è‹¥å¹²è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘è®¾ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¡è¾¹çš„è¢«è¦†ç›–æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯æ¬¡éƒ½ä¼šç»™é€”å¾„çš„ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚è¦†ç›–å®Œä¹‹åè®¿é—®çº¢è¾¹çš„æ¬¡æ•°-è®¿é—®è“è¾¹çš„æ¬¡æ•°=&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé—®æŸ“è‰²æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æš´åŠ›ç»™è¾¹æŸ“è‰²ã€‚&lt;/p&gt;
&lt;p&gt;æŸ“å®Œä¹‹åä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(R\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; æ˜¯ç¡®å®šçš„ã€‚æ‰€ä»¥ç›´æ¥èƒŒåŒ…ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc222f---expensive-expense&#34;&gt;ABC222F - Expensive Expense&lt;/h4&gt;
&lt;p&gt;æ ‘ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(E_{i, j}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è·¯å¾„ä¸Šè¾¹æƒå’ŒåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ç‚¹æƒï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰¾åˆ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(E_{i, j}\)&lt;/span&gt;ï¼Œç‚¹æ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(2\times 10^5\)&lt;/span&gt; çº§åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•æ¢æ ¹ dpã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc231&#34;&gt;ABC231&lt;/h3&gt;
&lt;p&gt;A + B + C + D + Fï¼Œrk571&lt;/p&gt;
&lt;h4 id=&#34;abc231e---minimal-payments&#34;&gt;ABC231E - Minimal payments&lt;/h4&gt;
&lt;p&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(A_{i - 1}\mid A_i\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å¯ä»¥åªè€ƒè™‘ä¸¤ç§æ–¹æ¡ˆï¼šç”¨è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å°½å¯èƒ½å‡‘ï¼Œæˆ–è€…ç”¨æ›´å¤§çš„é¢å€¼ä»˜ç„¶åè¦æ‰¾é›¶ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb3&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb3-1&#34;&gt;&lt;a href=&#34;#cb3-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-2&#34;&gt;&lt;a href=&#34;#cb3-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb3-3&#34;&gt;&lt;a href=&#34;#cb3-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll a[&lt;span class=&#34;dv&#34;&gt;65&lt;/span&gt;], x, ans;&lt;/span&gt;
&lt;span id=&#34;cb3-4&#34;&gt;&lt;a href=&#34;#cb3-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;unordered_map&amp;lt;ll, unordered_map&amp;lt;ll, ll&amp;gt; &amp;gt; f;&lt;/span&gt;
&lt;span id=&#34;cb3-5&#34;&gt;&lt;a href=&#34;#cb3-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-6&#34;&gt;&lt;a href=&#34;#cb3-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll dfs(ll x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now) {&lt;/span&gt;
&lt;span id=&#34;cb3-7&#34;&gt;&lt;a href=&#34;#cb3-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x;&lt;/span&gt;
&lt;span id=&#34;cb3-8&#34;&gt;&lt;a href=&#34;#cb3-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[x][now] &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[x][now];&lt;/span&gt;
&lt;span id=&#34;cb3-9&#34;&gt;&lt;a href=&#34;#cb3-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll r = x % a[now], q = x / a[now], p = a[now] - r;&lt;/span&gt;
&lt;span id=&#34;cb3-10&#34;&gt;&lt;a href=&#34;#cb3-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; q;&lt;/span&gt;
&lt;span id=&#34;cb3-11&#34;&gt;&lt;a href=&#34;#cb3-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll w1 = q + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; + dfs(p, now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-12&#34;&gt;&lt;a href=&#34;#cb3-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll w2 = q + dfs(r, now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-13&#34;&gt;&lt;a href=&#34;#cb3-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[x][now] = min(w1, w2);&lt;/span&gt;
&lt;span id=&#34;cb3-14&#34;&gt;&lt;a href=&#34;#cb3-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb3-15&#34;&gt;&lt;a href=&#34;#cb3-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-16&#34;&gt;&lt;a href=&#34;#cb3-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb3-17&#34;&gt;&lt;a href=&#34;#cb3-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, x);&lt;/span&gt;
&lt;span id=&#34;cb3-18&#34;&gt;&lt;a href=&#34;#cb3-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb3-19&#34;&gt;&lt;a href=&#34;#cb3-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans = x;&lt;/span&gt;
&lt;span id=&#34;cb3-20&#34;&gt;&lt;a href=&#34;#cb3-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(dfs(x, n));&lt;/span&gt;
&lt;span id=&#34;cb3-21&#34;&gt;&lt;a href=&#34;#cb3-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-22&#34;&gt;&lt;a href=&#34;#cb3-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc231g---balls-in-boxes&#34;&gt;ABC231G - Balls in Boxes&lt;/h4&gt;
&lt;p&gt;æœŸæœ›ç‰›é€¼é¢˜ã€‚å¤§ä½“æ€è·¯å°±æ˜¯æ‹†å¼€æœŸæœ›çš„å¼å­ï¼Œåˆ©ç”¨çº¿æ€§æ€§è¿›è¡ŒåŒ–ç®€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªç›’å­ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç›’å­ä¸€å¼€å§‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä¸ªçƒï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéšæœºé€‰ä¸€ä¸ªç›’å­åŠ ä¸€ä¸ªçƒï¼Œæœ€åæ¯ä¸ªç›’å­æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; ä¸ªçƒï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\(S = \prod B_i\)&lt;/span&gt; çš„æœŸæœ›ï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(E[S]\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(X_i\)&lt;/span&gt; ä¸ºè¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç›’å­è¢«é€‰ä¸­æ¬¡æ•°çš„éšæœºå˜é‡ï¼Œåˆ™æˆ‘ä»¬è¦çš„æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(E[\prod_i(A_i + X_i)]\)&lt;/span&gt;ã€‚è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(N = 2\)&lt;/span&gt; çš„æƒ…å†µï¼Œå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(E[(A_1 + X_1)(A_2 + X_2)] = E[A_1A_2] + E[A_1X_2] + E[A_2X_1] + E[X_1X_2]\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¨è€Œå¹¿ä¹‹ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªä¸ä¸€æ ·çš„ä¸‹æ ‡ &lt;span class=&#34;math inline&#34;&gt;\(i_1,\cdots, i_n\)&lt;/span&gt;ï¼Œå®¹æ˜“çŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(E[\prod_{j = 1}^n X_{i_j}] = E[\prod_{i = 1}^nX_i]\)&lt;/span&gt;ã€‚æ‰€ä»¥æå‡ºè¿™ä¸ªå…¬å› å¼ï¼Œæœ‰ &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i =1}^N(A_i + X_i)\right] = \sum_{n = 0}^NS_{N, n}(A_1,\cdots, A_N)E\left[\prod_{i =1}^{N - n}X_i\right]
\]&lt;/span&gt; å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(S_{N, n}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªå˜é‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å¯¹ç§°å¤šé¡¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨åªéœ€è¦å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ç®—å‡º &lt;span class=&#34;math inline&#34;&gt;\(S_{N, n}(A_1,\cdots, A_N)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(E[\prod_{i = 1}^nX_i]\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å‰è€…ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S_{N, n}(A_1,\cdots, A_N) = [x^n]\prod_{i =1}^N(A_ix + 1)\)&lt;/span&gt;ã€‚è¿™ä¸ªä¸œè¥¿ä¸€ä¸ªåˆ†æ²» NTT ç¢¾è¿‡å»åº”è¯¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯åè€…ã€‚æˆ‘ä»¬è€ƒè™‘éšæœºå˜é‡ &lt;span class=&#34;math inline&#34;&gt;\(X_{i, j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç›’å­åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ¬¡æ“ä½œæ˜¯å¦ä¼šè¢«é€‰ä¸­ï¼ˆ0/1ï¼‰ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(X_i = \sum_{j = 1}^KX_{i, j}\)&lt;/span&gt;ã€‚æšä¸¾ä¸€ä¸‹ä¸‹æ ‡ï¼Œå‘ç° &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i = 1}^n X_i \right] = \sum_{j_1, j_2,\cdots, j_n}E\left[\prod_{i = 1}^nX_{i, j_i}\right]
\]&lt;/span&gt; ç„¶åå½“ &lt;span class=&#34;math inline&#34;&gt;\(i_1\not= i_2\)&lt;/span&gt; çš„æ—¶å€™ï¼Œæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(X_{i_1, j}X_{i_2, j} = 0\)&lt;/span&gt;ã€‚æ•… &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i = 1}^nX_{i, j_i}\right] =
\begin{cases}
\left(\frac 1N\right)^n \quad&amp;amp; \text{if }j_i\text{ are pairwise different}\\
0\quad&amp;amp; \text{otherwise}
\end{cases}
\]&lt;/span&gt; äºæ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
E\left[\prod_{i = 1}^n X_i \right] = \left(\prod_{i = 1}^n(K + 1 - i)\right)\left(\frac1N\right)^n
\]&lt;/span&gt; è¿™ä¸ªå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; ç®—ï¼Œäºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; è§£å†³äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc232&#34;&gt;ABC232&lt;/h3&gt;
&lt;p&gt;Aï¼ŒB ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;C å»ºå‡ºä¸€å¼ å›¾çš„é‚»æ¥çŸ©é˜µç„¶åç”¨ &lt;code&gt;next_permutation&lt;/code&gt; æšä¸¾æ’åˆ—åˆ¤æ–­æ˜¯å¦èƒ½å»ºç«‹æ˜ å°„å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;D ç®€å•ç½‘æ ¼ dpï¼Œæ³¨æ„è¾¹ç•Œæ¡ä»¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232e---rook-path&#34;&gt;ABC232E - Rook Path&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H \times W\)&lt;/span&gt; çš„ç½‘æ ¼ï¼Œä½ åˆå§‹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((x_1, y_1)\)&lt;/span&gt;ï¼Œè¦æ±‚åš &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; æ¬¡æ“ä½œåä½ç½®å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\((x_2, y_2)\)&lt;/span&gt;ã€‚æ¯æ¬¡æ“ä½œå½¢å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç§»åŠ¨æ¨ªåæ ‡ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\((x&amp;#39;, y)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(1\le x&amp;#39;\le H\land x&amp;#39;\neq x\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç§»åŠ¨çºµåæ ‡ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\((x, y&amp;#39;)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(1\le y&amp;#39;\le W\land y&amp;#39;\neq y\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ï¼ˆå°±æ˜¯è½¦çš„ç§»åŠ¨æ–¹å¼ï¼‰é—®æœ‰å¤šå°‘ç§å¯èƒ½çš„æ“ä½œæ–¹æ¡ˆï¼Œä¸¤ç§æ“ä½œæ–¹æ¡ˆä¸åŒå½“ä¸”ä»…å½“ä¸­é—´æŸä¸€æ­¥ç»è¿‡çš„ç‚¹ä¸åŒã€‚ç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®å¥—è·¯ï¼Œè¿™ä¸ªä¸œè¥¿çš„æ¨ªå‘ç§»åŠ¨å’Œçºµå‘ç§»åŠ¨æ˜¯å¯ä»¥åˆ†å¼€æ¥è€ƒè™‘çš„ã€‚å³ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ¨ªå‘ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆï¼Œå†ä¹˜ä¸Šçºµå‘ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(K - m\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆï¼Œå†ä¹˜ä¸Šç»„åˆç³»æ•° &lt;span class=&#34;math inline&#34;&gt;\(\dbinom K m\)&lt;/span&gt;ã€‚è€ƒè™‘è®¡ç®—åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ DPï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{0/1, i}\)&lt;/span&gt; è¡¨ç¤ºæ¨ªå‘ç§»åŠ¨ï¼ˆçºµå‘çš„ç±»ä¼¼ï¼‰å›åˆ°å‡ºå‘ç‚¹ä¸å¦ï¼Œèµ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­åˆå§‹è¾¹ç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{1,0} = 1\)&lt;/span&gt;ï¼Œå³èµ° &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ­¥ï¼Œç»ˆç‚¹åœ¨åŸç‚¹çš„æ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚è½¬ç§»å¦‚ä¸‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{cases}
f_{1, i} = (H - 1)f_{1, i - 1}\\
f_{0, i} = f_{1, i - 1} + (H - 2)f_{0, i - 1}
\end{cases}
\]&lt;/span&gt; è½¬ç§»çš„æ„ä¹‰è¿˜æ˜¯å¾ˆæ˜¾ç„¶çš„ã€‚äºæ˜¯æˆ‘ä»¬ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; æ±‚å‡º dp æ•°ç»„ï¼Œè¿™é¢˜å°±åšå®Œäº†ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc232/submissions/28029224&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232f---simple-operations-on-sequence&#34;&gt;ABC232F - Simple Operations on Sequence&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(2\le N\le 18\)&lt;/span&gt;ï¼‰ï¼š&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le A_i, B_i\le 10^8\)&lt;/span&gt;ï¼‰ã€‚å¯ä»¥è¿›è¡Œå¦‚ä¸‹ä¸¤ç§æ“ä½œï¼Œé—®æœ€å°çš„ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; çš„æ“ä½œä»£ä»·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; åŠ ä¸€/å‡ä¸€ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le X\le 10^8\)&lt;/span&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­çš„ç›¸é‚»å…ƒç´ ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le Y\le 10^{16}\)&lt;/span&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯«æ— ç–‘é—®ï¼Œä¸¤ä¸ªæ“ä½œæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¯ä»¥åˆ†å¼€è€ƒè™‘ã€‚å¦‚æœæˆ‘ä»¬å…ˆäº¤æ¢ï¼Œå‡ºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(P_1, P_2,\cdots,P_N\)&lt;/span&gt; çš„æ’åˆ—ï¼Œç„¶åå†ç»Ÿè®¡ç¬¬ä¸€ä¸ªçš„ç­”æ¡ˆã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{inv}(P)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; çš„é€†åºå¯¹æ•°ï¼Œåˆ™æ€»ä»£ä»·ä¸ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^N|A_{P_i} - B_i|\cdot X + \operatorname{inv}(P)\cdot Y
\]&lt;/span&gt; æŠŠé€†åºå¯¹çš„è¿™ä¸ªå…³äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„è´¡çŒ®æ‹†å¼€ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^N(|A_{P_i} - B_i|\cdot X + |\{p:p\in\{1,2,\cdots, N\} \backslash \{P_1, \cdots, P_{i - 1}\}, p &amp;lt; P_i\}|\cdot Y)
\]&lt;/span&gt; ç„¶åä¼šå‘ç°ä¸€ä¸ªå¾ˆå…³é”®çš„åœ°æ–¹ï¼šåé¢é‚£ä¸ªä¸œè¥¿åªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{P_1, \cdots, P_i\}\)&lt;/span&gt; è¿™ä¸ªé›†åˆæœ‰å…³ï¼Œè€Œè¿™ä¸ªé›†åˆå¾ˆå°ï¼Œæ‰€ä»¥ä¸å¦¨è€ƒè™‘å°†å…¶çŠ¶å‹èµ·æ¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(x, S)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(|p:p\in\{1, \cdots, N\}\backslash S, p &amp;lt; x|\)&lt;/span&gt;ã€‚ç„¶åå¼å­æ”¹å†™ä¸ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^N(|A_{P_i} - B_i|\cdot X + f(P_i, \{P_1, \cdots, P_{i - 1}\})\cdot Y)
\]&lt;/span&gt; äºæ˜¯å‘ç°ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥çŠ¶å‹ dpï¼Œå…·ä½“åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(dp_S\)&lt;/span&gt; è¡¨ç¤ºæ’åˆ—çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(|S|\)&lt;/span&gt; é¡¹æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…çš„å…ƒç´ ï¼Œåˆ™è½¬ç§»åº”è¯¥æ˜¯å¾ˆå¥½è½¬ç§»çš„ã€‚è¿™é¢˜å°±åšå®Œäº†ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc232/submissions/28032712&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232g---modulo-shortest-path&#34;&gt;ABC232G - Modulo Shortest Path&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€å¼  &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªç‚¹çš„æœ‰å‘å®Œå…¨å›¾ï¼Œå…¶ä¸­ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ‰å‘è¾¹è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\((A_i + B_j)\bmod M\)&lt;/span&gt;ã€‚é—® &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le N\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\le M\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¦‚æœæˆ‘ä»¬ç›´æ¥è¿è¾¹è·‘ Dijï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šå¯„ï¼Œè¾¹æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çº§åˆ«çš„ï¼Œè¦æƒ³åŠæ³•å°‘ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸ªæŠ€å·§ï¼Œå»ºä¸€å¼ æ–°å›¾ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„å»º &lt;span class=&#34;math inline&#34;&gt;\([0, M)\)&lt;/span&gt; çš„è™šç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(\overline{0},\overline 1,\cdots,\overline{M - 1}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(\forall k\in[0, M - 1)\)&lt;/span&gt;ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(\overline k\to \overline{k + 1}\)&lt;/span&gt;ï¼Œè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\in [1, N]\)&lt;/span&gt;ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(i\to \overline{-A_i\bmod M}\)&lt;/span&gt;ï¼Œè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\in [1, N]\)&lt;/span&gt;ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(\overline{B_i}\)&lt;/span&gt;ï¼Œè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å°±ç›¸å½“äºï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\overline{-A_i\bmod M}\)&lt;/span&gt;ï¼Œç„¶åä¸€æ­¥æ­¥èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\overline{B_j}\)&lt;/span&gt;ï¼Œå†èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚å‘ç°ä¸­é—´çš„è·¯ç¨‹åˆšå¥½å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((A_i + B_j)\bmod M\)&lt;/span&gt;ï¼Œäºæ˜¯é—®é¢˜å°±å¾—åˆ°äº†è½¬åŒ–ï¼Œæˆ‘ä»¬æ±‚æ–°å›¾ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€çŸ­è·¯å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯æ˜¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n + m)\)&lt;/span&gt; ä¼¼ä¹ä¹Ÿå¿…æ­»æ— ç–‘ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¯ä¸Šçš„å¾ˆå¤šç‚¹æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç¼©èµ·æ¥ï¼Œä¼šå’ŒåŸæ¥çš„ç‚¹è¿æ¥çš„è™šç‚¹åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; ä¸ªï¼Œè¿™æ ·å­ç‚¹æ•°å’Œè¾¹æ•°å°±éƒ½æ§åˆ¶åœ¨äº† &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çº§åˆ«ï¼Œç›´æ¥è·‘ Dij ä¾¿å¯é€šè¿‡ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc232/submissions/28035096&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc232h---kings-tour&#34;&gt;ABC232H - Kingâ€™s Tour&lt;/h4&gt;
&lt;p&gt;ä¸çŸ¥é“ç»„é¢˜äººæ€ä¹ˆæƒ³çš„ã€‚ã€‚ã€‚è¿™ä¸ªé¢˜å±…ç„¶æ”¾åœ¨ Hã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(H\times W\)&lt;/span&gt; æ£‹ç›˜ï¼Œä¸€ä¸ªå›½ç‹åˆå§‹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((1, 1)\)&lt;/span&gt;ã€‚å›½ç‹æ¯æ­¥å¯ä»¥èµ°åˆ°ä¸å…¶å…«è¿é€šçš„æ ¼å­ï¼Œè¯·æ„é€ ä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—å›½ç‹ä¸é‡å¤åœ°èµ°å®Œäº†æ¯ä¸ªæ ¼å­ï¼Œä¸”ç»ˆç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le H, W\le 100\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((a, b)\neq (1, 1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è€ƒè™‘å‡æ²»æ„é€ ã€‚è€ƒè™‘å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H = 2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(W = 2\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(H = 2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·æ„é€ æ–¹æ¡ˆï¼ˆå›¾æº AtCoder å®˜æ–¹é¢˜è§£ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/ghi/45d400563f38eb01ffea2e66239b9664.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å³ï¼Œè½¨è¿¹ä¸ºï¼š&lt;span class=&#34;math inline&#34;&gt;\((1, 1)\to (2, 1)\to\cdots\to(1, b)\to (1, b + 1)\to \cdots \to(1, W)\to (2, W)\to \cdots\to (2, b)\)&lt;/span&gt;ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(W= 2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°†è¡Œåˆ—è°ƒæ¢ä¹‹åæ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H &amp;gt; 2\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(W &amp;gt; 2\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸‹é¢è¿™ä¸ªæ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/ghi/6a11b9fe7eebca4ddd44a12826580c99.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç»¿è‰²åœˆå‡ºæ¥çš„ç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œåˆ†ç±»è®¨è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((a, b)\notin S\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥èµ°å®Œ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…çš„ç‚¹ï¼Œç„¶åå‚ç›´ç¿»è½¬ä¸€ä¸‹åæ ‡ç³»ï¼Œå°±å˜æˆäº†ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å­é—®é¢˜ï¼Œé€’å½’å¤„ç†å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((a, b)\in S\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬äº¤æ¢è¡Œåˆ—ä¹‹åï¼Œå°±å˜æˆäº† &lt;span class=&#34;math inline&#34;&gt;\((a,b)\notin S\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥é€’å½’åœ°å»è§£å†³è¿™é“é¢˜äº†ã€‚è¿™ç§ä»£ç å†™çš„å¾ˆå·§å¦™ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb4&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb4-1&#34;&gt;&lt;a href=&#34;#cb4-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-2&#34;&gt;&lt;a href=&#34;#cb4-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt; &lt;/span&gt;
&lt;span id=&#34;cb4-3&#34;&gt;&lt;a href=&#34;#cb4-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pii&amp;gt; solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; h, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; w, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;/span&gt;
&lt;span id=&#34;cb4-4&#34;&gt;&lt;a href=&#34;#cb4-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;pii&amp;gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb4-5&#34;&gt;&lt;a href=&#34;#cb4-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (h == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb4-6&#34;&gt;&lt;a href=&#34;#cb4-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, b - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i)), ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, i));&lt;/span&gt;
&lt;span id=&#34;cb4-7&#34;&gt;&lt;a href=&#34;#cb4-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; - a, b));&lt;/span&gt;
&lt;span id=&#34;cb4-8&#34;&gt;&lt;a href=&#34;#cb4-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, b + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, w) ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i));&lt;/span&gt;
&lt;span id=&#34;cb4-9&#34;&gt;&lt;a href=&#34;#cb4-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, w, b + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret.push_back(pii(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, i));&lt;/span&gt;
&lt;span id=&#34;cb4-10&#34;&gt;&lt;a href=&#34;#cb4-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back(pii(a, b));&lt;/span&gt;
&lt;span id=&#34;cb4-11&#34;&gt;&lt;a href=&#34;#cb4-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((h &amp;gt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; &amp;amp;&amp;amp; w == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) || b == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; || (a == h &amp;amp;&amp;amp; b == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)) {&lt;/span&gt;
&lt;span id=&#34;cb4-12&#34;&gt;&lt;a href=&#34;#cb4-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret = solve(w, h, b, a);&lt;/span&gt;
&lt;span id=&#34;cb4-13&#34;&gt;&lt;a href=&#34;#cb4-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : ret) myswap(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb4-14&#34;&gt;&lt;a href=&#34;#cb4-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb4-15&#34;&gt;&lt;a href=&#34;#cb4-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, h) ret.push_back(pii(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb4-16&#34;&gt;&lt;a href=&#34;#cb4-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; res = solve(h, w - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, h + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - a, b - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb4-17&#34;&gt;&lt;a href=&#34;#cb4-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : res) p.first = h + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - p.first, ++p.second;&lt;/span&gt;
&lt;span id=&#34;cb4-18&#34;&gt;&lt;a href=&#34;#cb4-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.insert(ret.end(), res.begin(), res.end());&lt;/span&gt;
&lt;span id=&#34;cb4-19&#34;&gt;&lt;a href=&#34;#cb4-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb4-20&#34;&gt;&lt;a href=&#34;#cb4-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb4-21&#34;&gt;&lt;a href=&#34;#cb4-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb4-22&#34;&gt;&lt;a href=&#34;#cb4-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt; &lt;/span&gt;
&lt;span id=&#34;cb4-23&#34;&gt;&lt;a href=&#34;#cb4-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb4-24&#34;&gt;&lt;a href=&#34;#cb4-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; h, w, a, b; read(h, w, a, b);&lt;/span&gt;
&lt;span id=&#34;cb4-25&#34;&gt;&lt;a href=&#34;#cb4-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; ans = solve(h, w, a, b);&lt;/span&gt;
&lt;span id=&#34;cb4-26&#34;&gt;&lt;a href=&#34;#cb4-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; p : ans) print(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb4-27&#34;&gt;&lt;a href=&#34;#cb4-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-28&#34;&gt;&lt;a href=&#34;#cb4-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;abc233&#34;&gt;ABC233&lt;/h3&gt;
&lt;h4 id=&#34;abc233f---swap-and-sort&#34;&gt;ABC233F - Swap and Sort&lt;/h4&gt;
&lt;p&gt;ç®€è¦é¢˜æ„ï¼šç»™å®šæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 1000\)&lt;/span&gt;ã€‚åŒæ—¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç»„å…³ç³» &lt;span class=&#34;math inline&#34;&gt;\((a_i, b_i)\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯ä»¥äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(P_{a_i}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(P_{b_i}\)&lt;/span&gt;ã€‚æ„é€ ä¸€ä¸ªæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(5\times 10^5\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; ä¸ºå‡åºã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªé—®é¢˜å¯ä»¥æŠ½è±¡æˆä¸€å¼ å›¾ã€‚ç„¶åå¯ä»¥å‘ç°ï¼Œå½“ä¸”ä»…å½“æ•°å­— &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; å’Œç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åœ¨ä¸€ä¸ªè¿é€šåˆ†é‡å†…æ—¶æ•´ä¸ªé—®é¢˜æœ‰è§£ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥å†™ä¸€ä¸ªå¹¶æŸ¥é›†ä¹‹ç±»çš„ä¸œè¥¿åˆ¤æ–­ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ„é€ æ–¹æ¡ˆã€‚ç”±äºä¸è¦æ±‚æœ€ä¼˜æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è€ƒè™‘å»ºå‡ºä¸€ä¸ªç”Ÿæˆæ ‘ï¼Œç„¶åä»ç‚¹åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ç‚¹å¼€å§‹é€ä¸ªå¤ä½å¹¶åˆ ç‚¹ã€‚æ“ä½œæ¬¡æ•°æœ€å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(999 + 998 + \cdots + 1 = 499500\)&lt;/span&gt;ã€‚&lt;a href=&#34;https://atcoder.jp/contests/abc233/submissions/28192989&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc233g---strongest-takahashi&#34;&gt;ABC233G - Strongest Takahashi&lt;/h4&gt;
&lt;p&gt;ç®€è¦é¢˜æ„ï¼šç»™å®šä¸€å¼  &lt;span class=&#34;math inline&#34;&gt;\(N\times N\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le N\le 50\)&lt;/span&gt;ï¼‰ç½‘æ ¼ï¼Œé‡Œé¢è‹¥å¹²ä¸ªæ ¼å­æœ‰éšœç¢ã€‚æ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(D\times D\)&lt;/span&gt; çš„åŒºåŸŸç„¶åæ¶ˆè€— &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt; ç‚¹ä½“åŠ›å°†å…¶ä¸­çš„éšœç¢æ¶ˆå»ã€‚é—®å°†æ‰€æœ‰éšœç¢æ¶ˆå»çš„æœ€å°ä½“åŠ›æ¶ˆè€—ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§é«˜ç»´åº¦çš„ dp ä¸€ç›´æ˜¯æˆ‘çš„å¼±ç‚¹ã€‚ã€‚ã€‚è€ƒè™‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A\times B\)&lt;/span&gt; çš„çŸ©å½¢åŒºåŸŸï¼ˆå­é—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬æ˜¾ç„¶éœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(C = \max(A,B)\)&lt;/span&gt; çš„ä½“åŠ›æ¥è¦†ç›–æ•´ä¸ªçŸ©å½¢ã€‚ç„¶è€Œå¯èƒ½å­˜åœ¨æ›´å°‘çš„ä½“åŠ›æ¶ˆè€—å°±èƒ½è¦†ç›–ã€‚å…·ä½“åœ°ï¼Œå½“å­˜åœ¨ä¸€ä¸ªç©ºè¡Œ/ç©ºåˆ—æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘å°†å­çŸ©å½¢åˆ’å¼€ï¼Œå˜æˆä¸¤ä¸ªç‹¬ç«‹å­é—®é¢˜ï¼Œçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰æ›´ä¼˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è®¾ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_{l,u,r,d}\)&lt;/span&gt; æ¥è¿›è¡Œ dpï¼ˆä½¿ç”¨è®°æœè½¬ç§»ï¼‰å³å¯ï¼Œè½¬ç§»å¤æ‚åº¦ä¼¼ä¹æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^5)\)&lt;/span&gt; çš„ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc233/submissions/28194586&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc233ex---manhattan-christmas-tree&#34;&gt;ABC233Ex - Manhattan Christmas Tree&lt;/h4&gt;
&lt;p&gt;ç®€è¦é¢˜æ„ï¼šç»™å®šå¹³é¢å†… &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡è¯¢é—®åˆ° &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿‘çš„ç‚¹åˆ° &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; çš„è·ç¦»ï¼Œè¿™é‡Œçš„è·ç¦»æŒ‡æ›¼å“ˆé¡¿è·ç¦»ã€‚&lt;span class=&#34;math inline&#34;&gt;\(5\times 10^5\)&lt;/span&gt;ï¼Œ7sã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å‘ç°æ›¼å“ˆé¡¿è·ç¦»å¾ˆä¸å¥½å¤„ç†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿‘ä¹‹ç±»çš„é—®é¢˜ï¼Œå› ä¸ºæ—¢è¦è€ƒè™‘ä¸¤ä¸ªç»´åº¦åˆæœ‰ç»å¯¹å€¼ã€‚æ‰€ä»¥è€ƒè™‘å°†æ¯ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\((x + y, x - y)\)&lt;/span&gt;ï¼Œè¿™æ ·åŸå›¾çš„æ›¼å“ˆé¡¿è·ç¦»å°±å¯ä»¥è¢«è½¬åŒ–ä¸ºåˆ‡æ¯”é›ªå¤«è·ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¯¹äºæ¯ä¸ªè¯¢é—®å°±å¯ä»¥äºŒåˆ†ä¸€ä¸‹ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¿‘çš„è·ç¦»ï¼ŒæŸ¥è¯¢æœ‰å¤šå°‘ä¸ªç‚¹åˆ° &lt;span class=&#34;math inline&#34;&gt;\((a,b)\)&lt;/span&gt; çš„åˆ‡æ¯”é›ªå¤«è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(\le d\)&lt;/span&gt;ï¼Œè¿™ä¸ªæŸ¥è¯¢å…¶å®å°±æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç‚¹ï¼ˆæŸ¥è¯¢çŸ©å½¢å’Œï¼‰ï¼Œå¯ä»¥é€šè¿‡å†™ä¸€ä¸ªä¸»å¸­æ ‘æ¥å®ç°ã€‚å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O((n + Q)\log^2X)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; ä¸ºç‚¹çš„å€¼åŸŸã€‚ä¸»å¸­æ ‘å†™ç€æœ‰ç‚¹å¿ƒçƒ¦ï¼Œè¦æ³¨æ„ç»†èŠ‚ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc233/submissions/28193992&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc234&#34;&gt;ABC234&lt;/h3&gt;
&lt;p&gt;Aï¼ŒB ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;C è€ƒè™‘å°† &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;D ç»´æŠ¤ä¸€ä¸ªå°æ ¹å †åœ¨çº¿ç»´æŠ¤å‰ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; å¤§å…ƒç´ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;E å‘ç°é¦–é¡¹åªå¯èƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_1\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(a_1 + 1\)&lt;/span&gt;ï¼Œéšåæšä¸¾å…¬å·®åˆ¤æ–­æ˜¯å¦å¯è¡Œå³å¯ï¼Œç»†èŠ‚ç•¥å¤šã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc234f---reordering&#34;&gt;ABC234F - Reordering&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œé—®é€‰å‡ºé‡Œé¢çš„éƒ¨åˆ†å­—æ¯å¹¶é‡æ’åèƒ½å¾—åˆ°å¤šå°‘ç§ä¸åŒå­—ç¬¦ä¸²ã€‚&lt;span class=&#34;math inline&#34;&gt;\(|S|\le 5000\)&lt;/span&gt;ï¼Œæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘èƒ½æ„æˆçš„å­—ç¬¦ä¸²åªä¸å­—ç¬¦é›†åˆæœ‰å…³ã€‚æˆ‘ä»¬ä¸å¦¨ä» &lt;span class=&#34;math inline&#34;&gt;\(\texttt a\)&lt;/span&gt; å¼€å§‹ï¼Œä¸€ä¸ªä¸ªçš„åŠ å­—ç¬¦ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; è¡¨ç¤ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§å­—ç¬¦ä¸­ï¼Œå¡«æ»¡äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæ ¼å­çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™è€ƒè™‘ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå­—ç¬¦æˆ‘ä»¬å¡« &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªè¿›å»ï¼Œå°±ç›¸å½“äºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(j - k + 1\)&lt;/span&gt; ä¸ªä¸åŒçš„æ¡¶é‡Œé¢æ”¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªç›¸åŒçƒï¼Œå¯ä»¥æœ‰ç©ºæ¡¶ï¼Œæ‰€ä»¥è½¬ç§»å¦‚ä¸‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_{i,j} = \sum_{k = 0}^{\min(j, g(i))}\binom k jf_{i- 1, j - k}
\]&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(g(i)\)&lt;/span&gt; ä¸ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§å­—ç¬¦åœ¨åŸä¸²ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(\sum f_{26, i}\)&lt;/span&gt; å°±æ˜¯ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb5&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb5-1&#34;&gt;&lt;a href=&#34;#cb5-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;5005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-2&#34;&gt;&lt;a href=&#34;#cb5-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb5-3&#34;&gt;&lt;a href=&#34;#cb5-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[&lt;span class=&#34;dv&#34;&gt;26&lt;/span&gt;][maxn], fac[maxn], ifac[maxn];&lt;/span&gt;
&lt;span id=&#34;cb5-4&#34;&gt;&lt;a href=&#34;#cb5-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; buc[&lt;span class=&#34;dv&#34;&gt;27&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-5&#34;&gt;&lt;a href=&#34;#cb5-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb5-6&#34;&gt;&lt;a href=&#34;#cb5-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint binom(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; fac[n] * ifac[m] * ifac[n - m];}&lt;/span&gt;
&lt;span id=&#34;cb5-7&#34;&gt;&lt;a href=&#34;#cb5-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb5-8&#34;&gt;&lt;a href=&#34;#cb5-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb5-9&#34;&gt;&lt;a href=&#34;#cb5-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-10&#34;&gt;&lt;a href=&#34;#cb5-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = strlen(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-11&#34;&gt;&lt;a href=&#34;#cb5-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) ++buc[s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-12&#34;&gt;&lt;a href=&#34;#cb5-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    fac[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-13&#34;&gt;&lt;a href=&#34;#cb5-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) fac[i] = i * fac[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-14&#34;&gt;&lt;a href=&#34;#cb5-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ifac[n] = qPow(fac[n], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-15&#34;&gt;&lt;a href=&#34;#cb5-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ifac[i] = (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * ifac[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-16&#34;&gt;&lt;a href=&#34;#cb5-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, buc[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]) f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][j] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-17&#34;&gt;&lt;a href=&#34;#cb5-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb5-18&#34;&gt;&lt;a href=&#34;#cb5-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb5-19&#34;&gt;&lt;a href=&#34;#cb5-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, min(buc[i], j)) {&lt;/span&gt;
&lt;span id=&#34;cb5-20&#34;&gt;&lt;a href=&#34;#cb5-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[i][j] += binom(j, k) * f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j - k];&lt;/span&gt;
&lt;span id=&#34;cb5-21&#34;&gt;&lt;a href=&#34;#cb5-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb5-22&#34;&gt;&lt;a href=&#34;#cb5-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb5-23&#34;&gt;&lt;a href=&#34;#cb5-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb5-24&#34;&gt;&lt;a href=&#34;#cb5-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-25&#34;&gt;&lt;a href=&#34;#cb5-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) ans += f[&lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;][j];&lt;/span&gt;
&lt;span id=&#34;cb5-26&#34;&gt;&lt;a href=&#34;#cb5-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb5-27&#34;&gt;&lt;a href=&#34;#cb5-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-28&#34;&gt;&lt;a href=&#34;#cb5-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc234g---divide-a-sequence&#34;&gt;ABC234G - Divide a Sequence&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2^{N - 1}\)&lt;/span&gt; ç§æ–¹æ³•å°†å…¶åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéç©ºåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(B_1,\cdots, B_k\)&lt;/span&gt;ï¼Œæ±‚å‡ºå¯¹äºæ¯ç§åˆ’åˆ†æ–¹å¼ï¼Œä¸‹é¢è¿™ä¸ªå¼å­çš„å’Œï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\le 3\times 10^5\)&lt;/span&gt;ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\prod_{i = 1}^k(\max\{B_i\} - \min\{B_i\})
\]&lt;/span&gt; è€ƒè™‘ä¸€ä¸ª dpï¼š&lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(A_1, \cdots, A_i\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œè¾¹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_0 = 1\)&lt;/span&gt;ã€‚åˆ™æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_i = \sum_{j = 0}^{i - 1}f_j(\max_{k = j + 1}^i\{A_i\} - \min_{k = j + 1}^i\{A_i\})
\]&lt;/span&gt; è¿™ä¸ªå¼å­çœ‹ä¼¼æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„ï¼Œæ‹†å¼€æ¥ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_i = \sum_{j = 0}^{i - 1}f_j\max_{k = j + 1}^i\{A_i\} - \sum_{j = 0}^{i - 1}f_j\min_{k = j + 1}^i\{A_i\}
\]&lt;/span&gt; ç„¶åæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(\max_{k = j + 1}^i\{A_k\}\)&lt;/span&gt;ï¼Œä»¥åŠå¯¹åº”çš„ dp å€¼ä¹‹å’Œï¼Œä½¿ç”¨å•è°ƒæ ˆå°±å¯ä»¥å®Œæˆè¿™é¢˜äº†ã€‚ç­”æ¡ˆå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_n\)&lt;/span&gt;ï¼Œå®ç°ç»†èŠ‚è§ä»£ç ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb6&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb6-1&#34;&gt;&lt;a href=&#34;#cb6-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-2&#34;&gt;&lt;a href=&#34;#cb6-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[maxn];&lt;/span&gt;
&lt;span id=&#34;cb6-3&#34;&gt;&lt;a href=&#34;#cb6-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n;&lt;/span&gt;
&lt;span id=&#34;cb6-4&#34;&gt;&lt;a href=&#34;#cb6-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-5&#34;&gt;&lt;a href=&#34;#cb6-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; node {&lt;/span&gt;
&lt;span id=&#34;cb6-6&#34;&gt;&lt;a href=&#34;#cb6-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a;&lt;/span&gt;
&lt;span id=&#34;cb6-7&#34;&gt;&lt;a href=&#34;#cb6-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint v;&lt;/span&gt;
&lt;span id=&#34;cb6-8&#34;&gt;&lt;a href=&#34;#cb6-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} st1[maxn], st2[maxn];&lt;/span&gt;
&lt;span id=&#34;cb6-9&#34;&gt;&lt;a href=&#34;#cb6-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; top1, top2;&lt;/span&gt;
&lt;span id=&#34;cb6-10&#34;&gt;&lt;a href=&#34;#cb6-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb6-11&#34;&gt;&lt;a href=&#34;#cb6-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb6-12&#34;&gt;&lt;a href=&#34;#cb6-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb6-13&#34;&gt;&lt;a href=&#34;#cb6-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb6-14&#34;&gt;&lt;a href=&#34;#cb6-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-15&#34;&gt;&lt;a href=&#34;#cb6-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint maxsum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, minsum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-16&#34;&gt;&lt;a href=&#34;#cb6-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb6-17&#34;&gt;&lt;a href=&#34;#cb6-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        modint sumv = f[i];&lt;/span&gt;
&lt;span id=&#34;cb6-18&#34;&gt;&lt;a href=&#34;#cb6-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top1 &amp;amp;&amp;amp; st1[top1].a &amp;lt; a[i]) {&lt;/span&gt;
&lt;span id=&#34;cb6-19&#34;&gt;&lt;a href=&#34;#cb6-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            maxsum -= st1[top1].a * st1[top1].v;&lt;/span&gt;
&lt;span id=&#34;cb6-20&#34;&gt;&lt;a href=&#34;#cb6-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            sumv += st1[top1].v;&lt;/span&gt;
&lt;span id=&#34;cb6-21&#34;&gt;&lt;a href=&#34;#cb6-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            --top1;&lt;/span&gt;
&lt;span id=&#34;cb6-22&#34;&gt;&lt;a href=&#34;#cb6-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb6-23&#34;&gt;&lt;a href=&#34;#cb6-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        maxsum += sumv * a[i];&lt;/span&gt;
&lt;span id=&#34;cb6-24&#34;&gt;&lt;a href=&#34;#cb6-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++top1, st1[top1] = {a[i], sumv};&lt;/span&gt;
&lt;span id=&#34;cb6-25&#34;&gt;&lt;a href=&#34;#cb6-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        sumv = f[i];&lt;/span&gt;
&lt;span id=&#34;cb6-26&#34;&gt;&lt;a href=&#34;#cb6-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top2 &amp;amp;&amp;amp; st2[top2].a &amp;gt; a[i]) {&lt;/span&gt;
&lt;span id=&#34;cb6-27&#34;&gt;&lt;a href=&#34;#cb6-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            minsum -= st2[top2].a * st2[top2].v;&lt;/span&gt;
&lt;span id=&#34;cb6-28&#34;&gt;&lt;a href=&#34;#cb6-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            sumv += st2[top2].v;&lt;/span&gt;
&lt;span id=&#34;cb6-29&#34;&gt;&lt;a href=&#34;#cb6-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            --top2;&lt;/span&gt;
&lt;span id=&#34;cb6-30&#34;&gt;&lt;a href=&#34;#cb6-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb6-31&#34;&gt;&lt;a href=&#34;#cb6-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        minsum += sumv * a[i];&lt;/span&gt;
&lt;span id=&#34;cb6-32&#34;&gt;&lt;a href=&#34;#cb6-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++top2, st2[top2] = {a[i], sumv};&lt;/span&gt;
&lt;span id=&#34;cb6-33&#34;&gt;&lt;a href=&#34;#cb6-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = maxsum - minsum;&lt;/span&gt;
&lt;span id=&#34;cb6-34&#34;&gt;&lt;a href=&#34;#cb6-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb6-35&#34;&gt;&lt;a href=&#34;#cb6-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb6-36&#34;&gt;&lt;a href=&#34;#cb6-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb6-37&#34;&gt;&lt;a href=&#34;#cb6-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc234ex---enumerate-pairs&#34;&gt;ABC234Ex - Enumerate Pairs&lt;/h4&gt;
&lt;p&gt;ç»™å®šäºŒç»´å¹³é¢ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x_i, y_i)\)&lt;/span&gt; å’Œä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ã€‚è¯·åˆ—å‡ºæ‰€æœ‰æ¬§å‡ é‡Œå¾—è·ç¦»å°äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ç‚¹å¯¹ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le N\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le K\le 1.5\times 10^9\)&lt;/span&gt;ã€‚ä¿è¯æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(4\times 10^5\)&lt;/span&gt; å¯¹ç‚¹å¯¹å°†è¢«æšä¸¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»¥ä¸‹é¢˜è§£å‚è€ƒäº† AtCoder å®˜æ–¹é¢˜è§£&lt;/strong&gt;ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc234/editorial/3235&#34;&gt;ä¼ é€é—¨&lt;/a&gt;ã€‚ç¥ä»™ç»“è®ºé¢˜ï¼Œå…ˆç»™å‡ºç»“è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x_i, y_i)\)&lt;/span&gt;ï¼Œå°†å…¶åˆ†é…åˆ°é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\((\lfloor x_i/K\rfloor, \lfloor y_i/K\rfloor)\)&lt;/span&gt; ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åå¯¹äºä»»æ„ä¸€ä¸ªç‚¹ï¼Œè‹¥å…¶è¢«åˆ†é…åˆ°äº† &lt;span class=&#34;math inline&#34;&gt;\((X, Y)\)&lt;/span&gt; é›†åˆä¸­ï¼Œåˆ™èƒ½ä¸å…¶é…å¯¹çš„ç‚¹ä¸€å®šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\((X + m, Y + l)\)&lt;/span&gt; é›†åˆä¸­ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(-1\le m,l\le 1\)&lt;/span&gt;ã€‚ç›´æ¥æšä¸¾å³å¯å¾—åˆ°ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ä¸ºè¾“å‡ºçš„ç­”æ¡ˆä¸ªæ•°ï¼ˆå¿½ç•¥äº†ä½¿ç”¨æ•°æ®ç»“æ„äº§ç”Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb7&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb7-1&#34;&gt;&lt;a href=&#34;#cb7-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-2&#34;&gt;&lt;a href=&#34;#cb7-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-3&#34;&gt;&lt;a href=&#34;#cb7-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pll = pair&amp;lt;ll, ll&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-4&#34;&gt;&lt;a href=&#34;#cb7-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-5&#34;&gt;&lt;a href=&#34;#cb7-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll big = &lt;span class=&#34;dv&#34;&gt;2000000000&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-6&#34;&gt;&lt;a href=&#34;#cb7-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; ll K;&lt;/span&gt;
&lt;span id=&#34;cb7-7&#34;&gt;&lt;a href=&#34;#cb7-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pll p[maxn];&lt;/span&gt;
&lt;span id=&#34;cb7-8&#34;&gt;&lt;a href=&#34;#cb7-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;ll, vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; &amp;gt; mp;&lt;/span&gt;
&lt;span id=&#34;cb7-9&#34;&gt;&lt;a href=&#34;#cb7-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;ll&amp;gt; delta = {-big - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -big, -big + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, big - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, big, big + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb7-10&#34;&gt;&lt;a href=&#34;#cb7-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb7-11&#34;&gt;&lt;a href=&#34;#cb7-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb7-12&#34;&gt;&lt;a href=&#34;#cb7-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, K);&lt;/span&gt;
&lt;span id=&#34;cb7-13&#34;&gt;&lt;a href=&#34;#cb7-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb7-14&#34;&gt;&lt;a href=&#34;#cb7-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(p[i].first, p[i].second);&lt;/span&gt;
&lt;span id=&#34;cb7-15&#34;&gt;&lt;a href=&#34;#cb7-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll id = (p[i].first / K) * big + (p[i].second / K);&lt;/span&gt;
&lt;span id=&#34;cb7-16&#34;&gt;&lt;a href=&#34;#cb7-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        mp[id].push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb7-17&#34;&gt;&lt;a href=&#34;#cb7-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb7-18&#34;&gt;&lt;a href=&#34;#cb7-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;pii&amp;gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb7-19&#34;&gt;&lt;a href=&#34;#cb7-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb7-20&#34;&gt;&lt;a href=&#34;#cb7-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll id = (p[i].first / K) * big + (p[i].second / K);&lt;/span&gt;
&lt;span id=&#34;cb7-21&#34;&gt;&lt;a href=&#34;#cb7-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;d : delta) {&lt;/span&gt;
&lt;span id=&#34;cb7-22&#34;&gt;&lt;a href=&#34;#cb7-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll curid = id + d;&lt;/span&gt;
&lt;span id=&#34;cb7-23&#34;&gt;&lt;a href=&#34;#cb7-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;j : mp[curid]) {&lt;/span&gt;
&lt;span id=&#34;cb7-24&#34;&gt;&lt;a href=&#34;#cb7-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (j &amp;gt;= i) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-25&#34;&gt;&lt;a href=&#34;#cb7-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll dis = (p[i].first - p[j].first) * (p[i].first - p[j].first) + (p[i].second - p[j].second) * (p[i].second - p[j].second);&lt;/span&gt;
&lt;span id=&#34;cb7-26&#34;&gt;&lt;a href=&#34;#cb7-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dis &amp;lt;= K * K) ans.push_back(pii(j, i));&lt;/span&gt;
&lt;span id=&#34;cb7-27&#34;&gt;&lt;a href=&#34;#cb7-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb7-28&#34;&gt;&lt;a href=&#34;#cb7-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb7-29&#34;&gt;&lt;a href=&#34;#cb7-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb7-30&#34;&gt;&lt;a href=&#34;#cb7-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(ans.begin(), ans.end());&lt;/span&gt;
&lt;span id=&#34;cb7-31&#34;&gt;&lt;a href=&#34;#cb7-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans.size());&lt;/span&gt;
&lt;span id=&#34;cb7-32&#34;&gt;&lt;a href=&#34;#cb7-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : ans) print(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb7-33&#34;&gt;&lt;a href=&#34;#cb7-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb7-34&#34;&gt;&lt;a href=&#34;#cb7-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šè¿°åšæ³•å¾—è§£çš„æ­£ç¡®æ€§è¾ƒä¸ºæ˜¾ç„¶ï¼Œè¿™é‡Œä¸è¯´æ˜ã€‚ä¸‹é¢å¯¹æ—¶é—´å¤æ‚åº¦ç»™å‡ºè¯æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(B_{X, Y}\)&lt;/span&gt; ä¸ºé›†åˆ &lt;span class=&#34;math inline&#34;&gt;\((X,Y)\)&lt;/span&gt; ä¸­çš„ç‚¹çš„æ•°é‡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; ä¸ºâ€œå« &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªç‚¹çš„é›†åˆå†…æœ€å°‘çš„è·ç¦»å°äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ç‚¹å¯¹æ•°â€ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„ä¸Šç•Œæ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ï¼Œä¸‹é¢è¯æ˜å…¶ä¸‹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Omega(n^2)\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªè¾¹é•¿å°äº &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{K}{\sqrt 2}\)&lt;/span&gt; çš„å­æ­£æ–¹å½¢åŒºåŸŸä¸­ï¼Œæ¯ä¸€å¯¹ç‚¹å¯¹çš„è·ç¦»éƒ½å°äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ã€‚è€Œä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(K\times K\)&lt;/span&gt; çš„æ­£æ–¹å½¢åŒºåŸŸèƒ½ç”± &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; ä¸ªå°çš„è¾¹é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{K}{\sqrt 2}\)&lt;/span&gt; çš„å°æ­£æ–¹å½¢è¦†ç›–ã€‚è€ƒè™‘å¾€å¤§åŒºåŸŸä¸­æ”¾ &lt;span class=&#34;math inline&#34;&gt;\(4n\)&lt;/span&gt; ä¸ªç‚¹ï¼Œåˆ™è‡³å°‘ä¸€ä¸ªå°åŒºåŸŸåŒ…å«è‡³å°‘ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ã€‚è¯¥å°åŒºåŸŸæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{n(n - 1)}{2}\)&lt;/span&gt; ä¸ªç‚¹å¯¹ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; çš„ä¸‹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Omega(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è€Œ &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}f(B_{X,Y}) \le M\)&lt;/span&gt;ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}B^2_{X,Y}\)&lt;/span&gt; çš„ä¸Šç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬çš„ç®—æ³•é‡Œé¢ï¼Œè¦æšä¸¾çš„ç‚¹å¯¹æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}\sum_{m = -1}^1\sum_{l = -1}^1B_{X,Y}B_{X+m,Y+l}\)&lt;/span&gt;ã€‚å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_{X,Y}B^2_{X,Y}\)&lt;/span&gt; çš„ä¸Šç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ï¼Œç„¶åï¼Œæ ¹æ®å‡å€¼ä¸ç­‰å¼ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B_{X,Y}B_{X + m,Y+l}\le \dfrac12(B_{X,Y}^2 + B_{X + m, Y + l}^2)\)&lt;/span&gt;ï¼Œæ‰€ä»¥æ•´ä½“çš„ä¸Šç•Œä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(N + M)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯æ¯•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc235&#34;&gt;ABC235&lt;/h3&gt;
&lt;p&gt;A, B, C ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;D è€ƒè™‘ä¸€ä¸ª BFSï¼Œæ¯æ¬¡å˜æ¢çœ‹ä½œä¸€æ¬¡è½¬ç§»ï¼Œç”±äºæœ‰æ•ˆçŠ¶æ€æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(10^7\)&lt;/span&gt; ä¸ªï¼Œæ‰€ä»¥æ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc235f---variety-of-digits&#34;&gt;ABC235F - Variety of Digits&lt;/h4&gt;
&lt;p&gt;ç»™ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªæ•°ä½ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt;ï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; ä¸­åè¿›åˆ¶ä¸‹åŒ…å«äº†å…¨éƒ¨ &lt;span class=&#34;math inline&#34;&gt;\(c_1,\cdots, c_m\)&lt;/span&gt; æ•°ä½çš„æ•´æ•°çš„å’Œï¼ˆå‰å¯¼ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ç®—ï¼‰ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^{10^4}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le 10\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le c_1&amp;lt;\cdots&amp;lt;c_m\le 9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ•°ä½ DPã€‚è€ƒè™‘åˆ°æˆ‘ä»¬å¯ä»¥å°†æ•°ä½é›†åˆå‹èµ·æ¥ï¼Œæ‰€ä»¥è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, S}\)&lt;/span&gt; è¡¨ç¤ºä»ä½åˆ°é«˜ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½ï¼Œä»é«˜åˆ°ä½å·²ç»é€‰çš„æ•°ä½é›†åˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ•°å­—ä¸ªæ•°å’Œæ•°å­—å’Œï¼ˆæ³¨æ„è¿™ä¸¤ä¸ªä¸œè¥¿éœ€è¦åŒæ—¶ç»´æŠ¤ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè½¬ç§»åº”è¯¥æ˜¯æ¯”è¾ƒå¥½æƒ³çš„ï¼Œæ³¨æ„å‰å¯¼ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸åº”è®¡ç®—åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb8&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb8-1&#34;&gt;&lt;a href=&#34;#cb8-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e4&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-2&#34;&gt;&lt;a href=&#34;#cb8-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-3&#34;&gt;&lt;a href=&#34;#cb8-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, c[&lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;], S0, a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-4&#34;&gt;&lt;a href=&#34;#cb8-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pair&amp;lt;modint, modint&amp;gt; f[maxn][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb8-5&#34;&gt;&lt;a href=&#34;#cb8-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint pow10[maxn];&lt;/span&gt;
&lt;span id=&#34;cb8-6&#34;&gt;&lt;a href=&#34;#cb8-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; vis[maxn][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb8-7&#34;&gt;&lt;a href=&#34;#cb8-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-8&#34;&gt;&lt;a href=&#34;#cb8-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pair&amp;lt;modint, modint&amp;gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pos, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; S, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; zero) {&lt;/span&gt;
&lt;span id=&#34;cb8-9&#34;&gt;&lt;a href=&#34;#cb8-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (pos == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb8-10&#34;&gt;&lt;a href=&#34;#cb8-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((S &amp;amp; S0) == S0) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb8-11&#34;&gt;&lt;a href=&#34;#cb8-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb8-12&#34;&gt;&lt;a href=&#34;#cb8-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-13&#34;&gt;&lt;a href=&#34;#cb8-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!lim &amp;amp;&amp;amp; !zero &amp;amp;&amp;amp; vis[pos][S]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[pos][S];&lt;/span&gt;
&lt;span id=&#34;cb8-14&#34;&gt;&lt;a href=&#34;#cb8-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; up = lim ? a[pos] : &lt;span class=&#34;dv&#34;&gt;9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-15&#34;&gt;&lt;a href=&#34;#cb8-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pair&amp;lt;modint, modint&amp;gt; ret = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb8-16&#34;&gt;&lt;a href=&#34;#cb8-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, up) {&lt;/span&gt;
&lt;span id=&#34;cb8-17&#34;&gt;&lt;a href=&#34;#cb8-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        pair&amp;lt;modint, modint&amp;gt; tmp;&lt;/span&gt;
&lt;span id=&#34;cb8-18&#34;&gt;&lt;a href=&#34;#cb8-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (zero &amp;amp;&amp;amp; !i) tmp = dfs(pos - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, S, lim &amp;amp;&amp;amp; i == up, zero);&lt;/span&gt;
&lt;span id=&#34;cb8-19&#34;&gt;&lt;a href=&#34;#cb8-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; tmp = dfs(pos - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, S | (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; i), lim &amp;amp;&amp;amp; i == up, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-20&#34;&gt;&lt;a href=&#34;#cb8-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.first += tmp.first;&lt;/span&gt;
&lt;span id=&#34;cb8-21&#34;&gt;&lt;a href=&#34;#cb8-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.second += tmp.second + tmp.first * pow10[pos] * i;&lt;/span&gt;
&lt;span id=&#34;cb8-22&#34;&gt;&lt;a href=&#34;#cb8-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-23&#34;&gt;&lt;a href=&#34;#cb8-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!lim &amp;amp;&amp;amp; !zero) vis[pos][S] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, f[pos][S] = ret;&lt;/span&gt;
&lt;span id=&#34;cb8-24&#34;&gt;&lt;a href=&#34;#cb8-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb8-25&#34;&gt;&lt;a href=&#34;#cb8-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb8-26&#34;&gt;&lt;a href=&#34;#cb8-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-27&#34;&gt;&lt;a href=&#34;#cb8-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb8-28&#34;&gt;&lt;a href=&#34;#cb8-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), n = strlen(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-29&#34;&gt;&lt;a href=&#34;#cb8-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pow10[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-30&#34;&gt;&lt;a href=&#34;#cb8-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = s[n - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, pow10[i] = &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; * pow10[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb8-31&#34;&gt;&lt;a href=&#34;#cb8-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(m);&lt;/span&gt;
&lt;span id=&#34;cb8-32&#34;&gt;&lt;a href=&#34;#cb8-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) read(c[i]), S0 |= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; c[i]);&lt;/span&gt;
&lt;span id=&#34;cb8-33&#34;&gt;&lt;a href=&#34;#cb8-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(dfs(n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;).second);&lt;/span&gt;
&lt;span id=&#34;cb8-34&#34;&gt;&lt;a href=&#34;#cb8-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-35&#34;&gt;&lt;a href=&#34;#cb8-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc235g---gardens&#34;&gt;ABC235G - Gardens&lt;/h4&gt;
&lt;p&gt;ä¸‰ç§é¢œè‰²çš„çƒåˆ†åˆ«æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A, B, C\)&lt;/span&gt; ä¸ªï¼ŒåŒç§é¢œè‰²çš„çƒä¸åŒºåˆ†ï¼Œç°å°†å…¶æ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·çš„ç®±å­å†…ï¼Œè¦æ±‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªç®±å­è‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªçƒã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªç®±å­å†…è‡³å¤šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªåŒç§çƒã€‚&lt;/li&gt;
&lt;li&gt;ä¸å¿…æ”¾å®Œæ‰€æœ‰çš„çƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ±‚æ–¹æ¡ˆæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le N\le 5\times 10^6\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le A,B,C\le N\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ´ç´ çš„ DP å®¹æ˜“æƒ³åˆ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(NABC) = O(N^4)\)&lt;/span&gt;ï¼Œé“å®šè¿‡ä¸å»ã€‚ä¸å¦¨åç€è€ƒè™‘é—®é¢˜ï¼Œå‘ç°â€œä¸ºç©ºâ€æ¯”â€œä¸ä¸ºç©ºâ€è¦å¥½æƒ³å¾—å¤šï¼Œè€ƒè™‘å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œè®¡ç®—â€œè‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç®±å­ä¸ºç©ºâ€çš„æ–¹æ¡ˆæ•°ï¼Œä¸éš¾å‘ç°å…¶å°±ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\binom{N}{i}\left(\sum_{a=0}^{\min\{N-  i, A\}}\binom{N - i}{a}\right)\left(\sum_{b=0}^{\min\{N-  i, B\}}\binom{N - i}{b}\right)\left(\sum_{c=0}^{\min\{N-  i, C\}}\binom{N - i}{c}\right)
\]&lt;/span&gt; è§£é‡Šï¼šé¦–å…ˆé€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªä¸€å®šä¸ºç©ºçš„ç®±å­ï¼Œç„¶ååˆ†åˆ«æšä¸¾ä¸‰ç§é¢œè‰²çš„çƒæ”¾çš„ä¸ªæ•°å¹¶æ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(N - i\)&lt;/span&gt; ä¸ªå¯èƒ½ä¸ä¸ºç©ºçš„ç®±å­ã€‚&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆä¸ºâ€œæ°å¥½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªç®±å­ä¸ºç©ºâ€ï¼ŒäºŒé¡¹å¼åæ¼”ä¸€ä¸‹ï¼ˆä¸­é—´æ¨å¯¼è¿‡ç¨‹çœç•¥ï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•å®¹æ–¥ï¼‰å¾—åˆ°ç­”æ¡ˆä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^N(-1)^i\binom{N}{i}\left(\sum_{a=0}^{\min\{N-  i, A\}}\binom{N - i}{a}\right)\left(\sum_{b=0}^{\min\{N-  i, B\}}\binom{N - i}{b}\right)\left(\sum_{c=0}^{\min\{N-  i, C\}}\binom{N - i}{c}\right)
\]&lt;/span&gt; åŒ–çš„å¥½çœ‹ç‚¹å°±æ˜¯ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^N(-1)^{N - i}\binom{N}{i}\left(\sum_{a=0}^{\min\{i, A\}}\binom{i}{a}\right)\left(\sum_{b=0}^{\min\{i, B\}}\binom{i}{b}\right)\left(\sum_{c=0}^{\min\{i, C\}}\binom{i}{c}\right)
\]&lt;/span&gt; ç„¶è€Œç›´æ¥è®¡ç®—è¿˜æ˜¯éœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(O(N^2)\)&lt;/span&gt;ï¼Œç»§ç»­ä¼˜åŒ–è®¡ç®—è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{M}(N) = \displaystyle\sum_{i=0}^{\min\{N, M\}}\binom N i\)&lt;/span&gt;ï¼Œåˆ™ç­”æ¡ˆå¯ä»¥æ”¹å†™ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^N(-1)^{N-i}\binom Ni f_{A}(i)f_{B}(i)f_C(i)
\]&lt;/span&gt; å¦‚æœæˆ‘ä»¬çŸ¥é“äº† &lt;span class=&#34;math inline&#34;&gt;\(f_M(N)\)&lt;/span&gt; çš„å€¼åèƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ¨å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_{M}(N + 1)\)&lt;/span&gt; çš„å€¼ï¼Œæ•´ä¸ªé—®é¢˜å°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(N)\)&lt;/span&gt; è§£å†³äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(N+ 1\le M\)&lt;/span&gt; çš„æ—¶å€™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\min\{N+1,M\} = N+1\)&lt;/span&gt;ï¼Œæ‰€ä»¥æ ¹æ®äºŒé¡¹å¼å®šç†ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{M}(N+1)=2f_M(N)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„è§£æ³•å‚è€ƒ &lt;a href=&#34;https://atcoder.jp/contests/abc235/editorial/3262&#34;&gt;AtCoder å®˜æ–¹é¢˜è§£&lt;/a&gt;ï¼Œæ¨èå»å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæ€æƒ³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/ghi/d93c643497867d310c6255fb673d9682.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_M(N)\)&lt;/span&gt; å°±å¯ä»¥çœ‹ä½œä»å·¦ä¸‹è§’å‡ºå‘ï¼Œæ¯ä¸€æ­¥å¾€ä¸Š/å³èµ°ä¸€æ ¼ï¼Œèµ°åˆ°æ©™è‰²ç‚¹çš„æ–¹æ¡ˆæ•°ï¼ˆæ€»æ­¥æ•°éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæˆ‘ä»¬æšä¸¾äº†æ¨ªå‘èµ°çš„æ­¥æ•° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è€Œå·²ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_M(N)\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(f_M(N + 1)\)&lt;/span&gt; çš„å…³ç³»å°±å˜æˆäº†æ±‚èµ°åˆ°æ©™è‰²ç‚¹çš„æ–¹æ¡ˆæ•°ä¸èµ°åˆ°è“è‰²ç‚¹çš„æ–¹æ¡ˆæ•°ä¹‹é—´çš„å…³ç³»ã€‚å‘ç°ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªæ©™è‰²ç‚¹çš„æ—¶å€™æ€»å¯ä»¥å¾€ä¸Š/å³èµ°ä¸€æ ¼åˆ°è¾¾è“è‰²ç‚¹ï¼Œé™¤å»æœ€å³ä¸‹è§’é‚£ä¸ªç‚¹å³å¯ã€‚æ‰€ä»¥ &lt;span class=&#34;math display&#34;&gt;\[
f_M(N+ 1) = 2f_M(N) - \binom{N}{M}
\]&lt;/span&gt; å‘ç°å¯¹äºä¸Šé¢çš„æƒ…å†µï¼Œåªéœ€å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(N&amp;lt;M\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom NM\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä¸‹é¢çš„å…¬å¼ä¹Ÿæ˜¯å®Œå…¨é€‚ç”¨çš„ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f_M(0) = 0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯è¿™é“é¢˜ &lt;span class=&#34;math inline&#34;&gt;\(O(N)\)&lt;/span&gt; è§£å†³äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb9&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb9-1&#34;&gt;&lt;a href=&#34;#cb9-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;5e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-2&#34;&gt;&lt;a href=&#34;#cb9-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint fac[maxn], ifac[maxn];&lt;/span&gt;
&lt;span id=&#34;cb9-3&#34;&gt;&lt;a href=&#34;#cb9-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, A, B, C;&lt;/span&gt;
&lt;span id=&#34;cb9-4&#34;&gt;&lt;a href=&#34;#cb9-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-5&#34;&gt;&lt;a href=&#34;#cb9-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint binom(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; m) {&lt;/span&gt;
&lt;span id=&#34;cb9-6&#34;&gt;&lt;a href=&#34;#cb9-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;lt; m) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-7&#34;&gt;&lt;a href=&#34;#cb9-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; fac[n] * ifac[m] * ifac[n - m];&lt;/span&gt;
&lt;span id=&#34;cb9-8&#34;&gt;&lt;a href=&#34;#cb9-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb9-9&#34;&gt;&lt;a href=&#34;#cb9-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-10&#34;&gt;&lt;a href=&#34;#cb9-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb9-11&#34;&gt;&lt;a href=&#34;#cb9-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, A, B, C);&lt;/span&gt;
&lt;span id=&#34;cb9-12&#34;&gt;&lt;a href=&#34;#cb9-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    fac[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-13&#34;&gt;&lt;a href=&#34;#cb9-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) fac[i] = fac[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] * i;&lt;/span&gt;
&lt;span id=&#34;cb9-14&#34;&gt;&lt;a href=&#34;#cb9-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ifac[n] = qPow(fac[n], mod - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb9-15&#34;&gt;&lt;a href=&#34;#cb9-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ifac[i] = (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * ifac[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb9-16&#34;&gt;&lt;a href=&#34;#cb9-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, a = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, b = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, c = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-17&#34;&gt;&lt;a href=&#34;#cb9-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb9-18&#34;&gt;&lt;a href=&#34;#cb9-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        modint tmp = ((n - i) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-19&#34;&gt;&lt;a href=&#34;#cb9-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp *= binom(n, i);&lt;/span&gt;
&lt;span id=&#34;cb9-20&#34;&gt;&lt;a href=&#34;#cb9-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb9-21&#34;&gt;&lt;a href=&#34;#cb9-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * a - binom(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, A);&lt;/span&gt;
&lt;span id=&#34;cb9-22&#34;&gt;&lt;a href=&#34;#cb9-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            b = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * b - binom(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, B);&lt;/span&gt;
&lt;span id=&#34;cb9-23&#34;&gt;&lt;a href=&#34;#cb9-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            c = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * c - binom(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, C);&lt;/span&gt;
&lt;span id=&#34;cb9-24&#34;&gt;&lt;a href=&#34;#cb9-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb9-25&#34;&gt;&lt;a href=&#34;#cb9-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp *= a * b * c;&lt;/span&gt;
&lt;span id=&#34;cb9-26&#34;&gt;&lt;a href=&#34;#cb9-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += tmp;&lt;/span&gt;
&lt;span id=&#34;cb9-27&#34;&gt;&lt;a href=&#34;#cb9-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb9-28&#34;&gt;&lt;a href=&#34;#cb9-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb9-29&#34;&gt;&lt;a href=&#34;#cb9-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-30&#34;&gt;&lt;a href=&#34;#cb9-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc235ex---painting-weighted-graph&#34;&gt;ABC235Ex - Painting Weighted Graph&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; è¾¹å¸¦è¾¹æƒæ— å‘å›¾ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\le N\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le M\le 10^5\)&lt;/span&gt;ã€‚ä¸€å¼€å§‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šæ¶‚é»‘è‰²ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œè‡³å¤š &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; æ¬¡ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å’Œä¸€ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå°†æ‰€æœ‰çš„ä» &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å‡ºå‘ï¼Œä¸ç»è¿‡ä»»ä½•æƒå€¼å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„è¾¹èƒ½åˆ°è¾¾çš„ç‚¹æ¶‚ä¸ºçº¢è‰²ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é—®å¯èƒ½çš„çº¢è‰²ç‚¹é›†çš„æ•°é‡ï¼Œæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚å›¾å¯èƒ½æœ‰é‡è¾¹å’Œè‡ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;å’•ï¼Œä»¥åæœ‰ç©ºæ¥è¡¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc237&#34;&gt;ABC237&lt;/h3&gt;
&lt;p&gt;A å¯ä»¥æŠ•æœºå–å·§ä¸€ä¸‹å¼ºåˆ¶è½¬ä¸º &lt;code&gt;int&lt;/code&gt; ä¹‹åæ˜¯å¦ä¸åŸæ¥ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;B ç•¥ï¼ŒC éšä¾¿è§‚å¯Ÿä¸€ä¸‹å³å¯ï¼Œç•¥ã€‚D å¯ä»¥å®ç°ä¸€ä¸ª &lt;code&gt;deque&lt;/code&gt; æˆ–è€…å€’åºè€ƒè™‘é—®é¢˜ï¼Œç•¥ã€‚&lt;/p&gt;
&lt;p&gt;E å»ºå‡ºå›¾åå‘ç°æ˜¯ä¸€ä¸ªå¸¦æœ‰è´Ÿæƒè¾¹çš„æœ€çŸ­è·¯æ¨¡å‹ï¼Œè·‘ä¸ª SPFA å¯ä»¥è¿‡ï¼Œç•¥ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc237e---skiing&#34;&gt;ABC237E - Skiing&lt;/h4&gt;
&lt;p&gt;æ»‘é›ªåœºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªåœ°ç‚¹ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªå¡ï¼Œä¿è¯å›¾è¿é€šã€‚æ¯ä¸ªèŠ‚ç‚¹æœ‰é«˜åº¦ &lt;span class=&#34;math inline&#34;&gt;\(h_u\)&lt;/span&gt;ã€‚å½“ä»è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt; é€šè¿‡æ—¶ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(h_u &amp;gt; h_v\)&lt;/span&gt;ï¼Œåˆ™å¿«ä¹æŒ‡æ•°å¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(h_u - h_v\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œå¿«ä¹æŒ‡æ•°å‡å° &lt;span class=&#34;math inline&#34;&gt;\(2(h_v - h_u)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å‡ºå‘ï¼Œåˆå§‹å¿«ä¹æŒ‡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé—®èƒ½è¾¾åˆ°çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n, m\)&lt;/span&gt; å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\times 10^5\)&lt;/span&gt; çº§åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯¹è¾¹æƒå–ç›¸åæ•°å»ºæ¨¡æˆæœ€çŸ­è·¯æ¨¡å‹ï¼Œå‘ç°å…¶æœ‰è´Ÿæƒè¾¹ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ Dijkstraï¼Œè€Œæ•°æ®èŒƒå›´åˆææœ‰å¯èƒ½å¡æ­» SPFAï¼ˆäº‹å®è¯æ˜ SPFA èƒ½è¿‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åŠ¿èƒ½ Dijkstraï¼Œä¸ºæ¯ä¸ªç‚¹å¢åŠ ä¸€ä¸ªåŠ¿èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(h_u\)&lt;/span&gt;ï¼Œç„¶åå¯¹è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt; çš„æƒå€¼åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(h_u - h_v\)&lt;/span&gt;ï¼Œä½¿å¾—æ‰€æœ‰è¾¹æƒéè´Ÿï¼Œæœ€åæ¯ä¸ªç‚¹çš„ç­”æ¡ˆå°±ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d_u + h_u - h_1\)&lt;/span&gt;ã€‚ä½†æ˜¯æ±‚åŠ¿èƒ½çš„è¿‡ç¨‹ä»ç„¶éœ€è¦ SPFAï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æœ¬é¢˜ä¸­çš„â€œé«˜åº¦â€å°±æ˜¯ä¸€ä¸ªç°æˆçš„åŠ¿èƒ½ï¼Œæ»¡è¶³äº†åŠ¿èƒ½ä¹‹å·®åªå’Œç›¸å¯¹é«˜åº¦æœ‰å…³è¿™ä¸€æ€§è´¨ï¼Œæ‰€ä»¥ç›´æ¥å°†å…¶å½“ä½œåŠ¿èƒ½æ¥åšå°±å¯ä»¥äº†ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log n)\)&lt;/span&gt;ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc237/submissions/29219115&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc237f---lis-3&#34;&gt;ABC237F - |LIS| = 3&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œæ±‚æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æ­£æ•´æ•°åºåˆ—çš„ä¸ªæ•°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæ¯ä¸ªå…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(\in[1, M]\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ LIS çš„é•¿åº¦æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(3\le N\le 1000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(3\le M\le 10\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç»å…¸çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; çš„ LIS çš„åšæ³•ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸ºâ€œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ LIS çš„æœ€å°ç»“å°¾æ•°å­—â€ï¼Œè€Œ DP æ•°ç»„çš„é•¿åº¦å³ä¸º LIS çš„é•¿åº¦ï¼Œæ‰€ä»¥å¹²è„†è€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, a, b, c}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰è€ƒè™‘åˆ° &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt;ï¼ŒLIS çš„ DP æ•°ç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a, b, c\)&lt;/span&gt; çš„åºåˆ—ä¸ªæ•°ã€‚ä¸éš¾å‘ç°è¿™ä¸ªçŠ¶æ€æ˜¯æ²¡æœ‰åæ•ˆæ€§çš„ï¼Œè½¬ç§»å°±è€ƒè™‘å½“å‰å¡«ä»€ä¹ˆæ•°ï¼Œç„¶åä»¿ç…§ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; LIS çš„è½¬ç§»æ–¹å¼è¿›è¡Œè½¬ç§»ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(NM^4)\)&lt;/span&gt;ï¼Œå¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb10&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb10-1&#34;&gt;&lt;a href=&#34;#cb10-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[&lt;span class=&#34;dv&#34;&gt;1005&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb10-2&#34;&gt;&lt;a href=&#34;#cb10-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb10-3&#34;&gt;&lt;a href=&#34;#cb10-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-4&#34;&gt;&lt;a href=&#34;#cb10-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb10-5&#34;&gt;&lt;a href=&#34;#cb10-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb10-6&#34;&gt;&lt;a href=&#34;#cb10-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-7&#34;&gt;&lt;a href=&#34;#cb10-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(k, j, m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(l, k, m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(t, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb10-8&#34;&gt;&lt;a href=&#34;#cb10-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (t &amp;lt;= j) f[i][t][k][l] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j][k][l];&lt;/span&gt;
&lt;span id=&#34;cb10-9&#34;&gt;&lt;a href=&#34;#cb10-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (t &amp;lt;= k) f[i][j][t][l] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j][k][l];&lt;/span&gt;
&lt;span id=&#34;cb10-10&#34;&gt;&lt;a href=&#34;#cb10-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (t &amp;lt;= l) f[i][j][k][t] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j][k][l];&lt;/span&gt;
&lt;span id=&#34;cb10-11&#34;&gt;&lt;a href=&#34;#cb10-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-12&#34;&gt;&lt;a href=&#34;#cb10-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-13&#34;&gt;&lt;a href=&#34;#cb10-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) FOR(j, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) FOR(k, j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) ans += f[n][i][j][k];&lt;/span&gt;
&lt;span id=&#34;cb10-14&#34;&gt;&lt;a href=&#34;#cb10-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb10-15&#34;&gt;&lt;a href=&#34;#cb10-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-16&#34;&gt;&lt;a href=&#34;#cb10-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc237g---range-sort-query&#34;&gt;ABC237G - Range Sort Query&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æ’åˆ—ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ“ä½œä¸ºé€‰å®šä¸€åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; ç„¶åå‡åº/é™åºæ’åºï¼Œé—®å…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; æœ€åçš„ä¸‹æ ‡åœ¨å“ªé‡Œã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le N, Q\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç»å…¸é—®é¢˜ï¼ˆHEOI æ’åºï¼‰çš„å˜å¼ã€‚æœ€å¼ºå¤§çš„è§£æ³•æ˜¾ç„¶ä¸ºçº¿æ®µæ ‘åˆå¹¶/åˆ†è£‚ï¼Œä½†æ˜¯åœ¨è¿™é‡Œä¸éœ€è¦ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ï¼Œ0-1 åºåˆ—çš„åŒºé—´æ’åºå¾ˆå¥½ä½¿ç”¨çº¿æ®µæ ‘æ¥å®Œæˆï¼Œåªéœ€è¦å®ç°åŒºé—´æŸ“è‰²å’ŒåŒºé—´æ±‚å’Œã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å°†å…¶è½¬ä¸º 0-1 åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; X\)&lt;/span&gt; çš„å…ƒç´ å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå…¶ä»–å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªç»“æœã€‚å°† &lt;span class=&#34;math inline&#34;&gt;\(\le X\)&lt;/span&gt; çš„å…ƒç´ å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå…¶ä»–å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ“ä½œï¼Œå¾—åˆ°å¦ä¸€ä¸ªç»“æœï¼Œç„¶åç„¶åç„¶åå‘ç°è¿™ä¸¤ä¸ªåºåˆ—å”¯ä¸€ä¸€ä¸ªä¸ä¸€æ ·çš„åœ°æ–¹æ˜¾ç„¶å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; æœ€åçš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(N\log N)\)&lt;/span&gt;ï¼Œè§† &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; åŒé˜¶ã€‚&lt;a href=&#34;https://atcoder.jp/contests/abc237/submissions/29158241&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc237ex---hakata&#34;&gt;ABC237Ex - Hakata&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\le 200\)&lt;/span&gt; çš„å­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œé—®æœ€å¤šèƒ½ä»é‡Œé¢é€‰å‡ºå¤šå°‘ä¸ª&lt;strong&gt;å›æ–‡å­æ®µ&lt;/strong&gt;ï¼Œä½¿å¾—ä¸€ä¸ªå­æ®µä¸æ˜¯å¦ä¸€ä¸ªå­æ®µçš„å­æ®µã€‚å­æ®µæŒ‡è¿ç»­çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œä¸åŒå›æ–‡å­ä¸²çš„ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(\le |S|\)&lt;/span&gt;ï¼Œç„¶åå­ä¸²é—´çš„åŒ…å«å…³ç³»æ˜¯ä¸€ç§ååºå…³ç³»ï¼Œå¯ä»¥å½¢æˆä¸€ä¸ª DAGï¼Œè€ŒåŸé—®é¢˜é—®çš„å°±æ˜¯å…¶çš„æœ€å¤§åé“¾ã€‚&lt;/p&gt;
&lt;p&gt;å¤ä¹ ä¸€ä¸‹ &lt;a href=&#34;https://www.luogu.com.cn/problem/P4298&#34;&gt;P4298 [CTSC2008]ç¥­ç¥€&lt;/a&gt; ä¾¿çŸ¥é“æœ€å¤§åé“¾ = æœ€å°é“¾è¦†ç›–ï¼ˆDilworth å¼•ç†ï¼‰ï¼Œè€Œæœ€å°é“¾è¦†ç›–å¯ä»¥é€šè¿‡æ‹†ç‚¹äºŒåˆ†å›¾åŒ¹é…æ¥æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;æ”¾åˆ°æœ¬é¢˜é‡Œé¢ï¼Œå°±å¯¹äºæ¯ä¸ªä¸åŒå›æ–‡å­æ®µï¼ˆè¿™éƒ¨åˆ†é¡¶å¤© &lt;span class=&#34;math inline&#34;&gt;\(O(|S|^3)\)&lt;/span&gt;ï¼‰ï¼Œä¸ºå…¶æ ‡å·ï¼Œç„¶åå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å­ä¸²ï¼Œè¿è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(i_{\mathrm {left}}\to j_{\mathrm{right}}\)&lt;/span&gt;ï¼Œç„¶åè·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œç”¨å›æ–‡ä¸²æ•°é‡å‡å»åŒ¹é…å³å¾—åˆ°ç­”æ¡ˆã€‚æ—¶é—´å¤æ‚åº¦å°±ä¸åˆ†æäº†ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(400\)&lt;/span&gt; ä¸ªç‚¹çš„äºŒåˆ†å›¾åŒ¹é…å¹¶ä¸æ…¢ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/abc237/submissions/29158769&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc244&#34;&gt;ABC244&lt;/h3&gt;
&lt;h4 id=&#34;abc244d---swap-hats&#34;&gt;ABC244D - Swap Hats&lt;/h4&gt;
&lt;p&gt;&lt;del&gt;å¤§èƒ†çŒœç»“è®º&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è‹¥ç›¸åŒçš„ä½ç½®æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªæˆ– &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªæ—¶ä¸º Yesï¼Œå¦åˆ™ä¸º Noï¼Œä¸‹é¢ç»™å‡ºç®€è¦è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªçš„æ—¶å€™å°±æŠŠä¸¤ä¸ªåå¤æ¨ªè·³å³å¯ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªçš„è¯å¯ä»¥æ„é€ æ–¹æ¡ˆåœ¨æ“ä½œä¸¤æ¬¡åè½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªä¸€æ ·çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ç›¸åŒçš„ä½ç½®åªå¯èƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªï¼Œåšä»»æ„ä¸€æ¬¡äº¤æ¢åéƒ½ä¼šå˜æˆä¸Šé¢ä¸¤ç§æƒ…å†µï¼Œæ‰€ä»¥å¯„äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc244f---shortest-good-path&#34;&gt;ABC244F - Shortest Good Path&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; è¾¹æ— å‘å›¾ï¼Œä»¤é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„è·¯å¾„ &lt;span class=&#34;math inline&#34;&gt;\(A_{1,\cdots, K}\)&lt;/span&gt; å¯¹é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ 0-1 ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ºåˆæ³•çš„å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; åç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(S_i\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(2^n\)&lt;/span&gt; ç§ä¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œæ±‚å‡ºæœ€å°çš„åˆæ³•çš„è·¯å¾„çš„ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¹‹å’Œã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 17\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;èŒƒå›´è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶å‹ dpã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§å›¾ä¸Šæœ‰é“¾çš„ï¼Œå°±ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; ä¸ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„é“¾çš„ä»€ä¹ˆä»€ä¹ˆã€‚ç„¶åæ³¨æ„åˆ°è¿™ä¸ªçŠ¶æ€æ˜¯æ²¡æ³•è½¬ç§»çš„ï¼Œå› ä¸ºæ¥ä¸Šä¸€ä¸ªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; é‡Œé¢å­˜åœ¨çš„ç‚¹ä¹‹åï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S&amp;#39;\)&lt;/span&gt; æ˜¯å°äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£å°±è€ƒè™‘ç¿»è½¬ä¸€ä¸‹çŠ¶æ€å’Œå€¼ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k,S}\)&lt;/span&gt; ä¸ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„é“¾æ˜¯å¦å­˜åœ¨ã€‚ç„¶åè½¬ç§»å°±å¾ˆå¥½åšåˆ°äº†ï¼Œæ¯›ä¼°ä¼°å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^32^n)\)&lt;/span&gt;ï¼Œæœ‰ç‚¹å‹‰å¼ºä½†æ˜¯å®ç°çš„å¥½çš„è¯å¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆé•¿åº¦ä¸Šç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(4n\)&lt;/span&gt;ï¼Œå› ä¸º G é¢˜è¯´äº†ä¸Šç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(4n\)&lt;/span&gt;&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb11&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb11-1&#34;&gt;&lt;a href=&#34;#cb11-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;18&lt;/span&gt;, maxS = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;17&lt;/span&gt;) | &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-2&#34;&gt;&lt;a href=&#34;#cb11-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, G[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb11-3&#34;&gt;&lt;a href=&#34;#cb11-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; f[maxn][&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt; * maxn][maxS];&lt;/span&gt;
&lt;span id=&#34;cb11-4&#34;&gt;&lt;a href=&#34;#cb11-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[maxS];&lt;/span&gt;
&lt;span id=&#34;cb11-5&#34;&gt;&lt;a href=&#34;#cb11-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-6&#34;&gt;&lt;a href=&#34;#cb11-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb11-7&#34;&gt;&lt;a href=&#34;#cb11-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb11-8&#34;&gt;&lt;a href=&#34;#cb11-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb11-9&#34;&gt;&lt;a href=&#34;#cb11-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u, v);&lt;/span&gt;
&lt;span id=&#34;cb11-10&#34;&gt;&lt;a href=&#34;#cb11-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u][v] = G[v][u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-11&#34;&gt;&lt;a href=&#34;#cb11-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-12&#34;&gt;&lt;a href=&#34;#cb11-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(vis, &lt;span class=&#34;bn&#34;&gt;0x3f&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; vis);&lt;/span&gt;
&lt;span id=&#34;cb11-13&#34;&gt;&lt;a href=&#34;#cb11-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) f[i][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-14&#34;&gt;&lt;a href=&#34;#cb11-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; vis[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-15&#34;&gt;&lt;a href=&#34;#cb11-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt; * n) { &lt;span class=&#34;co&#34;&gt;// length&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-16&#34;&gt;&lt;a href=&#34;#cb11-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb11-17&#34;&gt;&lt;a href=&#34;#cb11-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(S, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb11-18&#34;&gt;&lt;a href=&#34;#cb11-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (G[i][j]) {&lt;/span&gt;
&lt;span id=&#34;cb11-19&#34;&gt;&lt;a href=&#34;#cb11-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[i][k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S] |= f[j][k][S ^ (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))];&lt;/span&gt;
&lt;span id=&#34;cb11-20&#34;&gt;&lt;a href=&#34;#cb11-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[i][k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S]) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-21&#34;&gt;&lt;a href=&#34;#cb11-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb11-22&#34;&gt;&lt;a href=&#34;#cb11-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmin(vis[S], f[i][k][S] ? k : (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)&lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-23&#34;&gt;&lt;a href=&#34;#cb11-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb11-24&#34;&gt;&lt;a href=&#34;#cb11-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb11-25&#34;&gt;&lt;a href=&#34;#cb11-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-26&#34;&gt;&lt;a href=&#34;#cb11-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans += vis[i];&lt;/span&gt;
&lt;span id=&#34;cb11-27&#34;&gt;&lt;a href=&#34;#cb11-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb11-28&#34;&gt;&lt;a href=&#34;#cb11-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-29&#34;&gt;&lt;a href=&#34;#cb11-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½†æ˜¯è¿™è¿˜ä¸æ˜¯æœ€ä¼˜çš„ï¼Œè€Œä¸”è¿™ä¸ªæ‹¿ç»“è®ºæ¥æ¨çš„æƒ³æ³•å¾ˆä¸ä¼˜ç¾ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè‹¥å°† dp çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\((i, S)\)&lt;/span&gt; çœ‹ä½œç‚¹ï¼Œè½¬ç§»çœ‹ä½œè¾¹ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ä¼šå°‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n^22^n)\)&lt;/span&gt; è·‘çš„è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œè€Œä¸”å°‘äº† &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; å€å¸¸æ•°ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc244g---construct-good-path&#34;&gt;ABC244G - Construct Good Path&lt;/h4&gt;
&lt;p&gt;å…¨éƒ¨ç»§æ‰¿ F çš„å®šä¹‰ï¼Œå°†èŒƒå›´æ”¹æˆ &lt;span class=&#34;math inline&#34;&gt;\(N\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(M\le 2\times 10^5\)&lt;/span&gt;ï¼Œå¹¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ç„¶åè®©ä½ æ„é€ ä¸€ä¸ªåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ã€‚è¦æ±‚é•¿åº¦ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(4N\)&lt;/span&gt;ï¼Œä¿è¯æœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå°†è¿™ä¸ªé—®é¢˜æ”¾åˆ°ç”Ÿæˆæ ‘ä¸Šã€‚ç„¶åå°±ä»æ ¹èŠ‚ç‚¹å¾€ä¸‹èµ°ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œè‹¥ä»ä»–çš„å­æ ‘å‡ºæ¥åè¿˜æ˜¯ä¸å¯¹å¤´ï¼Œé‚£å°±åå¤æ¨ªè·³ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ ¹èŠ‚ç‚¹ç‰¹åˆ¤ä¸€ä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb12&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb12-1&#34;&gt;&lt;a href=&#34;#cb12-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-2&#34;&gt;&lt;a href=&#34;#cb12-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb12-3&#34;&gt;&lt;a href=&#34;#cb12-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb12-4&#34;&gt;&lt;a href=&#34;#cb12-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn], ans;&lt;/span&gt;
&lt;span id=&#34;cb12-5&#34;&gt;&lt;a href=&#34;#cb12-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-6&#34;&gt;&lt;a href=&#34;#cb12-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u) {&lt;/span&gt;
&lt;span id=&#34;cb12-7&#34;&gt;&lt;a href=&#34;#cb12-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans.push_back(u), ++vis[u];&lt;/span&gt;
&lt;span id=&#34;cb12-8&#34;&gt;&lt;a href=&#34;#cb12-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;v : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb12-9&#34;&gt;&lt;a href=&#34;#cb12-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[v]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-10&#34;&gt;&lt;a href=&#34;#cb12-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(v);&lt;/span&gt;
&lt;span id=&#34;cb12-11&#34;&gt;&lt;a href=&#34;#cb12-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((vis[v] &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) != s[v] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb12-12&#34;&gt;&lt;a href=&#34;#cb12-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back(u), ++vis[u], ans.push_back(v), ++vis[v];&lt;/span&gt;
&lt;span id=&#34;cb12-13&#34;&gt;&lt;a href=&#34;#cb12-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans.push_back(u), ++vis[u];&lt;/span&gt;
&lt;span id=&#34;cb12-14&#34;&gt;&lt;a href=&#34;#cb12-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-15&#34;&gt;&lt;a href=&#34;#cb12-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-16&#34;&gt;&lt;a href=&#34;#cb12-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb12-17&#34;&gt;&lt;a href=&#34;#cb12-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-18&#34;&gt;&lt;a href=&#34;#cb12-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb12-19&#34;&gt;&lt;a href=&#34;#cb12-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb12-20&#34;&gt;&lt;a href=&#34;#cb12-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb12-21&#34;&gt;&lt;a href=&#34;#cb12-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u, v);&lt;/span&gt;
&lt;span id=&#34;cb12-22&#34;&gt;&lt;a href=&#34;#cb12-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb12-23&#34;&gt;&lt;a href=&#34;#cb12-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-24&#34;&gt;&lt;a href=&#34;#cb12-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-25&#34;&gt;&lt;a href=&#34;#cb12-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-26&#34;&gt;&lt;a href=&#34;#cb12-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((vis[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) != s[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) ans.pop_back();&lt;/span&gt;
&lt;span id=&#34;cb12-27&#34;&gt;&lt;a href=&#34;#cb12-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans.size());&lt;/span&gt;
&lt;span id=&#34;cb12-28&#34;&gt;&lt;a href=&#34;#cb12-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;x : ans) print(x, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-29&#34;&gt;&lt;a href=&#34;#cb12-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-30&#34;&gt;&lt;a href=&#34;#cb12-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc244ex---linear-maximizationæœªå†™ä»£ç &#34;&gt;ABC244Ex - Linear Maximizationï¼ˆæœªå†™ä»£ç ï¼‰&lt;/h4&gt;
&lt;p&gt;ç»´æŠ¤äºŒç»´å¹³é¢ä¸Šçš„ç‚¹é›† &lt;span class=&#34;math inline&#34;&gt;\(S = \{(x, y)\}\)&lt;/span&gt;ï¼Œåˆå§‹ä¸ºç©ºã€‚ä¸‹é¢è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ¯æ¬¡å¾€ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­åŠ å…¥ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; å¹¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; å¹¶æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(\max_{(x,y)\in S}\{ax + by\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(Q\le 2\times 10^5\)&lt;/span&gt;ï¼Œåæ ‡ç»å¯¹å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ³• &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼šè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(ax + by = b(\frac ab\cdot x + y)\)&lt;/span&gt;ï¼Œçœ‹å‡ºä¸€æ¬¡å‡½æ•°çš„å½¢å¼ä¹‹åæ— è„‘æè¶…æ ‘å³å¯ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ç‰¹åˆ¤ç¬¦å·ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b=0\)&lt;/span&gt; ç­‰æƒ…å†µã€‚è€Œä¸”æµ®ç‚¹è¯¯å·®ä¼¼ä¹æœ‰ç‚¹å¿ƒçƒ¦æ‰€ä»¥æˆ‘æ²¡å†™ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ³• &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼šæ‹¿å¹³è¡¡æ ‘ç»´æŠ¤åŠ¨æ€å‡¸åŒ…ï¼Œç„¶ååœ¨å‡¸åŒ…ä¸Šä¸‰åˆ†æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸æƒ³å†™ä»£ç äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc246&#34;&gt;ABC246&lt;/h3&gt;
&lt;p&gt;A ç›´æ¥éšä¾¿åšã€‚&lt;/p&gt;
&lt;p&gt;B è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(\cos(\theta)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\sin(\theta)\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;C å…ˆæŒ‰ç…§ç‰©å“å¤§å°è´ªä¸€æ¬¡å¿ƒï¼Œç„¶åå†å°†å‰©ä¸‹éƒ¨åˆ†ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(a_i\bmod x\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼‰é‡æ–°æ’åºå†åšä¸€æ¬¡è´ªå¿ƒã€‚å®¹æ˜“è¯´æ˜å…¶æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;D å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((a+b)(a^2+b^2)\le 10^{18}\)&lt;/span&gt;ï¼Œé’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(a\ge b\)&lt;/span&gt; çš„è¯å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä¸Šç•Œåªèƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(10^6\)&lt;/span&gt;ï¼Œæ‰€ä»¥æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ç„¶åäºŒåˆ† &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc246e---bishop-2&#34;&gt;ABC246E - Bishop 2&lt;/h4&gt;
&lt;p&gt;åœºä¸Šè°ƒè¿™é¢˜è°ƒåˆ°æœ€åéƒ½å¯„äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ•´ä¸ªå°±æ˜¯ä¸€ä¸ª 0-1 bfs çš„æ¨¡å‹ï¼Œæ¯æ¬¡çœ‹æˆèµ°ä¸€æ ¼ï¼ŒåŒå‘èµ°ç›¸å½“äºæ¯”è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œè½¬å‘ç›¸å½“äºè¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦å°±æ˜¯ bfs çš„å¤æ‚åº¦ï¼Œå®¹æ˜“è¯´æ˜å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb13&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb13-1&#34;&gt;&lt;a href=&#34;#cb13-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-2&#34;&gt;&lt;a href=&#34;#cb13-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb13-3&#34;&gt;&lt;a href=&#34;#cb13-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb13-4&#34;&gt;&lt;a href=&#34;#cb13-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-5&#34;&gt;&lt;a href=&#34;#cb13-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1505&lt;/span&gt;, fx[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;}, fy[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb13-6&#34;&gt;&lt;a href=&#34;#cb13-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;queue&amp;lt;pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb13-7&#34;&gt;&lt;a href=&#34;#cb13-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; mp[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb13-8&#34;&gt;&lt;a href=&#34;#cb13-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, sx, sy, tx, ty, f[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb13-9&#34;&gt;&lt;a href=&#34;#cb13-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-10&#34;&gt;&lt;a href=&#34;#cb13-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb13-11&#34;&gt;&lt;a href=&#34;#cb13-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; sx &amp;gt;&amp;gt; sy &amp;gt;&amp;gt; tx &amp;gt;&amp;gt; ty;&lt;/span&gt;
&lt;span id=&#34;cb13-12&#34;&gt;&lt;a href=&#34;#cb13-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; &amp;amp;mp[i][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb13-13&#34;&gt;&lt;a href=&#34;#cb13-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[sx][sy] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, q.push({sx, sy});&lt;/span&gt;
&lt;span id=&#34;cb13-14&#34;&gt;&lt;a href=&#34;#cb13-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; check = [](&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; y &amp;lt;= n &amp;amp;&amp;amp; mp[x][y] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;;};&lt;/span&gt;
&lt;span id=&#34;cb13-15&#34;&gt;&lt;a href=&#34;#cb13-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb13-16&#34;&gt;&lt;a href=&#34;#cb13-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; now = q.front(); q.pop();&lt;/span&gt;
&lt;span id=&#34;cb13-17&#34;&gt;&lt;a href=&#34;#cb13-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-18&#34;&gt;&lt;a href=&#34;#cb13-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = now.first, y = now.second;&lt;/span&gt;
&lt;span id=&#34;cb13-19&#34;&gt;&lt;a href=&#34;#cb13-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;true&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-20&#34;&gt;&lt;a href=&#34;#cb13-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                x += fx[k], y += fy[k];&lt;/span&gt;
&lt;span id=&#34;cb13-21&#34;&gt;&lt;a href=&#34;#cb13-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!check(x, y)) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-22&#34;&gt;&lt;a href=&#34;#cb13-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!f[x][y]) f[x][y] = f[now.first][now.second] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, q.push({x, y});&lt;/span&gt;
&lt;span id=&#34;cb13-23&#34;&gt;&lt;a href=&#34;#cb13-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[x][y] &amp;lt;= f[now.first][now.second]) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-24&#34;&gt;&lt;a href=&#34;#cb13-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb13-25&#34;&gt;&lt;a href=&#34;#cb13-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb13-26&#34;&gt;&lt;a href=&#34;#cb13-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-27&#34;&gt;&lt;a href=&#34;#cb13-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; f[tx][ty] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb13-28&#34;&gt;&lt;a href=&#34;#cb13-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-29&#34;&gt;&lt;a href=&#34;#cb13-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;abc246f---typewriter&#34;&gt;ABC246F - typewriter&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘å¯¹å•ä¸ªä¸²æˆ‘ä»¬æ€ä¹ˆè®¡æ•°ï¼Œä¸éš¾å‘ç°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\text{å­—æ¯ä¸ªæ•°}^L\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¤šä¸ªä¸²æ¥äº†ï¼Œæˆ‘ä»¬å°±éœ€è¦å»é‡ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬å–ä¸¤ä¸ªä¸²å­—æ¯çš„äº¤ï¼Œç„¶åæ‰£æ‰è¿™ä¸€éƒ¨åˆ†çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ‰©å±•ä¸€ä¸‹å°±æ˜¯æœ€åŸºæœ¬çš„å®¹æ–¥ï¼Œçœ‹åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\le 18\)&lt;/span&gt; å°±æšä¸¾æ‰€æœ‰ä¸²çš„å­é›†ï¼Œç®—å…¶äº¤çš„ç­”æ¡ˆï¼Œè´¡çŒ®ä¹˜ä¸Šå®¹æ–¥ç³»æ•° &lt;span class=&#34;math inline&#34;&gt;\((-1)^{|S|}\)&lt;/span&gt;ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(2^nc)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸ºæŸå’Œå­—ç¬¦é›†å¤§å°æœ‰å…³çš„å¸¸æ•°ï¼ˆ&lt;del&gt;æ‡’å¾—åˆ†æäº†&lt;/del&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc246g---game-on-tree-3&#34;&gt;ABC246G - Game on Tree 3&lt;/h4&gt;
&lt;p&gt;ç‚¹å¸¦æƒ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ ¹æ ‘ï¼Œåˆå§‹æœ‰ä¸€ä¸ªæŒ‡é’ˆåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ï¼Œæ¯è½®æ¸¸æˆä¸­å…ˆé’æœ¨é€‰æ‹©ä¸€ä¸ªéæ ¹ç‚¹å¹¶å°†å…¶æƒç½®é›¶ï¼Œç„¶åé«˜æ¡¥å°†æŒ‡é’ˆç§»å‘å…¶æ‰€åœ¨ä½ç½®çš„ä»»æ„å„¿å­ã€‚é«˜æ¡¥å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»ç»“æŸæ¸¸æˆï¼ˆä½†å½“æŒ‡é’ˆç§»åˆ°å¶å­èŠ‚ç‚¹åæ¸¸æˆå¼ºåˆ¶ç»“æŸï¼‰ã€‚åˆ†æ•°ä¸ºæŒ‡é’ˆæœ€åæŒ‡å‘çš„ç‚¹çš„æƒã€‚é’æœ¨æƒ³æœ€å°åŒ–åˆ†æ•°ï¼Œé«˜æ¡¥æƒ³æœ€å¤§åŒ–åˆ†æ•°ï¼Œä¸¤äººç»é¡¶èªæ˜ï¼Œé—®æœ€åçš„åˆ†æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥åšä¼¼ä¹ä¸å¤ªå¯èƒ½ï¼Œæˆ‘ä»¬è€ƒè™‘äºŒåˆ†ç­”æ¡ˆï¼Œå³â€œæœ€ä¼˜ç­–ç•¥ä¸‹ï¼Œé«˜æ¡¥èƒ½å¦è‡³å°‘æ‹¿åˆ° &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; åˆ†â€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªè½¬åŒ–ï¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(\ge c\)&lt;/span&gt; çš„æƒçœ‹ä½œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; c\)&lt;/span&gt; çš„æƒçœ‹ä½œ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œç„¶åå‘ç°ï¼Œåªè¦é«˜æ¡¥å›èµ°åˆ°äº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ï¼Œé‚£ä¹ˆä»–å°±èµ¢äº†ï¼Œå¦åˆ™è¾“äº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæ˜¾ç„¶ï¼Œè‹¥é«˜æ¡¥å°†æŒ‡é’ˆç§»å‘ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; åï¼Œé’æœ¨ä¼šé€‰æ‹©åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†…å°†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ ‘å½¢ dpï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†…é«˜æ¡¥å›èƒ½èµ°åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç‚¹ä¸ªæ•°ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_u = \max(\sum f_v - 1, 0) + [a_u\ge c]\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f_1 &amp;gt; 0\)&lt;/span&gt; æ—¶åˆæ³•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;abc246ex---01-queries&#34;&gt;ABC246Ex - 01? Queries&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5\)&lt;/span&gt; çš„åŒ…å« &lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;code&gt;1&lt;/code&gt; å’Œ &lt;code&gt;?&lt;/code&gt; çš„ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä»¥åŠ &lt;span class=&#34;math inline&#34;&gt;\(q\le 10^5\)&lt;/span&gt; æ¬¡æ“ä½œ &lt;span class=&#34;math inline&#34;&gt;\((x_i, c_i)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; ä¸ºä¸‹æ ‡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; ä¸ºå­—ç¬¦é›†ä¸­çš„æŸå­—ç¬¦ã€‚æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(1,\cdots, q\)&lt;/span&gt; çš„é¡ºåºï¼Œæ¯æ¬¡å°† &lt;span class=&#34;math inline&#34;&gt;\(S_{x_i}\leftarrow c_i\)&lt;/span&gt;ï¼Œç„¶åè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„ 0-1 å­ä¸²ä¸ªæ•°ï¼ˆ&lt;code&gt;?&lt;/code&gt; è§†ä¸ºé€šé…ç¬¦ï¼‰ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ€è€ƒå¯¹äºä¸€ä¸ªå›ºå®šçš„ 0-1 ä¸²å¦‚ä½•è®¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è®¾è®¡ä¸€ä¸ª dp çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0/1}\)&lt;/span&gt; è¡¨ç¤ºè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt;ï¼Œç»“å°¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; çš„å­åºåˆ—æ•°é‡ï¼Œåˆ™ç­”æ¡ˆæ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{n, 0} + f_{n,1}\)&lt;/span&gt;ï¼Œç°åœ¨è€ƒè™‘è½¬ç§»ï¼šå‘ç°å¯ä»¥å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt; ä¸º &lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;code&gt;1&lt;/code&gt; è¿˜æ˜¯ &lt;code&gt;?&lt;/code&gt; åˆ†ç±»è®¨è®ºï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,0} &amp;amp;=
\begin{cases}
f_{i - 1, 0} + (f_{i - 1, 1} + 1) &amp;amp; S_i = \texttt 0\lor S_i = \texttt{?}\\
f_{i - 1, 0} &amp;amp; S_i = \texttt 1\\
\end{cases}
\\
f_{i,1} &amp;amp;= 
\begin{cases}
f_{i - 1, 1} + (f_{i - 1, 0} + 1) &amp;amp; S_i = \texttt 1 \lor S_i = \texttt{?}\\
f_{i - 1, 1} &amp;amp; S_i = \texttt 0
\end{cases}
\end{aligned}
\]&lt;/span&gt; é‚£ä¹ˆæˆ‘ä»¬ä¼šå‘ç°ï¼Œdp æ•°ç»„çš„è½¬ç§»æ˜¯å¾ˆæœ‰è§„å¾‹çš„ï¼Œè€Œä¸”æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹éƒ½æ˜¯ä¿®æ”¹ä¸€ä¸ªç‚¹å¤„çš„è½¬ç§»æ–¹å¼ï¼Œè€Œä¸”è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(f_{n,0} + f_{n, 1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™è®©ä½ æƒ³åˆ°ä»€ä¹ˆï¼åŠ¨æ€ dpã€‚å…·ä½“åœ°ï¼Œä»¤å‘é‡ &lt;span class=&#34;math display&#34;&gt;\[
\boldsymbol F_i = \begin{bmatrix}
f_{i, 0}\\
f_{i, 1}\\
1
\end{bmatrix}
\]&lt;/span&gt; ï¼ˆæœ€ä¸‹é¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ˜¯å› ä¸ºå¸¸æ•°é¡¹éœ€è¦è½¬ç§»ï¼‰é‚£ä¹ˆå°±å¯ä»¥å†™å‡ºä¸‰ä¸ªè½¬ç§»çŸ©é˜µï¼š &lt;span class=&#34;math display&#34;&gt;\[
\boldsymbol A_{\texttt 0} = \begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 1\\
0 &amp;amp; 1 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 1
\end{bmatrix}, \boldsymbol A_{\texttt 1} = \begin{bmatrix}
1 &amp;amp; 0 &amp;amp; 0\\
1 &amp;amp; 1 &amp;amp; 1\\
0 &amp;amp; 0 &amp;amp; 1
\end{bmatrix}, A_{\texttt{?}} = \begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 1\\
1 &amp;amp; 1 &amp;amp; 1\\
0 &amp;amp; 0 &amp;amp; 1
\end{bmatrix}
\]&lt;/span&gt; äºæ˜¯å°±æœ‰ &lt;span class=&#34;math display&#34;&gt;\[
\boldsymbol F_i = \boldsymbol A_{S_i}\times \boldsymbol F_{i - 1} = A_{S_i}A_{S_{i-1}}\cdots \boldsymbol F_0
\]&lt;/span&gt; çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µè¿ä¹˜ç§¯ï¼Œå•ç‚¹ä¿®æ”¹ä¸€ä¸‹ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O((n + q)\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abc247&#34;&gt;ABC247&lt;/h3&gt;
&lt;h4 id=&#34;abc247ex---rearranging-problem&#34;&gt;ABC247Ex - Rearranging Problem&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šå€¼åŸŸä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt;ï¼Œè¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ“ä½œï¼šæ¯æ¬¡é€‰å®šä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i\ne j\)&lt;/span&gt; ç„¶åäº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c_j\)&lt;/span&gt;ã€‚æ˜¾ç„¶è¿™æ ·ä¼šå¾—åˆ°ä¸€ä¸ªä¸‹æ ‡çš„æ–°æ’åˆ—ï¼Œé—®æœ‰å¤šå°‘ç§è¿™æ ·çš„æ’åˆ—ä½¿å¾—æœ€åçš„åºåˆ—å’ŒåŸæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; ç›¸åŒã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åº”è¯¥æ˜¯æ¯”è¾ƒç»å…¸ä½†æˆ‘ä¸ä¼šçš„è®¡æ•°å¥—è·¯ã€‚å‘ç°å…¶å®æœ€åç›¸å½“äºåªåœ¨ç›¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å½¢æˆçš„è¿é€šå—å†…éƒ¨åšäº¤æ¢ï¼Œå³æ’åˆ—çš„æ¯ä¸ªç½®æ¢ç¯å†… &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; è¦ç›¸åŒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lemma 1ï¼šäº¤æ¢ä¸¤ä¸ªæ•°ï¼Œç½®æ¢ç¯çš„ä¸ªæ•°ä¼š &lt;span class=&#34;math inline&#34;&gt;\(+1/-1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªå¼•ç†åº”è¯¥ä¸éš¾è¯æ˜ï¼ˆéšä¾¿ç”»å›¾åˆ†è®¨ä¸€ä¸‹å³å¯ï¼‰ï¼Œè€Œä¸”è²Œä¼¼æ˜¯ä¸ªç»å…¸ç»“è®ºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lemma 2ï¼šä¸€ä¸ªæ’åˆ—èƒ½åœ¨äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡åå¾—åˆ°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(n - c\le k\land (n - c)\equiv k\pmod 2\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸ºç½®æ¢ç¯ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªå¼•ç†å¯ä»¥ç”¨ Lemma 1 è¯æ˜ã€‚æ³¨æ„åˆ°åˆ°ä¸€å¼€å§‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç¯ï¼Œç„¶åå¥‡å¶æ€§è®¨è®ºä¸€ä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ç°åœ¨è¦æ±‚çš„å°±æ˜¯å¯¹äºæ¯ä¸ªåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æ±‚å‡ºåˆæ³•çš„ç½®æ¢ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ dpï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt; çš„æ’åˆ—ï¼Œç½®æ¢ç¯ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„åˆæ³•æ’åˆ—ä¸ªæ•°ã€‚è½¬ç§»çš„è¯è€ƒè™‘æ·»åŠ  &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ—¶å€™å…¶æ˜¯å½¢æˆäº†æ–°ç¯è¿˜æ˜¯å¡å…¥äº†æŸä¸ªè€ç¯ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = f_{i, j - 1} + f_{i - 1, j}\times |\{x\mid 1\le x&amp;lt; i, c_i = c_x\}|
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿ç±»ä¼¼äºç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°çš„è½¬ç§»ï¼Œæ‰€ä»¥å¯ä»¥åˆ†æ²» NTTï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt;ã€‚&lt;del&gt;å·æ‡’ç”¨äº†ä»–ç»™çš„ NTTã€‚&lt;/del&gt;&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb14&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb14-1&#34;&gt;&lt;a href=&#34;#cb14-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-2&#34;&gt;&lt;a href=&#34;#cb14-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;atcoder/modint&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-3&#34;&gt;&lt;a href=&#34;#cb14-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;atcoder/convolution&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-4&#34;&gt;&lt;a href=&#34;#cb14-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb14-5&#34;&gt;&lt;a href=&#34;#cb14-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-6&#34;&gt;&lt;a href=&#34;#cb14-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb14-7&#34;&gt;&lt;a href=&#34;#cb14-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; mint = atcoder::modint998244353;&lt;/span&gt;
&lt;span id=&#34;cb14-8&#34;&gt;&lt;a href=&#34;#cb14-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; atcoder::convolution;&lt;/span&gt;
&lt;span id=&#34;cb14-9&#34;&gt;&lt;a href=&#34;#cb14-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-10&#34;&gt;&lt;a href=&#34;#cb14-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-11&#34;&gt;&lt;a href=&#34;#cb14-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;vector&amp;lt;mint&amp;gt;&amp;gt; P;&lt;/span&gt;
&lt;span id=&#34;cb14-12&#34;&gt;&lt;a href=&#34;#cb14-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt[maxn], n, k;&lt;/span&gt;
&lt;span id=&#34;cb14-13&#34;&gt;&lt;a href=&#34;#cb14-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-14&#34;&gt;&lt;a href=&#34;#cb14-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb14-15&#34;&gt;&lt;a href=&#34;#cb14-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb14-16&#34;&gt;&lt;a href=&#34;#cb14-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb14-17&#34;&gt;&lt;a href=&#34;#cb14-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x; cin &amp;gt;&amp;gt; x;&lt;/span&gt;
&lt;span id=&#34;cb14-18&#34;&gt;&lt;a href=&#34;#cb14-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        P.push_back({cnt[x]++, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb14-19&#34;&gt;&lt;a href=&#34;#cb14-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb14-20&#34;&gt;&lt;a href=&#34;#cb14-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (P.size() &amp;gt;= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb14-21&#34;&gt;&lt;a href=&#34;#cb14-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;decltype&lt;/span&gt;(P) nxt;&lt;/span&gt;
&lt;span id=&#34;cb14-22&#34;&gt;&lt;a href=&#34;#cb14-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt; P.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) nxt.push_back(convolution(P[i], P[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]));&lt;/span&gt;
&lt;span id=&#34;cb14-23&#34;&gt;&lt;a href=&#34;#cb14-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (P.size() &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) nxt.push_back(P.back());&lt;/span&gt;
&lt;span id=&#34;cb14-24&#34;&gt;&lt;a href=&#34;#cb14-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        nxt.swap(P);&lt;/span&gt;
&lt;span id=&#34;cb14-25&#34;&gt;&lt;a href=&#34;#cb14-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb14-26&#34;&gt;&lt;a href=&#34;#cb14-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;f = P.front();&lt;/span&gt;
&lt;span id=&#34;cb14-27&#34;&gt;&lt;a href=&#34;#cb14-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    mint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-28&#34;&gt;&lt;a href=&#34;#cb14-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(c, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)f.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n - c &amp;lt;= k &amp;amp;&amp;amp; ((n - c) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) == (k &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) ans += f[c];&lt;/span&gt;
&lt;span id=&#34;cb14-29&#34;&gt;&lt;a href=&#34;#cb14-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; ans.val() &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb14-30&#34;&gt;&lt;a href=&#34;#cb14-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-31&#34;&gt;&lt;a href=&#34;#cb14-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;arc&#34;&gt;ARC&lt;/h2&gt;
&lt;h3 id=&#34;arc-è¡¥é¢˜è¡¨&#34;&gt;ARC è¡¥é¢˜è¡¨&lt;/h3&gt;
&lt;p&gt;è¿‘æœŸç›®æ ‡ï¼šARC ç¨³å®šåšå‡º 3 é¢˜ï¼Œå°½åŠ›è¡¥å®Œ A-Dã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Round&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Rank&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Perf&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;Sol&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;th&gt;E&lt;/th&gt;
&lt;th&gt;F&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC116&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;vp&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;vp&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC117&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc117/standings?watching=YangTY&#34;&gt;597&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1736&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC118&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc118/standings?watching=YangTY&#34;&gt;1679&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;807&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC119&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc119/standings?watching=YangTY&#34;&gt;1141&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1180&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC120&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc120/standings?watching=YangTY&#34;&gt;785&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1345&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC123&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc123/standings?watching=YangTY&#34;&gt;608&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1756&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC124&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc124/standings?watching=YangTY&#34;&gt;1276&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1004&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC125&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc125/standings?watching=Cgfyufsygsm&#34;&gt;463&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1850&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC126&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc126/standings?watching=YangTY&#34;&gt;876&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1371&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC128&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc128/standings?watching=YangTY&#34;&gt;340&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1998&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC131&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc131/standings?watching=YangTY&#34;&gt;220&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2230&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC132&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc132/standings?watching=YangTY&#34;&gt;566&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1728&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC134&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc134/standings?watching=YangTY&#34;&gt;877&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;1538&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;ARC137&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc137/standings?watching=YangTY&#34;&gt;281&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2148&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;3&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;ARC138&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc138/standings?watching=YangTY&#34;&gt;246&lt;/a&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;2242&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;4&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;ä¸€äº›æ–°è§åˆ°çš„-trick-1&#34;&gt;ä¸€äº›æ–°è§åˆ°çš„ trick&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ARC116Bï¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(\max\times \min\)&lt;/span&gt; æ‹†å¼€è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;ARC125Dï¼šå­åºåˆ—è‡ªåŠ¨æœº dpã€‚&lt;/li&gt;
&lt;li&gt;ARC128Cï¼šçº¿æ€§è§„åˆ’çš„æœ€å€¼ä¸€å®šåœ¨è¾¹ç•Œå–åˆ°ã€‚&lt;/li&gt;
&lt;li&gt;ARC134Cï¼š&lt;strong&gt;æŸç§å…ƒç´ è‡³å°‘å ä¸€åŠ&lt;/strong&gt;ï¼Œè€ƒè™‘å…ˆå¼ºè¡Œé…å¯¹ï¼Œç„¶åæ­£å¸¸åšã€‚&lt;/li&gt;
&lt;li&gt;ARC137Dï¼šæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æ„ä¹‰ä¸‹çš„ Lucas â†’ é«˜ç»´å‰ç¼€å’Œã€‚&lt;/li&gt;
&lt;li&gt;ARC137Eï¼šæœ€å°è´¹ç”¨å¾ªç¯æµçš„å»ºå›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;arc116&#34;&gt;ARC116&lt;/h3&gt;
&lt;p&gt;VPã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc116a---odd-vs-even&#34;&gt;ARC116A - Odd vs Even&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(T\le 2\times 10^5\)&lt;/span&gt;ï¼‰ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^{18}\)&lt;/span&gt;ï¼‰ï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„å¥‡çº¦æ•°å¤šè¿˜æ˜¯å¶çº¦æ•°å¤šã€‚ï¼ˆçº¦æ•°å‡ä¸ºæ­£çº¦æ•°ï¼‰&lt;/p&gt;
&lt;p&gt;å¾ˆæ˜æ˜¾ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(n\bmod 2 = 1\)&lt;/span&gt;ï¼Œåˆ™ç­”æ¡ˆä¸ºå¥‡çº¦æ•°å¤šã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™è€ƒå¯Ÿçº¦æ•°ä»¬æ€ä¹ˆæ¥çš„ã€‚å¯¹äºä¸€ä¸ªå¶æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æˆ‘ä»¬æ€»èƒ½å°†å…¶è¿™æ ·æ‹†åˆ†ï¼š&lt;span class=&#34;math inline&#34;&gt;\(n = 2^k\times p\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; ä¸ºå¥‡æ•°ï¼‰ã€‚é‚£ä¹ˆå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(k = 1\)&lt;/span&gt;ï¼Œåˆ™ä¸éš¾å‘ç°å¥‡å¶çº¦æ•°ä¸€æ ·å¤šï¼Œå¦åˆ™è‚¯å®šæ˜¯å¶çº¦æ•°å¤šã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc116b---products-of-min-max&#34;&gt;ARC116B - Products of Min-Max&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€å«æ­£æ•´æ•°çš„é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\sum_{S\subseteq A}\max_{a\in S}\lbrace a\rbrace\min_{a\in S}\lbrace a\rbrace\bmod{998244353}
\]&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘æŠŠæœ€å¤§å€¼å’Œæœ€å°å€¼æ‹å‡ºæ¥è€ƒè™‘è´¡çŒ®ï¼šå°†å…¶ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä»å°åˆ°å¤§æ’åºã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå‡è®¾æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;lt;j\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(a_i\le a_j\)&lt;/span&gt;ï¼Œè¿™ä¸€å¯¹å…ƒç´ è´¡çŒ®çš„å­é›†ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^{j - i - 1}\)&lt;/span&gt;ã€‚æ‰€ä»¥ç­”æ¡ˆå°±ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^{n - 1}\sum_{j = i + 1}^na_ia_j\cdot2^{j - i} + \sum_{i = 1}^na_i^2
\]&lt;/span&gt; åŒ–ç®€ä¸‹æ¥å¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^{n - 1}\left(a_i\cdot 2^{-i}\sum_{j = i + 1}^na_j\cdot2^{j - 1}\right) + \sum_{i = 1}^na_i^2
\]&lt;/span&gt; é¢„å¤„ç† &lt;span class=&#34;math inline&#34;&gt;\(a_i2^{i - 1}\)&lt;/span&gt; çš„åç¼€å’Œå°±å¯ä»¥ç›´æ¥åšäº†ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc116c---multiple-sequences&#34;&gt;ARC116C - Multiple Sequences&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n,m\le 2\times 10^5\)&lt;/span&gt;ï¼‰ï¼Œæ±‚æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; çš„ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le A_i\le m\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(A_{i + 1}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„æ•´æ•°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“æœæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¦™çš„è®¡æ•°é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; çš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å°±æ˜¯æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; æ¯ä¸ªè´¨å› å­ç»™å®‰æ’åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªä¸åŒçš„ä½ç½®ä¸Šï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚ä½†æ˜¯æ­¤æ—¶éœ€è¦å¯¹æ¯ä¸ªè´¨å› å­åˆ†å¼€è€ƒè™‘ï¼Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(A_n = \prod p_i^{c_i}\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªè´¨å› å­éƒ½ç”¨æ’æ¿æ³•ç„¶åå†ä¹˜èµ·æ¥å¾—åˆ°æ€»æ–¹æ¡ˆï¼Œå³ &lt;span class=&#34;math display&#34;&gt;\[
f(A_n) = \prod\binom{n + c_i - 1}{c_i}
\]&lt;/span&gt; æœ€åæŠŠæ‰€æœ‰çš„ç»“æœåŠ èµ·æ¥å³ä¸ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc117&#34;&gt;ARC117&lt;/h3&gt;
&lt;p&gt;A + B + C + D&lt;/p&gt;
&lt;h4 id=&#34;arc117c---tricolor-pyramid&#34;&gt;ARC117C - Tricolor Pyramid&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc117/tasks/arc117_c&#34;&gt;é¢˜ç›®&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„é¢˜ã€‚é¦–å…ˆæŠŠé¢œè‰²åˆ†åˆ«çœ‹æˆ &lt;span class=&#34;math inline&#34;&gt;\(0,1,2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¸Šä¸€å±‚çš„æ–¹å—å°±ç”± &lt;span class=&#34;math inline&#34;&gt;\(-(a_1 + a_2) \bmod 3\)&lt;/span&gt; å¯ä»¥å¾—åˆ°ã€‚æŠŠæ‰€æœ‰çš„ä¸€ç›´ç´¯åŠ ä¸Šå»å°±æ˜¯æ¨è¾‰ä¸‰è§’çš„å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/arc117/6d089e1cdfb0ed3c0bf6daee87fc198e.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å›¾æº AtCoder å®˜æ–¹é¢˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ±‚äºŒé¡¹å¼ç³»æ•°å³å¯ï¼Œä½¿ç”¨ Lucas å®šç†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc117d---miracle-tree&#34;&gt;ARC117D - Miracle Tree&lt;/h4&gt;
&lt;p&gt;ç»™ä¸€æ£µæ ‘çš„æ¯ä¸ªé¡¶ç‚¹æ ‡å·ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(E_i \ge 1\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(|E_i - E_j|\le \operatorname{dist}(i, j)\)&lt;/span&gt;ã€‚å¯»æ‰¾ä¸€ç§æœ€å¤§æ ‡å·æœ€å°çš„æ–¹æ¡ˆå¹¶è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ç›¸å½“å¥½çš„æ€ç»´é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘éšä¾¿æ ‡ä¸€ä¸ªå›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img.atcoder.jp/arc117/a4103a74b2e0196e17a1a389f8fad851.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å›¾æº AtCoder å®˜æ–¹é¢˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°æˆ‘ä»¬æ ‡çš„å·åº”è¯¥ä¸ºï¼š&lt;span class=&#34;math inline&#34;&gt;\(\lbrace1, 2, 3, 5, 8, 9\rbrace\)&lt;/span&gt; æ˜¯æœ€ä¼˜çš„ã€‚ç›¸å½“äºå°±æ˜¯é‡åˆ°ä¸€ä¸ªç‚¹ï¼Œé¦–å…ˆèµ°ä¸€æ¡å­é“¾ï¼Œç„¶åå›æº¯å›æ¥çš„æ—¶å€™ä»ç„¶éœ€è¦ç»Ÿè®¡å›æº¯é“¾é•¿ï¼Œç„¶ååŠ åˆ°ä¸‹ä¸€æ¡å­é“¾çš„è´¡çŒ®é‡Œé¢å»ï¼ˆå› ä¸ºè¦ &lt;span class=&#34;math inline&#34;&gt;\(|E_i - E_j|\le \operatorname{dist}(i, j)\)&lt;/span&gt;ï¼‰ã€‚æˆ‘ä»¬è‡ªç„¶å¸Œæœ›çš„æ˜¯å°½å¯èƒ½å›æº¯çš„å°‘ï¼Œæ‰€ä»¥åšçš„æ—¶å€™ä»ç›´å¾„çš„ä¸€ç«¯å¼€å§‹èµ°ï¼Œç„¶åé‡åˆ°åˆ†å‰å°±ä¼˜å…ˆèµ°éç›´å¾„çš„è¾¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc118&#34;&gt;ARC118&lt;/h3&gt;
&lt;p&gt;A&lt;/p&gt;
&lt;h4 id=&#34;arc118a---tax-included-price&#34;&gt;ARC118A - Tax Included Price&lt;/h4&gt;
&lt;p&gt;æ‰“è¡¨å¯åšã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc118b---village-of-m-people&#34;&gt;ARC118B - Village of M People&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ä»¥åŠ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œæ„é€  &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\sum B_i = M\)&lt;/span&gt; ä¸” &lt;span class=&#34;math display&#34;&gt;\[
\max_i\left|\frac{B_i}{M} - \frac{A_i}{N}\right|
\]&lt;/span&gt; æœ€å°ã€‚&lt;/p&gt;
&lt;p&gt;â€œæœ€å¤§çš„æœ€å°â€ï¼ŒäºŒåˆ†ç­”æ¡ˆå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¦è®© &lt;span class=&#34;math inline&#34;&gt;\(\max_i\left|\frac{B_i}{M} - \frac{A_i}{N}\right|\)&lt;/span&gt; æœ€å°ï¼Œå³ä¸ºè®© &lt;span class=&#34;math inline&#34;&gt;\(\max_i|B_iN - A_iM|\)&lt;/span&gt; æœ€å°ï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\forall i, \left\lceil \frac{MA_i-x}{N}\right\rceil\leq B_i\leq \left\lfloor\frac{MA_i+x}{N}\right\rfloor\)&lt;/span&gt;ã€‚è¿™æ ·å­ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; çš„ä¸Šç•Œå’Œä¸‹ç•Œå°±å‡ºæ¥äº†ï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(R_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(\sum L_i\le M\le \sum R_i\)&lt;/span&gt;ï¼Œåˆ™ç­”æ¡ˆä¸€å®šæ˜¯å¯ä»¥è¢«æ„é€ å‡ºæ¥çš„ã€‚è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥å®Œæˆå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ checkã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•æ„é€ è¿™ä¸ªç­”æ¡ˆå‘¢ï¼ŸæŠŠæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; è®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L_i\)&lt;/span&gt;ï¼Œç„¶åä¾æ¬¡ä¸Šè°ƒæ¥è¡¥é½ä½™é‡ &lt;span class=&#34;math inline&#34;&gt;\(M - \sum L_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb15&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb15-1&#34;&gt;&lt;a href=&#34;#cb15-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-2&#34;&gt;&lt;a href=&#34;#cb15-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-3&#34;&gt;&lt;a href=&#34;#cb15-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-4&#34;&gt;&lt;a href=&#34;#cb15-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb15-5&#34;&gt;&lt;a href=&#34;#cb15-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb15-6&#34;&gt;&lt;a href=&#34;#cb15-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define int &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-7&#34;&gt;&lt;a href=&#34;#cb15-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-8&#34;&gt;&lt;a href=&#34;#cb15-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-9&#34;&gt;&lt;a href=&#34;#cb15-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-10&#34;&gt;&lt;a href=&#34;#cb15-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb15-11&#34;&gt;&lt;a href=&#34;#cb15-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-12&#34;&gt;&lt;a href=&#34;#cb15-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-13&#34;&gt;&lt;a href=&#34;#cb15-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb15-14&#34;&gt;&lt;a href=&#34;#cb15-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb15-15&#34;&gt;&lt;a href=&#34;#cb15-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x |= (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb15-16&#34;&gt;&lt;a href=&#34;#cb15-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb15-17&#34;&gt;&lt;a href=&#34;#cb15-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = s * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb15-18&#34;&gt;&lt;a href=&#34;#cb15-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x ? -s : s;&lt;/span&gt;
&lt;span id=&#34;cb15-19&#34;&gt;&lt;a href=&#34;#cb15-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb15-20&#34;&gt;&lt;a href=&#34;#cb15-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-21&#34;&gt;&lt;a href=&#34;#cb15-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, a[maxn], n, m;&lt;/span&gt;
&lt;span id=&#34;cb15-22&#34;&gt;&lt;a href=&#34;#cb15-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; L[maxn], R[maxn], suml, sumr;&lt;/span&gt;
&lt;span id=&#34;cb15-23&#34;&gt;&lt;a href=&#34;#cb15-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-24&#34;&gt;&lt;a href=&#34;#cb15-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; max(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;gt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb15-25&#34;&gt;&lt;a href=&#34;#cb15-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; min(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;lt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb15-26&#34;&gt;&lt;a href=&#34;#cb15-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-27&#34;&gt;&lt;a href=&#34;#cb15-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb15-28&#34;&gt;&lt;a href=&#34;#cb15-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-29&#34;&gt;&lt;a href=&#34;#cb15-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(L, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; L), memset(R, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; R);&lt;/span&gt;
&lt;span id=&#34;cb15-30&#34;&gt;&lt;a href=&#34;#cb15-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    suml = sumr = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-31&#34;&gt;&lt;a href=&#34;#cb15-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k)&lt;/span&gt;
&lt;span id=&#34;cb15-32&#34;&gt;&lt;a href=&#34;#cb15-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-33&#34;&gt;&lt;a href=&#34;#cb15-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        L[i] = max(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (m * a[i] - x + n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / n);&lt;/span&gt;
&lt;span id=&#34;cb15-34&#34;&gt;&lt;a href=&#34;#cb15-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        R[i] = (m * a[i] + x) / n;&lt;/span&gt;
&lt;span id=&#34;cb15-35&#34;&gt;&lt;a href=&#34;#cb15-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        suml += L[i], sumr += R[i];&lt;/span&gt;
&lt;span id=&#34;cb15-36&#34;&gt;&lt;a href=&#34;#cb15-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-37&#34;&gt;&lt;a href=&#34;#cb15-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; suml &amp;lt;= m &amp;amp;&amp;amp; m &amp;lt;= sumr;&lt;/span&gt;
&lt;span id=&#34;cb15-38&#34;&gt;&lt;a href=&#34;#cb15-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb15-39&#34;&gt;&lt;a href=&#34;#cb15-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-40&#34;&gt;&lt;a href=&#34;#cb15-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;signed&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb15-41&#34;&gt;&lt;a href=&#34;#cb15-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb15-42&#34;&gt;&lt;a href=&#34;#cb15-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    k = read(), n = read(), m = read();&lt;/span&gt;
&lt;span id=&#34;cb15-43&#34;&gt;&lt;a href=&#34;#cb15-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) a[i] = read();&lt;/span&gt;
&lt;span id=&#34;cb15-44&#34;&gt;&lt;a href=&#34;#cb15-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = n * m, x;&lt;/span&gt;
&lt;span id=&#34;cb15-45&#34;&gt;&lt;a href=&#34;#cb15-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt;= r)&lt;/span&gt;
&lt;span id=&#34;cb15-46&#34;&gt;&lt;a href=&#34;#cb15-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-47&#34;&gt;&lt;a href=&#34;#cb15-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-48&#34;&gt;&lt;a href=&#34;#cb15-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (check(mid)) x = mid, r = mid - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-49&#34;&gt;&lt;a href=&#34;#cb15-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; l = mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-50&#34;&gt;&lt;a href=&#34;#cb15-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-51&#34;&gt;&lt;a href=&#34;#cb15-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    check(x);&lt;/span&gt;
&lt;span id=&#34;cb15-52&#34;&gt;&lt;a href=&#34;#cb15-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sumb = suml;&lt;/span&gt;
&lt;span id=&#34;cb15-53&#34;&gt;&lt;a href=&#34;#cb15-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k)&lt;/span&gt;
&lt;span id=&#34;cb15-54&#34;&gt;&lt;a href=&#34;#cb15-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb15-55&#34;&gt;&lt;a href=&#34;#cb15-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = min(R[i] - L[i], m - sumb);&lt;/span&gt;
&lt;span id=&#34;cb15-56&#34;&gt;&lt;a href=&#34;#cb15-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        sumb += x;&lt;/span&gt;
&lt;span id=&#34;cb15-57&#34;&gt;&lt;a href=&#34;#cb15-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, x + L[i]);&lt;/span&gt;
&lt;span id=&#34;cb15-58&#34;&gt;&lt;a href=&#34;#cb15-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-59&#34;&gt;&lt;a href=&#34;#cb15-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-60&#34;&gt;&lt;a href=&#34;#cb15-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc118c---coprime-set&#34;&gt;ARC118C - Coprime Set&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(3\le N\le 2500\)&lt;/span&gt;ï¼‰ï¼Œæ„é€  &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä½¿å¾—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; äº’ä¸ç›¸åŒä¸” &lt;span class=&#34;math inline&#34;&gt;\(A_i\in[1, 10000]\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i \not= j, \gcd(A_i, A_j) &amp;gt; 1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\gcd_i\{A_i\} = 1\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªé¢˜éœ€è¦ä¸€ä¸ªå¼•ç†ï¼šå¯¹äºä¸€ç³»åˆ—å·²ç»æ»¡è¶³æ¡ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œå°†ä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„å€æ•°åŠ è¿›å»ï¼Œæ–°å¾—åˆ°çš„é›†åˆä¹Ÿæ˜¯æ»¡è¶³æ¡ä»¶çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ­£ç¡®æ€§æ¯”è¾ƒæ˜¾ç„¶ï¼Œä¸è¯ã€‚æ‰€ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(\{6, 10, 15\}\)&lt;/span&gt; å‡ºå‘ï¼Œå°±å¯ä»¥æ„é€ å‡ºæ‰€æœ‰çš„åˆæ³•ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb16&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb16-1&#34;&gt;&lt;a href=&#34;#cb16-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-2&#34;&gt;&lt;a href=&#34;#cb16-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-3&#34;&gt;&lt;a href=&#34;#cb16-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[&lt;span class=&#34;dv&#34;&gt;10005&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb16-4&#34;&gt;&lt;a href=&#34;#cb16-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-5&#34;&gt;&lt;a href=&#34;#cb16-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb16-6&#34;&gt;&lt;a href=&#34;#cb16-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb16-7&#34;&gt;&lt;a href=&#34;#cb16-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-8&#34;&gt;&lt;a href=&#34;#cb16-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;
&lt;span id=&#34;cb16-9&#34;&gt;&lt;a href=&#34;#cb16-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt; &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt;; ++i) vis[i * &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-10&#34;&gt;&lt;a href=&#34;#cb16-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt;; ++i) vis[i * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-11&#34;&gt;&lt;a href=&#34;#cb16-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt; &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt;; ++i) vis[i * &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-12&#34;&gt;&lt;a href=&#34;#cb16-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-13&#34;&gt;&lt;a href=&#34;#cb16-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;), vis[&lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;] = vis[&lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;] = vis[&lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-14&#34;&gt;&lt;a href=&#34;#cb16-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;; i &amp;lt;= &lt;span class=&#34;dv&#34;&gt;10000&lt;/span&gt; &amp;amp;&amp;amp; cnt &amp;lt;= n; ++i) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[i]) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &amp;quot;&lt;/span&gt;, i), ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb16-15&#34;&gt;&lt;a href=&#34;#cb16-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-16&#34;&gt;&lt;a href=&#34;#cb16-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc119&#34;&gt;ARC119&lt;/h3&gt;
&lt;p&gt;A + B&lt;/p&gt;
&lt;h4 id=&#34;arc119b---electric-board&#34;&gt;ARC119B - Electric Board&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ª 01 ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ“ä½œå¯ä»¥é€‰å– &lt;span class=&#34;math inline&#34;&gt;\((l,r)\)&lt;/span&gt;ï¼Œæ»¡è¶³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_l = 0\land S_{l+ 1} = S_{l + 2} = \cdots = S_{r} = 1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_l = S_{l + 1} = \cdots = S_{r - 1} = 1 \land S_r = 0\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åäº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(S_l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt;ã€‚é—®æœ€å°‘å¤šå°‘æ¬¡æ“ä½œä¹‹åå¯ä»¥å°† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸å¦¨å°†æ¯æ¬¡æ“ä½œçœ‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç§»åŠ¨æ“ä½œï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ˜¯è¿ç»­åŠ¨çš„ï¼Œä¸å¥½è€ƒè™‘ã€‚é‚£ä¹ˆå°±åªéœ€è¦ä»å·¦å¾€å³è¿›è¡Œè´ªå¿ƒï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¾æ¬¡å¾€å³ç§»ç›´åˆ°ä¸ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¯¹åº”ã€‚è®°å½•ä¸‹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä½ç½®ç„¶åç›´æ¥è´ªå¿ƒå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc119c---arc-wrecker-2&#34;&gt;ARC119C - ARC Wrecker 2&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œå¯¹äºåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\([l, r - 1]\)&lt;/span&gt; é—´çš„ä¸€ä¸ªæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\(A_x\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(A_{x + 1}\)&lt;/span&gt; åŒæ—¶åŠ ä¸€æˆ–å‡ä¸€ã€‚é—®æœ‰å¤šå°‘ä¸ª &lt;span class=&#34;math inline&#34;&gt;\([l,r ]\)&lt;/span&gt; å¯ä»¥åœ¨æœ‰é™æ¬¡æ“ä½œä¹‹åå˜ä¸ºå…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æ“ä½œç›¸å½“äºæ˜¯ç»™å¥‡æ•°ä¸‹æ ‡çš„æ•°å’Œå¶æ•°ä¸‹æ ‡çš„æ•°åŒæ—¶åŠ å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ‰€ä»¥ä¸ºäº†æœ€åå¾—åˆ°å…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä¸€å¼€å§‹é€‰çš„åŒºé—´ä¸­å¥‡ä¸‹æ ‡å’Œå¶ä¸‹æ ‡æ•°çš„å’Œå¿…é¡»ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°è¿™æ¡æ€§è´¨ä¹‹åè®°å½•ä¸€ä¸‹å‰ç¼€å’Œï¼Œç„¶åç”¨ &lt;code&gt;map&lt;/code&gt; éšä¾¿è®°å½•ä»¥ä¸‹å°±å¯ä»¥åšäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb17&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb17-1&#34;&gt;&lt;a href=&#34;#cb17-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb17-2&#34;&gt;&lt;a href=&#34;#cb17-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-3&#34;&gt;&lt;a href=&#34;#cb17-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll ans, a[maxn], s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb17-4&#34;&gt;&lt;a href=&#34;#cb17-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-5&#34;&gt;&lt;a href=&#34;#cb17-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;map&amp;lt;ll, ll&amp;gt; m;&lt;/span&gt;
&lt;span id=&#34;cb17-6&#34;&gt;&lt;a href=&#34;#cb17-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-7&#34;&gt;&lt;a href=&#34;#cb17-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb17-8&#34;&gt;&lt;a href=&#34;#cb17-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb17-9&#34;&gt;&lt;a href=&#34;#cb17-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = read();&lt;/span&gt;
&lt;span id=&#34;cb17-10&#34;&gt;&lt;a href=&#34;#cb17-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i] = read() * ((i &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-11&#34;&gt;&lt;a href=&#34;#cb17-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) s[i] = a[i] + s[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], ++m[s[i]];&lt;/span&gt;
&lt;span id=&#34;cb17-12&#34;&gt;&lt;a href=&#34;#cb17-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ++m[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb17-13&#34;&gt;&lt;a href=&#34;#cb17-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;map&amp;lt;ll, ll&amp;gt;::iterator it = m.begin(); it != m.end(); ++it)&lt;/span&gt;
&lt;span id=&#34;cb17-14&#34;&gt;&lt;a href=&#34;#cb17-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += (*it).second * ((*it).second - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-15&#34;&gt;&lt;a href=&#34;#cb17-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb17-16&#34;&gt;&lt;a href=&#34;#cb17-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-17&#34;&gt;&lt;a href=&#34;#cb17-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç­”æ¡ˆçš„ä¸Šç•Œæ˜¯ä¼šçˆ† &lt;code&gt;int&lt;/code&gt;ï¼Œè¦å¼€ &lt;code&gt;long long&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc119d---grid-repainting-3&#34;&gt;ARC119D - Grid Repainting 3&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ &lt;span class=&#34;math inline&#34;&gt;\(H\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(W\)&lt;/span&gt; åˆ—çš„æ–¹æ ¼ï¼Œæ¯ä¸ªæ–¹æ ¼ä¸€å¼€å§‹æ¶‚äº†çº¢è‰²æˆ–è€…è“è‰²ã€‚è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼šå¯¹äºå½“å‰çš„æ¯ä¸ªçº¢è‰²æ ¼å­ï¼Œå¯ä»¥é€‰æ‹©å®ƒå¹¶å°†å…¶æ‰€åœ¨çš„ä¸€è¡Œæˆ–ä¸€åˆ—å…¨éƒ¨æ¶‚æ»¡ç™½è‰²ã€‚é—®æœ€åæœ€å¤šå¤šå°‘ä¸ªæ ¼å­å¯ä»¥æ˜¯ç™½è‰²å¹¶æ„é€ æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§æ–¹æ ¼å¹¶ä¸”æ“ä½œæ˜¯å¯¹äºæ•´è¡Œæˆ–æ•´åˆ—çš„é¢˜ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ„å»ºä¸€å¼ äºŒåˆ†å›¾æ¥è§£å†³é—®é¢˜ã€‚å·¦éƒ¨çš„ç‚¹ä»£è¡¨æ¯è¡Œï¼Œå³éƒ¨çš„ç‚¹ä»£è¡¨æ¯åˆ—ï¼Œä¸€ä¸ªçº¢æ ¼å­ä»£è¡¨ä¸€æ¡è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬åˆ†æè¿™ä¸ªæ¶‚è‰²æ–¹æ¡ˆã€‚æ¶‚æ‰ä¸€æ•´è¡Œ/åˆ—ç›¸å½“äºåºŸæ‰è¿™ä¸€ä¸ªç‚¹ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªç‚¹ç›¸å…³çš„æ‰€æœ‰è¾¹å…¨éƒ¨åºŸæ‰ï¼ˆå³ä¸ºåºŸæ‰åœ¨è¿™è¡Œ/åˆ—ä¸Šçš„çº¢æ ¼å­ï¼‰ã€‚å½“ç„¶åºŸæ‰è¿™ä¸ªç‚¹çš„æ¡ä»¶æ˜¯å®ƒèƒ½å¼•å‡ºè‡³å°‘ä¸€æ¡è¾¹ï¼ˆå³å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªçº¢æ ¼å­åœ¨è¿™è¡Œ/åˆ—ä¸Šé¢ï¼‰ã€‚ä¾æ®è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›ä¸€ä¸ªè¿é€šåˆ†é‡å†…ï¼ŒåºŸæ‰çš„ç‚¹ï¼ˆå³æ¶‚æ‰çš„è¡Œ/åˆ—ï¼‰è¶Šå¤šè¶Šå¥½ï¼Œè€ƒè™‘å¦‚ä½•ä½¿å®ƒæœ€å¤šã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ï¼Œä¸€ä¸ªè¿é€šåˆ†é‡åˆ åˆ°æœ€åä¸€å®šä¼šå‰©ä¸‹ä¸€ä¸ªç‚¹ï¼ˆè‡³äºä¸ºä»€ä¹ˆå¯ä»¥è‡ªå·±æ€è€ƒä¸€ä¸‹ï¼‰ã€‚æˆ‘ä»¬å°è¯•æ„é€ ä¸€ä¸‹æ–¹æ¡ˆï¼šå‡è®¾æˆ‘ä»¬å‰©ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ„å»ºè¿™ä¸ªè¿é€šåˆ†é‡çš„ dfs ç”Ÿæˆæ ‘ï¼Œç„¶åä»å¶å­èŠ‚ç‚¹å¾€ä¸Šåˆ ç‚¹ï¼Œè¿™æ ·ä¸€å®šå¯ä»¥ä¿è¯æ˜¯åˆæ³•è€Œä¸”é™¤äº† &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œå…¶ä»–çš„ç‚¹ä¼šè¢«åˆ å¹²å‡€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼ å›¾æ˜¯æœ‰å¾ˆå¤šä¸ªè¿é€šåˆ†é‡çš„ï¼Œè€Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªè¿é€šåˆ†é‡è¿›è¡Œå†³ç­–ï¼šç•™ä¸‹å“ªä¸ªç‚¹æœ€ä¼˜ã€‚æˆ‘ä»¬è¦æ¶‚ç™½çš„æ ¼å­æœ€å¤šï¼Œå‡è®¾æ¶‚äº† &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; åˆ—ï¼Œåˆ™å‰©ä¸‹çš„è“æ ¼å­ä¸º &lt;span class=&#34;math inline&#34;&gt;\((h - r)(w - c)\)&lt;/span&gt; ä¸ªï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æœ€å°åŒ–ã€‚ä¸éš¾å‘ç°æˆ‘ä»¬å¯ä»¥ç›´æ¥æšä¸¾ç•™ä¸‹æ¥çš„è¡Œç‚¹å’Œåˆ—ç‚¹çš„ä¸ªæ•°ï¼Œç„¶åæ‰¾åˆ°æœ€ä¼˜è§£å°±ç›´æ¥å†³ç­–æ¯ä¸ªè¿é€šåˆ†é‡å‰©ä¸‹è¡Œè¿˜æ˜¯åˆ—ï¼ˆåæ­£å“ªä¸€è¡Œå“ªä¸€åˆ—ä¸é‡è¦ï¼‰ï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦çš„æµç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ“è‰²æ ‡è®°è¿é€šåˆ†é‡&lt;/li&gt;
&lt;li&gt;å†³ç­–å‰©ä¸‹å¤šå°‘åˆ—ç‚¹å’Œå¤šå°‘è¡Œç‚¹&lt;/li&gt;
&lt;li&gt;dfs è®°å½•ç­”æ¡ˆ&lt;/li&gt;
&lt;li&gt;è¾“å‡º&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;arc120&#34;&gt;ARC120&lt;/h3&gt;
&lt;p&gt;A + B&lt;/p&gt;
&lt;h4 id=&#34;arc120b---uniformly-distributed&#34;&gt;ARC120B - Uniformly Distributed&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(H \times W\)&lt;/span&gt; çš„æ–¹æ ¼ï¼Œå…¶ä¸­ä¸€äº›æ¶‚äº†çº¢è‰²ï¼Œä¸€äº›æ¶‚äº†è“è‰²ï¼Œä¸€äº›ä»€ä¹ˆéƒ½æ²¡æ¶‚ã€‚é—®å¯¹äºå‰©ä½™çš„æ ¼å­ï¼Œæœ‰å¤šå°‘ç§æ¶‚è‰²çš„æ–¹æ¡ˆä½¿å¾—ä» &lt;span class=&#34;math inline&#34;&gt;\((1,1)\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\((H,W)\)&lt;/span&gt; ä¸Šçš„æ‰€æœ‰è·¯å¾„ç»è¿‡çš„çº¢æ ¼å­æ•°é‡éƒ½ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°ï¼Œå¯¹äºä¸€ä¸ªä»å³ä¸Šåˆ°å·¦ä¸‹çš„å‰¯å¯¹è§’çº¿ï¼Œå…¶è¦ä¹ˆå…¨ä¸ºçº¢è‰²ï¼Œè¦ä¹ˆå…¨ä¸ºè“è‰²ã€‚å¤§ä½“çš„ç†ç”±å¦‚ä¸‹ï¼šï¼ˆéä¸¥æ ¼è¯æ˜ï¼‰&lt;/p&gt;
&lt;p&gt;ä» &lt;span class=&#34;math inline&#34;&gt;\((1,1)\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\((H,W)\)&lt;/span&gt; ä¸€å®šæ˜¯ä¼šç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(H + W - 1\)&lt;/span&gt; æ¡å¦‚ä¸Šé¢è¿™æ ·çš„å‰¯å¯¹è§’çº¿çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šè¦ä¿è¯æ— è®ºæ€ä¹ˆç©¿è¿‡ä¸€æ¡å‰¯å¯¹è§’çº¿ï¼Œå…¶ç»è¿‡çš„çº¢æ ¼å­æ•°é‡éƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç›´æ¥åšå°±è¡Œäº†ï¼Œå¯¹äºä¸€æ¡æœ‰çº¢æ ¼å­çš„å‰¯å¯¹è§’çº¿ï¼Œå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼›å¯¹äºä¸€æ¡å…¨ç©ºçš„å‰¯å¯¹è§’çº¿ï¼Œå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼ˆä¸¤ç§æ¶‚è‰²æ–¹æ¡ˆï¼‰ï¼›å¯¹äºæ—¢æœ‰è“è‰²åˆæœ‰çº¢è‰²çš„å‰¯å¯¹è§’çº¿ï¼Œå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æŠŠè¿™äº›è´¡çŒ®ç”¨ä¹˜æ³•åŸç†åˆå¹¶å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc120c---swaps-2&#34;&gt;ARC120C - Swaps 2&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ã€‚é—®å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; è¿›è¡Œæœ‰é™æ¬¡å¦‚ä¸‹æ“ä½œåèƒ½å¦ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(1\le i\lt N\)&lt;/span&gt;
&lt;ul&gt;
&lt;li&gt;äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(A_{i+ 1}\)&lt;/span&gt; çš„å€¼&lt;/li&gt;
&lt;li&gt;ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; åŠ ä¸€&lt;/li&gt;
&lt;li&gt;ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(A_{i + 1}\)&lt;/span&gt; å‡ä¸€&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœèƒ½ï¼Œé—®æœ€å°‘æ“ä½œæ­¥æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè€ƒè™‘è§£çš„å­˜åœ¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸ªæ•°ç§»åŠ¨çš„æƒ…å†µï¼šæ˜¾ç„¶æ˜¯å¾€å³èµ°å°±å‡å°ï¼Œå¾€å·¦èµ°å°±å¢å¤§ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„æ–°ä½ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(D_i\)&lt;/span&gt;ï¼Œåˆ™å¿…ç„¶æœ‰ï¼š &lt;span class=&#34;math display&#34;&gt;\[
B_{D_i} = A_i + i - D_i
\]&lt;/span&gt; ç§»é¡¹ï¼Œ &lt;span class=&#34;math display&#34;&gt;\[
B_{D_i} + D_i = A_i + i
\]&lt;/span&gt; å‘ç°ä¸¤è¾¹çš„å½¢å¼å¾ˆåƒï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å»ºç«‹ä¸¤ä¸ªæ–°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{A_i + i\}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{B_i + i\}\)&lt;/span&gt; ç„¶åå°†å…¶å€¼æ’åºåˆ¤æ–­å…¶èƒ½ä¸èƒ½ä¸€ä¸€å¯¹åº”å°±å¯ä»¥åˆ¤æ–­æœ‰æ²¡æœ‰è§£äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè€ƒè™‘è§£çš„æœ€ä¼˜æ€§ã€‚&lt;/p&gt;
&lt;p&gt;åˆšæ‰çš„æ’åºä¸­ï¼Œè‹¥æŒ‰ç…§å€¼ä¸ºç¬¬ä¸€å…³é”®å­—æ’åºï¼ŒåŸä¸‹æ ‡ä¸ºç¬¬äºŒå…³é”®å­—æ’åºï¼Œåˆ™æˆ‘ä»¬ä¸éš¾è¯æ˜ï¼Œæ­¤æ—¶ä¸€ä¸€å¯¹åº”çš„ç»“æœæ˜¯æœ€ä¼˜çš„ã€‚è¿™æ ·å­ &lt;span class=&#34;math inline&#34;&gt;\(D_i\)&lt;/span&gt; å°±æ‰¾åˆ°äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ç§»åˆ° &lt;span class=&#34;math inline&#34;&gt;\(A_{D_i}\)&lt;/span&gt; çš„è¿‡ç¨‹å¾ˆåƒå†’æ³¡æ’åºï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­å…ƒç´ çš„ä¸‹æ ‡å°±å¯ä»¥åšäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb18&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb18-1&#34;&gt;&lt;a href=&#34;#cb18-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-2&#34;&gt;&lt;a href=&#34;#cb18-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-3&#34;&gt;&lt;a href=&#34;#cb18-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;algorithm&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-4&#34;&gt;&lt;a href=&#34;#cb18-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb18-5&#34;&gt;&lt;a href=&#34;#cb18-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb18-6&#34;&gt;&lt;a href=&#34;#cb18-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define int &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-7&#34;&gt;&lt;a href=&#34;#cb18-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-8&#34;&gt;&lt;a href=&#34;#cb18-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-9&#34;&gt;&lt;a href=&#34;#cb18-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-10&#34;&gt;&lt;a href=&#34;#cb18-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; read()&lt;/span&gt;
&lt;span id=&#34;cb18-11&#34;&gt;&lt;a href=&#34;#cb18-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-12&#34;&gt;&lt;a href=&#34;#cb18-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-13&#34;&gt;&lt;a href=&#34;#cb18-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb18-14&#34;&gt;&lt;a href=&#34;#cb18-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb18-15&#34;&gt;&lt;a href=&#34;#cb18-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x |= (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb18-16&#34;&gt;&lt;a href=&#34;#cb18-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb18-17&#34;&gt;&lt;a href=&#34;#cb18-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s = s * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb18-18&#34;&gt;&lt;a href=&#34;#cb18-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x ? -s : s;&lt;/span&gt;
&lt;span id=&#34;cb18-19&#34;&gt;&lt;a href=&#34;#cb18-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-20&#34;&gt;&lt;a href=&#34;#cb18-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-21&#34;&gt;&lt;a href=&#34;#cb18-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; node&lt;/span&gt;
&lt;span id=&#34;cb18-22&#34;&gt;&lt;a href=&#34;#cb18-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-23&#34;&gt;&lt;a href=&#34;#cb18-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; val, id;&lt;/span&gt;
&lt;span id=&#34;cb18-24&#34;&gt;&lt;a href=&#34;#cb18-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;&amp;lt;(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; node &amp;amp;b)&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-25&#34;&gt;&lt;a href=&#34;#cb18-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb18-26&#34;&gt;&lt;a href=&#34;#cb18-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; val == b.val ? id &amp;lt; b.id : val &amp;lt; b.val;&lt;/span&gt;
&lt;span id=&#34;cb18-27&#34;&gt;&lt;a href=&#34;#cb18-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-28&#34;&gt;&lt;a href=&#34;#cb18-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} ai[maxn], bi[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-29&#34;&gt;&lt;a href=&#34;#cb18-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-30&#34;&gt;&lt;a href=&#34;#cb18-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], b[maxn], n;&lt;/span&gt;
&lt;span id=&#34;cb18-31&#34;&gt;&lt;a href=&#34;#cb18-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-32&#34;&gt;&lt;a href=&#34;#cb18-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; myabs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb18-33&#34;&gt;&lt;a href=&#34;#cb18-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-34&#34;&gt;&lt;a href=&#34;#cb18-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x &amp;gt;= &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; ? x : -x;&lt;/span&gt;
&lt;span id=&#34;cb18-35&#34;&gt;&lt;a href=&#34;#cb18-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-36&#34;&gt;&lt;a href=&#34;#cb18-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-37&#34;&gt;&lt;a href=&#34;#cb18-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], tag[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], d[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-38&#34;&gt;&lt;a href=&#34;#cb18-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-39&#34;&gt;&lt;a href=&#34;#cb18-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define L &lt;/span&gt;(k&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb18-40&#34;&gt;&lt;a href=&#34;#cb18-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define R &lt;/span&gt;(L&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;|&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb18-41&#34;&gt;&lt;a href=&#34;#cb18-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define M &lt;/span&gt;((i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;+&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;j)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb18-42&#34;&gt;&lt;a href=&#34;#cb18-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-43&#34;&gt;&lt;a href=&#34;#cb18-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; build(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k)&lt;/span&gt;
&lt;span id=&#34;cb18-44&#34;&gt;&lt;a href=&#34;#cb18-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-45&#34;&gt;&lt;a href=&#34;#cb18-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i == j)&lt;/span&gt;
&lt;span id=&#34;cb18-46&#34;&gt;&lt;a href=&#34;#cb18-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt;(f[k] = i);&lt;/span&gt;
&lt;span id=&#34;cb18-47&#34;&gt;&lt;a href=&#34;#cb18-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    build(i, M, L);&lt;/span&gt;
&lt;span id=&#34;cb18-48&#34;&gt;&lt;a href=&#34;#cb18-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    build(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R);&lt;/span&gt;
&lt;span id=&#34;cb18-49&#34;&gt;&lt;a href=&#34;#cb18-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[k] = f[L] + f[R];&lt;/span&gt;
&lt;span id=&#34;cb18-50&#34;&gt;&lt;a href=&#34;#cb18-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-51&#34;&gt;&lt;a href=&#34;#cb18-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-52&#34;&gt;&lt;a href=&#34;#cb18-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-53&#34;&gt;&lt;a href=&#34;#cb18-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; pushdown(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k)&lt;/span&gt;
&lt;span id=&#34;cb18-54&#34;&gt;&lt;a href=&#34;#cb18-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-55&#34;&gt;&lt;a href=&#34;#cb18-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    tag[L] += tag[k], tag[R] += tag[k];&lt;/span&gt;
&lt;span id=&#34;cb18-56&#34;&gt;&lt;a href=&#34;#cb18-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[L] += (M - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * tag[k];&lt;/span&gt;
&lt;span id=&#34;cb18-57&#34;&gt;&lt;a href=&#34;#cb18-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[R] += (j - M) * tag[k];&lt;/span&gt;
&lt;span id=&#34;cb18-58&#34;&gt;&lt;a href=&#34;#cb18-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    tag[k] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-59&#34;&gt;&lt;a href=&#34;#cb18-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-60&#34;&gt;&lt;a href=&#34;#cb18-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-61&#34;&gt;&lt;a href=&#34;#cb18-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-62&#34;&gt;&lt;a href=&#34;#cb18-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; modify(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; d)&lt;/span&gt;
&lt;span id=&#34;cb18-63&#34;&gt;&lt;a href=&#34;#cb18-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-64&#34;&gt;&lt;a href=&#34;#cb18-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;gt; y) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-65&#34;&gt;&lt;a href=&#34;#cb18-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;gt;= x &amp;amp;&amp;amp; j &amp;lt;= y)&lt;/span&gt;
&lt;span id=&#34;cb18-66&#34;&gt;&lt;a href=&#34;#cb18-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb18-67&#34;&gt;&lt;a href=&#34;#cb18-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[k] += d * (j - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-68&#34;&gt;&lt;a href=&#34;#cb18-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tag[k] += d;&lt;/span&gt;
&lt;span id=&#34;cb18-69&#34;&gt;&lt;a href=&#34;#cb18-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-70&#34;&gt;&lt;a href=&#34;#cb18-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-71&#34;&gt;&lt;a href=&#34;#cb18-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pushdown(i, j, k);&lt;/span&gt;
&lt;span id=&#34;cb18-72&#34;&gt;&lt;a href=&#34;#cb18-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= M) modify(i, M, L, x, y, d);&lt;/span&gt;
&lt;span id=&#34;cb18-73&#34;&gt;&lt;a href=&#34;#cb18-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (y &amp;gt; M) modify(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R, x, y, d);&lt;/span&gt;
&lt;span id=&#34;cb18-74&#34;&gt;&lt;a href=&#34;#cb18-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[k] = f[L] + f[R];&lt;/span&gt;
&lt;span id=&#34;cb18-75&#34;&gt;&lt;a href=&#34;#cb18-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-76&#34;&gt;&lt;a href=&#34;#cb18-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-77&#34;&gt;&lt;a href=&#34;#cb18-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-78&#34;&gt;&lt;a href=&#34;#cb18-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb18-79&#34;&gt;&lt;a href=&#34;#cb18-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-80&#34;&gt;&lt;a href=&#34;#cb18-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i == j) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[k];&lt;/span&gt;
&lt;span id=&#34;cb18-81&#34;&gt;&lt;a href=&#34;#cb18-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pushdown(i, j, k);&lt;/span&gt;
&lt;span id=&#34;cb18-82&#34;&gt;&lt;a href=&#34;#cb18-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= M) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; query(i, M, L, x);&lt;/span&gt;
&lt;span id=&#34;cb18-83&#34;&gt;&lt;a href=&#34;#cb18-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; query(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R, x);&lt;/span&gt;
&lt;span id=&#34;cb18-84&#34;&gt;&lt;a href=&#34;#cb18-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-85&#34;&gt;&lt;a href=&#34;#cb18-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-86&#34;&gt;&lt;a href=&#34;#cb18-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;signed&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb18-87&#34;&gt;&lt;a href=&#34;#cb18-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb18-88&#34;&gt;&lt;a href=&#34;#cb18-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = read();&lt;/span&gt;
&lt;span id=&#34;cb18-89&#34;&gt;&lt;a href=&#34;#cb18-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i] = read(), ai[i].val = a[i] + i, ai[i].id = i;&lt;/span&gt;
&lt;span id=&#34;cb18-90&#34;&gt;&lt;a href=&#34;#cb18-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) b[i] = read(), bi[i].val = b[i] + i, bi[i].id = i;&lt;/span&gt;
&lt;span id=&#34;cb18-91&#34;&gt;&lt;a href=&#34;#cb18-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;sort(ai + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, ai + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-92&#34;&gt;&lt;a href=&#34;#cb18-92&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;sort(bi + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, bi + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-93&#34;&gt;&lt;a href=&#34;#cb18-93&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb18-94&#34;&gt;&lt;a href=&#34;#cb18-94&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ai[i].val != bi[i].val) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;-1&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-95&#34;&gt;&lt;a href=&#34;#cb18-95&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; d[bi[i].id] = ai[i].id;&lt;/span&gt;
&lt;span id=&#34;cb18-96&#34;&gt;&lt;a href=&#34;#cb18-96&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    build(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-97&#34;&gt;&lt;a href=&#34;#cb18-97&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-98&#34;&gt;&lt;a href=&#34;#cb18-98&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb18-99&#34;&gt;&lt;a href=&#34;#cb18-99&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb18-100&#34;&gt;&lt;a href=&#34;#cb18-100&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += abs(query(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d[i]) - i);&lt;/span&gt;
&lt;span id=&#34;cb18-101&#34;&gt;&lt;a href=&#34;#cb18-101&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        modify(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d[i], &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-102&#34;&gt;&lt;a href=&#34;#cb18-102&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-103&#34;&gt;&lt;a href=&#34;#cb18-103&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb18-104&#34;&gt;&lt;a href=&#34;#cb18-104&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-105&#34;&gt;&lt;a href=&#34;#cb18-105&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc120d---bracket-score-2&#34;&gt;ARC120D - Bracket Score 2&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2N\)&lt;/span&gt; çš„æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œä¾ç…§å…¶æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2N\)&lt;/span&gt; çš„åˆæ³•æ‹¬å·åºåˆ—ï¼Œä½¿å¾—å…¶åˆ†æ•°æœ€å¤§ï¼Œåˆ†æ•°çš„è®¡ç®—æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸€å¯¹åŒ¹é…çš„æ‹¬å· &lt;span class=&#34;math inline&#34;&gt;\(S_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_j\)&lt;/span&gt;ï¼Œå…¶è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(|A_j - A_i|\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;å°†æ¯ä¸€å¯¹åŒ¹é…çš„æ‹¬å·çš„åˆ†æ•°åŠ èµ·æ¥å¾—åˆ°æ€»åˆ†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çœ¼å‰ä¸€äº®çš„æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°ï¼Œè®©å¤§çš„å°½é‡å¤§ï¼Œå°çš„å°½é‡å°å°±å¯ä»¥ä½¿å¾—æ€»åˆ†æœ€å¤§ã€‚å› æ­¤é€‰å‡ºæœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œæ ‡è®°ä¸ºé»‘è‰²ï¼Œå‰©ä½™çš„æ ‡è®°ä¸ºç™½è‰²ã€‚ç„¶åæ ¹æ®ä¸€é»‘ä¸€ç™½é…å¯¹çš„åŸåˆ™ç›´æ¥æ„é€ æ‹¬å·åºåˆ—å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc123&#34;&gt;ARC123&lt;/h3&gt;
&lt;p&gt;A + B + C&lt;/p&gt;
&lt;h4 id=&#34;arc123b---increasing-triples&#34;&gt;ARC123&lt;strong&gt;B - Increasing Triples&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(10^5\)&lt;/span&gt; çº§åˆ«çš„åºåˆ—ï¼Œå¯ä»¥ä»»æ„æ’åˆ—ï¼Œé—®æœ€å¤šèƒ½æœ‰å¤šå°‘ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(A_i &amp;lt; B_i &amp;lt; C_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨å †å®ç°çš„è´ªå¿ƒã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc123c---1-2-3---decomposition&#34;&gt;ARC123C - 1, 2, 3 - Decomposition&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œéœ€è¦æ±‚å‡ºæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½¿å¾—å­˜åœ¨é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{A_i\}\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\sum A_i = n\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; çš„æ¯ä¸ªæ•°ä½éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1000\)&lt;/span&gt;ï¼‰ç»„æ•°æ®ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^{18}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ•°ä½ dpã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb19&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb19-1&#34;&gt;&lt;a href=&#34;#cb19-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; solve() {&lt;/span&gt;
&lt;span id=&#34;cb19-2&#34;&gt;&lt;a href=&#34;#cb19-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f[&lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;25&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb19-3&#34;&gt;&lt;a href=&#34;#cb19-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(f, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; f);&lt;/span&gt;
&lt;span id=&#34;cb19-4&#34;&gt;&lt;a href=&#34;#cb19-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-5&#34;&gt;&lt;a href=&#34;#cb19-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n = strlen(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb19-6&#34;&gt;&lt;a href=&#34;#cb19-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-7&#34;&gt;&lt;a href=&#34;#cb19-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-8&#34;&gt;&lt;a href=&#34;#cb19-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-9&#34;&gt;&lt;a href=&#34;#cb19-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[i][j][k]) {&lt;/span&gt;
&lt;span id=&#34;cb19-10&#34;&gt;&lt;a href=&#34;#cb19-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    FOR(l, max((j + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, k), min(j, a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb19-11&#34;&gt;&lt;a href=&#34;#cb19-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                        f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;][l] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-12&#34;&gt;&lt;a href=&#34;#cb19-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    FOR(l, max((j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, k), min(j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;))&lt;/span&gt;
&lt;span id=&#34;cb19-13&#34;&gt;&lt;a href=&#34;#cb19-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                        f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;][l] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-14&#34;&gt;&lt;a href=&#34;#cb19-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb19-15&#34;&gt;&lt;a href=&#34;#cb19-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb19-16&#34;&gt;&lt;a href=&#34;#cb19-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb19-17&#34;&gt;&lt;a href=&#34;#cb19-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb19-18&#34;&gt;&lt;a href=&#34;#cb19-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-19&#34;&gt;&lt;a href=&#34;#cb19-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb19-20&#34;&gt;&lt;a href=&#34;#cb19-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb19-21&#34;&gt;&lt;a href=&#34;#cb19-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[n][i][j])&lt;/span&gt;
&lt;span id=&#34;cb19-22&#34;&gt;&lt;a href=&#34;#cb19-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans = min(ans, max((i + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, j));&lt;/span&gt;
&lt;span id=&#34;cb19-23&#34;&gt;&lt;a href=&#34;#cb19-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb19-24&#34;&gt;&lt;a href=&#34;#cb19-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc124&#34;&gt;ARC124&lt;/h3&gt;
&lt;p&gt;çŠ¶æ€å¾ˆå·® A + B&lt;/p&gt;
&lt;h3 id=&#34;arc125&#34;&gt;ARC125&lt;/h3&gt;
&lt;p&gt;A + B + C&lt;/p&gt;
&lt;h4 id=&#34;arc125a---dial-up&#34;&gt;ARC125A - Dial Up&lt;/h4&gt;
&lt;p&gt;ç›´æ¥è´ªå¿ƒå³å¯ï¼Œç»†èŠ‚ç•¥å¤šã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc125b---squares&#34;&gt;ARC125B - Squares&lt;/h4&gt;
&lt;p&gt;æ±‚æœ‰åºæ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; å…¶ä¸­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le x, y\le n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^{12}\)&lt;/span&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(x^2 - y\)&lt;/span&gt; ä¸ºå®Œå…¨å¹³æ–¹æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çš„æ•°é‡æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x^2 - y = z^2\)&lt;/span&gt;ï¼Œç„¶åå¹³æ–¹å·®æ€¼è¿‡å»å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((x + z)(x - z) = y\)&lt;/span&gt;ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x + z = p\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x - z = q\)&lt;/span&gt;ã€‚åˆ™é—®é¢˜åŒ–ä¸ºæ±‚ &lt;span class=&#34;math inline&#34;&gt;\((p, q)\)&lt;/span&gt; çš„æ•°é‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(p\ge q\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(x = \dfrac{p + q}{2}\)&lt;/span&gt; ä¸ºæ•´æ•°ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le x = \dfrac{p + q}{2}\le n\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1 \le y = pq\le n\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt; æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt;ï¼Œç„¶å &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¦æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(q\le p\le n\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(p\equiv q\pmod 2\)&lt;/span&gt;ã€‚è¿™ä¸ªä¸œè¥¿å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; ç®—ã€‚äºæ˜¯æ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc125c---lis-to-original-sequence&#34;&gt;ARC125C - LIS to Original Sequence&lt;/h4&gt;
&lt;p&gt;æ„é€ é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå•è°ƒå¢æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(\{a_1, \cdots, a_k\}\)&lt;/span&gt;ï¼Œæ„é€ å­—å…¸åºæœ€å°çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{p_1, \cdots, p_n\}\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\{p_i\}\)&lt;/span&gt; çš„ LIS ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å­é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k = 1\)&lt;/span&gt; æ—¶ï¼Œç­”æ¡ˆæ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\{n, n - 1, n - 2, \cdots, 1\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k \ge 2\)&lt;/span&gt; æ—¶ï¼Œè€ƒè™‘åˆ° LIS çš„æ€§è´¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_1 = a_1\)&lt;/span&gt;ï¼Œç„¶åå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(p_1\not= 1\)&lt;/span&gt;ï¼Œä¸ºäº†ä½¿å¾—å­—å…¸åºæœ€å°ä¸”ä¸ç ´åæœ€é•¿ LIS çš„æ€§è´¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_2 = 1\)&lt;/span&gt;ã€‚ç„¶åå°±å¯ä»¥ä¾æ¬¡ç±»æ¨ä¸‹å»æ¨å¯¼ã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºæ˜¯ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(1\le i\le k - 1\)&lt;/span&gt;ï¼Œå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_{i + 1}\)&lt;/span&gt; ä¸­æ’å…¥è‡³å¤šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(x &amp;lt; a_i\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(x &amp;lt; a_{i + 1}\)&lt;/span&gt;ã€‚æœ€åçš„æ‰€æœ‰å…ƒç´ é™åºæ’åˆ—å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc125d---unique-subsequence&#34;&gt;ARC125D - Unique Subsequence&lt;/h4&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{a_1, \cdots, a_n\}\)&lt;/span&gt;ï¼Œé—®å‡ºç°æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å­åºåˆ—çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(a_0 = 0\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_{n + 1} = n + 1\)&lt;/span&gt;ï¼Œç„¶åè®¾è®¡ä¸€ä¸ª dp çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(\{a_0, \cdots, a_i\}\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å¼ºåˆ¶é€‰çš„ç­”æ¡ˆï¼Œåˆ™æœ€ç»ˆç­”æ¡ˆä¸ºæ‰€æœ‰æ•°å­—æœ€åå‡ºç°ä½ç½®çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æˆ‘ä»¬ä¸€å®šä¸èƒ½è®© &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸Šä¸€ä¸ªå‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(lst_i\)&lt;/span&gt; å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; äº§ç”Ÿè´¡çŒ®ï¼Œå¦åˆ™é€‰å–å­åºåˆ—çš„æ–¹å¼å°±ä¸å”¯ä¸€äº†ã€‚ç„¶åä¸€å®šè¦ä¿è¯æ˜¯æœ€åä¸€ä¸ªå‡ºç°çš„æ•°äº§ç”Ÿè´¡çŒ®ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ª BIT ç»´æŠ¤å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb20&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb20-1&#34;&gt;&lt;a href=&#34;#cb20-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb20-2&#34;&gt;&lt;a href=&#34;#cb20-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb20-3&#34;&gt;&lt;a href=&#34;#cb20-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb20-4&#34;&gt;&lt;a href=&#34;#cb20-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb20-5&#34;&gt;&lt;a href=&#34;#cb20-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        last[i] = now[a[i]];&lt;/span&gt;
&lt;span id=&#34;cb20-6&#34;&gt;&lt;a href=&#34;#cb20-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        now[a[i]] = i;&lt;/span&gt;
&lt;span id=&#34;cb20-7&#34;&gt;&lt;a href=&#34;#cb20-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb20-8&#34;&gt;&lt;a href=&#34;#cb20-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    add(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb20-9&#34;&gt;&lt;a href=&#34;#cb20-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb20-10&#34;&gt;&lt;a href=&#34;#cb20-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = sum(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - sum(last[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb20-11&#34;&gt;&lt;a href=&#34;#cb20-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        add(last[i], -f[last[i]]);&lt;/span&gt;
&lt;span id=&#34;cb20-12&#34;&gt;&lt;a href=&#34;#cb20-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        add(i, f[i]);&lt;/span&gt;
&lt;span id=&#34;cb20-13&#34;&gt;&lt;a href=&#34;#cb20-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb20-14&#34;&gt;&lt;a href=&#34;#cb20-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-15&#34;&gt;&lt;a href=&#34;#cb20-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb20-16&#34;&gt;&lt;a href=&#34;#cb20-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now[i])&lt;/span&gt;
&lt;span id=&#34;cb20-17&#34;&gt;&lt;a href=&#34;#cb20-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans += f[now[i]];&lt;/span&gt;
&lt;span id=&#34;cb20-18&#34;&gt;&lt;a href=&#34;#cb20-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb20-19&#34;&gt;&lt;a href=&#34;#cb20-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-20&#34;&gt;&lt;a href=&#34;#cb20-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc126&#34;&gt;ARC126&lt;/h3&gt;
&lt;p&gt;çŠ¶æ€å·®ã€‚A + Bã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc126c---maximize-gcd&#34;&gt;ARC126C - Maximize GCD&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\((A_1, \cdots, A_n)\)&lt;/span&gt;ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(A_i\gets A_i + 1\)&lt;/span&gt;ï¼Œé—®æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡æ“ä½œä¹‹åèƒ½è¾¾åˆ°çš„æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(\gcd_i\{A_i\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le A_i, n\le 3\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 10^{18}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä» &lt;span class=&#34;math inline&#34;&gt;\([1, A_{\max}]\)&lt;/span&gt; å…ˆæšä¸¾è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\gcd\{A_i\}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯è®¡ç®—å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; è¦è¿›è¡Œå¤šå°‘æ¬¡æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è®¾å½“å‰è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\((k - 1)x &amp;lt; A_i \le kx\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œè¿™ä¸ªä»£ä»·æ˜¯å¾ˆå¥½ç®—çš„ï¼Œéšä¾¿å‰ç¼€å’Œä¼˜åŒ–ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚æ‰€ä»¥å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œè®¡ç®—å…¶æ“ä½œæ¬¡æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(A_{\max} / x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåˆ°äº†æœ€åæ¯ä¸ªæ•°éƒ½å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(A_{\max}\)&lt;/span&gt; äº†ï¼Œè¿˜æœ‰å‰©ä½™çš„æ“ä½œæ¬¡æ•°ï¼Œåˆ™è€ƒè™‘ç»§ç»­å¾€ä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(\lfloor k / n\rfloor\)&lt;/span&gt; ä¸ªã€‚æ€»æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n + A_{\max}\ln A_{\max})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc128&#34;&gt;ARC128&lt;/h3&gt;
&lt;p&gt;A + B + Cï¼Œrk 340ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc128c---max-dot&#34;&gt;ARC128C - Max Dot&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\text{maximize } \sum_{i = 1}^nA_ix_i\\
\text{s.t. } \begin{cases}
0\le x_1\le x_2\\
0\le x_2\le x_3\\
\cdots\\
0\le x_n\le m\\
x_1 + x_2 + \cdots x_n = S
\end{cases}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘çº¿æ€§è§„åˆ’çš„è§£ä¸€å®šåœ¨å¯è¡ŒåŸŸçš„ç«¯ç‚¹å¤„å–åˆ°ã€‚æ‰€ä»¥å‰å‡ ä¸ªå– &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œåå‡ ä¸ªå– &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼Œä¸­é—´å‡ ä¸ªå–å¹³å‡æ•°ã€‚æšä¸¾å‰åç¼€ç«¯ç‚¹å³å¯ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc131&#34;&gt;ARC131&lt;/h3&gt;
&lt;p&gt;A + B + C + Eï¼Œrk220ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc131b---grid-repainting-4&#34;&gt;ARC131B - Grid Repainting 4&lt;/h4&gt;
&lt;p&gt;ç”±å››è‰²å®šç†çŸ¥ç›´æ¥æ„é€ å³å¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc131c---zero-xor&#34;&gt;ARC131C - Zero XOR&lt;/h4&gt;
&lt;p&gt;ç‰›é€¼é¢˜ã€‚ç»™å®šä¸€æ•°é›†ï¼Œä¸¤äººåšå¼ˆï¼Œä¸€æ­¥å¯ä»¥åˆ é™¤ä¸€ä¸ªæ•°å­—ã€‚åˆ åˆ°å‰©ä¸‹æ•°é›†çš„å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ—¶è·èƒœã€‚ä¸¤äººéƒ½æœ€ä¼˜æ–¹æ¡ˆï¼Œé—®å…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºï¼šæ‰€æœ‰æ•°å­—å¼‚æˆ–å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(\in S\)&lt;/span&gt;ï¼Œåˆ™å…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n \equiv 1\pmod 2\)&lt;/span&gt;ï¼Œå…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™åæ‰‹å¿…èƒœã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(x\in S\)&lt;/span&gt; çš„æƒ…å†µéå¸¸å¥½ç†è§£ï¼Œå…ˆæ‰‹åªéœ€è¦å–å‡º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ï¼Œæ¸¸æˆå°†åœ¨ä¸¤äººå–å®Œæ‰€æœ‰æ•°å­—ä¹‹åç»“æŸã€‚æœ€åä¸€ä¸ªå–çš„äººå°†ä¸ºèµ¢å®¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc131e---christmas-wreath&#34;&gt;ARC131E - Christmas Wreath&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®Œå…¨å›¾çš„è¾¹æŸ“è‰² &lt;span class=&#34;math inline&#34;&gt;\((R,B,W)\)&lt;/span&gt;ï¼Œè¦æ±‚ä¸‰ç§é¢œè‰²å‡ºç°çš„é¢‘ç‡ç›¸ç­‰ï¼Œä¸”ä»»æ„ä¸€ä¸ªä¸‰å…ƒç¯ä¸èƒ½å‡ºç°ä¸‰è¾¹é¢œè‰²ä¸ä¸€æ ·ï¼Œæ±‚æ„é€ æ–¹æ¡ˆæˆ–è¾“å‡ºæ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘é‚»æ¥çŸ©é˜µï¼Œå‘ç°æ¯ä¸€è¡Œé¢œè‰²ç›¸åŒå°±èƒ½æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªæ¡ä»¶å°±éšä¾¿æ„é€ å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc132&#34;&gt;ARC132&lt;/h3&gt;
&lt;h4 id=&#34;arc132a---permutation-grid&#34;&gt;ARC132A - Permutation Grid&lt;/h4&gt;
&lt;p&gt;æ¯”è¾ƒå¦™çš„æ€è·¯ã€‚è€ƒè™‘åˆå§‹æ„é€ å‡ºä¸€ä¸ªçŠ¶æ€ç„¶åæ ¹æ®æ’åˆ—å˜æ¢ã€‚ç»“è®ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(R_x +C_y\ge n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc132b---shift-and-reverse&#34;&gt;ARC132B - Shift and Reverse&lt;/h4&gt;
&lt;p&gt;å¯ä»¥æ³¨æ„åˆ°ç¿»è½¬æ“ä½œè‡³å¤šè¿›è¡Œä¸¤æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥åˆ†ç±»è®¨è®ºç„¶ååšåšå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc132c---almost-sorted&#34;&gt;ARC132C - Almost Sorted&lt;/h4&gt;
&lt;p&gt;æ¯”è¾ƒå¥½çš„çŠ¶å‹é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i\in\{-1, 1, 2, 3,\cdots, n\}\)&lt;/span&gt;ï¼Œå’Œä¸€ä¸ªæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ã€‚é—®æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; çš„ä¸ªæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(p_1,\cdots,p_n\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1,n]\)&lt;/span&gt; æ’åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(a_i\ne -1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(p_i = a_i\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(|p_i - i|\le d\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le d\le 5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d &amp;lt; n\le 500\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_i\in[i - d, i + d]\)&lt;/span&gt;ï¼Œå€¼åŸŸåŒºé—´é•¿åº¦æœ€å¤§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(11\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘çŠ¶å‹èµ·æ¥ã€‚æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, S}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\([i - d, i + d]\)&lt;/span&gt; çš„å€¼åŸŸåŒºé—´çš„å ç”¨æƒ…å†µä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè½¬ç§»äº†ï¼Œæ¯æ¬¡å°±æšä¸¾ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ ¼å¡«çš„æ•°ï¼Œç»†èŠ‚æ¯”è¾ƒå¤šï¼Œå‚è§å¦‚ä¸‹ä»£ç ã€‚æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(4^ddn)\)&lt;/span&gt;ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb21&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb21-1&#34;&gt;&lt;a href=&#34;#cb21-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;505&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-2&#34;&gt;&lt;a href=&#34;#cb21-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n, d, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb21-3&#34;&gt;&lt;a href=&#34;#cb21-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;modint f[maxn][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;12&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb21-4&#34;&gt;&lt;a href=&#34;#cb21-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-5&#34;&gt;&lt;a href=&#34;#cb21-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; getfirst() {&lt;/span&gt;
&lt;span id=&#34;cb21-6&#34;&gt;&lt;a href=&#34;#cb21-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-7&#34;&gt;&lt;a href=&#34;#cb21-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d) {&lt;/span&gt;
&lt;span id=&#34;cb21-8&#34;&gt;&lt;a href=&#34;#cb21-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans |= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i + d)) * vis[i];&lt;/span&gt;
&lt;span id=&#34;cb21-9&#34;&gt;&lt;a href=&#34;#cb21-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-10&#34;&gt;&lt;a href=&#34;#cb21-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb21-11&#34;&gt;&lt;a href=&#34;#cb21-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb21-12&#34;&gt;&lt;a href=&#34;#cb21-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-13&#34;&gt;&lt;a href=&#34;#cb21-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb21-14&#34;&gt;&lt;a href=&#34;#cb21-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, d);&lt;/span&gt;
&lt;span id=&#34;cb21-15&#34;&gt;&lt;a href=&#34;#cb21-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb21-16&#34;&gt;&lt;a href=&#34;#cb21-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[i] == j) vis[j] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-17&#34;&gt;&lt;a href=&#34;#cb21-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][getfirst()] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-18&#34;&gt;&lt;a href=&#34;#cb21-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb21-19&#34;&gt;&lt;a href=&#34;#cb21-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(S, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * d + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb21-20&#34;&gt;&lt;a href=&#34;#cb21-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = (S &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) | (vis[i + d] &amp;lt;&amp;lt; (&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * d));&lt;/span&gt;
&lt;span id=&#34;cb21-21&#34;&gt;&lt;a href=&#34;#cb21-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (~a[i]) f[i][now] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S];&lt;/span&gt;
&lt;span id=&#34;cb21-22&#34;&gt;&lt;a href=&#34;#cb21-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; FOR(j, -d, d) {&lt;/span&gt;
&lt;span id=&#34;cb21-23&#34;&gt;&lt;a href=&#34;#cb21-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i + j &amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; || i + j &amp;gt; n || now &amp;amp; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j + d))) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-24&#34;&gt;&lt;a href=&#34;#cb21-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[i][now | (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j + d))] += f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][S];&lt;/span&gt;
&lt;span id=&#34;cb21-25&#34;&gt;&lt;a href=&#34;#cb21-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb21-26&#34;&gt;&lt;a href=&#34;#cb21-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb21-27&#34;&gt;&lt;a href=&#34;#cb21-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-28&#34;&gt;&lt;a href=&#34;#cb21-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[n][(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (d + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb21-29&#34;&gt;&lt;a href=&#34;#cb21-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-30&#34;&gt;&lt;a href=&#34;#cb21-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc132d---between-two-binary-strings&#34;&gt;ARC132D - Between Two Binary Strings&lt;/h4&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(S_{n,m}\)&lt;/span&gt; ä¸ºæ‰€æœ‰çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n+ m\)&lt;/span&gt;ï¼Œä¸”åŒ…å«æ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ª &lt;code&gt;0&lt;/code&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª &lt;code&gt;1&lt;/code&gt; çš„å­—ç¬¦ä¸²çš„é›†åˆã€‚å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¾ä¸½ç¨‹åº¦ä¸ºç›¸é‚»ä¸¤ä½ç›¸åŒçš„ä¸ªæ•°ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(S_1\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(S_2\)&lt;/span&gt; çš„ç¼–è¾‘è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(d_{S_1, S_2}\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\(S_1\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(S_2\)&lt;/span&gt; çš„æ“ä½œæ¬¡æ•°ï¼Œå…¶ä¸­æ¯æ¬¡æ“ä½œèƒ½äº¤æ¢ç›¸é‚»çš„ä¸¤ä¸ªå­—ç¬¦ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(S_1, S_2\in S_{n,m}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(S_2\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S_1\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(S_3\)&lt;/span&gt; é—´å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(d_{S_1, S_3} = d_{S_1, S_2} + d_{S_2, S_3}\)&lt;/span&gt;ã€‚ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œé—®åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; é—´çš„å­—ç¬¦ä¸²çš„æœ€å¤§ç¾ä¸½ç¨‹åº¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜æ˜¯ä¸€é“æ¯”è¾ƒå¦™çš„ç»“è®ºé¢˜ï¼šå½“ç¡®å®šç¬¬ä¸€ä¸ªå­—æ¯æ—¶ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²å¯ä»¥è´ªå¿ƒçš„è¿›è¡Œæ„é€ ï¼Œåªéœ€ä¿è¯&lt;strong&gt;å‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªé‡Œé¢ &lt;code&gt;1&lt;/code&gt; çš„ä¸ªæ•°å¤„äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ä¸­é—´&lt;/strong&gt;ã€‚ç„¶åæˆ‘ä»¬åˆè¦æœ€å¤§åŒ–ç¾ä¸½å€¼ï¼Œä¾æ­¤æ„é€ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¯æ˜ï¼šè€ƒè™‘ä¸€ä¸ªå­—ç¬¦ä¸²å°±æ˜¯äºŒç»´å¹³é¢ä¸Šä¸€æ¡ä» &lt;span class=&#34;math inline&#34;&gt;\((0, 0)\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\((n, m)\)&lt;/span&gt; çš„è·¯å¾„ã€‚æŸä¸€ä½æ˜¯ &lt;code&gt;1&lt;/code&gt; è¡¨ç¤ºå‘ä¸Šèµ°ä¸€æ ¼ï¼ŒæŸä¸€ä½æ˜¯ &lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºå‘å³èµ°ä¸€æ ¼ã€‚åŒæ—¶ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²çš„ç¾ä¸½å€¼å°±æ˜¯é•¿åº¦å‡ä¸€å†å‡æ‹ç‚¹ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬å‘ç°ï¼Œäº¤æ¢ä¸¤ä¸ªç›¸é‚»çš„ &lt;code&gt;01&lt;/code&gt; ç›¸å½“äºæ˜¯å°†ä¸€ä¸ªæ‹ç‚¹ç¿»æŠ˜ï¼Œæ•…åœ¨å¹³é¢ä¸Šå¤„äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä¸­é—´çš„è·¯å¾„éƒ½æ˜¯å¯è¡Œçš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å…¶å®å°±æ˜¯ï¼Œèƒ½ä¸æ‹å°±ä¸æ‹ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb22&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb22-1&#34;&gt;&lt;a href=&#34;#cb22-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-2&#34;&gt;&lt;a href=&#34;#cb22-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn], t[maxn];&lt;/span&gt;
&lt;span id=&#34;cb22-3&#34;&gt;&lt;a href=&#34;#cb22-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb22-4&#34;&gt;&lt;a href=&#34;#cb22-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-5&#34;&gt;&lt;a href=&#34;#cb22-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb22-6&#34;&gt;&lt;a href=&#34;#cb22-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb22-7&#34;&gt;&lt;a href=&#34;#cb22-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), read(t + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-8&#34;&gt;&lt;a href=&#34;#cb22-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, len = n + m;&lt;/span&gt;
&lt;span id=&#34;cb22-9&#34;&gt;&lt;a href=&#34;#cb22-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(init, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-10&#34;&gt;&lt;a href=&#34;#cb22-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s0 = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, t0 = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, x0 = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-11&#34;&gt;&lt;a href=&#34;#cb22-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (init != s[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &amp;amp;&amp;amp; init != t[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-12&#34;&gt;&lt;a href=&#34;#cb22-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-13&#34;&gt;&lt;a href=&#34;#cb22-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = init;&lt;/span&gt;
&lt;span id=&#34;cb22-14&#34;&gt;&lt;a href=&#34;#cb22-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, len) {&lt;/span&gt;
&lt;span id=&#34;cb22-15&#34;&gt;&lt;a href=&#34;#cb22-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            s0 += (s[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;), t0 += (t[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-16&#34;&gt;&lt;a href=&#34;#cb22-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-17&#34;&gt;&lt;a href=&#34;#cb22-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x0 + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;= max(s0, t0)) ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb22-18&#34;&gt;&lt;a href=&#34;#cb22-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; now = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-19&#34;&gt;&lt;a href=&#34;#cb22-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb22-20&#34;&gt;&lt;a href=&#34;#cb22-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x0 &amp;gt;= min(s0, t0)) ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb22-21&#34;&gt;&lt;a href=&#34;#cb22-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; now = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-22&#34;&gt;&lt;a href=&#34;#cb22-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb22-23&#34;&gt;&lt;a href=&#34;#cb22-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ++x0;&lt;/span&gt;
&lt;span id=&#34;cb22-24&#34;&gt;&lt;a href=&#34;#cb22-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb22-25&#34;&gt;&lt;a href=&#34;#cb22-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        chkmax(ans, cnt - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-26&#34;&gt;&lt;a href=&#34;#cb22-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb22-27&#34;&gt;&lt;a href=&#34;#cb22-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb22-28&#34;&gt;&lt;a href=&#34;#cb22-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-29&#34;&gt;&lt;a href=&#34;#cb22-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc134&#34;&gt;ARC134&lt;/h3&gt;
&lt;h4 id=&#34;arc134c---the-majority&#34;&gt;ARC134C - The Majority&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·ç›’å­ï¼Œåˆå§‹å…¨ä¸ºç©ºã€‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ç§é¢œè‰²çš„çƒï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§é¢œè‰²æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸ªçƒï¼ŒåŒç§é¢œè‰²çš„çƒä¸åŒºåˆ†ã€‚ç°è¦å°†æ‰€æœ‰çƒæ”¾å…¥ç›’å­é‡Œï¼Œè¦æ±‚æ¯ä¸ªç›’å­é‡Œé¢ï¼Œé¢œè‰² &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„çƒçš„ä¸ªæ•°è¦å åˆ°ä¸€åŠä»¥ä¸Šï¼ˆä¸¥æ ¼ï¼‰ã€‚é—®æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå·§å¦™çš„è®¡æ•°å¥—è·¯ï¼ˆé›¾ï¼‰ï¼Œå³æˆ‘ä»¬è€ƒè™‘å°† &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; é¢œè‰²çš„çƒå’Œå…¶ä»–çš„çƒä¸€ä¸€é…å¯¹ï¼Œå³å°† &lt;span class=&#34;math inline&#34;&gt;\(a_1:=a_1 - \sum_{i = 2}^na_i\)&lt;/span&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\([2, n]\)&lt;/span&gt; é¢œè‰²çš„çƒæ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ªç›’å­é‡Œï¼ˆå¯ä»¥æœ‰ç©ºç›’ï¼‰ï¼Œæ±‚å‡ºæ–¹æ¡ˆæ•°ï¼Œç„¶åå†ä¹˜ä¸Šå°† &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; é¢œè‰²çš„çƒæ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä¸ªç›’å­çš„æ–¹æ¡ˆæ•°ï¼ˆä¸å…è®¸æœ‰ç©ºç›’ï¼‰ï¼Œå³ &lt;span class=&#34;math display&#34;&gt;\[
\binom{a_1 - \sum_{i = 2}^na_i}{K + 1}\prod_{i=2}^n\binom{a_i + K + 1}{K+1}
\]&lt;/span&gt; æ­£ç¡®æ€§æ˜¾ç„¶ï¼Œæ€æƒ³è¾ƒä¸ºé‡è¦ï¼Œmarkedã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc134d---concatenate-subsequences&#34;&gt;ARC134D - Concatenate Subsequences&lt;/h4&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2N\)&lt;/span&gt; çš„æ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ã€‚ç°è¦æ„é€  &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä¸€ä¸ªå­åºåˆ—ï¼Œæ–¹æ¡ˆä¸ºï¼šä» &lt;span class=&#34;math inline&#34;&gt;\(1, 2, \cdots, N\)&lt;/span&gt; ä¸­å–å‡ºä¸€ä¸ªå­åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(x_1, \cdots, x_k\)&lt;/span&gt;ï¼Œç„¶åå–å‡º &lt;span class=&#34;math inline&#34;&gt;\(a_{x_1}, a_{x_2},\cdots, a_{x_k}, a_{x_1 + N}, a_{x_2 +N},\cdots, a_{x_k + N}\)&lt;/span&gt;ã€‚è¦æ±‚æ„é€ å‡ºæ¥çš„è¿™ä¸ªåºåˆ—å­—å…¸åºæœ€å°ï¼Œè¾“å‡ºè¿™ä¸ªåºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;å­—å…¸åºé—®é¢˜ä¸€èˆ¬è€ƒè™‘è´ªå¿ƒã€‚æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A = a_1, a_2, \cdots, a_N\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B = a_{N+ 1},\cdots, a_{2N}\)&lt;/span&gt;ï¼Œå– &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­çš„æœ€å°å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åˆ™å¦‚æœå­˜åœ¨ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(A_i = X\land B_i\le A_i\)&lt;/span&gt;ï¼Œåˆ™æŠŠåªæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(B_i\)&lt;/span&gt; å–èµ°å°±ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å‡è®¾å¯¹äºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_i = X\)&lt;/span&gt; éƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A_i&amp;lt;B_i\)&lt;/span&gt;ï¼Œå¯ä»¥è¯æ˜æŠŠä»–ä»¬å…¨éƒ¨å–èµ°æ˜¯æœ€ä¼˜çš„ï¼Œè€Œåå°±éœ€è¦è€ƒè™‘å–å‰©ä¸‹çš„å…ƒç´ äº†ã€‚ä»¤æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(A_i = X\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å‡åºæ„æˆåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(y_1,\cdots, y_k\)&lt;/span&gt;ã€‚æ¥ä¸‹æ¥è€ƒè™‘çš„å°±æ˜¯æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(y_k&amp;lt;j\le N\land A_j\le B_{y_1}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°ï¼Œå°†å…¶æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\((A_j, j)\)&lt;/span&gt; å‡åºæ’åºä¹‹åï¼Œæˆ‘ä»¬ä¼šä¼˜å…ˆå–èµ°æ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(A_j &amp;lt; B_{y_1}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæœ€åå°±æ˜¯è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(A_j = B_{y_1}\)&lt;/span&gt; çš„æƒ…å†µï¼Œè¿™æ—¶å€™å°±éœ€è¦è€ƒè™‘ç¬¬ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(B_{y_m}\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(B_{y_m}\ne B_{y_1}\)&lt;/span&gt;ï¼Œå³å¦‚æœåŠ è¿›å»èƒ½ä½¿å¾—å­—å…¸åºæ›´å°ï¼Œé‚£å°±åŠ ï¼Œå¦åˆ™å°±ä¸è¦åŠ ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯è¿™é¢˜å°±åšå®Œäº†ï¼Œç»†èŠ‚æœ‰ç‚¹çƒ¦ï¼Œ&lt;a href=&#34;https://atcoder.jp/contests/arc134/submissions/29161132&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;arc137&#34;&gt;ARC137&lt;/h3&gt;
&lt;p&gt;A + B + Dï¼Œrk281ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc137a---coprime-pair&#34;&gt;ARC137A - Coprime Pair&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(1\le L &amp;lt; R\le 10^{18}\)&lt;/span&gt;ï¼Œæ±‚ä¸€å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(L\le x\le y\le R\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\gcd(x,y) = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåœ¨é¢˜ç›®çº¦æŸä¸‹ï¼Œç´ æ•°é—´éš”è‡³å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(K= 1500\)&lt;/span&gt; å·¦å³ï¼Œæ‰€ä»¥ç›´æ¥ä» &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; å³è¾¹å’Œ &lt;span class=&#34;math inline&#34;&gt;\(R\)&lt;/span&gt; å·¦è¾¹æš´åŠ›æ‰¾ç­”æ¡ˆå³å¯ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(K^2\log R)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œè¿™ä¸ªä¸œè¥¿ä¼¼ä¹æœ‰æ›´ç´§çš„ç•Œï¼Œä½†æ˜¯ atcoder å®˜æ–¹é¢˜è§£æˆ‘çœ‹ä¸æ‡‚ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc137b---count-1s&#34;&gt;ARC137B - Count 1â€™s&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ª 0-1 ä¸²ï¼Œå¯ä»¥å°†ä¸€ä¸ªå­æ®µç¿»è½¬ä¸€æ¬¡ï¼Œé—®æœ€åèƒ½è¾¾åˆ°å¤šå°‘ç§ä¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯ä»¥è§‚å¯Ÿåˆ°æœ€åè¾¾åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°è‚¯å®šæ˜¯è¿ç»­çš„ä¸€æ®µã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è€ƒè™‘æ±‚å‡º &lt;em&gt;&lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä¸ªæ•°å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°&lt;/em&gt; çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\max + \min + 1\)&lt;/span&gt; å³ä¸ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc137c---distinct-numbers&#34;&gt;ARC137C - Distinct Numbers&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªå…ƒç´ çš„æ•°é›† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä¿è¯å…ƒç´ ä¸¤ä¸¤ä¸åŒã€‚å…ˆæ‰‹åæ‰‹åšå¼ˆï¼Œè½®åˆ°æ¯äººæ“ä½œæ—¶ï¼Œå°†æœ€å¤§çš„æ•°å–å‡ºï¼Œæ¢æˆä¸€ä¸ªæ›´å°çš„éè´Ÿæ•´æ•°å†å¡å›å»ï¼Œéœ€ä¿è¯å…ƒç´ ä¸¤ä¸¤ä¸åŒçš„æ€§è´¨ä¸è¢«ç ´åã€‚ç¬¬ä¸€ä¸ªæ²¡åŠæ³•è¿›è¡Œæ“ä½œçš„ç©å®¶è¾“ã€‚é—®èµ¢å®¶ã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºé¢˜ï¼ˆï¼Ÿï¼‰ã€‚åˆ†ç±»è®¨è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_n - a_{n-1}&amp;gt;1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(a_1, a_2,\cdots, a_{n-1}, a_{n-1} +1\)&lt;/span&gt; çš„å±€é¢ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥å…¶ä¸ºå¿…èƒœæ€ï¼Œé‚£ä¹ˆå…¶å¯ä»¥è½¬ç§»åˆ°ä¸€ä¸ªå¿…è´¥æ€ï¼ŒåŸåºåˆ—ä¹Ÿå¯ä»¥ç›´æ¥è½¬ç§»åˆ°é‚£ä¸ªå¿…è´¥æ€ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥å…¶ä¸ºå¿…è´¥æ€ï¼Œé‚£ä¹ˆåŸåºåˆ—å¯ä»¥ç›´æ¥è½¬ç§»åˆ°ä»–ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ Alice å¿…èƒœã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_n - a_{n-1} = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åŒæ–¹éƒ½è¦å°½å¯èƒ½ç»´æŒè¿™ä¸ªçŠ¶æ€ï¼Œå¦åˆ™å°±å˜æˆå¯¹æ‰‹å¿…èƒœã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æ“ä½œçš„æ—¶å€™ &lt;span class=&#34;math inline&#34;&gt;\(a_{n} - a_{n-1}\)&lt;/span&gt; éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚æ¯æ¬¡æ“ä½œåä¼šå‘ç°åŸæ¥çš„æ¬¡å¤§å€¼å˜æˆäº†æ–°çš„æœ€å¤§å€¼ã€‚åˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\(a_n - n\)&lt;/span&gt; çš„å¥‡å¶æ€§å³å¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb23&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb23-1&#34;&gt;&lt;a href=&#34;#cb23-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-2&#34;&gt;&lt;a href=&#34;#cb23-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n;&lt;/span&gt;
&lt;span id=&#34;cb23-3&#34;&gt;&lt;a href=&#34;#cb23-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb23-4&#34;&gt;&lt;a href=&#34;#cb23-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb23-5&#34;&gt;&lt;a href=&#34;#cb23-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb23-6&#34;&gt;&lt;a href=&#34;#cb23-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb23-7&#34;&gt;&lt;a href=&#34;#cb23-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[n] - a[n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) print(&lt;span class=&#34;st&#34;&gt;&amp;quot;Alice&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-8&#34;&gt;&lt;a href=&#34;#cb23-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((n + a[n] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) print(&lt;span class=&#34;st&#34;&gt;&amp;quot;Alice&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-9&#34;&gt;&lt;a href=&#34;#cb23-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; print(&lt;span class=&#34;st&#34;&gt;&amp;quot;Bob&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb23-10&#34;&gt;&lt;a href=&#34;#cb23-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-11&#34;&gt;&lt;a href=&#34;#cb23-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc137d---prefix-xors&#34;&gt;ARC137D - Prefix XORs&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šæ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\le 10^6\)&lt;/span&gt;ï¼Œä»¥åŠæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots, m\)&lt;/span&gt;ï¼Œæ±‚å‡ºç»è¿‡ä¸‹é¢æ“ä½œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡ä¹‹å &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(B_i = \displaystyle\bigoplus_{i=1}^i A_i\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(\oplus\)&lt;/span&gt; ä»£è¡¨å¼‚æˆ–ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A = B\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯¹äºä¸€ä¸ªå›ºå®šçš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; è´¡çŒ®äº†å¤šå°‘æ¬¡ï¼Œä¸‹é¢å‡å®š &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä» &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å§‹ç¼–å·ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä½ å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(A_n\)&lt;/span&gt; ä¼šè´¡çŒ® &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{n - i + k - 1}{k - 1}\)&lt;/span&gt; æ¬¡ã€‚ä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬åªéœ€è¦çŸ¥é“ä»–çš„å¥‡å¶æ€§ï¼Œå…¶ä¸ºå¥‡æ•°å°±ä¼šäº§ç”Ÿè´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¢å¡æ–¯å®šç†çš„ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¿›åˆ¶å½¢å¼ï¼Œå‘ç°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(n - i + k - 1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„è¶…é›†æ—¶ï¼ŒLucas çš„å¼å­é‡Œé¢æ‰ä¸ä¼šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; é¡¹ï¼Œæ‰ä¼šäº§ç”Ÿ &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{n - i + k - 1}{k - 1}\)&lt;/span&gt; çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ³¨æ„åˆ°ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n - i + k - 1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; çš„è¶…é›†ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(n - i\)&lt;/span&gt; æŒ‰ä½ä¸ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; å¿…ç„¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚é‚£ä¹ˆå°±è€ƒè™‘åšä¸€ä¸ªé«˜ç»´å‰ç¼€å’Œï¼Œç„¶åå¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; æŸ¥è¯¢çš„æ—¶å€™æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; å–è¡¥é›†å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb24&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb24-1&#34;&gt;&lt;a href=&#34;#cb24-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) | &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-2&#34;&gt;&lt;a href=&#34;#cb24-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a[maxn], n, m;&lt;/span&gt;
&lt;span id=&#34;cb24-3&#34;&gt;&lt;a href=&#34;#cb24-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb24-4&#34;&gt;&lt;a href=&#34;#cb24-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb24-5&#34;&gt;&lt;a href=&#34;#cb24-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb24-6&#34;&gt;&lt;a href=&#34;#cb24-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb24-7&#34;&gt;&lt;a href=&#34;#cb24-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    reverse(a, a + n);&lt;/span&gt;
&lt;span id=&#34;cb24-8&#34;&gt;&lt;a href=&#34;#cb24-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;19&lt;/span&gt;) FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;amp; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)) a[i] ^= a[i ^ (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)];&lt;/span&gt;
&lt;span id=&#34;cb24-9&#34;&gt;&lt;a href=&#34;#cb24-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) print(a[(k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ^ ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)], &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb24-10&#34;&gt;&lt;a href=&#34;#cb24-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-11&#34;&gt;&lt;a href=&#34;#cb24-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;arc137e---bakery&#34;&gt;ARC137E - Bakery&lt;/h4&gt;
&lt;p&gt;é¢˜æ„ï¼šè§„åˆ’é¢åŒ…åº—ï¼Œå¤©æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1,2,\cdots, N\)&lt;/span&gt;ã€‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ä¸ªé¢åŒ…å¸ˆï¼Œç¼–å·ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œé›‡ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å¼€æ”¯æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(C_i\)&lt;/span&gt;ï¼Œç„¶åå…¶ä¼šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(L_i,\cdots, R_i\)&lt;/span&gt; æ¯å¤©åšä¸€ä¸ªé¢åŒ…ã€‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©é¢åŒ…å¸ˆä¸€å…±åšäº† &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; ä¸ªé¢åŒ…çš„è¯ï¼Œå”®å‡ºçš„å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\min(A_i,x_i)\)&lt;/span&gt; ä¸ªé¢åŒ…ã€‚æ¯ä¸ªé¢åŒ…è·åˆ© &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt;ï¼Œæ±‚æœ€å¤§åˆ©æ¶¦ï¼ˆå”®å‡ºé¢åŒ…çš„è·åˆ©å‡å»é›‡ä½£é¢åŒ…å¸ˆçš„å¼€æ”¯ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le N,M\le 2000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le D,C_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€çœ¼è€ƒè™‘å»ºè´¹ç”¨æµï¼Œç„¶è€Œç”¨é¢åŒ…æ¥æµä¼¼ä¹ä¸å¥½å¤„ç†é¢åŒ…å¸ˆçš„å¼€æ”¯ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆåªèƒ½æ‹¿é¢åŒ…å¸ˆæ¥æµäº†ï¼Œå¯¹äºé¢åŒ…çš„è´¡çŒ®ï¼Œå°±è€ƒè™‘åœ¨å¤©æ•°ä¹‹é—´æµã€‚å…·ä½“åœ°ï¼šå»ºç«‹å›¾ï¼Œç¼–å·ä» &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(j\to(j - 1)\)&lt;/span&gt;ï¼Œæµé‡ &lt;span class=&#34;math inline&#34;&gt;\(A_j\)&lt;/span&gt;ï¼Œè´¹ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(-D\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†å¤„ç†äº§ç”Ÿè´¡çŒ®çš„é¢åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(j\to (j-1)\)&lt;/span&gt;ï¼Œæµé‡ &lt;span class=&#34;math inline&#34;&gt;\(M - A_j\)&lt;/span&gt;ï¼Œè´¹ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†è¦è®©å‰©ä¸‹äº§ç”Ÿä¸äº†è´¡çŒ®çš„æµè¿‡å»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\((L_{i} - 1)\to R_i\)&lt;/span&gt;ï¼Œæµé‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œè´¹ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(C_i\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†å¤„ç†é¢åŒ…å¸ˆçš„è´¹ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šå›¾çš„&lt;strong&gt;æœ€å°è´¹ç”¨å¾ªç¯æµ&lt;/strong&gt;çš„è´¹ç”¨å°±æ˜¯ç­”æ¡ˆã€‚ç„¶è€Œæˆ‘ä»¬ä¸ä¼šç›´çƒåšè´¹ç”¨å¾ªç¯æµï¼Œæ‰€ä»¥è€ƒè™‘ä¸€ä¸‹æ€ä¹ˆè½¬åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œé€‰ä¸€ä¸ªé¢åŒ…å¸ˆç›¸å½“äºé€‰äº†ä¸€ä¸ªç¯ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯ä¼šé€‰&lt;strong&gt;è´Ÿç¯&lt;/strong&gt;ï¼ˆå¦åˆ™ä¸å¦‚ä¸é€‰ï¼‰ã€‚é‚£ä¹ˆå°±å¯¹æ‰€æœ‰çš„è´Ÿæƒè¾¹ &lt;span class=&#34;math inline&#34;&gt;\((u,v,w,c)\)&lt;/span&gt; è¿›è¡Œå¦‚ä¸‹å¤„ç†ï¼šåŠ è¾¹ &lt;span class=&#34;math inline&#34;&gt;\((s, v, w, 0)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((u, t, w, 0)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((v, u, w, -c)\)&lt;/span&gt;ï¼Œç„¶åè´¹ç”¨é¢„å…ˆåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ã€‚å‰©ä¸‹çš„æ­£æƒå’Œ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æƒè¾¹ç…§æ—§ä¸å˜ï¼Œç„¶åè·‘ä¸€ä¸ª&lt;strong&gt;æµé‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; çš„æœ€å°è´¹ç”¨æµ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·åšçš„æ­£ç¡®æ€§æ˜¯ï¼šå…ˆå‡è®¾è´Ÿæƒè¾¹å…¨éƒ¨æµæ»¡ï¼Œç„¶åè‹¥æµäº† &lt;span class=&#34;math inline&#34;&gt;\(s\to v\to u\to t\)&lt;/span&gt; ç›¸å½“äºé€€æ‰åŸæ¥çš„æµã€‚å‰©ä¸‹å°±æ˜¯å’Œæ­£æƒè¾¹è¿ç¯è®¡ç®—äº†ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œåœ¨æœ¬é¢˜é‡Œé¢ï¼Œç”±äºå›¾ç»“æ„çš„ç‰¹æ®Šæ€§ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((s,v,w,0)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((u,t,w,0)\)&lt;/span&gt; æ˜¯æ²¡å¿…è¦åŠ çš„ï¼Œå› ä¸ºå¯¹äºä¸€ä¸ªç‚¹ï¼Œå…¶ä¸€å®šä¼šåŒæ—¶è¿ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œæœ€å°è´¹ç”¨æœ€å¤§æµå‘Šè¯‰æˆ‘ä»¬ä¼šä¼˜å…ˆæµæ»¡ &lt;span class=&#34;math inline&#34;&gt;\(s\to u\to t\)&lt;/span&gt;ï¼Œå¯¹è´¹ç”¨ä¸äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥æˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸¢æ‰è¶…çº§æºæ±‡ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œè¿è¾¹æ–¹å¼å¦‚ä¸‹ï¼šå¯¹æ¯ä¸ªå¤©è¿ &lt;span class=&#34;math inline&#34;&gt;\((j-1,j,A_j,D)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((j-1,j,M - A_j,0)\)&lt;/span&gt;ï¼Œå†å¯¹æ¯ä¸ªé¢åŒ…å¸ˆè¿ &lt;span class=&#34;math inline&#34;&gt;\((L_i - 1, R_i, 1, C_i)\)&lt;/span&gt;ï¼Œè·‘ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æµé‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; çš„æœ€å°è´¹ç”¨æµå³å¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬é¢˜å¡æœ´ç´ çš„ EK + SPFA è´¹ç”¨æµï¼Œæ­£è§£æ˜¯åŸå§‹å¯¹å¶ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(N^2\log N)\)&lt;/span&gt;ï¼Œè§† &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; åŒé˜¶ã€‚å¦‚æœä½ æ˜¯å’Œæˆ‘ä¸€æ ·çš„æ‡’ç‹—çš„è¯å¯ä»¥ç”¨ä¸€ä¸‹ ACL å®˜æ–¹çš„è´¹ç”¨æµï¼Œç”¨çš„å°±æ˜¯åŸå§‹å¯¹å¶ï¼Œå¾ˆå¿«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb25&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb25-1&#34;&gt;&lt;a href=&#34;#cb25-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-2&#34;&gt;&lt;a href=&#34;#cb25-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;2005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-3&#34;&gt;&lt;a href=&#34;#cb25-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; N, M, D;&lt;/span&gt;
&lt;span id=&#34;cb25-4&#34;&gt;&lt;a href=&#34;#cb25-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb25-5&#34;&gt;&lt;a href=&#34;#cb25-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb25-6&#34;&gt;&lt;a href=&#34;#cb25-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(N, M, D);&lt;/span&gt;
&lt;span id=&#34;cb25-7&#34;&gt;&lt;a href=&#34;#cb25-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    atcoder::mcf_graph&amp;lt;ll, ll&amp;gt; G(N + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb25-8&#34;&gt;&lt;a href=&#34;#cb25-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-9&#34;&gt;&lt;a href=&#34;#cb25-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, N) {&lt;/span&gt;
&lt;span id=&#34;cb25-10&#34;&gt;&lt;a href=&#34;#cb25-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a; read(a);&lt;/span&gt;
&lt;span id=&#34;cb25-11&#34;&gt;&lt;a href=&#34;#cb25-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G.add_edge(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i, a, D), G.add_edge(i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i, M - a, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb25-12&#34;&gt;&lt;a href=&#34;#cb25-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * D * a;&lt;/span&gt;
&lt;span id=&#34;cb25-13&#34;&gt;&lt;a href=&#34;#cb25-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb25-14&#34;&gt;&lt;a href=&#34;#cb25-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, M) {&lt;/span&gt;
&lt;span id=&#34;cb25-15&#34;&gt;&lt;a href=&#34;#cb25-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, r, c; read(l, r, c);&lt;/span&gt;
&lt;span id=&#34;cb25-16&#34;&gt;&lt;a href=&#34;#cb25-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G.add_edge(l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, c);&lt;/span&gt;
&lt;span id=&#34;cb25-17&#34;&gt;&lt;a href=&#34;#cb25-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb25-18&#34;&gt;&lt;a href=&#34;#cb25-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans - G.flow(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, N, M).second);&lt;/span&gt;
&lt;span id=&#34;cb25-19&#34;&gt;&lt;a href=&#34;#cb25-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-20&#34;&gt;&lt;a href=&#34;#cb25-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;arc138&#34;&gt;ARC138&lt;/h3&gt;
&lt;h4 id=&#34;arc138c---rotate-and-play-game&#34;&gt;ARC138C - Rotate and Play Game&lt;/h4&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥é€šè¿‡è§‚å¯Ÿå¤§æ ·ä¾‹å‘ç°ï¼ŒSnuke ä¸€å®šä¼šå–èµ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(n / 2\)&lt;/span&gt; ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘å¯¹äºä¸€ä¸ªé™æ€çš„åºåˆ—ï¼ŒSnuke å¦‚ä½•èƒ½å¤ŸæˆåŠŸå–èµ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(n/2\)&lt;/span&gt; ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è‹¥è§†æœ€å¤§çš„ï¼ˆè¦å–èµ°çš„ï¼‰ &lt;span class=&#34;math inline&#34;&gt;\(n/2\)&lt;/span&gt; ä¸ªå…ƒç´ ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œå‰©ä½™çš„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„è¯ï¼Œç›¸å½“äºå¯¹äºæ¯ä¸€ä¸ªä½ç½®ï¼Œå‰ç¼€å’Œéƒ½ä¸èƒ½ä¸ºè´Ÿï¼ˆè™½ç„¶åªæ˜¯å……åˆ†ï¼Œä½†ä¸å¿…è¦ï¼‰ã€‚è¯æ˜ï¼šæ¯ä¸€è½®ä¸­ï¼ŒSnuke å–èµ°æœ€é å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼ˆè‚¯å®šè¦é¿å…ä»–è¢«æŠ¢èµ°ï¼‰ï¼Œç„¶å Mr.Â Min ç…§å¸¸å–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(+1\)&lt;/span&gt;ï¼Œäºæ˜¯ä¹åŸåºåˆ—å‰ç¼€å’Œçš„æ€§è´¨è‚¯å®šè¿˜æ˜¯æ»¡è¶³çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨é—®é¢˜å°±å˜ä¸ºå¦‚ä½•æ±‚å¾ªç¯ä½ç§»çš„åç§»é‡ã€‚æ³¨æ„åˆ°æ ¹æ®æ‹¬å·åºåˆ—çš„æ€§è´¨ï¼Œå…¶ä¸€å®šæœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå°±å°†è¿™ä¸ªåºåˆ—å¤åˆ¶ä¸€ä»½ï¼Œç„¶åçœ‹ &lt;span class=&#34;math inline&#34;&gt;\([i, i + n - 1]\)&lt;/span&gt; ä¸­çš„å‰ç¼€å’Œæœ€å°å€¼æ˜¯å¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge S_i\)&lt;/span&gt; å³å¯ã€‚å¯ä»¥ä½¿ç”¨ ST è¡¨æˆ–è€…æ»‘åŠ¨çª—å£ä¸€ç±»çš„æ¥åšã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb26&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb26-1&#34;&gt;&lt;a href=&#34;#cb26-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-2&#34;&gt;&lt;a href=&#34;#cb26-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-3&#34;&gt;&lt;a href=&#34;#cb26-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb26-4&#34;&gt;&lt;a href=&#34;#cb26-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb26-5&#34;&gt;&lt;a href=&#34;#cb26-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-6&#34;&gt;&lt;a href=&#34;#cb26-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-7&#34;&gt;&lt;a href=&#34;#cb26-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-8&#34;&gt;&lt;a href=&#34;#cb26-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, st[&lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;][maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], lg[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb26-9&#34;&gt;&lt;a href=&#34;#cb26-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-10&#34;&gt;&lt;a href=&#34;#cb26-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;
&lt;span id=&#34;cb26-11&#34;&gt;&lt;a href=&#34;#cb26-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll val; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; id;&lt;/span&gt;
&lt;span id=&#34;cb26-12&#34;&gt;&lt;a href=&#34;#cb26-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} a[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb26-13&#34;&gt;&lt;a href=&#34;#cb26-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb26-14&#34;&gt;&lt;a href=&#34;#cb26-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb26-15&#34;&gt;&lt;a href=&#34;#cb26-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb26-16&#34;&gt;&lt;a href=&#34;#cb26-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; a[i].val, a[i].id = i;&lt;/span&gt;
&lt;span id=&#34;cb26-17&#34;&gt;&lt;a href=&#34;#cb26-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, [](&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a.val &amp;gt; b.val;});&lt;/span&gt;
&lt;span id=&#34;cb26-18&#34;&gt;&lt;a href=&#34;#cb26-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll sum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, tmp = a[n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;].val;&lt;/span&gt;
&lt;span id=&#34;cb26-19&#34;&gt;&lt;a href=&#34;#cb26-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sum += a[i].val, a[i].val = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-20&#34;&gt;&lt;a href=&#34;#cb26-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, (n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[i].val = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-21&#34;&gt;&lt;a href=&#34;#cb26-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, [](&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a.id &amp;lt; b.id;});&lt;/span&gt;
&lt;span id=&#34;cb26-22&#34;&gt;&lt;a href=&#34;#cb26-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) a[n + i] = a[i];&lt;/span&gt;
&lt;span id=&#34;cb26-23&#34;&gt;&lt;a href=&#34;#cb26-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    lg[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-24&#34;&gt;&lt;a href=&#34;#cb26-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i] = st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + a[i].val, lg[i] = lg[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-25&#34;&gt;&lt;a href=&#34;#cb26-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;19&lt;/span&gt;) FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, (n &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) st[j][i] = max(st[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i], st[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i + (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))]);&lt;/span&gt;
&lt;span id=&#34;cb26-26&#34;&gt;&lt;a href=&#34;#cb26-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;31&lt;/span&gt; - &lt;span class=&#34;fu&#34;&gt;__builtin_clz&lt;/span&gt;(n);&lt;/span&gt;
&lt;span id=&#34;cb26-27&#34;&gt;&lt;a href=&#34;#cb26-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[i].val == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb26-28&#34;&gt;&lt;a href=&#34;#cb26-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ret = max(st[s][i], st[s][i + n - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; s)]);&lt;/span&gt;
&lt;span id=&#34;cb26-29&#34;&gt;&lt;a href=&#34;#cb26-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ret &amp;lt;= st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cout &amp;lt;&amp;lt; i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; sum &amp;lt;&amp;lt; endl, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-30&#34;&gt;&lt;a href=&#34;#cb26-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb26-31&#34;&gt;&lt;a href=&#34;#cb26-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-32&#34;&gt;&lt;a href=&#34;#cb26-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ³¨æ„ä»£ç é‡Œé¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(\pm 1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\min/\max\)&lt;/span&gt; æ€§ä¼¼ä¹å’Œé¢˜è§£ç›¸åï¼ˆåæ­£æ˜¯å¯¹ç§°çš„ï¼Œä¸ç®¡äº†ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;arc138d---differ-by-k-bits&#34;&gt;ARC138D - Differ by K bits&lt;/h4&gt;
&lt;p&gt;æ’äº†æ´›è°·åŸé¢˜ &lt;a href=&#34;https://www.luogu.com.cn/problem/P7949&#34;&gt;P7949&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜ä¸­ï¼Œæš´åŠ›çš„å¤æ‚åº¦è²Œä¼¼æ˜¯å¯¹çš„ï¼Œå…·ä½“åŸå› ä¸è¯¦ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb27&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb27-1&#34;&gt;&lt;a href=&#34;#cb27-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-2&#34;&gt;&lt;a href=&#34;#cb27-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb27-3&#34;&gt;&lt;a href=&#34;#cb27-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-4&#34;&gt;&lt;a href=&#34;#cb27-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb27-5&#34;&gt;&lt;a href=&#34;#cb27-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-6&#34;&gt;&lt;a href=&#34;#cb27-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt; | &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-7&#34;&gt;&lt;a href=&#34;#cb27-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb27-8&#34;&gt;&lt;a href=&#34;#cb27-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; a, b;&lt;/span&gt;
&lt;span id=&#34;cb27-9&#34;&gt;&lt;a href=&#34;#cb27-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-10&#34;&gt;&lt;a href=&#34;#cb27-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x) {&lt;/span&gt;
&lt;span id=&#34;cb27-11&#34;&gt;&lt;a href=&#34;#cb27-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a.push_back(x); vis[x] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-12&#34;&gt;&lt;a href=&#34;#cb27-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a.size() == (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n)) {&lt;/span&gt;
&lt;span id=&#34;cb27-13&#34;&gt;&lt;a href=&#34;#cb27-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;Yes&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-14&#34;&gt;&lt;a href=&#34;#cb27-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;x : a)&lt;/span&gt;
&lt;span id=&#34;cb27-15&#34;&gt;&lt;a href=&#34;#cb27-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot; &amp;quot;&lt;/span&gt;; exit(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-16&#34;&gt;&lt;a href=&#34;#cb27-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb27-17&#34;&gt;&lt;a href=&#34;#cb27-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;c : b) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[c ^ x]) dfs(c ^ x);&lt;/span&gt;
&lt;span id=&#34;cb27-18&#34;&gt;&lt;a href=&#34;#cb27-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-19&#34;&gt;&lt;a href=&#34;#cb27-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb27-20&#34;&gt;&lt;a href=&#34;#cb27-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-21&#34;&gt;&lt;a href=&#34;#cb27-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb27-22&#34;&gt;&lt;a href=&#34;#cb27-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb27-23&#34;&gt;&lt;a href=&#34;#cb27-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k % &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-24&#34;&gt;&lt;a href=&#34;#cb27-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;fu&#34;&gt;__builtin_popcount&lt;/span&gt;(i) == k) b.push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb27-25&#34;&gt;&lt;a href=&#34;#cb27-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb27-26&#34;&gt;&lt;a href=&#34;#cb27-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-27&#34;&gt;&lt;a href=&#34;#cb27-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è€ƒè™‘æ­£è§£ï¼šé¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œå…¶ä¸€å®šæ— è§£ã€‚å› ä¸ºä¸å¯èƒ½æ‰€æœ‰æ•°çš„ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{popcount}\)&lt;/span&gt; éƒ½æ˜¯å¶æ•°ã€‚ä¸” &lt;span class=&#34;math inline&#34;&gt;\(k = n\)&lt;/span&gt; çš„æƒ…å†µä¹Ÿæ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬è‹¥æ˜¯å°† &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{popcount}(x) = k\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ’å…¥çº¿æ€§åŸº &lt;span class=&#34;math inline&#34;&gt;\(\mathfrak B\)&lt;/span&gt;ï¼Œåˆ™å¯ä»¥å°†æˆåŠŸæ’å…¥çš„æ•°çœ‹ä½œä¸€ç»„åŸºåº•ï¼Œè€Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(|\mathfrak B|&amp;lt;n\)&lt;/span&gt; æ˜¾ç„¶ä¹Ÿæ— è§£ã€‚å¦åˆ™æˆ‘ä»¬æ€»èƒ½æ„é€ å‡ºç­”æ¡ˆï¼šåªéœ€è¦æ»¡è¶³æ„æˆç›¸é‚»ä¸¤ä¸ªæ•°çš„çº¿æ€§ç»„åˆä¸­ï¼Œæœ‰ä¸€é¡¹ä¸ä¸€æ ·å³å¯ï¼Œå…·ä½“è¿™ä¸ªå¯ä»¥ç”¨æ ¼é›·ç å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb28&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb28-1&#34;&gt;&lt;a href=&#34;#cb28-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-2&#34;&gt;&lt;a href=&#34;#cb28-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb28-3&#34;&gt;&lt;a href=&#34;#cb28-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb28-4&#34;&gt;&lt;a href=&#34;#cb28-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-5&#34;&gt;&lt;a href=&#34;#cb28-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb28-6&#34;&gt;&lt;a href=&#34;#cb28-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-7&#34;&gt;&lt;a href=&#34;#cb28-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, a[&lt;span class=&#34;dv&#34;&gt;22&lt;/span&gt;], p[&lt;span class=&#34;dv&#34;&gt;22&lt;/span&gt;], cnt;&lt;/span&gt;
&lt;span id=&#34;cb28-8&#34;&gt;&lt;a href=&#34;#cb28-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-9&#34;&gt;&lt;a href=&#34;#cb28-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; insert(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x0) {&lt;/span&gt;
&lt;span id=&#34;cb28-10&#34;&gt;&lt;a href=&#34;#cb28-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = x0;&lt;/span&gt;
&lt;span id=&#34;cb28-11&#34;&gt;&lt;a href=&#34;#cb28-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(j, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((x &amp;gt;&amp;gt; j) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb28-12&#34;&gt;&lt;a href=&#34;#cb28-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!p[j]) {&lt;/span&gt;
&lt;span id=&#34;cb28-13&#34;&gt;&lt;a href=&#34;#cb28-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            p[j] = x, a[cnt++] = x0;&lt;/span&gt;
&lt;span id=&#34;cb28-14&#34;&gt;&lt;a href=&#34;#cb28-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-15&#34;&gt;&lt;a href=&#34;#cb28-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; x ^= p[j];&lt;/span&gt;
&lt;span id=&#34;cb28-16&#34;&gt;&lt;a href=&#34;#cb28-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb28-17&#34;&gt;&lt;a href=&#34;#cb28-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-18&#34;&gt;&lt;a href=&#34;#cb28-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb28-19&#34;&gt;&lt;a href=&#34;#cb28-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-20&#34;&gt;&lt;a href=&#34;#cb28-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb28-21&#34;&gt;&lt;a href=&#34;#cb28-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb28-22&#34;&gt;&lt;a href=&#34;#cb28-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;fu&#34;&gt;__builtin_popcount&lt;/span&gt;(i) == k) insert(i);&lt;/span&gt;
&lt;span id=&#34;cb28-23&#34;&gt;&lt;a href=&#34;#cb28-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt &amp;lt; n) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;No&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-24&#34;&gt;&lt;a href=&#34;#cb28-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb28-25&#34;&gt;&lt;a href=&#34;#cb28-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb28-26&#34;&gt;&lt;a href=&#34;#cb28-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; g = i ^ (i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), now = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-27&#34;&gt;&lt;a href=&#34;#cb28-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((g &amp;gt;&amp;gt; j) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) now ^= a[j];&lt;/span&gt;
&lt;span id=&#34;cb28-28&#34;&gt;&lt;a href=&#34;#cb28-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; now &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-29&#34;&gt;&lt;a href=&#34;#cb28-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb28-30&#34;&gt;&lt;a href=&#34;#cb28-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-31&#34;&gt;&lt;a href=&#34;#cb28-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>Codeforces æ¯”èµ›æ—¥è®°</title>
        <link>https://oi.imyangty.com/summary-codeforces/</link>
        <pubDate>Wed, 17 Feb 2021 18:11:15 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/summary-codeforces/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg1.webp" alt="Featured image of post Codeforces æ¯”èµ›æ—¥è®°" /&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Round&lt;/th&gt;
&lt;th&gt;div&lt;/th&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;sol&lt;/th&gt;
&lt;th&gt;rk&lt;/th&gt;
&lt;th&gt;perf&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;th&gt;E&lt;/th&gt;
&lt;th&gt;F&lt;/th&gt;
&lt;th&gt;G&lt;/th&gt;
&lt;th&gt;H&lt;/th&gt;
&lt;th&gt;I&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R670&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1406&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;9207&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R695&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1467&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;6299&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R697&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1475&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R698&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1478&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4882&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R698&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1477&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;EDU103&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1476&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4551&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R699&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1481&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;2113&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R700&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1480&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;6974&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R700&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1479&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R701&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1485&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU104&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1487&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4964&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R702&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1490&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;1352&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R705&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1493&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;869&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R706&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1496&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1792&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R706&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1495&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R707&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1501&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1320&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R707&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1500&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R712&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1504&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;8171&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R712&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1503&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R718&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1517&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;HSSC21&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1553&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R733&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1530&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R736&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1549&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;373&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R736&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1548&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R737&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1557&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;463&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R738&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1559&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1780&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R740&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1561&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1738&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R740&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1558&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R741&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1562&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3894&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;DR 2021&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1556&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R742&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1567&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;2622&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R743&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1573&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R743&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1572&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;EDU113&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1569&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;8249&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;GR17&lt;/td&gt;
&lt;td&gt;gr&lt;/td&gt;
&lt;td&gt;1566&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4019&lt;/td&gt;
&lt;td&gt;1330&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;EDU114&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1574&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1807&lt;/td&gt;
&lt;td&gt;1585&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R745&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1581&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;279&lt;/td&gt;
&lt;td&gt;1886&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R745&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1580&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R746&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1592&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;550&lt;/td&gt;
&lt;td&gt;1928&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R747&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1594&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;605&lt;/td&gt;
&lt;td&gt;1825&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU115&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1598&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;581&lt;/td&gt;
&lt;td&gt;1825&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R749&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1586&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;349&lt;/td&gt;
&lt;td&gt;2284&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R750&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1582&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1738&lt;/td&gt;
&lt;td&gt;1514&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R754&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1605&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;869&lt;/td&gt;
&lt;td&gt;1787&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R755&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1588&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;451&lt;/td&gt;
&lt;td&gt;1933&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R758&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1608&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;522&lt;/td&gt;
&lt;td&gt;2059&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;GR18&lt;/td&gt;
&lt;td&gt;gr&lt;/td&gt;
&lt;td&gt;1615&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;816&lt;/td&gt;
&lt;td&gt;2031&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Hello2022&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;1621&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;skip&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R765&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1625&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;140&lt;/td&gt;
&lt;td&gt;2191&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R766&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1627&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1275&lt;/td&gt;
&lt;td&gt;1678&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU121&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1626&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R767&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1629&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;305&lt;/td&gt;
&lt;td&gt;1988&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R767&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1628&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R768&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1631&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;2765&lt;/td&gt;
&lt;td&gt;1435&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R768&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1630&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R769&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1632&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1620&lt;/td&gt;
&lt;td&gt;1661&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU122&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1633&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;vp&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;GR19&lt;/td&gt;
&lt;td&gt;gr&lt;/td&gt;
&lt;td&gt;1637&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1047&lt;/td&gt;
&lt;td&gt;1975&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R771&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1638&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;521&lt;/td&gt;
&lt;td&gt;1936&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R772&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1635&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;121&lt;/td&gt;
&lt;td&gt;2204&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU123&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1644&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;365&lt;/td&gt;
&lt;td&gt;1968&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R773&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1641&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;689&lt;/td&gt;
&lt;td&gt;1884&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R777&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1647&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;549&lt;/td&gt;
&lt;td&gt;1908&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R781&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1665&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3461&lt;/td&gt;
&lt;td&gt;1276&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU126&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1661&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;311&lt;/td&gt;
&lt;td&gt;2001&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R785&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1673&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1368&lt;/td&gt;
&lt;td&gt;1624&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;EDU128&lt;/td&gt;
&lt;td&gt;edu&lt;/td&gt;
&lt;td&gt;1680&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;958&lt;/td&gt;
&lt;td&gt;1742&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R796&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1687&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R796&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1688&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;181&lt;/td&gt;
&lt;td&gt;2034&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R801&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1695&lt;/td&gt;
&lt;td&gt;3.5&lt;/td&gt;
&lt;td&gt;332&lt;/td&gt;
&lt;td&gt;2038&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R802&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1700&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;240&lt;/td&gt;
&lt;td&gt;2044&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R807&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1705&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;140&lt;/td&gt;
&lt;td&gt;2206&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;TON R2&lt;/td&gt;
&lt;td&gt;1+2&lt;/td&gt;
&lt;td&gt;1704&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;424&lt;/td&gt;
&lt;td&gt;2303&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;ğŸ˜…&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R812&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1713&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;226&lt;/td&gt;
&lt;td&gt;2138&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;R813&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1712&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;88&lt;/td&gt;
&lt;td&gt;2318&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;R815&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1720&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;287&lt;/td&gt;
&lt;td&gt;2042&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‰‘&lt;/td&gt;
&lt;td&gt;ğŸ‘€&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;codeforces-round-670-div.-2&#34;&gt;Codeforces Round #670 (Div. 2)&lt;/h2&gt;
&lt;p&gt;æ‰“çš„ç¬¬ä¸€åœº CF ç„¶è€Œä¸€é¢˜éƒ½æ²¡åšå‡ºæ¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---three-sequences&#34;&gt;1406D - Three Sequences&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œè¦æ±‚æ„é€ ä¸€ä¸ªä¸å‡åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; å’Œä¸€ä¸ªä¸å¢åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a_i = b_i + c_i\)&lt;/span&gt;ã€‚è¯·æœ€å°åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\max\{b_i, c_i\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ¯æ¬¡å¯ä»¥å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(a_l, a_{l + 1},\cdots , a_r\)&lt;/span&gt; åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚é—®æ¯æ¬¡ä¿®æ”¹åçš„æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(\max\{b_i, c_i\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒå¥‡å¦™çš„è´ªå¿ƒã€‚æˆ‘ä»¬æ³¨æ„åˆ°ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max(b_n, c_1)\)&lt;/span&gt;ã€‚è€Œæˆ‘ä»¬å‘ç°ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(a_{i + 1} &amp;gt; a_i\)&lt;/span&gt;ï¼Œæˆ‘ä»¬è‹¥æ˜¯è°ƒæ•´åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸Šï¼Œåˆ™ä¸ä¼˜ï¼›ä½†å¦‚è‹¥è°ƒæ•´ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œåˆ™å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; é€’å¢ï¼Œæ‰€ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(b_{i + 1} = b_i + a_{i + 1} - a_i\)&lt;/span&gt; æ˜¯æœ€ä¼˜çš„ã€‚è€Œ &lt;span class=&#34;math inline&#34;&gt;\(a_{i + 1} &amp;lt; a_i\)&lt;/span&gt; æ—¶ï¼Œæˆ‘ä»¬è‹¥æ˜¯è°ƒæ•´ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(c_{i + 1} = c_i + a_{i +1} - a_i\)&lt;/span&gt; æ˜¯æœ€ä¼˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¥½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_1 = b_1 + c_1 = b_n - \sum_{i = 2}^n(b_i - b_{i - 1}) + c_1\)&lt;/span&gt;ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(b_n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c_1\)&lt;/span&gt; å°½é‡æ¥è¿‘æœ€ä¼˜ã€‚ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle\lceil\frac{a_1 + \sum_{i = 2}^n(b_i - b_{i - 1})}{2}\rceil\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€Œ &lt;span class=&#34;math inline&#34;&gt;\(\sum_{i = 2}^n(b_i - b_{i - 1}) = \sum_{i = 2}^n(a_i - a_{i - 1})\cdot[a_i &amp;gt; a_{i - 1}]\)&lt;/span&gt;ã€‚è¿™ä¸ªä¸œè¥¿åº”è¯¥æ˜¯å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; ç»´æŠ¤çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, q;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll a[maxn], d[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]), d[i] = a[i] - a[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll sum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (d[i] &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) sum += d[i];&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print((ll)ceil((sum + d[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) * &lt;span class=&#34;fl&#34;&gt;0.5&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; q; read(q);&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (q--) {&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, r; ll x;&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(l, r, x), ++r;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll dl = d[l], dr = d[r];&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        d[l] += x, d[r] -= x;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l != &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sum += max(d[l], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) - max(dl, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r != n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sum += max(d[r], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) - max(dr, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print((ll)ceil((sum + d[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) * &lt;span class=&#34;fl&#34;&gt;0.5&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;e---deleting-numbers&#34;&gt;1406E - Deleting Numbers&lt;/h3&gt;
&lt;p&gt;äº¤äº’é¢˜ã€‚äº¤äº’åº“ç»™å®šä¸€ä¸ªæ•°å­— &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œè¦ä½ çŒœä¸€ä¸ªæ•°å­— &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le x\le n\)&lt;/span&gt;ï¼‰ã€‚ä¸€å¼€å§‹ä½ æœ‰ä¸€ä¸ªé›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(\{1, 2,\cdots, n\}\)&lt;/span&gt;ï¼Œä½ å¯ä»¥è¿›è¡Œè‡³å¤š &lt;span class=&#34;math inline&#34;&gt;\(10000\)&lt;/span&gt; æ¬¡æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;A a&lt;/code&gt;ï¼šè¯¢é—®å½“å‰é›†åˆä¸­æœ‰å¤šå°‘æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å€æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;B a&lt;/code&gt;ï¼šè¯¢é—®å½“å‰é›†åˆä¸­æœ‰å¤šå°‘æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å€æ•°ï¼Œå¹¶å°†ä»–ä»¬å…¨éƒ¨åˆ æ‰ã€‚&lt;strong&gt;&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ä¼šè¢«åˆ æ‰ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;C a&lt;/code&gt;ï¼šå‘Šè¯‰äº¤äº’åº“ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le x\le n\le 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæœ‰ä¸€ç§å¾ˆæœ´ç´ çš„æƒ³æ³•æ˜¯æšä¸¾æ¯ä¸ªè´¨æ•°ï¼Œåˆ é™¤å…¶å€æ•°ç„¶ååˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ˜¯å¦æœ‰è¿™ä¸€ä¸ªè´¨å› å­ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œç„¶åå°±ä¾æ¬¡æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(p^k\)&lt;/span&gt; å¹¶è¯¢é—® &lt;code&gt;A p^k&lt;/code&gt; ç›´åˆ°æ”¶åˆ°çš„ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å°±æœ‰ä¸€éƒ¨åˆ† &lt;span class=&#34;math inline&#34;&gt;\(p^{k - 1}\)&lt;/span&gt;ï¼Œæ ¹æ®å”¯ä¸€åˆ†è§£å®šç†ï¼Œæˆ‘ä»¬è¿™æ ·å­å°±èƒ½ç¡®å®š &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\tau(n)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; ä¸­è´¨æ•°çš„å¹‚çš„æ•°é‡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\pi(n)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; ä¸­è´¨æ•°ä¸ªæ•°ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\pi(10^5) = 9592\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\tau(10^5) = 9700\)&lt;/span&gt;ã€‚ä¸Šé¢è¿™ä¸ªåšæ³•çš„è¯¢é—®æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\pi(n) + \tau(n) + 1\)&lt;/span&gt;ï¼Œæ˜¾ç„¶è¦å¯„ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¼˜åŒ–ã€‚ä¸€ä¸ªå¾ˆå¸¸è§çš„ç»“è®ºæ˜¯ï¼Œè€ƒè™‘æ ¹å·åˆ†æ²»ï¼Œå°†è´¨å› å­åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\le \sqrt n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;\sqrt n\)&lt;/span&gt; ä¸¤éƒ¨åˆ†ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; \sqrt n\)&lt;/span&gt; çš„ä¸€å®šåªæœ‰ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\le \sqrt n\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ä¸Šé¢çš„æ–¹æ³•æš´åŠ›ï¼Œæ“ä½œæ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\pi(\sqrt n) + \tau(\sqrt n)\le 238\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; \sqrt n\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ†å—ï¼Œæ¯æ¬¡åˆ  &lt;span class=&#34;math inline&#34;&gt;\(100\)&lt;/span&gt; ä¸ªè´¨æ•°ï¼Œåˆ äº†ä¹‹åè¯¢é—®è¢«åˆ æ‰çš„æ•°æ˜¯å¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(100\)&lt;/span&gt; ä¸ªï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆç›´æ¥æš´åŠ›æ‰¾è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;\sqrt n\)&lt;/span&gt; çš„è´¨å› å­å°±èƒ½å¾—åˆ°ç­”æ¡ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç»†èŠ‚æœ‰ç‚¹çƒ¦äººï¼Œä¸€å®šè¦å°å¿ƒã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb2-1&#34;&gt;&lt;a href=&#34;#cb2-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-2&#34;&gt;&lt;a href=&#34;#cb2-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[maxn], p[maxn], tot, n;&lt;/span&gt;
&lt;span id=&#34;cb2-3&#34;&gt;&lt;a href=&#34;#cb2-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-4&#34;&gt;&lt;a href=&#34;#cb2-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ask(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c) {&lt;/span&gt;
&lt;span id=&#34;cb2-5&#34;&gt;&lt;a href=&#34;#cb2-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; c &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; a &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; flush;&lt;/span&gt;
&lt;span id=&#34;cb2-6&#34;&gt;&lt;a href=&#34;#cb2-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x; cin &amp;gt;&amp;gt; x;&lt;/span&gt;
&lt;span id=&#34;cb2-7&#34;&gt;&lt;a href=&#34;#cb2-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x;&lt;/span&gt;
&lt;span id=&#34;cb2-8&#34;&gt;&lt;a href=&#34;#cb2-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-9&#34;&gt;&lt;a href=&#34;#cb2-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-10&#34;&gt;&lt;a href=&#34;#cb2-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb2-11&#34;&gt;&lt;a href=&#34;#cb2-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb2-12&#34;&gt;&lt;a href=&#34;#cb2-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb2-13&#34;&gt;&lt;a href=&#34;#cb2-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[i]) p[++tot] = i;&lt;/span&gt;
&lt;span id=&#34;cb2-14&#34;&gt;&lt;a href=&#34;#cb2-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i * p[j] &amp;lt;= n; ++j) {&lt;/span&gt;
&lt;span id=&#34;cb2-15&#34;&gt;&lt;a href=&#34;#cb2-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            vis[i * p[j]] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-16&#34;&gt;&lt;a href=&#34;#cb2-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i % p[j] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-17&#34;&gt;&lt;a href=&#34;#cb2-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb2-18&#34;&gt;&lt;a href=&#34;#cb2-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-19&#34;&gt;&lt;a href=&#34;#cb2-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; B = (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)ceil(sqrt(&lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt;)), ans = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i;&lt;/span&gt;
&lt;span id=&#34;cb2-20&#34;&gt;&lt;a href=&#34;#cb2-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt;= tot &amp;amp;&amp;amp; p[i] &amp;lt;= B; ++i) {&lt;/span&gt;
&lt;span id=&#34;cb2-21&#34;&gt;&lt;a href=&#34;#cb2-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ask(p[i], &lt;span class=&#34;ch&#34;&gt;&amp;#39;B&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-22&#34;&gt;&lt;a href=&#34;#cb2-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp = p[i], flag = ask(p[i], &lt;span class=&#34;ch&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-23&#34;&gt;&lt;a href=&#34;#cb2-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (flag &amp;amp;&amp;amp; (tmp *= p[i]) &amp;lt;= n) flag = ask(tmp, &lt;span class=&#34;ch&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-24&#34;&gt;&lt;a href=&#34;#cb2-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans *= tmp / p[i];&lt;/span&gt;
&lt;span id=&#34;cb2-25&#34;&gt;&lt;a href=&#34;#cb2-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-26&#34;&gt;&lt;a href=&#34;#cb2-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (i; i &amp;lt;= tot; i += &lt;span class=&#34;dv&#34;&gt;98&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb2-27&#34;&gt;&lt;a href=&#34;#cb2-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt0 = ask(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;ch&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;), r = min(i + &lt;span class=&#34;dv&#34;&gt;97&lt;/span&gt;, tot);&lt;/span&gt;
&lt;span id=&#34;cb2-28&#34;&gt;&lt;a href=&#34;#cb2-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, i, r) cnt0 -= ask(p[j], &lt;span class=&#34;ch&#34;&gt;&amp;#39;B&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-29&#34;&gt;&lt;a href=&#34;#cb2-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt1 = ask(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;ch&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-30&#34;&gt;&lt;a href=&#34;#cb2-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt0 != cnt1) {&lt;/span&gt;
&lt;span id=&#34;cb2-31&#34;&gt;&lt;a href=&#34;#cb2-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, i, r) {&lt;/span&gt;
&lt;span id=&#34;cb2-32&#34;&gt;&lt;a href=&#34;#cb2-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ask(p[j], &lt;span class=&#34;ch&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;)) {&lt;/span&gt;
&lt;span id=&#34;cb2-33&#34;&gt;&lt;a href=&#34;#cb2-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    ans *= p[j];&lt;/span&gt;
&lt;span id=&#34;cb2-34&#34;&gt;&lt;a href=&#34;#cb2-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-35&#34;&gt;&lt;a href=&#34;#cb2-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb2-36&#34;&gt;&lt;a href=&#34;#cb2-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb2-37&#34;&gt;&lt;a href=&#34;#cb2-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-38&#34;&gt;&lt;a href=&#34;#cb2-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb2-39&#34;&gt;&lt;a href=&#34;#cb2-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-40&#34;&gt;&lt;a href=&#34;#cb2-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot;C &amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; ans &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; flush;&lt;/span&gt;
&lt;span id=&#34;cb2-41&#34;&gt;&lt;a href=&#34;#cb2-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-42&#34;&gt;&lt;a href=&#34;#cb2-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-698&#34;&gt;Codeforces Round 698&lt;/h2&gt;
&lt;h3 id=&#34;a---nezzar-and-board&#34;&gt;1477A - Nezzar and Board&lt;/h3&gt;
&lt;p&gt;ä¸€å¼€å§‹é»‘æ¿ä¸Šå†™ç€ &lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5\)&lt;/span&gt; ä¸ªä¸åŒæ•´æ•°ï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œä¸€æ¬¡æ“ä½œå¯ä»¥ä»»æ„é€‰ä¸¤ä¸ªï¼ˆä¸ä¸€å®šäº’å¼‚çš„æ•°ï¼‰&lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; ç„¶ååœ¨é»‘æ¿ä¸ŠåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(2x-y\)&lt;/span&gt;ï¼Œé—®æœ‰é™æ¬¡æ“ä½œåèƒ½å¦å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚å€¼åŸŸ &lt;span class=&#34;math inline&#34;&gt;\([-10^{18}, 10^{18}]\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æœ€åå½¢å¼å¾ˆåƒæ˜¯ä¸€ä¸ªåˆ¤æ–­æ»¡è¶³æŸç§æ¡ä»¶çš„çº¿æ€§ç»„åˆèƒ½ä¸èƒ½å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„é—®é¢˜ï¼Œå³è£´èœ€å®šç†ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å½“ &lt;span class=&#34;math inline&#34;&gt;\(x_1 = 0\)&lt;/span&gt; çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„æ„é€  &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; çš„å€æ•°ï¼Œæ‰€ä»¥å½“ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(x_2,\cdots, x_n)\mid k\)&lt;/span&gt; çš„æ—¶å€™æœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x_1\ne 0\)&lt;/span&gt; çš„æƒ…å†µï¼Œå°±å°† &lt;span class=&#34;math inline&#34;&gt;\(x_2,\cdots, x_n, k\)&lt;/span&gt; å…¨éƒ¨å‡å» &lt;span class=&#34;math inline&#34;&gt;\(x_1\)&lt;/span&gt;ï¼Œæ ¹æ® &lt;span class=&#34;math inline&#34;&gt;\(2x-y\)&lt;/span&gt; çš„è¿‡ç¨‹ä¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(-x_1\)&lt;/span&gt; çš„åç§»é‡æ˜¯ä¸€ç›´å¸¦ç€èµ°çš„ï¼Œæ²¡æœ‰å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ Asd_Okuu æ•™è‚²äº†å¦ä¸€ç§æ€è·¯ï¼šè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(z = 2x - y\)&lt;/span&gt; çš„è¿‡ç¨‹æ˜¯åœ¨æ•°è½´ä¸Šåšè½´å¯¹ç§°ï¼ˆé’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(y&amp;gt;x\)&lt;/span&gt;ï¼‰ï¼Œé‚£ä¹ˆä¸€å®šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(z\equiv x\pmod{(y-x)}\)&lt;/span&gt;ï¼Œå³æˆ‘ä»¬å¯ä»¥ç”¨é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(y-x\)&lt;/span&gt; çš„æ®µæ¥è¦†ç›–ã€‚æ‰€ä»¥è‹¥å­˜åœ¨ä¸¤ä¸ªæ®µçš„é•¿åº¦åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a,b) = 1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆè¿™äº›æ®µçº¿æ€§ç»„åˆèµ·æ¥æ˜¯å¯ä»¥æŠŠæ•°è½´ä¸Šæ‰€æœ‰ç‚¹å¹²ç¢çš„ï¼Œå…¶å®ä¹Ÿå°±æ˜¯è£´èœ€å®šç†äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å°†æ‰€æœ‰æ•°æ’ä¸ªåºï¼Œå°†å·®åˆ†åš &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt;ï¼Œå‘ç°è¿™æ ·æ˜¯å……åˆ†çš„ï¼Œæå®šäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;b---nezzar-and-binary-string&#34;&gt;1477B - Nezzar and Binary String&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ª 0-1 ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œéœ€è¦æ»¡è¶³ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©æ—¶ &lt;span class=&#34;math inline&#34;&gt;\([l_i,r_i]\)&lt;/span&gt; å†…ä¸åŒæ—¶å« 0 å’Œ 1ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©ç»“æŸæ—¶å¯ä»¥æ”¹å˜é‡Œé¢&lt;strong&gt;å°‘äº&lt;/strong&gt; &lt;span class=&#34;math inline&#34;&gt;\((r_i - l_1 + 1) / 2\)&lt;/span&gt; ä¸ªå­—ç¬¦ï¼ŒåŒæ—¶éœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; å¤©ç»“æŸåå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œé—®èƒ½å¦è¾¾æˆã€‚æ•°æ®èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\(2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­£ç€åšå¤ªéš¾äº†ï¼Œå€’ç€æ¥å§ã€‚å€’ç€æ¥å°±ç›¸å½“äºæ˜¯å¡«å¹³åŒºé—´ï¼Œè‹¥é‡Œé¢ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªæ•°ç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªæ•°å°±ä¸å¯ä»¥ï¼Œå¦åˆ™å¾€æ”¹åŠ¨å°‘çš„é‚£ä¸ªå»æ”¹ï¼Œå°±å®Œäº‹äº†ã€‚ã€‚ã€‚ã€‚ã€‚æ‹¿ä¸ªåˆ†å—æˆ–è€…çº¿æ®µæ ‘ç»´æŠ¤å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---nezzar-and-nice-beatmap&#34;&gt;1477C - Nezzar and Nice Beatmap&lt;/h3&gt;
&lt;p&gt;ç»™å®šå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(A_1,A_2,\dots,A_n\)&lt;/span&gt; ï¼Œæ±‚ä¸€ä¸ªæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(p_1,p_2,\dots,p_n\)&lt;/span&gt; ä½¿å¾—å¯¹äºä»»æ„ä¸€ä¸ª $i(1,n),i$ éƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\angle A_{p_i-1} A_{p_i} A_{p_i+1} &amp;lt; \dfrac{\pi}{2}\)&lt;/span&gt; ã€‚è‹¥æ— è§£ï¼Œè¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; ï¼Œè‹¥æœ‰å¤šä¸ªç­”æ¡ˆï¼Œè¾“å‡ºä»»æ„ä¸€ä¸ªå³å¯ã€‚&lt;span class=&#34;math inline&#34;&gt;\(3 \leq n \leq 5000,\ -10^9\leq x_i,y_i \leq 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰‹ç©ä¸€ä¸‹å‘ç°è§£ä¸€å®šå­˜åœ¨ï¼Œè€Œä¸”ä¼¼ä¹æ¯æ¬¡é€‰æœ€è¿œçš„ç‚¹å°±å¯ä»¥äº†ï¼Œç»“æœçœŸçš„å°±æ˜¯è¿™æ ·ï¼Œé€‰å‡ºé’è§’çš„æ—¶å€™æˆ‘ä»¬æ€»å¯ä»¥é€šè¿‡é€‰æ›´é•¿çš„è¾¹æ¥è§£å†³é’è§’çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-700&#34;&gt;Codeforces Round 700&lt;/h2&gt;
&lt;h3 id=&#34;b---painting-the-array&#34;&gt;1479B - Painting the Array&lt;/h3&gt;
&lt;p&gt;ç»™å®šæ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œä½ å°†å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æŸ“æˆ &lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; è‰²ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ä¸ºä½ æŒ‡å®šçš„ &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; æ•°ç»„ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸­è¢«æŸ“æˆ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; è‰²çš„æ•°å­—å–å‡ºæ¥æŒ‰åŸé¡ºåºæ’æˆ &lt;span class=&#34;math inline&#34;&gt;\(a^{(0)}\)&lt;/span&gt;ï¼ŒæŸ“æˆ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; è‰²çš„æ’æˆ &lt;span class=&#34;math inline&#34;&gt;\(a^{(1)}\)&lt;/span&gt;ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(seg(a)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸­è¿ç»­æ®µçš„ä¸ªæ•°ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(seg(a^{(0)}) + seg(a^{(1)})\)&lt;/span&gt; çš„æœ€å¤§å€¼/æœ€å°å€¼ï¼ˆåˆ†åˆ«å¯¹åº” B1/B2ï¼‰ï¼Œæ•°æ®èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\(10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é«˜å¦™è´ªå¿ƒçœŸçš„ä¸æ˜¯å¾ˆç©å¾—èµ·ï¼Œè€ƒè™‘ dpã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,a,b}\)&lt;/span&gt; è¡¨ç¤ºå¡«äº† &lt;span class=&#34;math inline&#34;&gt;\([1,i]\)&lt;/span&gt;ï¼Œç¬¬ä¸€ä¸ªåºåˆ—æœ«å°¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„æœ€å¤§/æœ€å°ç­”æ¡ˆã€‚å‘ç°å¯ä»¥å¹²æ‰ä¸€ç»´å› ä¸ºå¿…ç„¶æœ‰ä¸€ç»´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚äºæ˜¯å˜æˆäº† &lt;span class=&#34;math inline&#34;&gt;\(f_{i,x}\)&lt;/span&gt; è¡¨ç¤ºå¡«å®Œ &lt;span class=&#34;math inline&#34;&gt;\([1,i]\)&lt;/span&gt;ï¼Œåˆ†åˆ«çš„æœ«å°¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œèƒ½è¾¾åˆ°çš„æœ€å¤§/æœ€å°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæœ‰è½¬ç§» &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i, a_{i-1}} &amp;amp;\leftarrow f_{i-1,x} + 1&amp;amp;a_i \ne x\\
f_{i,a_{i-1}}&amp;amp;\leftarrow f_{i-1,x}&amp;amp;a_i=x\\
f_{i,x}&amp;amp;\leftarrow f_{i-1,x} + 1&amp;amp;a_i\ne a_{i-1}\\
f_{i,x}&amp;amp;\leftarrow f_{i-1,x}&amp;amp;a_i=a_{i-1}
\end{aligned}
\]&lt;/span&gt; è¿™ä¸ªä¸œè¥¿å¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ï¼Œå¤§éƒ¨åˆ†çš„è½¬ç§»éƒ½æ˜¯å¹³å‡¡çš„ &lt;span class=&#34;math inline&#34;&gt;\(+1\)&lt;/span&gt;ï¼Œå†™ä¸€ä¸ªåŒºé—´åŠ åŒºé—´æœ€å€¼çš„çº¿æ®µæ ‘å³å¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; å¸¦èµ°ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶é«˜å¦™è´ªå¿ƒä¹Ÿæ˜¯æœ‰æ„æ€çš„â€”â€”çœ‹æ ¹æ®ä¸¤è¾¹é˜Ÿå°¾çš„ &lt;span class=&#34;math inline&#34;&gt;\(nxt\)&lt;/span&gt; æ¥é€‰æ‹©ï¼Œæ„Ÿè§‰éå¸¸çš„ç‰›é€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---continuous-city&#34;&gt;1479C - Continuous City&lt;/h3&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(1\le L\le R\le 10^6\)&lt;/span&gt;ï¼Œæ„é€ ä¸€ä¸ªæœ‰å‘å¸¦æƒå›¾ã€‚è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(n\le 32\)&lt;/span&gt;ï¼Œä¸”æ‰€æœ‰è¾¹éƒ½ä»ç¼–å·å°çš„ç‚¹æŒ‡å‘ç¼–å·å¤§çš„ç‚¹ï¼Œæ­¤å¤–è¿˜è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(1\to n\)&lt;/span&gt; çš„æ‰€æœ‰è·¯å¾„æƒå€¼éƒ½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([L, R]\)&lt;/span&gt; å†…ä¸”ä¸å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x\in[L,R]\)&lt;/span&gt; ä½¿å¾—ä¸å­˜åœ¨æˆ–å¤šäºä¸€æ¡ &lt;span class=&#34;math inline&#34;&gt;\(1\to n\)&lt;/span&gt; çš„è·¯å¾„çš„æƒå€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚æˆ–è¯´æ˜æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;è¯´äººè¯å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\to n\)&lt;/span&gt; çš„è·¯å¾„éœ€è¦æ°å¥½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(R - L + 1\)&lt;/span&gt; æ¡å¹¶ä¸”æƒå€¼åˆšå¥½è¦†ç›–äº† &lt;span class=&#34;math inline&#34;&gt;\([L,R]\)&lt;/span&gt; çš„åŒºé—´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 32\)&lt;/span&gt; æœ‰ç‚¹äºŒè¿›åˆ¶çš„æ„æ€ï¼Ÿè€ƒè™‘æ„é€  &lt;span class=&#34;math inline&#34;&gt;\([1, 2^{k}]\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œä»¤ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å·ç‚¹è¡¨ç¤ºé€‰ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(2^{i-2}\)&lt;/span&gt;ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å·ç‚¹å‘åé¢æ‰€æœ‰è¾¹è¿ä¸Šæƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^{i-2}\)&lt;/span&gt; çš„è¾¹ï¼Œå†ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å‘åé¢æ‰€æœ‰ç‚¹è¿æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„è¾¹ï¼Œé‚£ä¹ˆä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k+2\)&lt;/span&gt; çš„æ‰€æœ‰è·¯å¾„å°±éƒ½å¯¹åº”äº† &lt;span class=&#34;math inline&#34;&gt;\([1,2^k]\)&lt;/span&gt; é‡Œé¢çš„æ¯ä¸€ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(R\ne 2^k\)&lt;/span&gt; çš„æƒ…å†µï¼Œä»¤å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^k + t\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(2^{k+1}&amp;gt;R\)&lt;/span&gt;ã€‚åˆšæ‰çš„å›¾ä¸­æœ‰ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å·ç‚¹ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(i&amp;gt;1\)&lt;/span&gt;ï¼‰ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\to i\)&lt;/span&gt; çš„æ‰€æœ‰è·¯å¾„é‡Œé¢æ˜¯æ°å¥½è¦†ç›–äº† &lt;span class=&#34;math inline&#34;&gt;\([1, 2^{i-2}]\)&lt;/span&gt; çš„ã€‚å¹¶ä¸”è‹¥æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(R\)&lt;/span&gt; çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º &lt;span class=&#34;math inline&#34;&gt;\((R_kR_{k-1}\cdots R_1R_0)_2\)&lt;/span&gt;ï¼Œåˆ™å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(R_j=1\)&lt;/span&gt;ï¼Œå°†è¯¥ä½è®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„è¯ä½ä½å°±å¯ä»¥ä»»æ„è¦†ç›–çš„ã€‚&lt;/p&gt;
&lt;p&gt;å°±ä¾‹å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(R = (111010)_2\)&lt;/span&gt;ï¼Œå…³æ³¨ &lt;span class=&#34;math inline&#34;&gt;\(R_3 = 1\)&lt;/span&gt;ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\([(110000)_2, (110111)_2]\)&lt;/span&gt; éƒ½æ˜¯å¯ä»¥å–åˆ°çš„ï¼ˆç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä½ä»»æ„å–ï¼‰ï¼Œè¿™å¯å‘æˆ‘ä»¬ä» &lt;span class=&#34;math inline&#34;&gt;\(j+2\)&lt;/span&gt; å·ç‚¹è¿è¾¹å‘ä¸€ä¸ªæ–°ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(k+3\)&lt;/span&gt;ï¼Œè¾¹æƒä¸ºæ›´é«˜ä½ä¸Šçš„å€¼ä¹‹ç±»çš„æƒ³æ³•ã€‚ä½†æ˜¯è¿™æ ·ä¼šå‡ºç°ä¸€äº›ç»†èŠ‚ä¸Šçš„é—æ¼ï¼Œå› ä¸ºå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\((110000)_2\)&lt;/span&gt; å°±æ˜¯æ²¡èƒ½è¦†ç›–åˆ°çš„ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j+2\)&lt;/span&gt; å·ç‚¹è¦†ç›–çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\([1, 2^{j}]\)&lt;/span&gt;ï¼Œæœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä¸‹ç•Œæ²¡è¢«è¦†ç›–ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(2^{j}\)&lt;/span&gt; çš„ä¸Šç•Œåˆæ°å¥½å¤šè¦†ç›–äº†ä¸€ä½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¯å‘æˆ‘ä»¬ &lt;span class=&#34;math inline&#34;&gt;\(R\leftarrow R - 1\)&lt;/span&gt;ï¼Œè¿™æ ·å­å°±åˆšå¥½æŠŠä¸Šè¿°é—®é¢˜å…¨éƒ¨ä¿®å¤äº†ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\to k+3\)&lt;/span&gt; çš„æ‰€æœ‰è·¯å¾„å°±èƒ½è¦†ç›–æ•´ä¸ªåŒºé—´äº†ã€‚è€Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(L\ne 1\)&lt;/span&gt;ï¼Œç›´æ¥å¹³ç§» &lt;span class=&#34;math inline&#34;&gt;\(L - 1\)&lt;/span&gt;ï¼Œæ–°å¼€ä¸€ä¸ªèŠ‚ç‚¹å†æ¥ä¸Šå»å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb3&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb3-1&#34;&gt;&lt;a href=&#34;#cb3-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-2&#34;&gt;&lt;a href=&#34;#cb3-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb3-3&#34;&gt;&lt;a href=&#34;#cb3-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-4&#34;&gt;&lt;a href=&#34;#cb3-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb3-5&#34;&gt;&lt;a href=&#34;#cb3-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-6&#34;&gt;&lt;a href=&#34;#cb3-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;tuple&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb3-7&#34;&gt;&lt;a href=&#34;#cb3-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, r, n;&lt;/span&gt;
&lt;span id=&#34;cb3-8&#34;&gt;&lt;a href=&#34;#cb3-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-9&#34;&gt;&lt;a href=&#34;#cb3-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb3-10&#34;&gt;&lt;a href=&#34;#cb3-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;&lt;/span&gt;
&lt;span id=&#34;cb3-11&#34;&gt;&lt;a href=&#34;#cb3-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    r = r - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-12&#34;&gt;&lt;a href=&#34;#cb3-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;31&lt;/span&gt; - &lt;span class=&#34;fu&#34;&gt;__builtin_clz&lt;/span&gt;(r); &lt;span class=&#34;co&#34;&gt;// æœ€é«˜ä½&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb3-13&#34;&gt;&lt;a href=&#34;#cb3-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = k + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-14&#34;&gt;&lt;a href=&#34;#cb3-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) FOR(j, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) ans.emplace_back(i + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, j + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; i);&lt;/span&gt;
&lt;span id=&#34;cb3-15&#34;&gt;&lt;a href=&#34;#cb3-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) ans.emplace_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, i + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-16&#34;&gt;&lt;a href=&#34;#cb3-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;fu&#34;&gt;__builtin_popcount&lt;/span&gt;(r) &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb3-17&#34;&gt;&lt;a href=&#34;#cb3-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        --r, ans.emplace_back(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, ++n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb3-18&#34;&gt;&lt;a href=&#34;#cb3-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; i) &amp;amp; r) {&lt;/span&gt;
&lt;span id=&#34;cb3-19&#34;&gt;&lt;a href=&#34;#cb3-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-20&#34;&gt;&lt;a href=&#34;#cb3-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) tmp |= ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j) &amp;amp; r);&lt;/span&gt;
&lt;span id=&#34;cb3-21&#34;&gt;&lt;a href=&#34;#cb3-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.emplace_back(i + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; + tmp);&lt;/span&gt;
&lt;span id=&#34;cb3-22&#34;&gt;&lt;a href=&#34;#cb3-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb3-23&#34;&gt;&lt;a href=&#34;#cb3-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-24&#34;&gt;&lt;a href=&#34;#cb3-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l != &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans.emplace_back(n, n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), ++n;&lt;/span&gt;
&lt;span id=&#34;cb3-25&#34;&gt;&lt;a href=&#34;#cb3-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot;YES&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; n &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; ans.size() &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb3-26&#34;&gt;&lt;a href=&#34;#cb3-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;x : ans) {&lt;/span&gt;
&lt;span id=&#34;cb3-27&#34;&gt;&lt;a href=&#34;#cb3-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, j, k; tie(i, j, k) = x;&lt;/span&gt;
&lt;span id=&#34;cb3-28&#34;&gt;&lt;a href=&#34;#cb3-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; i &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; j &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; k &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb3-29&#34;&gt;&lt;a href=&#34;#cb3-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb3-30&#34;&gt;&lt;a href=&#34;#cb3-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb3-31&#34;&gt;&lt;a href=&#34;#cb3-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;d---odd-mineral-resource&#34;&gt;1479D - Odd Mineral Resource&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹æœ‰é¢œè‰² &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt;ã€‚å¤šæ¬¡æŸ¥è¯¢ï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(u,v,l,r\)&lt;/span&gt;ï¼Œæ±‚ä¸€ä¸ªé¢œè‰² &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(x\in[l,r]\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åœ¨è·¯å¾„ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; ä¸Šå‡ºç°äº†å¥‡æ•°æ¬¡ã€‚æ•°æ®èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\(3\times 10^5\)&lt;/span&gt;ï¼Œ5sã€‚&lt;/p&gt;
&lt;p&gt;æ ¹å·åšæ³•è§&lt;a href=&#34;https://oi.imyangty.com/summary-ds4/&#34;&gt;è¿™é‡Œ&lt;/a&gt;ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹éšæœºåŒ–çš„å• &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ°å‡ºç°å¶æ•°æ¬¡ä¸è€ƒè™‘çš„é™åˆ¶å¾ˆåƒå¼‚æˆ–ï¼Œé‚£ä¹ˆå¦‚æœè®¾è·¯å¾„ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; ä¸Š &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; é¢œè‰²çš„å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(u,v,l,r)\)&lt;/span&gt; çš„è¯ï¼Œè‹¥å…¶å¼‚æˆ–èµ·æ¥ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; èƒ½æè¿°è·¯å¾„ä¸Šæ²¡æœ‰å‡ºç°å¥‡æ•°æ¬¡çš„è¯ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸»å¸­æ ‘ + äºŒåˆ†æ¥å• &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è€ƒè™‘å°†æ¯ç§é¢œè‰²åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([0,2^{64})\)&lt;/span&gt; å†…éšæœºé‡æ–°èµ‹å€¼ï¼Œè¿™æ ·å­å‡ºé”™çš„æ¦‚ç‡æä½ï¼ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^{-64}q\)&lt;/span&gt;ï¼Œæ¥è¿‘ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¥—è·¯åœ°ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(f(u,v,l,r)\)&lt;/span&gt; æ‹†åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(1,u,l,r)\oplus f(1,v,l,r)\oplus f(1,\mathrm{LCA}, l,r)\oplus f(1,\mathrm{fa}_{\mathrm{LCA}}, l, r)\)&lt;/span&gt;ï¼Œä½¿ç”¨ä¸»å¸­æ ‘ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(f(1, u, l, r)\)&lt;/span&gt; ç„¶åå››è·¯åŒæ—¶äºŒåˆ†å³å¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-701-div.-2&#34;&gt;Codeforces Round #701 (Div. 2)&lt;/h2&gt;
&lt;p&gt;VP on 22/07/14ã€‚A + C + Dã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---move-and-swap&#34;&gt;1485E - Move and Swap&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€æ£µæ ‘ï¼Œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹ï¼Œå¶å­ç»“ç‚¹æ·±åº¦ç›¸åŒ,ç»“ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ‰æƒå€¼ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚ç°åœ¨æœ‰çº¢è“ä¸¤é¢—æ£‹å­ï¼Œæ¯ä¸€æ­¥å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŠŠçº¢è‰²æ£‹å­ç§»åŠ¨åˆ°å®ƒçš„å­èŠ‚ç‚¹ï¼›&lt;/li&gt;
&lt;li&gt;æŠŠè“è‰²æ£‹å­ç§»åŠ¨åˆ°å®ƒä¸‹ä¸€å±‚çš„ä»»ä½•ä¸€ä¸ªç»“ç‚¹ï¼›&lt;/li&gt;
&lt;li&gt;é€‰æ‹©äº¤æ¢æˆ–ä¸äº¤æ¢çº¢å­ä¸è“å­çš„ä½ç½®ï¼›&lt;/li&gt;
&lt;li&gt;è®¡ç®—å¾—åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(|a_{red}-a_{blue}|\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®æœ€å¤§çš„å¾—åˆ†å’Œã€‚&lt;/p&gt;
&lt;p&gt;å°†ç‚¹åˆ†å±‚è€ƒè™‘ï¼Œä¸»è¦è€ƒè™‘åˆ°çº¢ç‚¹æ¯”è¾ƒå›ºå®šè€Œè“ç‚¹å››å¤„ä¹±é£ï¼Œæ‰€ä»¥è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; ä¸ºæ“ä½œå®Œåçº¢ç‚¹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ—¶çš„ç­”æ¡ˆï¼ˆå‘ç°è“ç‚¹çš„ä½ç½®æ˜¯æ— å…³ç´§è¦çš„ï¼‰ã€‚è€ƒè™‘è½¬ç§»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ä¸äº¤æ¢çš„æ—¶å€™ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{fa}_u\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„çˆ¶äº²ï¼Œåˆ™ &lt;span class=&#34;math display&#34;&gt;\[
f_u = f_{\mathrm{fa}_u} + \max_v\{|a_u - a_v|\}
\]&lt;/span&gt; å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å°±æ˜¯è“ç‚¹ä¸‹è½çš„ä½ç½®ï¼Œä¸éš¾å‘ç°åªèƒ½æ˜¯æœ€å¤§çš„æˆ–æœ€å°çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;äº¤æ¢çš„è¯ï¼Œé‚£ä¹ˆçº¢ç‚¹å°±æ˜¯ä»»æ„é£˜äº†ï¼Œè®¾äº¤æ¢å‰çº¢ç‚¹ä½äº &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math display&#34;&gt;\[
f_u = \max_k\{|a_u - a_k| + f_{\mathrm{fa}_k}\}
\]&lt;/span&gt; å¥—è·¯åœ°æ‹†ç»å¯¹å€¼å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{\mathrm{fa}_k} - a_k + a_u\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_{\mathrm{fa}_k} + a_k - a_u\)&lt;/span&gt;ã€‚è€ƒè™‘ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(\max\{f_{\mathrm{fa}_k} + a_k\}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\max\{f_{\mathrm{fa}_k} - a_k\}\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;f---copy-or-prefix-sum&#34;&gt;1485F - Copy or Prefix Sum&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; æ•°ç»„ï¼Œä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æ˜¯åˆæ³•çš„æŒ‡å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; éƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(b_i=a_i\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(b_i=\sum\limits_{j=1}^{i}a_j\)&lt;/span&gt; ã€‚é—®åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æœ‰å¤šå°‘ä¸ªã€‚ç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(10^9+7\)&lt;/span&gt; å–æ¨¡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le t\le 10^4,1\le \sum n\le 2\times 10^5,-10^9\le b_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä½¿ç”¨ dp æ±‚è§£ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; ä¸ºå¡«äº†å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i = S\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚æ ¹æ®æ˜¯æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(b_i = a_i\)&lt;/span&gt; è¿˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(b_i = \sum a_j\)&lt;/span&gt; åˆ†ä¸ºä¸¤ç§è½¬ç§»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i, j + b_i} = f_{i - 1, j}\)&lt;/span&gt;ï¼Œæ­¤æ—¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(b_i = a_i\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i, b_i} = \sum f_{i - 1, j}\)&lt;/span&gt;ï¼Œæ­¤æ—¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(b_i = a_i\)&lt;/span&gt; çš„æƒ…å†µï¼Œä½†æ˜¯éœ€è¦ä¸ä¸Šé¢ &lt;span class=&#34;math inline&#34;&gt;\(j = 0\)&lt;/span&gt; çš„æƒ…å†µå»ä¸€ä¸‹é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‘ç°ç¬¬ä¸€ç§è½¬ç§»å®é™…ä¸Šå°±æ˜¯æ•°ç»„å¹³ç§»ï¼Œç¬¬äºŒç§è½¬ç§»æ˜¯åœ¨åšå…¨å±€å’Œã€‚å¼€ä¸€ä¸ªå°æ ‡è®°è®°å½•ç¬¬ä¸€ç§æ“ä½œçš„å…¨å±€å¹³ç§»é‡ï¼Œå†å¼€ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(ans\)&lt;/span&gt;ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_{i, b_i}= ans + ans - f_{i - 1, b_i}\)&lt;/span&gt;ï¼ˆå› ä¸ºæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, b_i}\)&lt;/span&gt; å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(ans\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ‹¿ &lt;code&gt;map&lt;/code&gt; éšç¼˜ç»´æŠ¤ä¸€ä¸‹å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-706&#34;&gt;Codeforces Round 706&lt;/h2&gt;
&lt;h3 id=&#34;a---diamond-miner&#34;&gt;1495A - Diamond Miner&lt;/h3&gt;
&lt;p&gt;åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è½´ä¸Šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªé’»çŸ³çŸ¿ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; è½´ä¸Šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªçŸ¿å·¥ï¼Œä¿è¯æ‰€æœ‰çš„çŸ¿å·¥å’Œé’»çŸ³éƒ½ä¸åœ¨åŸç‚¹ã€‚éœ€è¦å»ºç«‹æ¯ä¸ªçŸ¿å·¥ä¸æ¯ä¸ªé’»çŸ³çŸ¿çš„ä¸€ä¸€å¯¹åº”å…³ç³»ä½¿å¾—æ¯å¯¹çŸ¿å·¥å’ŒçŸ¿çš„è·ç¦»ä¹‹å’Œæœ€å°ã€‚&lt;/p&gt;
&lt;p&gt;è¦ä¹ˆæ˜¯è´ªå¿ƒè¦ä¹ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ dpï¼Œå…ˆè€ƒè™‘ä¸¤å¯¹çŸ¿å·¥å’Œé’»çŸ³çš„æƒ…å†µï¼šï¼ˆç”±äºæ­£è´Ÿå…¶å®ä¸å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ‰€æœ‰çš„é’»çŸ³å’ŒçŸ¿çš„åæ ‡éƒ½å–ç»å¯¹å€¼ï¼Œåœ¨æ­£åŠè½´ä¸Šè€ƒè™‘é—®é¢˜ã€‚ä¸¤å¯¹ç‚¹çš„æƒ…å†µæ— éå°±æ˜¯äº¤å‰ç€è¿ï¼ˆè“çº¿ï¼‰å’Œå¹³è¡Œç€è¿ï¼ˆçº¢çº¿ï¼‰ã€‚æ‰€ä»¥è€ƒè™‘å“ªä¸ªè¦å¤§ä¸€äº›ï¼Œå³æ¯”è¾ƒ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{a^2 + d^2} + \sqrt{b^2 + c^2}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{a^2 + c^2} + \sqrt{b^2 + d^2}\)&lt;/span&gt; çš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤è¾¹åŒæ—¶å¹³æ–¹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
a^2 + b^2 + c^2 + d^2 + \sqrt{(a^2 + d^2)(b^2 + c^2)}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å’Œ&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
a^2 + b^2 + c^2 + d^ 2+ \sqrt{(a^2 + c^2)(b^2 + d^2)}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åªéœ€è¦è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\((a + d)(b+ c)\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\((a + c)(b + d)\)&lt;/span&gt; çš„å¤§å°å³å¯ï¼ŒåŒ–ç®€ä¹‹åä¸éš¾å‘ç°&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
(a + d)(b + c)\ge(a + c)(b + d)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥&lt;strong&gt;å¹³è¡Œçš„è¿æ³•ä¸€å®šæ˜¯æœ€ä¼˜çš„&lt;/strong&gt;ã€‚å°†æ‰€æœ‰çš„ç‚¹å–ç»å¯¹å€¼åæ’åºç„¶åä¾æ¬¡ç´¯åŠ ç­”æ¡ˆå°±æå®šäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;b---lets-go-hiking&#34;&gt;1495B - Letâ€™s Go Hiking&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1-n\)&lt;/span&gt; çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼ŒQingshan å’Œ Daniel åœ¨è‰ç¨¿çº¸ä¸ŠæŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œè¿œè¶³æ¸¸æˆã€‚ é¦–å…ˆ Qingshan é€‰å®šä¸€ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; &lt;strong&gt;å¹¶å‘Šè¯‰ Daniel&lt;/strong&gt;ï¼Œæ¥ä¸‹æ¥ Daniel é€‰å®šå¦ä¸€ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le x, y\le n\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(x\not=y\)&lt;/span&gt;ã€‚ç„¶åä»–ä»¬è½®æµè¿›è¡Œæ¸¸æˆï¼ŒQingshan ä¸ºå…ˆæ‰‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœè½®åˆ° Qingshanï¼Œåˆ™ Qingshan åªèƒ½æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39;\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39; - x = 1\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39; \neq y\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_x\gt p_{x&amp;#39;}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè½®åˆ° Danielï¼Œåˆ™ Daniel åªèƒ½æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\(y&amp;#39;\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(y&amp;#39; - y = 1\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(y&amp;#39;\neq x\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p_y\lt p_{y&amp;#39;}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœè½®åˆ°æŸä¸€æ–¹æ—¶æ— è·¯å¯èµ°äº†ï¼Œåˆ™å¦ä¸€æ–¹èƒœåˆ©ã€‚ å‡è®¾åŒæ–¹éƒ½è¶³å¤Ÿèªæ˜ï¼Œé‚£ä¹ˆåˆ¤æ–­æœ‰å¤šå°‘ä¸ªåˆå§‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¯ä»¥è®© Qingshan ä¸€å®šå–èƒœã€‚&lt;/p&gt;
&lt;p&gt;é¢˜è§£ï¼šé¦–å…ˆå‘æ˜è¿™ä¸ªæ¸¸æˆçš„æ€§è´¨ï¼šæ¯ä¸ªäººåªèƒ½å¾€ä¸€ä¸ªæ–¹å‘èµ°ï¼Œä¸èƒ½å›å¤´ã€‚æ³¨æ„åˆ°è¿™ä¸ªæ€§è´¨ä¹‹åä¸éš¾å‘ç°å¦‚æœ Qingshan è¦èµ¢ï¼Œé‚£ä¹ˆ Daniel å¿…é¡»è¢« Qingshan å¡æ­»æˆ–è€…è‡ªå·±è¢«å¡æ­»ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºä¸¤æ–¹éƒ½è¶³å¤Ÿèªæ˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠé—®é¢˜èŒƒå›´ç¼©å°åˆ°æœ€é•¿å•è°ƒåºåˆ—ä¸Šé¢æ¥ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥æœ€å¤§åŒ–åŒæ–¹çš„ç§»åŠ¨æ­¥æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è¯æ˜çš„æ˜¯ï¼Œ&lt;strong&gt;Qingshan ä¸€å¼€å§‹é€‰çš„ç‚¹åœ¨æœ€é•¿å•è°ƒåºåˆ—çš„é¡¶ç«¯æ˜¯ä»–èƒ½èµ¢çš„å¿…è¦æ¡ä»¶&lt;/strong&gt;ã€‚è‡³äºä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœ Qingshan é€‰çš„ä¸æ˜¯æœ€é•¿å•è°ƒåºåˆ—çš„é¡¶ç«¯ï¼Œé‚£ä¹ˆ Daniel å°±å¯ä»¥é€‰æœ€é•¿å•è°ƒåºåˆ—çš„åº•ç«¯è¿›è¡Œæ¸¸æˆï¼Œé‚£ä¹ˆ Qingshan è‚¯å®šå…ˆè¢«å¡æ­»ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”å¦‚æœæœ‰å¤šæ¡ä¸ç›¸äº¤çš„æœ€é•¿å•è°ƒåºåˆ—ï¼Œ&lt;strong&gt;Qingshan å¿…è¾“&lt;/strong&gt;ã€‚å› ä¸ºè¿™æ · Daniel å¯ä»¥é€‰æ‹©å¦å¤–ä¸€æ¡åºåˆ—çš„åº•ç«¯ï¼Œè€Œ Qingshan æ˜¯å…ˆæ‰‹ï¼Œæ‰€ä»¥ Qingshan &lt;strong&gt;è‚¯å®šå…ˆè¢«å¡æ­»&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåªæœ‰ä¸€æ¡æœ€é•¿å•è°ƒåºåˆ—ï¼Œè¿˜æ˜¯ &lt;strong&gt;Qingshan å¿…è¾“&lt;/strong&gt;ï¼Œå› ä¸º Qingshan æ˜¯å…ˆæ‰‹ï¼ŒDaniel é€‰æ‹©çš„ä½ç½®ä½†å‡¡ä¸ Qingshan çš„åˆå§‹ä½ç½®æˆçš„é“¾é•¿ä¸º&lt;strong&gt;å¶æ•°&lt;/strong&gt;ï¼Œ&lt;strong&gt;é‚£ä¹ˆ Daniel è‚¯å®šå¯ä»¥å¡æ­» Qingshan&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‰©ä¸‹çš„ä¸¤ç§æƒ…å†µå°±æ˜¯åŒæ—¶æœ‰ä¸¤æ¡æœ€é•¿å•è°ƒåºåˆ—ï¼Œè¦ä¹ˆæˆâ€œVâ€å½¢è¦ä¹ˆæˆå±±å³°å½¢ã€‚å¯¹äºâ€œVâ€å½¢çš„æƒ…å†µ&lt;strong&gt;è¿˜æ˜¯ Qingshan å¿…è¾“&lt;/strong&gt;ï¼Œå› ä¸º Daniel å¯ä»¥å¾€ä¸ Qingshan ç›¸åçš„æ–¹å‘è·‘èµ°ï¼Œé‚£ä¹ˆå½“ Qingshan æœ€ååˆ°è¾¾è°·åº•çš„æ—¶å€™å°± GG äº†ã€‚å¯¹äºå±±å³°å½¢çš„æƒ…å†µï¼ŒQingshan è‚¯å®šæ˜¯é€‰å³°é¡¶ï¼Œæ¥ä¸‹æ¥åˆ†æœ€é•¿å•è°ƒåºåˆ—é•¿åº¦çš„å¥‡å¶æ€§è®¨è®ºï¼š&lt;/p&gt;
&lt;p&gt;å¥‡æ•°ï¼šå¦‚æœ Daniel é€‰äº†å¡åº•ï¼Œ&lt;strong&gt;é‚£ä¹ˆ Qingshan åªè¦å¾€ Daniel çš„æ–¹å‘èµ°é‚£ä¹ˆå°±å¿…ç„¶å¯ä»¥å¡æ­» Daniel&lt;/strong&gt;ï¼›å¦‚æœä¸é€‰å¡åº•ï¼Œ&lt;strong&gt;é‚£ä¹ˆ Qingshan åªè¦å¾€å¦ä¸€ä¸ªæ–¹å‘èµ°å°±å¯ä»¥è®© Daniel å…ˆæ— è·¯å¯èµ°&lt;/strong&gt;ï¼Œæ‰€ä»¥æ­¤æ—¶ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼ŒQingshan å”¯ä¸€çš„å¿…èƒœç­–ç•¥å°±æ˜¯é€‰æ‹©å±±é¡¶ã€‚&lt;/p&gt;
&lt;p&gt;å¶æ•°ï¼šç±»ä¼¼ä¸Šé¢çš„åˆ†ææ–¹æ³•ï¼Œä¸éš¾å‘ç°&lt;strong&gt;è¦ä¹ˆ Daniel å¡æ­» Qingshanï¼Œè¦ä¹ˆ Qingshan å…ˆæ— è·¯å¯èµ°&lt;/strong&gt;ï¼Œæ‰€ä»¥ Qingshan &lt;strong&gt;å¿…è´¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†æåˆ°è¿™é‡Œæˆ‘ä»¬å°±å‘ç°äº†&lt;strong&gt;ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å½“ä¸”ä»…å½“æœ‰ä¸¤æ¡æœ€é•¿å•è°ƒåºåˆ—å¹¶ä¸”ä»–ä»¬å…±äº«ä¸€ä¸ªæœ€é«˜ç‚¹ï¼Œå¦åˆ™ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; ç›´æ¥æ‰«å°±å¯ä»¥è¿‡äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---garden-of-the-sun&#34;&gt;1495C - Garden of the Sun&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; çŸ©é˜µï¼Œé‡Œé¢å«æœ‰å­—ç¬¦ &lt;code&gt;.&lt;/code&gt; å’Œ &lt;code&gt;X&lt;/code&gt;ã€‚ä¿è¯æ‰€æœ‰ &lt;code&gt;X&lt;/code&gt; ä¹‹é—´æ— å…¬å…±ç‚¹ï¼ˆå³ä¸è”é€šï¼‰ï¼Œè¯·å°†ä¸€éƒ¨åˆ† &lt;code&gt;.&lt;/code&gt; æ›¿æ¢æˆ &lt;code&gt;X&lt;/code&gt; ä½¿å¾—è¿™äº› &lt;code&gt;X&lt;/code&gt; å½¢æˆä¸€æ£µæ ‘ï¼ˆè¦æ±‚å››è”é€šï¼Œå³ä¸¤ä¸ª &lt;code&gt;X&lt;/code&gt; ä¹‹é—´æœ‰ä¸€å…¬å…±è¾¹ï¼Œä¸èƒ½æœ‰ç¯ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ&lt;strong&gt;æ‰€æœ‰ &lt;code&gt;X&lt;/code&gt; ä¹‹é—´æ— å…¬å…±ç‚¹&lt;/strong&gt;æ˜¯ä¸€ä¸ªç‰¹åˆ«å¥½çš„æ€§è´¨ï¼Œè¿™ä¿è¯äº†ä¸‹é¢å¡«å……åˆ—çš„æ–¹æ³•çš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(3\mid m\)&lt;/span&gt; çš„æƒ…å†µï¼Œä¸å¦¨ç›´æ¥å°† &lt;span class=&#34;math inline&#34;&gt;\(2,5,8,\cdots\)&lt;/span&gt; åˆ—å…¨éƒ¨å¡«æˆ &lt;code&gt;X&lt;/code&gt;ï¼Œä¸éš¾å‘ç°è¿™æ ·&lt;strong&gt;éš”ä¸¤åˆ—å¡«ä¸€åˆ—çš„æ–¹å¼æ˜¯ä¸ä¼šå‡ºç°ç¯çš„&lt;/strong&gt;ï¼Œç„¶åå†å°† &lt;span class=&#34;math inline&#34;&gt;\(3, 6, 9, \cdots\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(4,7,10,\cdots\)&lt;/span&gt; ç­‰åˆ—æ„é€ æˆè”é€šçš„å°±å¯ä»¥äº†ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åªè€ƒè™‘ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œï¼Œå¦‚æœåˆæ³•å°±ç›´æ¥è¿ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(3\not\mid m\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåªéœ€è¦å˜ä¸€ä¸‹ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(1, 4, 7,\cdots\)&lt;/span&gt; å¡«æˆ &lt;code&gt;X&lt;/code&gt;ï¼Œå‰©ä½™æ“ä½œç±»ä¼¼ã€‚è‡³äºä¸ºä»€ä¹ˆå¡«çš„åˆ—æ”¹å˜äº†åˆ™å¯ä»¥è€ƒè™‘ç”»ä¸€ä¸‹å›¾è‡ªå·±æ¨¡æ‹Ÿä¸€ä¸‹ï¼Œä¼šå‘ç°å¦‚æœé€‰ &lt;span class=&#34;math inline&#34;&gt;\(2, 5, 8,\cdots\)&lt;/span&gt; çš„è¯åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(m = 3k + 1\)&lt;/span&gt; çš„æ—¶å€™ä¼šå¤šå‡ºä¸€ä¸ªéœ€è¦å•ç‹¬è€ƒè™‘çš„åˆ—ï¼Œæ‰€ä»¥ä¸å¦‚ç®€åŒ–é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-707-div.2-based-on-moscow-open-olympiad-in-informatics&#34;&gt;Codeforces Round 707 Div.2 based on moscow open olympiad in informatics&lt;/h2&gt;
&lt;h3 id=&#34;a---going-home&#34;&gt;1500A - Going Home&lt;/h3&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\lbrace a_n\rbrace\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(4\le n\le 2\times10^5\)&lt;/span&gt; å¹¶ä¸” &lt;span class=&#34;math inline&#34;&gt;\(\forall i\in[1,n],1\le a_i\le 2.5\times10^6\)&lt;/span&gt;ï¼Œæ±‚å››ä¸ªä¸åŒçš„ä¸‹æ ‡ &lt;span class=&#34;math inline&#34;&gt;\(x,y,z,w\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a_x + a_y = a_z + a_w\)&lt;/span&gt;ã€‚ æœ‰è§£åˆ™æ‰“å°è§£ï¼Œæ— è§£è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(\texttt{NO}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æˆ‘ä»¬çš„å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_i + a_j\le 5\times 10^6\)&lt;/span&gt;ï¼Œè¿™ä¸ªæ˜¯è§£å†³é—®é¢˜çš„å…³é”®ã€‚ æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¤§åŠ›æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(S = a_i + a_j\)&lt;/span&gt;ï¼Œè®°å½•ä¸€ä¸‹åŠ å‡ºæ¥çš„è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œå¦‚æœåŒæ ·çš„ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å‡ºç°äº†ç¬¬äºŒæ¬¡åˆ™ç›´æ¥è¾“å‡ºç­”æ¡ˆå°±å¥½ã€‚æ ¹æ®&lt;strong&gt;é¸½å·¢åŸç†&lt;/strong&gt;ï¼Œæˆ‘ä»¬å¦‚æœæšä¸¾çš„æ¬¡æ•°è¶…è¿‡äº†å€¼åŸŸï¼Œé‚£ä¹ˆå°±è‚¯å®šä¸å­˜åœ¨è§£ã€‚&lt;/p&gt;
&lt;h2 id=&#34;contest-2050-and-codeforces-round-718-div.1-div.2&#34;&gt;Contest 2050 and Codeforces Round #718 (Div.1 + Div.2)&lt;/h2&gt;
&lt;p&gt;VP on 22/07/14&lt;/p&gt;
&lt;h3 id=&#34;e---group-photo&#34;&gt;1517E - Group Photo&lt;/h3&gt;
&lt;p&gt;å°†æ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; åˆ’åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸‹æ ‡åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt;ï¼Œè¦æ±‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(c_i - c_{i-1} \le c_{i+1} - c_i\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(p_i - p_{i-1}\ge p_{i+1}-p_i\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{x\in C}a_x &amp;lt; \sum\limits_{y\in P}a_y\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®æ–¹æ¡ˆæ•°æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; äºŒåä¸‡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„é™åˆ¶æ˜¯å‰æ¾åç´§å’Œå‰ç´§åæ¾ï¼Œè€Œä¸€ä¸ªç´§å¯¹åº”ç€å¦ä¸€ä¸ªå¿…é¡»æ¾ï¼Œæœ‰ç‚¹è¯ˆéª—çš„æ„Ÿè§‰ï¼Œæ‰€ä»¥èƒ½å‡ºç°çš„åˆ’åˆ†ä¹Ÿå°±åªæœ‰å¦‚ä¸‹ä¸¤ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;P...PC...C&lt;/code&gt;ï¼Œæ­£åˆ™è¡¨è¾¾å¼ &lt;code&gt;P+C+&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PC...CPC...PCP...PC&lt;/code&gt;ï¼Œæ­£åˆ™è¡¨è¾¾å¼ &lt;code&gt;P?C+(PC)*P+C?&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„åˆ°ç¬¬äºŒç§é‡Œé¢ &lt;code&gt;C..&lt;/code&gt; çš„éƒ¨åˆ†å’Œ &lt;code&gt;P..&lt;/code&gt; çš„éƒ¨åˆ†å¿…é¡»è‡³å°‘ä¸€ä¸ª &lt;code&gt;C&lt;/code&gt; å’Œä¸€ä¸ª &lt;code&gt;P&lt;/code&gt;ï¼Œå¦åˆ™ä¼šé€€åŒ–æˆç¬¬ä¸€ç§ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ç§å¾ˆå®¹æ˜“ä½¿ç”¨å‰ç¼€å’Œç»Ÿè®¡ã€‚ç¬¬äºŒç§æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; ç§å¤´å°¾é€‰/ä¸é€‰çš„ caseï¼Œç„¶åæšä¸¾ &lt;code&gt;C&lt;/code&gt; çš„ä¸ªæ•°ï¼Œç”±äºå…¶æ˜¾ç„¶å…³äº &lt;code&gt;PC&lt;/code&gt; çš„ä¸ªæ•°æœ‰å•è°ƒæ€§ï¼Œæ‰€ä»¥äºŒåˆ†å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---reunion&#34;&gt;1517F - Reunion&lt;/h3&gt;
&lt;p&gt;å¤§ä¼šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå¿—æ„¿è€… , ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¯ä»¥ç”¨ä¸€æ£µ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ç‚¹çš„æ ‘æè¿° . ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç»“ç‚¹ä»£è¡¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå¿—æ„¿è€… . å®šä¹‰æ ‘ä¸Šä¸¤ç‚¹é—´è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{dis}(u,v)\)&lt;/span&gt; ä¸ºä¸ºä»–ä»¬ä¹‹é—´çš„æœ€çŸ­è·¯å¾„æ‰€ç»è¿‡çš„è¾¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ä»–ä»¬æƒ³è¿›è¡Œä¸€åœºèšä¼š , ä¸€äº›å¿—æ„¿è€…æœ‰ç©ºå‚åŠ  , è€Œå…¶å®ƒçš„æ­£å¿™ . åœ¨è¿™ç§æƒ…å†µä¸‹ , å¯¹äºæŸä¸ªå¿—æ„¿è€… &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å’Œéè´Ÿæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; , å¦‚æœæ‰€æœ‰ä¸ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„è·ç¦»ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„å¿—æ„¿è€…&lt;strong&gt;å…¨éƒ¨&lt;/strong&gt;æœ‰ç©ºå‚åŠ  , é‚£ä¹ˆå¯ä»¥å¬å¼€ä¸€åœºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ºä¸­å¿ƒ , åŠå¾„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„èšä¼š . è¿™åœºèšä¼šçš„ç­‰çº§å®šä¹‰ä¸ºæ‰€æœ‰å¯èƒ½çš„åŠå¾„ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸­çš„&lt;strong&gt;æœ€å¤§å€¼&lt;/strong&gt; .&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ªå¿—æ„¿è€…éƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\frac12\)&lt;/span&gt; çš„æ¦‚ç‡æœ‰ç©ºå‚åŠ æˆ–è€…æ­£å¿™ . ç°åœ¨è¯·ä½ æ±‚å‡ºæ‰€æœ‰æƒ…å†µä¸‹èšä¼šç­‰çº§çš„&lt;strong&gt;æœŸæœ›&lt;/strong&gt;å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998\ 244\ 353\)&lt;/span&gt; å–æ¨¡çš„ç»“æœ . ç‰¹åˆ«çš„ , å½“æ‰€æœ‰å¿—æ„¿è€…éƒ½æ­£å¿™æ—¶ , è¯¥èšä¼šçš„ç­‰çº§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; ; å½“æ‰€æœ‰å¿—æ„¿è€…éƒ½æœ‰ç©ºå‚åŠ æ—¶ , è¯¥èšä¼šçš„ç­‰çº§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le300\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœŸæœ›é¢˜åŸºæœ¬æ²¡åšè¿‡å‡ é“ï¼Œä¸åŸ‹æ€¨è‡ªå·±äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å»å¯»æ‰¾ç­”æ¡ˆæ˜¯å›°éš¾çš„ï¼Œè€ƒè™‘é€šè¿‡æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; æ±‚æ–¹æ¡ˆæ•°æ¥ç®—æœŸæœ›ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæ­£é¢åœ°è€ƒè™‘&lt;strong&gt;å­˜åœ¨&lt;/strong&gt;ä¸€ä¸ªèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä½¿å¾—ä¸å…¶è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(\le r\)&lt;/span&gt; çš„äººéƒ½æœ‰ç©ºæ˜¯å›°éš¾çš„ï¼Œé€†å‘åœ°æ¥çœ‹ï¼Œä¸å¦¨ä»¤ä¸èƒ½å‚åŠ çš„æŸ“æˆé»‘è‰²ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(B_{u,r} = \{v:dis(u,v)\le r\}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰æŸ“è‰²äº†çš„ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B_{u,r}\)&lt;/span&gt; éƒ½æ˜¯è¢«å¹²æ‰äº†çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œè‹¥æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(B_{u,r}\)&lt;/span&gt; çš„å¹¶åŒ…å«äº†æ‰€æœ‰ç‚¹ï¼Œåˆ™è¯´æ˜è¯¥æƒ…å†µä¸‹åˆæ³•çš„åŠå¾„ä¸€å®š &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;r\)&lt;/span&gt;ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¯¹äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ç®—å‡º &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; r\)&lt;/span&gt; çš„æƒ…å†µï¼Œç®€å•å·®åˆ†ä¸€ä¸‹ä¹Ÿå°±å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(=r\)&lt;/span&gt; çš„æƒ…å†µäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥é—®é¢˜è½¬åŒ–ä¸ºå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œæ±‚æŸ“è‰²æ–¹æ¡ˆæ•°ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(B_{u,r}\)&lt;/span&gt; çš„å¹¶èƒ½å°†æ‰€æœ‰ç‚¹åŒ…å«ã€‚è€ƒè™‘ dpã€‚&lt;/p&gt;
&lt;h2 id=&#34;harbour.space-scholarship-contest-2021-2022-open-for-everyone-rated-div.-1-div.-2&#34;&gt;Harbour.Space Scholarship Contest 2021-2022 (open for everyone, rated, Div. 1 + Div. 2)&lt;/h2&gt;
&lt;p&gt;VP on 21/10/18. A + B + C + D + Fã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---permutation-shift&#34;&gt;1553E - Permutation Shift&lt;/h3&gt;
&lt;p&gt;åˆå§‹æœ‰æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\((1, 2, \cdots, n)\)&lt;/span&gt;ï¼Œç°ç»™å®šæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; å’Œæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼Œæ±‚å‡ºæ‰€æœ‰æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(k\in[0, n- 1]\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°†åˆå§‹æ’åˆ—å‘å³å¾ªç¯ç§»ä½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå•ä½åï¼Œèƒ½ç»è¿‡ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡äº¤æ¢å…ƒç´ çš„æ“ä½œåå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 3\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le m\le \dfrac n3\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è€ƒè™‘æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ç„¶ååˆ¤æ–­è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ˜¯å¦å¯è¡Œã€‚ä½†æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; æ˜¾ç„¶ä¼šçˆ†ç‚¸ã€‚è€ƒè™‘ç”±äºæˆ‘ä»¬ä¸€æ¬¡äº¤æ¢æœ€å¤šæ”¹å˜ä¸¤ä¸ªæ•°çš„ä½ç½®ï¼Œæ‰€ä»¥ä½ç½®ä¸ç”¨æ”¹å˜çš„æ•°å­—è‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n - 2m\)&lt;/span&gt; ä¸ªï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x_k\)&lt;/span&gt; è¡¨ç¤ºå¾ªç¯ç§»ä½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡åä¸ç”¨åŠ¨çš„æ•°å­—ä¸ªæ•°ï¼Œä¸€å®šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle\sum_{i = 0}^{n - 1}x_i = n\)&lt;/span&gt;ï¼Œè€Œä¸”ç”± &lt;span class=&#34;math inline&#34;&gt;\(m\le \dfrac n 3\)&lt;/span&gt; å¾—çŸ¥ &lt;span class=&#34;math inline&#34;&gt;\(x_k\ge \dfrac n 3\)&lt;/span&gt; æ’æˆç«‹ã€‚è¿™æ ·æ»¡è¶³æ¡ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(x_k\)&lt;/span&gt; è‡³å¤šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªã€‚æ‰€ä»¥æˆ‘ä»¬é¢„å¤„ç†ä¸€ä¸‹æ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(x_k\)&lt;/span&gt; ç„¶åæ¯æ¬¡æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(\ge n - 2m\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(x_k\)&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; æ‰¾ç¯å³å¯ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---pairwise-modulo&#34;&gt;1553F - Pairwise Modulo&lt;/h3&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{a_n\}\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le a_i\le 2\times 10^5\)&lt;/span&gt;ï¼‰ï¼Œå¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_k = \displaystyle\sum_{1\le i,j\le k}a_i\bmod a_j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ–°åŠ è¿›æ¥ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æ—¶äº§ç”Ÿçš„è´¡çŒ®ï¼Œå°†è¿™éƒ¨åˆ†è´¡çŒ®ä¸ &lt;span class=&#34;math inline&#34;&gt;\(f_{i - 1}\)&lt;/span&gt; ç›¸åŠ å³å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt;ã€‚å…¶åˆ†ä¸º&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sum_j a_j\bmod a_i\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†æ¯”è¾ƒå¥½åŠï¼Œæ ‘çŠ¶æ•°ç»„ç›´æ¥æ‰«ä¾¿æ˜¯ï¼Œä¿© &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sum_j a_i\bmod a_j\)&lt;/span&gt;ã€‚è¿™éƒ¨åˆ†ä¸å¤ªå¥½ç›´æ¥å»ç®—ã€‚è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(a_i\bmod a_j = a_i - a_j\lfloor a_i/a_j\rfloor\)&lt;/span&gt;ï¼Œæ•…å¯ä»¥åœ¨è®¡ç®—ä¹‹å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; çš„æ—¶å€™é¡ºä¾¿æ›´æ–°ä¸€ä¸‹å®ƒèƒ½æ›´æ–°åˆ°çš„åŒºé—´ã€‚åŒºé—´åŠ ï¼Œå•ç‚¹æŸ¥ï¼Œä¾ç„¶å¯ä»¥æ ‘çŠ¶æ•°ç»„ã€‚è¿˜æ˜¯ä¿© &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; è§£å†³æ‰äº†ã€‚æ¯” E ä¸çŸ¥é“ç®€å•åˆ°å“ªé‡Œå»äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;g---common-divisor-graph&#34;&gt;1553G - Common Divisor Graph&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªåŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªèŠ‚ç‚¹çš„å›¾ã€‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªèŠ‚ç‚¹éƒ½æœ‰æƒå€¼ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œæ²¡æœ‰ä¸¤ä¸ªèŠ‚ç‚¹æƒå€¼ç›¸åŒã€‚èŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; ä¹‹é—´æœ‰ä¸€æ¡æ— å‘è¾¹ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a_i,a_j)&amp;gt;1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡åŒ…å«æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(s,t\)&lt;/span&gt; è¡¨ç¤ºä½ å¸Œæœ›ä»èŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; åˆ°è¾¾èŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ã€‚ä¸ºäº†åˆ°è¾¾é‚£ä¸ªèŠ‚ç‚¹ï¼Œä½ å¯ä»¥è¿›è¡Œä¸‹åˆ—æ“ä½œä»»æ„æ¬¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰å®šä¸€ä¸ªèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ã€‚åˆ›é€ ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹çš„æƒå€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\times(a_i+1)\)&lt;/span&gt;ï¼Œå¹¶æŒ‰ç…§ä¸Šè¿°è§„åˆ™è¿è¾¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œä½ éƒ½éœ€è¦æ±‚å‡ºï¼Œè‡³å°‘éœ€è¦å¤šå°‘æ¬¡æ“ä½œæ‰èƒ½ä½¿èŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; èƒ½åˆ°è¾¾èŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ã€‚è¯¢é—®äº’ç›¸ç‹¬ç«‹ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(a_s(a_s + 1)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_t(a_t + 1)\)&lt;/span&gt; å¿…ç„¶æœ‰å…¬çº¦æ•° &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æ‰€ä»¥è¿é€šã€‚æ‰€ä»¥ç­”æ¡ˆè‡³å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€å¼€å§‹å…ˆç”¨å¹¶æŸ¥é›†è¿å¥½å·²ç»æœ‰äº†çš„è¾¹ï¼ŒæŸ¥è¯¢çš„æ—¶å€™è‹¥å·²ç»è¿é€šï¼Œåˆ™ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚ç„¶åè€ƒè™‘ä»€ä¹ˆæ—¶å€™ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ˜¾ç„¶ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(a_s + 1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_t\)&lt;/span&gt; æ‰€åœ¨é›†åˆè¿é€šæˆ–è€… &lt;span class=&#34;math inline&#34;&gt;\(a_s\)&lt;/span&gt; æ‰€åœ¨é›†åˆå’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_t + 1\)&lt;/span&gt; è¿é€šæ—¶ç­”æ¡ˆå°±ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚è¿™ä¸ªå¯ä»¥é¢„å¤„ç†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦å¤§æŠµæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; çº§åˆ«çš„ï¼Œèƒ½è¿‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-737-div.-2&#34;&gt;Codeforces Round #737 (Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;c.-moamen-and-xor&#34;&gt;1557C. Moamen and XOR&lt;/h3&gt;
&lt;p&gt;æ‹†å¼€ä½æ¥è€ƒè™‘ã€‚å¤„ç†ä¸€ä¸‹ç»„åˆæ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-738-div.-2&#34;&gt;Codeforces Round #738 (Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;d1.-mocha-and-diana-easy-version&#34;&gt;1559D1. Mocha and Diana (Easy Version)&lt;/h3&gt;
&lt;p&gt;æš´åŠ›ç»™ä¸¤ä¸ªæ£®æ—åŠ è¾¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n^2\log n)\)&lt;/span&gt; å¯è¿‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d2.-mocha-and-diana-hard-version&#34;&gt;1559D2. Mocha and Diana (Hard Version)&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘å»¶ç»­ä¸Šé¢˜çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;è´ªå¿ƒçš„æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; èƒ½è¿çš„è¾¹è¿äº†ï¼Œç„¶åä¼šå‡ºç°ä¸¤ç±»ç‚¹ï¼šåªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å›¾ä¸­ä¸ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç›¸è¿ä»¥åŠåªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; å›¾ä¸­ä¸ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç›¸è¿ã€‚ç„¶åæ˜¾ç„¶å¯ä»¥åœ¨ä¸¤ä¸ªé›†åˆä¸­æŒ‘ç‚¹å‡ºæ¥è¿è¾¹ã€‚ç›´æ¥è¿å°±è¡Œäº†ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e.-mocha-and-stars&#34;&gt;1559E. Mocha and Stars&lt;/h3&gt;
&lt;p&gt;æ±‚æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\((a_1, a_2, \cdots , a_n)\)&lt;/span&gt; çš„æ•°é‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\forall i\in[1, n], a_i\in[l_i, r_i]\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sum a_i\le m\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\gcd(a_1, a_2, \cdots, a_n) = 1\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 50\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le 10^5\)&lt;/span&gt;ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; çš„é™åˆ¶ï¼Œå‘ç°å…¶ä¸ºä¸€ä¸ªèƒŒåŒ…ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; ä¸ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‰©å“ï¼ŒèƒŒåŒ…å®¹é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰è½¬ç§»æ–¹ç¨‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = \sum_{k = l_i}^{r_i}f_{i - 1, j - k}
\]&lt;/span&gt; è¿™æ ·ç›´æ¥å»åšæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(nm^2)\)&lt;/span&gt; çš„ï¼Œå‘ç°è½¬ç§»å¯ä»¥ä½¿ç”¨å‰ç¼€å’Œä¼˜åŒ–ï¼Œå…·ä½“è®¾ &lt;span class=&#34;math inline&#34;&gt;\(s_{i, j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math display&#34;&gt;\[
s_{i, j} = \sum_{k = 0}^jf_{i, k}
\]&lt;/span&gt; ç„¶åå°±æœ‰äº†è½¬ç§»æ–¹ç¨‹ &lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = s_{i - 1, j - l_i} - s_{i - 1, j - r_i - 1}
\]&lt;/span&gt; èƒŒåŒ…éƒ¨åˆ†çš„å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; çš„é™åˆ¶ï¼Œè¿™ç±»å¥—è·¯é—®é¢˜ä½¿ç”¨è«æ¯”ä¹Œæ–¯åæ¼”å³å¯ã€‚ &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
&amp;amp;\sum_{a_1=l_1}^{r_1}\sum_{a_2=l_2}^{r_2}\cdots\sum_{a_n=l_n}^{r_n}[\gcd(a_1,\cdots,a_n)=1]\left[\sum_{i = 1}^na_i\le m\right]\\
=&amp;amp;\sum_{a_1=l_1}^{r_1}\sum_{a_2=l_2}^{r_2}\cdots\sum_{a_n=l_n}^{r_n}\left[\sum_{i = 1}^na_i\le m\right]\sum_{d \mid \gcd(a_1,\cdots,a_n)}\mu(d)\\ =&amp;amp;\sum_{a_1=l_1}^{r_1}\sum_{a_2=l_2}^{r_2}\cdots\sum_{a_n=l_n}^{r_n}\left[\sum_{i = 1}^na_i\le m\right]\sum_{d\mid a_1,\cdots,d \mid a_n}\mu(d)\\
=&amp;amp;\sum_{d=1}^M\mu(d)\sum_{a_1=\lceil\frac{l_1}{d}\rceil}^{\lfloor\frac{r_1}{d}\rfloor}\sum_{a_2=\lceil\frac{l_2}{d}\rceil}^{\lfloor\frac{r_2}{d}\rfloor}\cdots\sum_{a_n=\lceil\frac{l_n}{d}\rceil}^{\lfloor\frac{r_n}{d}\rfloor}\left[\sum_{i = 1}^na_i\le \left\lfloor\frac m d\right\rfloor\right]
\end{aligned}
\]&lt;/span&gt; æ€»æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(nm\log m)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb4&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb4-1&#34;&gt;&lt;a href=&#34;#cb4-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb4-2&#34;&gt;&lt;a href=&#34;#cb4-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    init();&lt;/span&gt;
&lt;span id=&#34;cb4-3&#34;&gt;&lt;a href=&#34;#cb4-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m);&lt;/span&gt;
&lt;span id=&#34;cb4-4&#34;&gt;&lt;a href=&#34;#cb4-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(L[i]), read(R[i]);&lt;/span&gt;
&lt;span id=&#34;cb4-5&#34;&gt;&lt;a href=&#34;#cb4-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-6&#34;&gt;&lt;a href=&#34;#cb4-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(d, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb4-7&#34;&gt;&lt;a href=&#34;#cb4-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (mu[d] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-8&#34;&gt;&lt;a href=&#34;#cb4-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, m / d) sum[j] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-9&#34;&gt;&lt;a href=&#34;#cb4-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb4-10&#34;&gt;&lt;a href=&#34;#cb4-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            l[i] = (L[i] + d - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / d, r[i] = R[i] / d;&lt;/span&gt;
&lt;span id=&#34;cb4-11&#34;&gt;&lt;a href=&#34;#cb4-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m / d) f[j] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-12&#34;&gt;&lt;a href=&#34;#cb4-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, l[i], m / d) {&lt;/span&gt;
&lt;span id=&#34;cb4-13&#34;&gt;&lt;a href=&#34;#cb4-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[j] = sum[j - l[i]];&lt;/span&gt;
&lt;span id=&#34;cb4-14&#34;&gt;&lt;a href=&#34;#cb4-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (j - r[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;gt;= &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) f[j] -= sum[j - r[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb4-15&#34;&gt;&lt;a href=&#34;#cb4-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb4-16&#34;&gt;&lt;a href=&#34;#cb4-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            sum[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-17&#34;&gt;&lt;a href=&#34;#cb4-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m / d) sum[j] = f[j] + sum[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb4-18&#34;&gt;&lt;a href=&#34;#cb4-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb4-19&#34;&gt;&lt;a href=&#34;#cb4-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans += sum[m / d] * mu[d];&lt;/span&gt;
&lt;span id=&#34;cb4-20&#34;&gt;&lt;a href=&#34;#cb4-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb4-21&#34;&gt;&lt;a href=&#34;#cb4-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb4-22&#34;&gt;&lt;a href=&#34;#cb4-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb4-23&#34;&gt;&lt;a href=&#34;#cb4-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;vk-cup-2021-final-engine-and-codeforces-round-740&#34;&gt;VK Cup 2021 â€” Final (Engine) and Codeforces Round #740&lt;/h2&gt;
&lt;h3 id=&#34;a.-simply-strange-sort&#34;&gt;1561A. Simply Strange Sort&lt;/h3&gt;
&lt;p&gt;æ¨¡æ‹Ÿ&lt;/p&gt;
&lt;h3 id=&#34;a.-charmed-by-the-game&#34;&gt;1558A. Charmed by the Game&lt;/h3&gt;
&lt;p&gt;ç›´æ¥æšä¸¾ A å…ˆæ‰‹ B èµ¢æ¯”èµ›çš„æ¬¡æ•°ï¼Œåˆ† &lt;span class=&#34;math inline&#34;&gt;\(a + b\)&lt;/span&gt; çš„å¥‡å¶æ€§è®¨è®ºå³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c.-deep-down-below&#34;&gt;1561C. Deep Down Below&lt;/h3&gt;
&lt;p&gt;äºŒåˆ†ç­”æ¡ˆï¼Œæ°´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;b.-up-the-strip&#34;&gt;1558B. Up the Strip&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼åˆ°åˆ«çš„æ ¼å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡æ³•æ“ä½œï¼šåˆ° &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le y &amp;lt; x\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é™¤æ³•æ“ä½œï¼šåˆ° &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(y = \lfloor x / d\rfloor\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d\ge 2\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;dpï¼Œé¦–å…ˆæœ€æœ´ç´ çš„åšæ³•å¯ä»¥é€šè¿‡å‰ç¼€å’Œå’Œæ•´é™¤åˆ†å—å®ç°ï¼Œæ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\sqrt n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; å¯¹åé¢äº§ç”Ÿçš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(j = qi + r\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le r &amp;lt; q\)&lt;/span&gt;ï¼Œåˆ™ä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\lfloor j / q\rfloor = i\)&lt;/span&gt;ï¼Œæ‰€ä»¥ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(q\ge 2\)&lt;/span&gt;ï¼Œä¼šå¯¹ &lt;span class=&#34;math inline&#34;&gt;\([qi, q(i + 1))\)&lt;/span&gt; äº§ç”Ÿè´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;å·®åˆ†ç»´æŠ¤ä¸€ä¸‹å³å¯ï¼Œå¤æ‚åº¦è°ƒå’Œ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-741-div.-2&#34;&gt;Codeforces Round 741 (Div. 2)&lt;/h2&gt;
&lt;p&gt;A + C&lt;/p&gt;
&lt;h3 id=&#34;c---rings&#34;&gt;1562C - Rings&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(10^5\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(01\)&lt;/span&gt; ä¸²ï¼Œè¦æ±‚é€‰å‡ºä¸¤ä¸åŒçš„é•¿åº¦å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(\lfloor \frac n2\rfloor\)&lt;/span&gt; çš„å­æ®µï¼Œè¦æ±‚ä¸€ä¸ªä¸ºå¦ä¸€ä¸ªçš„å€æ•°ï¼Œä¿è¯æœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ•°åé¢æ·»ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ç›¸å½“äºå°±æ˜¯ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ã€‚è€Œæœ¬é¢˜ä¸­å‰å¯¼é›¶ä¹Ÿä¸å½±å“ï¼Œæ‰€ä»¥ç›´æ¥æ‰¾ä¸²ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å³å¯ã€‚ç‰¹åˆ¤å…¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸²ã€‚&lt;/p&gt;
&lt;h2 id=&#34;deltix-round-summer-2021-open-for-everyone-rated-div.-1-div.-2&#34;&gt;Deltix Round, Summer 2021 (open for everyone, rated, Div. 1 + Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;c---compressed-bracket-sequence&#34;&gt;1556C - Compressed Bracket Sequence&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘å¦‚æœæˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸²è¿ç»­çš„å³æ‹¬å·ï¼Œç»Ÿè®¡ä»–ä»¬çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå·¦è¾¹çš„å·¦æ‹¬å·æ¯”ä»–å¤šï¼Œåˆ™è´¡çŒ®ä¸ºå³æ‹¬å·çš„ä¸ªæ•°ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå·¦è¾¹çš„å·¦æ‹¬å·å’Œä»–ä¸€æ ·å¤šï¼Œåˆ™è´¡çŒ®ä¸ºå³æ‹¬å·çš„æ•°é‡åŠ ä¸Šå·¦è¾¹ç›¸é‚»åˆæ³•æ‹¬å·ä¸²çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå·¦è¾¹çš„å·¦æ‹¬å·æ¯”ä»–å°‘ï¼Œåˆ™è´¡çŒ®ä¸ºå³æ‹¬å·çš„æ•°é‡åŠ ä¸Šå·¦è¾¹ç›¸é‚»åˆæ³•æ‹¬å·ä¸²çš„æ•°é‡ï¼Œä½†æ˜¯è¿˜å‰©è‹¥å¹²å³æ‹¬å·æ²¡æœ‰åŒ¹é…ï¼Œå¾€å·¦æšä¸¾å·¦æ‹¬å·é‡å¤ä¸Šè¿°ä¸‰ç§æƒ…å†µå³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éœ€è¦ç»´æŠ¤ä¸€ä¸ªç‚¹ç»“å°¾å¤„åˆæ³•æ‹¬å·ä¸²çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb5&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb5-1&#34;&gt;&lt;a href=&#34;#cb5-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-2&#34;&gt;&lt;a href=&#34;#cb5-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-3&#34;&gt;&lt;a href=&#34;#cb5-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb5-4&#34;&gt;&lt;a href=&#34;#cb5-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll sum[maxn];&lt;/span&gt;
&lt;span id=&#34;cb5-5&#34;&gt;&lt;a href=&#34;#cb5-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb5-6&#34;&gt;&lt;a href=&#34;#cb5-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb5-7&#34;&gt;&lt;a href=&#34;#cb5-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb5-8&#34;&gt;&lt;a href=&#34;#cb5-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb5-9&#34;&gt;&lt;a href=&#34;#cb5-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-10&#34;&gt;&lt;a href=&#34;#cb5-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; i &amp;lt;= n; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb5-11&#34;&gt;&lt;a href=&#34;#cb5-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tot = a[i];&lt;/span&gt;
&lt;span id=&#34;cb5-12&#34;&gt;&lt;a href=&#34;#cb5-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; j &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; j -= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb5-13&#34;&gt;&lt;a href=&#34;#cb5-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!tot) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-14&#34;&gt;&lt;a href=&#34;#cb5-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!a[j]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-15&#34;&gt;&lt;a href=&#34;#cb5-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tot &amp;lt; a[j]) {&lt;/span&gt;
&lt;span id=&#34;cb5-16&#34;&gt;&lt;a href=&#34;#cb5-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans += tot;&lt;/span&gt;
&lt;span id=&#34;cb5-17&#34;&gt;&lt;a href=&#34;#cb5-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[j] -= tot;&lt;/span&gt;
&lt;span id=&#34;cb5-18&#34;&gt;&lt;a href=&#34;#cb5-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ++sum[i];&lt;/span&gt;
&lt;span id=&#34;cb5-19&#34;&gt;&lt;a href=&#34;#cb5-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-20&#34;&gt;&lt;a href=&#34;#cb5-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tot == a[j]) {&lt;/span&gt;
&lt;span id=&#34;cb5-21&#34;&gt;&lt;a href=&#34;#cb5-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans += tot + sum[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-22&#34;&gt;&lt;a href=&#34;#cb5-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                sum[i] += &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; + sum[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-23&#34;&gt;&lt;a href=&#34;#cb5-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[j] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-24&#34;&gt;&lt;a href=&#34;#cb5-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-25&#34;&gt;&lt;a href=&#34;#cb5-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb5-26&#34;&gt;&lt;a href=&#34;#cb5-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                tot -= a[j];&lt;/span&gt;
&lt;span id=&#34;cb5-27&#34;&gt;&lt;a href=&#34;#cb5-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans += a[j] + sum[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb5-28&#34;&gt;&lt;a href=&#34;#cb5-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                a[j] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-29&#34;&gt;&lt;a href=&#34;#cb5-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb5-30&#34;&gt;&lt;a href=&#34;#cb5-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb5-31&#34;&gt;&lt;a href=&#34;#cb5-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb5-32&#34;&gt;&lt;a href=&#34;#cb5-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans, &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb5-33&#34;&gt;&lt;a href=&#34;#cb5-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb5-34&#34;&gt;&lt;a href=&#34;#cb5-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;d---take-a-guess&#34;&gt;1556D - Take a Guess&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªå¾ˆå…³é”®çš„ç»“è®ºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a + b = (a\land b) + (a\lor b)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç›´æ¥è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(a_1 + a_i\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(i\le [2, n]\)&lt;/span&gt;ï¼‰ï¼Œç„¶åå†è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(a_2 + a_3\)&lt;/span&gt;ï¼Œå°±å¯ä»¥åˆšå¥½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; æ¬¡è¯¢é—®é‡Œé¢å¾—åˆ°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---equilibrium&#34;&gt;1556E - Equilibrium&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(c_i = b_i - a_i\)&lt;/span&gt;ï¼Œåˆ™ä¸€æ¬¡æ“ä½œå˜ä¸ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æŸäº›ä½ç½®ä¸ŠåŠ ä¸€ï¼ŒæŸäº›ä½ç½®ä¸Šå‡ä¸€ï¼Œç›®æ ‡å˜ä¸ºä½¿æŸä¸€æ®µ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å…¨éƒ¨å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯è¡Œæ€§ï¼šä¼šå‘ç°è¿™ä¸ªæ“ä½œæœ‰ç‚¹ç±»ä¼¼æ‹¬å·åŒ¹é…ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; ä¸Šçš„ä»»æ„ä½ç½®çš„å‰ç¼€å’Œä¸å¯å°äºé›¶è€Œä¸”æ€»å’Œè¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚å³ &lt;span class=&#34;math inline&#34;&gt;\(\min\{s_j\}\ge s_{l - 1}\)&lt;/span&gt;ã€‚éœ€è¦ä¸€ä¸ª RMQã€‚&lt;/p&gt;
&lt;p&gt;æ„é€ ç­”æ¡ˆï¼šå°†åŠ å‡æ³•ä¸¤ä¸¤é…å¯¹ä¹‹åå¤šç»„çš„ä¸€èµ·å®Œæˆã€‚å³ä¸ºåµŒå¥—æœ€æ·±çš„æ‹¬å·ï¼Œç›¸å½“äºçˆ¬å±±çˆ¬çš„æœ€é«˜å³°ï¼ŒæŸ¥ä¸€ä¸‹çˆ¬å±±çš„æœ€é«˜å³°å³å¯ã€‚ä¹Ÿéœ€è¦ä¸€ä¸ª RMQã€‚ç›´æ¥ä¸Šå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---sports-betting&#34;&gt;1556F - Sports Betting&lt;/h3&gt;
&lt;h3 id=&#34;g---gates-to-another-world&#34;&gt;1556G - Gates to Another World&lt;/h3&gt;
&lt;h2 id=&#34;codeforces-round-742-div.-2&#34;&gt;Codeforces Round #742 (Div. 2)&lt;/h2&gt;
&lt;p&gt;A + B + C&lt;/p&gt;
&lt;h3 id=&#34;c---carrying-conundrum&#34;&gt;1567C - Carrying Conundrum&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šå®šä¹‰ Alice çš„åŠ æ³•ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a + b\)&lt;/span&gt; ç«–å¼ä¸‹è¿›ä½è¿›åˆ°å‰é¢ä¸¤ä½å»ã€‚é—®æœ‰å¤šå°‘ç§æœ‰åºæ­£æ•´æ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a + b = n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è€ƒè™‘ DPï¼Œæ³¨æ„åˆ°åªæœ‰å½“å‰ä½å’Œåé¢ä¸€ä½æœ‰åæ•ˆæ€§ï¼Œæ‰€ä»¥å¯ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, k_0, k_1}\)&lt;/span&gt; è¡¨ç¤ºä»ä½åˆ°é«˜ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½ï¼Œå½“å‰ä½åŠä¸Šä¸€ä½æœ‰æ²¡æœ‰äº§ç”Ÿè¿›ä½ï¼Œè½¬ç§»æ˜“å¾—ï¼Œç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{len, 0, 0}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„éœ€è¦å»é™¤ &lt;span class=&#34;math inline&#34;&gt;\((n, 0)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((0, n)\)&lt;/span&gt;ã€‚&lt;a href=&#34;https://codeforces.com/contest/1567/submission/127974617&#34;&gt;è¯„æµ‹è®°å½•#127974617&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---expression-evaluation-error&#34;&gt;1567D - Expression Evaluation Error&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œè¦æ±‚åˆ’åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(n_1,\cdots n_s\)&lt;/span&gt;ï¼Œè¦æ±‚æŠŠè¿™äº›æ•°çœ‹æˆ &lt;span class=&#34;math inline&#34;&gt;\(11\)&lt;/span&gt; è¿›åˆ¶çš„ç„¶åæŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(11\)&lt;/span&gt; è¿›åˆ¶åŠ èµ·æ¥ä½¿å¾—ç»“æœæœ€å¤§ã€‚æ„é€ æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘æŒ‰ä½è´ªå¿ƒï¼šè®©æœ€é«˜ä½æœ€å¤§æ˜¯æ˜¾ç„¶çš„ï¼Œè®©å…¶ç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„æœ€é«˜ä½ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚ç„¶åæˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªæ„é€ å‡ºçš„æœ€å¤§ç»“æœä¸€å®šä¸ä¼šå¤§äº &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çœ‹æˆ &lt;span class=&#34;math inline&#34;&gt;\(11\)&lt;/span&gt; è¿›åˆ¶è¡¨ç¤ºçš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æœ€ä¼˜çš„åšæ³•æ˜¯å°½é‡è®© Alice ä¸è¦è¿›ä½ï¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; è¡¨ç¤ºæˆ &lt;span class=&#34;math inline&#34;&gt;\(10^k\)&lt;/span&gt; ä¹‹å’Œï¼Œä¾‹å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(25\)&lt;/span&gt; å°±å¯ä»¥è¢«è¡¨ç¤ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(10 + 10 + 1 + 1 + 1 + 1 + 1\)&lt;/span&gt;ã€‚ä½†æ˜¯éš¾å…æœ‰åˆ’åˆ†æ•°é‡å¤šçš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±ä»é«˜ä½å¾€ä½ä½è´ªï¼Œè®©é«˜ä½å°½é‡ä¸è¦è¿›ä½å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä»æœ€é«˜ä½å¾€æœ€ä½ä½ä¾æ¬¡åˆ’åˆ†å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---non-decreasing-dilemma&#34;&gt;1567E - Non-Decreasing Dilemma&lt;/h3&gt;
&lt;p&gt;å•ç‚¹ä¿®æ”¹åºåˆ—ï¼ŒåŒºé—´æŸ¥è¯¢ä¸é™å­æ®µä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªåŒºé—´çš„ç­”æ¡ˆï¼Œå·¦ç«¯çš„ä¸é™å­æ®µé•¿åº¦ï¼Œå³ç«¯çš„ä¸é™å­æ®µé•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ &lt;code&gt;pushup&lt;/code&gt; å³å¯ã€‚&lt;a href=&#34;https://codeforces.com/contest/1567/submission/127985171&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;f---one-four-overload&#34;&gt;1567F - One-Four Overload&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; çš„æ–¹æ ¼ï¼Œæœ‰ &lt;code&gt;.&lt;/code&gt; å’Œ &lt;code&gt;X&lt;/code&gt; ä¸¤ç§ç‚¹ï¼Œè¦æ±‚åœ¨ &lt;code&gt;.&lt;/code&gt; ä¸­å¡«å…¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt;ï¼Œ&lt;code&gt;X&lt;/code&gt; ç‚¹ä¸­å¡«å…¥ &lt;span class=&#34;math inline&#34;&gt;\(5\)&lt;/span&gt; çš„å€æ•°æ»¡è¶³å…¶ä¸ºä¸å…¶å››è”é€šçš„ &lt;code&gt;.&lt;/code&gt; ä¸­æ•°å­—ä¹‹å’Œã€‚è¾“å‡ºæ— è§£æˆ–æ„é€ æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ° &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
1&amp;amp;\equiv 1&amp;amp;\pmod 5\\
4&amp;amp;\equiv -1&amp;amp;\pmod 5
\end{aligned}
\]&lt;/span&gt; æ‰€ä»¥ï¼Œä¸éš¾å‘ç°ä¸€ä¸ª &lt;code&gt;X&lt;/code&gt; ç‚¹æ—è¾¹å¿…é¡»å…·æœ‰æ•°é‡ç›¸ç­‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt;ã€‚å¯¹äºå½¢å¦‚ &lt;code&gt;.X.&lt;/code&gt; çš„æƒ…å†µï¼Œåªéœ€è¦å»ºè¾¹ç„¶åäºŒåˆ†å›¾æŸ“è‰²ä¸€ä¸‹å°±å¥½äº†ã€‚å…³é”®æ˜¯å¯¹äºâ€œåâ€å­—å½¢çš„æˆ‘ä»¬æ€ä¹ˆå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨çº¸ä¸Šæ‰‹ç©å‡ ä¸ªå‘ç°å¯¹é¢çš„å¡«ç›¸åŒé¢œè‰²çš„æ˜¯æœ€ä¼˜çš„ï¼Œè¿™æ ·å­èƒ½æ–¹ä¾¿å…¶ä»–çš„æ„é€ æ–¹æ¡ˆï¼šå¦‚&lt;/p&gt;
&lt;pre class=&#34;plain&#34;&gt;&lt;code&gt;.1..
4X41
.1XX
.1X4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è¿™æ ·&lt;/p&gt;
&lt;pre class=&#34;plain&#34;&gt;&lt;code&gt;.1..
1X4.
.4XX
..X.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‘ç°æ„é€ ä¸å‡ºæ¥ã€‚æŒ‰ç…§ä¸Šè¿°æ–¹æ³•æ„é€ äºŒåˆ†å›¾ï¼ˆä¸ºä»€ä¹ˆæ˜¯äºŒåˆ†å›¾åº”è¯¥æŒºæ˜¾ç„¶çš„ï¼‰ç„¶åå°±å¯ä»¥é€šè¿‡äº†ã€‚&lt;a href=&#34;https://codeforces.com/contest/1567/submission/128134089&#34;&gt;è¯„æµ‹è®°å½•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-global-round-16&#34;&gt;Codeforces Global Round 16&lt;/h2&gt;
&lt;p&gt;A + B + C + D1ã€‚D2 å·²è¡¥ï¼Œæ°´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---buds-re-hanging&#34;&gt;1566E - Buds Re-hanging&lt;/h3&gt;
&lt;p&gt;å®šä¹‰ä¸€æ£µæœ‰æ ¹æ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸º bud å½“ä¸”ä»…å½“å…¶æœ‰è‡³å°‘ä¸€ä¸ªå„¿å­ä¸”å…¶æ‰€æœ‰å„¿å­éƒ½ä¸ºå¶èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æ“ä½œå¯ä»¥æå‡ºä¸€ä¸ª bud åŠå…¶å„¿å­ç„¶åæ¥åœ¨ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä¸‹é¢ã€‚&lt;/p&gt;
&lt;p&gt;é—®è‹¥å¹²æ¬¡æ“ä½œä¹‹åå¶å­èŠ‚ç‚¹æœ€å°‘ä¸ºå¤šå°‘ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª bud æ¥åœ¨ä¸€ä¸ªå¶å­ä¸‹ä¹‹åä¼šä½¿å¾—å¶å­èŠ‚ç‚¹è‡³å¤šå‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼ˆå¦‚æœ bud ä¸Šé¢æ˜¯æ ¹åˆ™ä¼šå‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼‰ã€‚è€Œä¸”ç§»åŠ¨ bud çš„è¿‡ç¨‹å¯é€†ï¼Œä¸å¦¨å°†æ‰€æœ‰çš„ bud æ‰¾å‡ºæ¥æ¥åœ¨æ ¹ä¸Šï¼Œè®¾æ ‘èŠ‚ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œbud æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªï¼Œåˆ™å¶å­èŠ‚ç‚¹æ•°è‚¯å®šä¸º &lt;span class=&#34;math inline&#34;&gt;\(n - k - 1\)&lt;/span&gt;ï¼ˆæ€»ç»“ç‚¹å‡å»æ ¹å’Œæ¯ä¸ª budï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè€ƒè™‘å¦‚æœæ ¹ä¸Šè‡³å°‘è¿æœ‰ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œåˆ™æŠŠæ‰€æœ‰çš„ bud ä¾æ¬¡æ¥ä¸Šå»ï¼Œä¸€å…±ä¼šæ¥ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡ï¼Œç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(n - 2k - 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ ¹ä¸Šæ²¡æœ‰ç›´æ¥è¿çš„å¶å­èŠ‚ç‚¹ï¼Œåˆ™æŠŠæ¯ä¸ª bud ä¾æ¬¡åˆå¹¶ï¼Œæ¥ &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; æ¬¡ï¼Œç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(n - k - 1 - (k -1) = n - 2k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb8&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb8-1&#34;&gt;&lt;a href=&#34;#cb8-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-2&#34;&gt;&lt;a href=&#34;#cb8-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-3&#34;&gt;&lt;a href=&#34;#cb8-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, head[maxn], to[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], nxt[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], cnte, d[maxn], k;&lt;/span&gt;
&lt;span id=&#34;cb8-4&#34;&gt;&lt;a href=&#34;#cb8-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-5&#34;&gt;&lt;a href=&#34;#cb8-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; add(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v) {&lt;/span&gt;
&lt;span id=&#34;cb8-6&#34;&gt;&lt;a href=&#34;#cb8-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    to[++cnte] = v;&lt;/span&gt;
&lt;span id=&#34;cb8-7&#34;&gt;&lt;a href=&#34;#cb8-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    nxt[cnte] = head[u];&lt;/span&gt;
&lt;span id=&#34;cb8-8&#34;&gt;&lt;a href=&#34;#cb8-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    head[u] = cnte;&lt;/span&gt;
&lt;span id=&#34;cb8-9&#34;&gt;&lt;a href=&#34;#cb8-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-10&#34;&gt;&lt;a href=&#34;#cb8-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb8-11&#34;&gt;&lt;a href=&#34;#cb8-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-12&#34;&gt;&lt;a href=&#34;#cb8-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa) {&lt;/span&gt;
&lt;span id=&#34;cb8-13&#34;&gt;&lt;a href=&#34;#cb8-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; flag = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-14&#34;&gt;&lt;a href=&#34;#cb8-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = head[u]; i; i = nxt[i]) {&lt;/span&gt;
&lt;span id=&#34;cb8-15&#34;&gt;&lt;a href=&#34;#cb8-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v = to[i];&lt;/span&gt;
&lt;span id=&#34;cb8-16&#34;&gt;&lt;a href=&#34;#cb8-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v == fa) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-17&#34;&gt;&lt;a href=&#34;#cb8-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(v, u);&lt;/span&gt;
&lt;span id=&#34;cb8-18&#34;&gt;&lt;a href=&#34;#cb8-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (d[v] == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) flag = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-19&#34;&gt;&lt;a href=&#34;#cb8-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-20&#34;&gt;&lt;a href=&#34;#cb8-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (fa) {&lt;/span&gt;
&lt;span id=&#34;cb8-21&#34;&gt;&lt;a href=&#34;#cb8-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (flag) ++k, d[u] = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-22&#34;&gt;&lt;a href=&#34;#cb8-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; d[u] = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-23&#34;&gt;&lt;a href=&#34;#cb8-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-24&#34;&gt;&lt;a href=&#34;#cb8-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-25&#34;&gt;&lt;a href=&#34;#cb8-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb8-26&#34;&gt;&lt;a href=&#34;#cb8-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb8-27&#34;&gt;&lt;a href=&#34;#cb8-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb8-28&#34;&gt;&lt;a href=&#34;#cb8-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb8-29&#34;&gt;&lt;a href=&#34;#cb8-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb8-30&#34;&gt;&lt;a href=&#34;#cb8-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n);&lt;/span&gt;
&lt;span id=&#34;cb8-31&#34;&gt;&lt;a href=&#34;#cb8-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) head[i] = d[i] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-32&#34;&gt;&lt;a href=&#34;#cb8-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-33&#34;&gt;&lt;a href=&#34;#cb8-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb8-34&#34;&gt;&lt;a href=&#34;#cb8-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u), read(v);&lt;/span&gt;
&lt;span id=&#34;cb8-35&#34;&gt;&lt;a href=&#34;#cb8-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            add(u, v), add(v, u);&lt;/span&gt;
&lt;span id=&#34;cb8-36&#34;&gt;&lt;a href=&#34;#cb8-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb8-37&#34;&gt;&lt;a href=&#34;#cb8-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-38&#34;&gt;&lt;a href=&#34;#cb8-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-39&#34;&gt;&lt;a href=&#34;#cb8-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = head[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]; i; i = nxt[i])&lt;/span&gt;
&lt;span id=&#34;cb8-40&#34;&gt;&lt;a href=&#34;#cb8-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (d[to[i]] == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {s = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;}&lt;/span&gt;
&lt;span id=&#34;cb8-41&#34;&gt;&lt;a href=&#34;#cb8-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(n - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * k - s), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb8-42&#34;&gt;&lt;a href=&#34;#cb8-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb8-43&#34;&gt;&lt;a href=&#34;#cb8-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb8-44&#34;&gt;&lt;a href=&#34;#cb8-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-743-div.-12&#34;&gt;Codeforces Round #743 (Div. 1/2)&lt;/h2&gt;
&lt;p&gt;VP on 21/10/09ã€‚D2A + D2B + D1A + D1Bã€‚&lt;/p&gt;
&lt;h3 id=&#34;b---xor-of-3&#34;&gt;1572B - Xor of 3&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆæœ‰è§£çš„å¿…è¦æ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°ä¸ºå¶æ•°ä¸ªï¼Œå› ä¸ºæ¯æ¬¡æ“ä½œæ˜¯ä¸ä¼šæ”¹å˜ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°çš„å¥‡å¶æ€§çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè€ƒè™‘æ„é€ ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆæ‰§è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(n - 2, \cdots, 3, 1\)&lt;/span&gt;ï¼Œè¿™æ ·å­ä¹‹å &lt;span class=&#34;math inline&#34;&gt;\(a_1 = 0\)&lt;/span&gt;ï¼Œç„¶åå†æ‰§è¡Œä¸€é &lt;span class=&#34;math inline&#34;&gt;\(1, 3, \cdots, n - 2\)&lt;/span&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¶æ•°çš„æƒ…å†µå°†å…¶æ‹†æˆä¸¤æ®µé•¿åº¦ä¸ºå¥‡æ•°çš„å«å¶æ•°ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ç„¶ååˆ†å¼€åšå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---paint&#34;&gt;1572C - Paint&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæœ€å¤šå« &lt;span class=&#34;math inline&#34;&gt;\(20\)&lt;/span&gt; ç§é¢œè‰²çš„åºåˆ—ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æŠŠä¸€æ®µé¢œè‰²ç›¸åŒçš„åŒºé—´æŸ“æˆä¸€ç§é¢œè‰²ï¼Œé—®å°†æ‰€æœ‰é¢œè‰²æŸ“æˆåŒä¸€ç§çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 3000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åŒºé—´ dpã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè‚¯å®šå°†ç›¸é‚»çš„åŒè‰²ç¼©èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; ä¸º&lt;strong&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\([i, j]\)&lt;/span&gt; æŸ“æˆ &lt;span class=&#34;math inline&#34;&gt;\(c_j\)&lt;/span&gt; çš„æœ€å°ä»£ä»·&lt;/strong&gt;ã€‚ä¸ºä»€ä¹ˆè¿™æ ·å®šä¹‰çŠ¶æ€æ˜¯å› ä¸ºä¸€å®šå­˜åœ¨ä¸€ç§æ–¹æ¡ˆä½¿å¾—æœ€åçš„é¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c_j\)&lt;/span&gt;ï¼Œå®¹æ˜“å‘ç°å°† &lt;span class=&#34;math inline&#34;&gt;\([1, j - 1]\)&lt;/span&gt; åŒè‰²ä¹‹åå†å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c_j\)&lt;/span&gt; ç»Ÿä¸€æ˜¯ä¸ä¼šæ›´åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j} = \min\{f_{i + 1, j}, f_{i, j - 1} \} + 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œå¦‚æœå­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(i\le k &amp;lt; j\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(c_k = c_j\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(f_{i, k} + f_{k + 1, j}\)&lt;/span&gt; è½¬ç§»è¿‡æ¥ã€‚è®°å½•ä¸€ä¸‹ä¸Šä¸€ä¸ªä¸ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; é¢œè‰²ç›¸åŒçš„ç‚¹å°±å¯ä»¥äº†ã€‚ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{1, n}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---bridge-club&#34;&gt;1572D - Bridge Club&lt;/h3&gt;
&lt;p&gt;æ˜¾ç„¶ï¼Œå›¾ä¸ºäºŒåˆ†å›¾ï¼ŒæŒ‰ç…§äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°å³å¯åˆ†ä¸ºå·¦éƒ¨å’Œå³éƒ¨ï¼Œä¸­é—´è¿æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i + a_j\)&lt;/span&gt; çš„è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ç›´æ¥è´¹ç”¨æµæˆ–è€… KM éƒ½ä¼šæ­»æ‰ï¼Œå› ä¸ºç‚¹æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(2^n)\)&lt;/span&gt; çº§åˆ«ï¼Œè¾¹æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n2^n)\)&lt;/span&gt; çº§åˆ«ï¼Œå¿…æ­»æ— ç–‘ã€‚ä½†æ˜¯æ³¨æ„åˆ°è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ˜¯å¾ˆå°çš„ï¼Œæˆ‘ä»¬éœ€è¦ä» &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸Šä¸‹æ‰‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°ï¼Œæ¯ä¸ªç‚¹ä¼šè¿å‡ºå» &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¡è¾¹ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªåŒ¹é…ï¼Œé‚£ä¹ˆå‰©ä¸‹èƒ½åŒ¹é…çš„æ–¹æ¡ˆæ•°å°±ä¼šå‡å°‘ &lt;span class=&#34;math inline&#34;&gt;\(2(n - 1)\)&lt;/span&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªåŒ¹é…åæœ€å¤šåªä¼šå‡å°‘ &lt;span class=&#34;math inline&#34;&gt;\(k(2n - 1)\)&lt;/span&gt; ä¸ªåŒ¹é…æ–¹å¼ï¼Œå³æˆ‘ä»¬é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(k(2n - 1)\)&lt;/span&gt; ä¸ªåŒ¹é…å°±ä¼šè‡³å°‘å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªåŒ¹é…ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é€‰å‡ºæœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(k(2n - 1)\)&lt;/span&gt; æ¡è¾¹ï¼Œç„¶åè·‘è´¹ç”¨æµå°±è¡Œäº†ï¼Œä¸éš¾å‘ç°ä¸€å®šæœ‰æœ€ä¼˜çš„æ–¹æ¡ˆå­˜åœ¨åœ¨è¿™æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(k(2n - 1)\)&lt;/span&gt; æ¡è¾¹é‡Œé¢ï¼Œè¯æ˜å¯ç”¨åè¯æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“å®ç°ä¸­ï¼Œé€‰å‡ºæœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(k(2n - 1)\)&lt;/span&gt; æ¡è¾¹æˆ‘ä»¬ä½¿ç”¨ STL çš„ &lt;code&gt;nth_element()&lt;/code&gt; å‡½æ•°ï¼Œå…¶å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(\text{length of the seq})\)&lt;/span&gt;ï¼Œæœ¬é¢˜ä¸­ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n2^n\)&lt;/span&gt;ï¼Œç„¶åæ³¨æ„åŠ è¾¹çš„æ—¶å€™ä¸è¦ç»™æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\([0, 2^n - 1]\)&lt;/span&gt; çš„çƒå‘˜éƒ½åŠ è¾¹ï¼Œå¦åˆ™ä¼š TLEã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---polygon&#34;&gt;1572E - Polygon&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªä¸¥æ ¼å‡¸å¤šè¾¹å½¢ï¼Œæœ€å¤§åŒ–åˆ’ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; åˆ€åçš„æœ€å°é¢ç§¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(3\le n\le 200, 0\le k\le n - 3\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;äºŒåˆ†è¿™ä¸ªæœ€å°é¢ç§¯ã€‚ç°åœ¨æˆ‘ä»¬å°±éœ€è¦åˆ’å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(k + 1\)&lt;/span&gt; ä¸ªåŒºåŸŸçš„é¢ç§¯éƒ½å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åªè€ƒè™‘åˆ’åˆ† &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; è¿™ä¸ªåŒºé—´çš„ç‚¹ï¼Œæœ‰ä¸ªè´ªå¿ƒå°±æ˜¯æˆ‘ä»¬å°½å¯èƒ½å¤šåˆ’åˆ†ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ç›¸é‚»çš„è¿™éƒ¨åˆ†æœ‰å¯èƒ½é¢ç§¯ä¸å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œæˆ‘ä»¬è¦è®©å…¶å°½å¯èƒ½å¤§ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{l, r} = (K, M)\)&lt;/span&gt; è¡¨ç¤ºæœ€å¤šåˆ’åˆ†å‡ºäº† &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; å—åˆæ³•çš„åŒºåŸŸï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ç›¸é‚»éƒ¨åˆ†è¿™å—ä¸‰è§’å½¢çš„æœ€å¤§é¢ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ã€‚è½¬ç§»æ˜“å¾—ï¼Œæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(k\in(l, r)\)&lt;/span&gt; ç„¶åè€ƒè™‘åˆå¹¶ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;åªè¦ &lt;span class=&#34;math inline&#34;&gt;\(f_{1, n}\ge k + 1\)&lt;/span&gt;ï¼Œå°±è¯´æ˜äºŒåˆ†å‡ºæ¥è¿™ä¸ªé¢ç§¯æ˜¯åˆæ³•çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb9&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb9-1&#34;&gt;&lt;a href=&#34;#cb9-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-2&#34;&gt;&lt;a href=&#34;#cb9-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = &lt;span class=&#34;bu&#34;&gt;std::&lt;/span&gt;pair&amp;lt;ll, ll&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-3&#34;&gt;&lt;a href=&#34;#cb9-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-4&#34;&gt;&lt;a href=&#34;#cb9-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;205&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-5&#34;&gt;&lt;a href=&#34;#cb9-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll x[maxn], y[maxn];&lt;/span&gt;
&lt;span id=&#34;cb9-6&#34;&gt;&lt;a href=&#34;#cb9-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k;&lt;/span&gt;
&lt;span id=&#34;cb9-7&#34;&gt;&lt;a href=&#34;#cb9-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pii f[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb9-8&#34;&gt;&lt;a href=&#34;#cb9-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-9&#34;&gt;&lt;a href=&#34;#cb9-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll S(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; (x[j] - x[i]) * (y[k] - y[i]) - (y[j] - y[i]) * (x[k] - x[i]);}&lt;/span&gt;
&lt;span id=&#34;cb9-10&#34;&gt;&lt;a href=&#34;#cb9-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-11&#34;&gt;&lt;a href=&#34;#cb9-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(ll mid) {&lt;/span&gt;
&lt;span id=&#34;cb9-12&#34;&gt;&lt;a href=&#34;#cb9-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(len, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb9-13&#34;&gt;&lt;a href=&#34;#cb9-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j = i + len - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; j &amp;lt;= n; ++i, ++j) {&lt;/span&gt;
&lt;span id=&#34;cb9-14&#34;&gt;&lt;a href=&#34;#cb9-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i][j] = pii(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb9-15&#34;&gt;&lt;a href=&#34;#cb9-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(k, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb9-16&#34;&gt;&lt;a href=&#34;#cb9-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll K = f[i][k].first + f[k][j].first;&lt;/span&gt;
&lt;span id=&#34;cb9-17&#34;&gt;&lt;a href=&#34;#cb9-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ll M = f[i][k].second + f[k][j].second + S(i, k, j);&lt;/span&gt;
&lt;span id=&#34;cb9-18&#34;&gt;&lt;a href=&#34;#cb9-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (M &amp;gt;= mid) f[i][j] = max(f[i][j], pii(K + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb9-19&#34;&gt;&lt;a href=&#34;#cb9-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; f[i][j] = max(f[i][j], pii(K, M));&lt;/span&gt;
&lt;span id=&#34;cb9-20&#34;&gt;&lt;a href=&#34;#cb9-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb9-21&#34;&gt;&lt;a href=&#34;#cb9-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb9-22&#34;&gt;&lt;a href=&#34;#cb9-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb9-23&#34;&gt;&lt;a href=&#34;#cb9-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][n].first &amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb9-24&#34;&gt;&lt;a href=&#34;#cb9-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb9-25&#34;&gt;&lt;a href=&#34;#cb9-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb9-26&#34;&gt;&lt;a href=&#34;#cb9-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb9-27&#34;&gt;&lt;a href=&#34;#cb9-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(k);&lt;/span&gt;
&lt;span id=&#34;cb9-28&#34;&gt;&lt;a href=&#34;#cb9-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(x[i]), read(y[i]);&lt;/span&gt;
&lt;span id=&#34;cb9-29&#34;&gt;&lt;a href=&#34;#cb9-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = &lt;span class=&#34;fl&#34;&gt;4e18&lt;/span&gt;, ans;&lt;/span&gt;
&lt;span id=&#34;cb9-30&#34;&gt;&lt;a href=&#34;#cb9-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt;= r) {&lt;/span&gt;
&lt;span id=&#34;cb9-31&#34;&gt;&lt;a href=&#34;#cb9-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-32&#34;&gt;&lt;a href=&#34;#cb9-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (check(mid)) ans = mid, l = mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-33&#34;&gt;&lt;a href=&#34;#cb9-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; r = mid - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-34&#34;&gt;&lt;a href=&#34;#cb9-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb9-35&#34;&gt;&lt;a href=&#34;#cb9-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans, &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb9-36&#34;&gt;&lt;a href=&#34;#cb9-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb9-37&#34;&gt;&lt;a href=&#34;#cb9-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-745-div.-12&#34;&gt;Codeforces Round #745 (Div. 1/2)&lt;/h2&gt;
&lt;p&gt;çœŸçš„å¾ˆæ¯’ç˜¤çš„åœºã€‚Terrible Roundã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---subsequence&#34;&gt;1580D - Subsequence&lt;/h3&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œæ‰€æœ‰å…ƒç´ ä¸¤ä¸¤ä¸åŒã€‚éœ€è¦é€‰æ‹©ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„å­åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{b_1}, a_{b_2},\cdots, a_{b_m}\)&lt;/span&gt;ï¼Œè¦ä½¿å¾—å…¶ä»£ä»·æœ€å¤§ã€‚&lt;/p&gt;
&lt;p&gt;å­åºåˆ—çš„ä»·å€¼è¢«å®šä¹‰ä¸º &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=1}^m(m\cdot a_{b_i}) - \sum_{i=1}^m\sum_{j=1}^mf(\min(b_i, b_j), \max(b_i, b_j))
\]&lt;/span&gt; å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(f(x, y)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(\min_{x\le i\le y}\{a_i \}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le n\le 4000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åŒ–å‡ºå¼å­ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i = 1}^m(m - 1)a_{b_i} - 2\sum_{i=1}^{m-1}\sum_{j=i+1}^mf(b_i, b_j)
\]&lt;/span&gt; ç„¶ååƒ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; è¿™ç§ä¸€è„¸ RMQ æ ·çš„ä¸œè¥¿è€ƒè™‘æ”¾åˆ°ç¬›å¡å°”æ ‘ä¸Šï¼Œç„¶åå†åŒ–å¥½çœ‹ä¸€ç‚¹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=1}^{m-1}\sum_{j=i+1}^m a_{b_i} + a_{b_j} - 2f(b_i, b_j)
\]&lt;/span&gt; é‚£å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_{b_i} + a_{b_j}\)&lt;/span&gt; å†å‡å»ä¸¤å€ä»–ä»¬çš„ LCA çš„å€¼ï¼Œå¾ˆåƒä¸¤ç‚¹é—´çš„æ ‘ä¸Šè·ç¦»ã€‚è€ƒè™‘æ ‘å½¢ dp &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å­æ ‘é‡Œé¢é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªå…ƒç´ çš„æœ€å¤§ä»£ä»·ï¼Œå®¹æ˜“çŸ¥é“æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb10&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb10-1&#34;&gt;&lt;a href=&#34;#cb10-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-2&#34;&gt;&lt;a href=&#34;#cb10-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;4005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-3&#34;&gt;&lt;a href=&#34;#cb10-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, ls[maxn], rs[maxn], stk[maxn], top;&lt;/span&gt;
&lt;span id=&#34;cb10-4&#34;&gt;&lt;a href=&#34;#cb10-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll a[maxn], size[maxn], f[maxn][maxn], w[maxn];&lt;/span&gt;
&lt;span id=&#34;cb10-5&#34;&gt;&lt;a href=&#34;#cb10-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-6&#34;&gt;&lt;a href=&#34;#cb10-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u) {&lt;/span&gt;
&lt;span id=&#34;cb10-7&#34;&gt;&lt;a href=&#34;#cb10-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    size[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-8&#34;&gt;&lt;a href=&#34;#cb10-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ls[u]) {&lt;/span&gt;
&lt;span id=&#34;cb10-9&#34;&gt;&lt;a href=&#34;#cb10-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(ls[u]), w[ls[u]] = a[ls[u]] - a[u];&lt;/span&gt;
&lt;span id=&#34;cb10-10&#34;&gt;&lt;a href=&#34;#cb10-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, size[u], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-11&#34;&gt;&lt;a href=&#34;#cb10-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DEC(j, size[ls[u]], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-12&#34;&gt;&lt;a href=&#34;#cb10-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmax(f[u][i + j], f[u][i] + f[ls[u]][j] + j * (m - j) * w[ls[u]]);&lt;/span&gt;
&lt;span id=&#34;cb10-13&#34;&gt;&lt;a href=&#34;#cb10-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        size[u] += size[ls[u]];&lt;/span&gt;
&lt;span id=&#34;cb10-14&#34;&gt;&lt;a href=&#34;#cb10-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-15&#34;&gt;&lt;a href=&#34;#cb10-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (rs[u]) {&lt;/span&gt;
&lt;span id=&#34;cb10-16&#34;&gt;&lt;a href=&#34;#cb10-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(rs[u]), w[rs[u]] = a[rs[u]] - a[u];&lt;/span&gt;
&lt;span id=&#34;cb10-17&#34;&gt;&lt;a href=&#34;#cb10-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, size[u], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-18&#34;&gt;&lt;a href=&#34;#cb10-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DEC(j, size[rs[u]], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb10-19&#34;&gt;&lt;a href=&#34;#cb10-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmax(f[u][i + j], f[u][i] + f[rs[u]][j] + j * (m - j) * w[rs[u]]);&lt;/span&gt;
&lt;span id=&#34;cb10-20&#34;&gt;&lt;a href=&#34;#cb10-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        size[u] += size[rs[u]];&lt;/span&gt;
&lt;span id=&#34;cb10-21&#34;&gt;&lt;a href=&#34;#cb10-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-22&#34;&gt;&lt;a href=&#34;#cb10-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-23&#34;&gt;&lt;a href=&#34;#cb10-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb10-24&#34;&gt;&lt;a href=&#34;#cb10-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb10-25&#34;&gt;&lt;a href=&#34;#cb10-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb10-26&#34;&gt;&lt;a href=&#34;#cb10-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb10-27&#34;&gt;&lt;a href=&#34;#cb10-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]);&lt;/span&gt;
&lt;span id=&#34;cb10-28&#34;&gt;&lt;a href=&#34;#cb10-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    stk[top = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-29&#34;&gt;&lt;a href=&#34;#cb10-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb10-30&#34;&gt;&lt;a href=&#34;#cb10-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top &amp;amp;&amp;amp; a[stk[top]] &amp;gt; a[i]) --top;&lt;/span&gt;
&lt;span id=&#34;cb10-31&#34;&gt;&lt;a href=&#34;#cb10-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!top) ls[i] = stk[top + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb10-32&#34;&gt;&lt;a href=&#34;#cb10-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; ls[i] = rs[stk[top]], rs[stk[top]] = i;&lt;/span&gt;
&lt;span id=&#34;cb10-33&#34;&gt;&lt;a href=&#34;#cb10-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        stk[++top] = i;&lt;/span&gt;
&lt;span id=&#34;cb10-34&#34;&gt;&lt;a href=&#34;#cb10-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb10-35&#34;&gt;&lt;a href=&#34;#cb10-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs(stk[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb10-36&#34;&gt;&lt;a href=&#34;#cb10-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(f[stk[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]][m]);&lt;/span&gt;
&lt;span id=&#34;cb10-37&#34;&gt;&lt;a href=&#34;#cb10-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb10-38&#34;&gt;&lt;a href=&#34;#cb10-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-746-div.-2&#34;&gt;Codeforces Round #746 (Div. 2)&lt;/h2&gt;
&lt;p&gt;é¢˜ç›®å‡ºå¾—ä¸é”™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---bakry-and-partitioning&#34;&gt;1592C - Bakry and Partitioning&lt;/h3&gt;
&lt;p&gt;é—®å°†ä¸€æ£µæ ‘åˆ’åˆ†ä¸ºæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªè¿é€šå—ï¼Œè¦æ±‚è¿™äº›è¿é€šå—å†…ç‚¹æƒçš„å¼‚æˆ–å’Œç›¸ç­‰ï¼Œé—®æ˜¯å¦æœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå‘ç°ï¼Œå¦‚æœæ‰€æœ‰çš„ç‚¹æƒå¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œåˆ™å¿…ç„¶æœ‰è§£ï¼Œè€Œä¸”æ–­æ‰ä»»æ„ä¸€æ¡è¾¹éƒ½æ˜¯å¯ä»¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œå¼‚æˆ–å’Œå¯èƒ½ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œæˆ‘ä»¬ä¸å¦¨è®¾å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚è€Œæ ¹æ®å¼‚æˆ–çš„æ€§è´¨ï¼Œæˆ‘ä»¬çŸ¥é“åˆ’åˆ†å‡ºæ¥çš„å„ä¸ªè¿é€šå—çš„å¼‚æˆ–å’Œåªèƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼Œè€Œä¸”è¿é€šå—çš„ä¸ªæ•°ä¸ºå¥‡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿè€ƒè™‘åˆ’åˆ†ä¸ºä¸‰ä¸ªè¿é€šå—çš„æƒ…å†µï¼šæ—¢è¦å¼‚æˆ–èµ·æ¥ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; åˆè¦ä¸¤ä¸¤ç›¸ç­‰ï¼Œä¸éš¾å‘ç°åªèƒ½ä¸ºä¸‰ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚ç„¶åæˆ‘ä»¬åˆä¼šå‘ç°ï¼Œä½†å‡¡æœ‰è§£ï¼Œä¸€å®šèƒ½åˆ’åˆ†ä¸ºè¿™æ ·çš„ä¸‰ä¸ªè¿é€šå—ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨é—®é¢˜å°±è½¬åŒ–ä¸ºäº†æ‰¾åˆ°ä¸‰ä¸ªè¿é€šå—ä½¿å¾—ä»–ä»¬çš„å¼‚æˆ–å’Œéƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ã€‚dfs æ‰«æä¸€éå³å¯ã€‚å¦‚æœé‡åˆ°ä¸€ä¸ªèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æœ‰ä¸¤ä¸ªå­æ ‘ &lt;span class=&#34;math inline&#34;&gt;\(v_1,v_2\)&lt;/span&gt; å†…å«å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„å­æ ‘ï¼Œåˆ™ä¸€å®šæœ‰è§£ã€‚è€Œä¸”ï¼Œå¦‚æœå½“å‰å­æ ‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä¸”å­˜åœ¨ä¸€ä¸ªåŒ…å«åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å†…çš„å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„å­æ ‘ï¼Œåˆ™ä¹Ÿä¸€å®šæœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;ç¨åŠ åˆ†æå¯çŸ¥ä¸Šé¢ä¸¤ç§æ¶µç›–äº†æ‰€æœ‰çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---hemose-in-icpc&#34;&gt;1592D - Hemose in ICPC ?&lt;/h3&gt;
&lt;p&gt;ç‚¹æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(n \le 1000\)&lt;/span&gt;ï¼‰çš„æ ‘ï¼Œæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(12\)&lt;/span&gt; æ¬¡æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢ç»™å®šä¸€ä¸ªç‚¹é›†ï¼Œè¿”å›æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(Dist(u, v)\)&lt;/span&gt;ï¼Œä»£è¡¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ç®€å•è·¯å¾„ä¸Šçš„è¾¹æƒçš„ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt;ã€‚è¦æ±‚æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; åªä¼šå‡å°ï¼Œä¸ä¼šå¢å¤§ï¼Œå› æ­¤ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(u, v)\)&lt;/span&gt; æœ€å¤§æ—¶ä¸€å®šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ç›¸è¿ï¼Œç›¸å½“äºæˆ‘ä»¬è¦æ‰¾è¿™æ£µæ ‘çš„æœ€å¤§è¾¹æƒã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•å»æ‰¾ï¼Ÿè¿™ä¸ªæŸ¥è¯¢æ¬¡æ•°å’Œæ•°æ®èŒƒå›´å¾ˆæ˜æ˜¾çš„æš—ç¤ºäº†æˆ‘ä»¬è¦äºŒåˆ†ä¸€ä¸ªç‚¹é›†ï¼Œå¯æ˜¯æˆ‘ä»¬å¦‚ä½•ä¿è¯äºŒåˆ†å‡ºæ¥çš„ä¸¤ä¸ªç‚¹é›†æ˜¯è”é€šçš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è€ƒè™‘è¿™æ£µæ ‘çš„æ¬§æ‹‰åºï¼Œå°†æ¬§æ‹‰åºå»ºå‡ºæ¥åä¼šå‘ç°ä¸¤ä¸¤ä¹‹é—´ä¸€å®šæ˜¯æœ‰è¾¹çš„ï¼Œæ‰€ä»¥åœ¨æ¬§æ‹‰åºä¸ŠäºŒåˆ†æ‰¾æœ€å¤§å€¼å°±å¯ä»¥äº†ï¼Œå¯ä»¥ä¿è¯æŸ¥è¯¢æ¬¡æ•°æœ€å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(1 + \log(2n - 1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°èµ·æ¥å¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-747-div.-2&#34;&gt;Codeforces Round #747 (Div. 2)&lt;/h2&gt;
&lt;p&gt;A + B + C + D + E1ã€‚rk 606ã€‚è¡¥å®Œäº†ï¼Œå¥½è€¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e2---rubiks-cube-coloring-hard-version&#34;&gt;1594E2 - Rubikâ€™s Cube Coloring (hard version)&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼š&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å±‚çš„æ»¡äºŒå‰æ ‘ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªèŠ‚ç‚¹å·²ç»è¢«æŸ“è‰²ï¼Œé¢œè‰²æ¥è‡ªé­”æ–¹çš„å…­ç§é¢œè‰²ã€‚è¦æ±‚æ ‘ä¸Šç›¸é‚»çš„èŠ‚ç‚¹æŸ“çš„é¢œè‰²ä¸èƒ½ä¸ºé­”æ–¹ä¸Šä¸ ç›¸é‚»çš„é¢œè‰²ï¼Œé—®å°†æ•´æ£µæ ‘æ¶‚æ»¡çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç»§æ‰¿ä¸€ä¸‹ E1 çš„åšæ³•ï¼Œæ²¡æœ‰é¢„å…ˆé’¦å®šçš„é¢œè‰²é‚£ä¹ˆç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(6\times 4^{2^k - 2}\)&lt;/span&gt;ã€‚æˆ‘ä»¬å‘ç°ï¼Œå·²ç»é’¦å®šå¥½çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ä¼šå½±å“å…¶åˆ°æ ¹çš„ä¸€æ¡è·¯å¾„ï¼ŒæŠŠè¿™æ¡è·¯å¾„æŠ½å‡ºæ¥ dp å³å¯ã€‚ç„¶åä»¤æ²¡æœ‰è¢«å½±å“çš„ç‚¹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªï¼Œç­”æ¡ˆä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(4^m\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb11&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb11-1&#34;&gt;&lt;a href=&#34;#cb11-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb11-2&#34;&gt;&lt;a href=&#34;#cb11-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-3&#34;&gt;&lt;a href=&#34;#cb11-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-4&#34;&gt;&lt;a href=&#34;#cb11-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;string, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; st;&lt;/span&gt;
&lt;span id=&#34;cb11-5&#34;&gt;&lt;a href=&#34;#cb11-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;ll, modint&amp;gt; f[&lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb11-6&#34;&gt;&lt;a href=&#34;#cb11-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; mp;&lt;/span&gt;
&lt;span id=&#34;cb11-7&#34;&gt;&lt;a href=&#34;#cb11-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;ll, set&amp;lt;ll&amp;gt; &amp;gt; G;&lt;/span&gt;
&lt;span id=&#34;cb11-8&#34;&gt;&lt;a href=&#34;#cb11-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll k, n;&lt;/span&gt;
&lt;span id=&#34;cb11-9&#34;&gt;&lt;a href=&#34;#cb11-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-10&#34;&gt;&lt;a href=&#34;#cb11-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(ll u) {&lt;/span&gt;
&lt;span id=&#34;cb11-11&#34;&gt;&lt;a href=&#34;#cb11-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; v : G[u]) dfs(v);&lt;/span&gt;
&lt;span id=&#34;cb11-12&#34;&gt;&lt;a href=&#34;#cb11-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(c, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb11-13&#34;&gt;&lt;a href=&#34;#cb11-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (~mp[u] &amp;amp;&amp;amp; c ^ mp[u]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-14&#34;&gt;&lt;a href=&#34;#cb11-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[c][u] = ~mp[u] ? &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-15&#34;&gt;&lt;a href=&#34;#cb11-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; v : G[u])&lt;/span&gt;
&lt;span id=&#34;cb11-16&#34;&gt;&lt;a href=&#34;#cb11-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[c][u] *= (f[(c + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) % &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;][v] + f[(c + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) % &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;][v]);&lt;/span&gt;
&lt;span id=&#34;cb11-17&#34;&gt;&lt;a href=&#34;#cb11-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-18&#34;&gt;&lt;a href=&#34;#cb11-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-19&#34;&gt;&lt;a href=&#34;#cb11-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb11-20&#34;&gt;&lt;a href=&#34;#cb11-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb11-21&#34;&gt;&lt;a href=&#34;#cb11-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb11-22&#34;&gt;&lt;a href=&#34;#cb11-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-23&#34;&gt;&lt;a href=&#34;#cb11-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin.tie(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-24&#34;&gt;&lt;a href=&#34;#cb11-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; k &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb11-25&#34;&gt;&lt;a href=&#34;#cb11-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    st[&lt;span class=&#34;st&#34;&gt;&amp;quot;white&amp;quot;&lt;/span&gt;] = st[&lt;span class=&#34;st&#34;&gt;&amp;quot;yellow&amp;quot;&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-26&#34;&gt;&lt;a href=&#34;#cb11-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    st[&lt;span class=&#34;st&#34;&gt;&amp;quot;green&amp;quot;&lt;/span&gt;] = st[&lt;span class=&#34;st&#34;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-27&#34;&gt;&lt;a href=&#34;#cb11-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    st[&lt;span class=&#34;st&#34;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;] = st[&lt;span class=&#34;st&#34;&gt;&amp;quot;orange&amp;quot;&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-28&#34;&gt;&lt;a href=&#34;#cb11-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb11-29&#34;&gt;&lt;a href=&#34;#cb11-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll u;&lt;/span&gt;
&lt;span id=&#34;cb11-30&#34;&gt;&lt;a href=&#34;#cb11-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        string s;&lt;/span&gt;
&lt;span id=&#34;cb11-31&#34;&gt;&lt;a href=&#34;#cb11-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cin &amp;gt;&amp;gt; u &amp;gt;&amp;gt; s;&lt;/span&gt;
&lt;span id=&#34;cb11-32&#34;&gt;&lt;a href=&#34;#cb11-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        mp[u] = st[s];&lt;/span&gt;
&lt;span id=&#34;cb11-33&#34;&gt;&lt;a href=&#34;#cb11-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-34&#34;&gt;&lt;a href=&#34;#cb11-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!mp.count(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) mp[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-35&#34;&gt;&lt;a href=&#34;#cb11-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; mp0 = mp;&lt;/span&gt;
&lt;span id=&#34;cb11-36&#34;&gt;&lt;a href=&#34;#cb11-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; p : mp0) {&lt;/span&gt;
&lt;span id=&#34;cb11-37&#34;&gt;&lt;a href=&#34;#cb11-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll u = p.first;&lt;/span&gt;
&lt;span id=&#34;cb11-38&#34;&gt;&lt;a href=&#34;#cb11-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (u ^ &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb11-39&#34;&gt;&lt;a href=&#34;#cb11-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            G[u &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;].insert(u);&lt;/span&gt;
&lt;span id=&#34;cb11-40&#34;&gt;&lt;a href=&#34;#cb11-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!mp.count(u)) mp[u] = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-41&#34;&gt;&lt;a href=&#34;#cb11-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            u &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-42&#34;&gt;&lt;a href=&#34;#cb11-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb11-43&#34;&gt;&lt;a href=&#34;#cb11-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb11-44&#34;&gt;&lt;a href=&#34;#cb11-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb11-45&#34;&gt;&lt;a href=&#34;#cb11-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    modint ans = (f[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + f[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) * qPow(&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;, ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; &amp;lt;&amp;lt; k) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - mp.size()) % (mod - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb11-46&#34;&gt;&lt;a href=&#34;#cb11-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; ans.val &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb11-47&#34;&gt;&lt;a href=&#34;#cb11-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb11-48&#34;&gt;&lt;a href=&#34;#cb11-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿˜æ˜¯æŒºå¥½çš„ä¸€é“é¢˜ï¼Œæå‡ºæœ‰ç”¨çš„ç‚¹æ¥è¿›è¡Œæ ‘å½¢ dpã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---ideal-farm&#34;&gt;1594F - Ideal Farm&lt;/h3&gt;
&lt;p&gt;ç»™å‡º &lt;span class=&#34;math inline&#34;&gt;\(n, s, k\)&lt;/span&gt;ï¼Œé—®æ˜¯å¦æ‰€æœ‰çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„æ­£æ•´æ•°åºåˆ—éƒ½æœ‰ä¸€æ®µé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„åŒºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ„é€ ä¸€ä¸ªæ— è§£çš„æƒ…å†µã€‚å³è¦æ±‚æ²¡æœ‰ä¸¤ä¸ªå‰ç¼€å’Œçš„å·®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œæ„é€ çš„æ—¶å€™å³ &lt;span class=&#34;math inline&#34;&gt;\(1, 1,1,\cdots, k + 1, 1, 1, \cdots\)&lt;/span&gt; å¦‚æ˜¯æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n &amp;lt; k\)&lt;/span&gt; çš„æ—¶å€™ç‰¹åˆ¤ä¸€ä¸‹ã€‚è ¢å¾—è¦æ­»ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb12&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb12-1&#34;&gt;&lt;a href=&#34;#cb12-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-2&#34;&gt;&lt;a href=&#34;#cb12-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb12-3&#34;&gt;&lt;a href=&#34;#cb12-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb12-4&#34;&gt;&lt;a href=&#34;#cb12-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb12-5&#34;&gt;&lt;a href=&#34;#cb12-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb12-6&#34;&gt;&lt;a href=&#34;#cb12-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll s, n, k;&lt;/span&gt;
&lt;span id=&#34;cb12-7&#34;&gt;&lt;a href=&#34;#cb12-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(s), read(n), read(k);&lt;/span&gt;
&lt;span id=&#34;cb12-8&#34;&gt;&lt;a href=&#34;#cb12-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n &amp;lt; k) {&lt;/span&gt;
&lt;span id=&#34;cb12-9&#34;&gt;&lt;a href=&#34;#cb12-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s == k) puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;YES&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-10&#34;&gt;&lt;a href=&#34;#cb12-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-11&#34;&gt;&lt;a href=&#34;#cb12-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb12-12&#34;&gt;&lt;a href=&#34;#cb12-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll w = n / k * &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * k + n % k;&lt;/span&gt;
&lt;span id=&#34;cb12-13&#34;&gt;&lt;a href=&#34;#cb12-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            s &amp;lt; w ? puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;YES&amp;quot;&lt;/span&gt;) : puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb12-14&#34;&gt;&lt;a href=&#34;#cb12-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb12-15&#34;&gt;&lt;a href=&#34;#cb12-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb12-16&#34;&gt;&lt;a href=&#34;#cb12-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb12-17&#34;&gt;&lt;a href=&#34;#cb12-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;educational-codeforces-round-115&#34;&gt;Educational Codeforces Round 115&lt;/h2&gt;
&lt;p&gt;A + B + C + Dã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---staircases&#34;&gt;1598E - Staircases&lt;/h3&gt;
&lt;p&gt;æ³¨æ„åˆ°å…¶å®å°±è¿™ä¸¤ç§æ¥¼æ¢¯ï¼Œè¦ä¹ˆç»“æŸä½ç½®æ˜¯ä¸¤ä¸ªæ¨ªç€çš„ï¼Œè¦ä¹ˆæ˜¯ä¸¤ä¸ªç«–ç€çš„ã€‚æ‰€ä»¥å¯ä»¥ dpï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j, 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\((i, j)\)&lt;/span&gt; ç»“æŸï¼Œæœ€åä½ç½®ä¸ºæ¨ª/ç«–çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰è½¬ç§» &lt;span class=&#34;math display&#34;&gt;\[
\begin{cases}
f_{i, j, 0} :=f_{i, j, 0} + f_{i - 1, j, 1}\\
f_{i, j, 1} := f_{i ,j , 1} + f_{i, j - 1. 0}
\end{cases}
\]&lt;/span&gt; åˆå§‹æ¡ä»¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j, 0/1} = 1\)&lt;/span&gt;ï¼Œå› ä¸ºä¸€ä¸ªæ ¼å­ä¹Ÿç®—æ¥¼æ¢¯ã€‚ä½†æ˜¯ä¼šç®—é‡ï¼Œæ‰€ä»¥éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯ä¿®æ”¹æ“ä½œã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œä¸€æ¬¡ä¿®æ”¹æ“ä½œèƒ½å½±å“çš„ dp å€¼æ˜¯æœ‰é™çš„ã€‚æ‰‹ç©ä¸€ä¸‹å‘ç°æœ€å¤šå½±å“ &lt;span class=&#34;math inline&#34;&gt;\(3n\)&lt;/span&gt; ä¸ªæ ¼å­ã€‚æ•…æ€»æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2 + nq)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å°±ä¸æ”¾äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---rbs&#34;&gt;1598F - RBS&lt;/h3&gt;
&lt;p&gt;æ‹¬å·åŒ¹é… + çŠ¶å‹ dp å¥½é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰åˆæ³•çš„æ‹¬å·ä¸²ï¼Œç»™å‡º &lt;span class=&#34;math inline&#34;&gt;\(n\le 20\)&lt;/span&gt; ä¸ªæ€»é•¿ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(4\times 10^5\)&lt;/span&gt; çš„æ‹¬å·ä¸² &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt;ï¼Œé—®å°†æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt; æŒ‰ç…§ä¸€å®šé¡ºåºæ‹¼æ¥èµ·æ¥åæœ€å¤šæœ‰å¤šå°‘ä¸ªå‰ç¼€ä¸ºåˆæ³•æ‹¬å·ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 20\)&lt;/span&gt; è¿™ä¸ªé™åˆ¶å°±å¾ˆçµæ€§ï¼Œè€ƒè™‘çŠ¶å‹ dpã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{S}\)&lt;/span&gt; ä¸ºé›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…å­—ç¬¦ä¸²æ‹¼èµ·æ¥çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ€è€ƒè½¬ç§»ã€‚å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; åœ¨åŠ ä¸Šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ï¼Œå¹¶å‡å®š &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è¢«æ¥åœ¨æœ«å°¾ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ‹¬å·ä¸²çš„æ€§è´¨ï¼Œæˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\texttt{&amp;#39;(&amp;#39;} = 1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\texttt{&amp;#39;)&amp;#39;} = -1\)&lt;/span&gt;ï¼Œç„¶åä¸€ä¸ªæ‹¬å·ä¸²å°†ä¸ºåˆæ³•å½“ä¸”ä»…å½“å…¶æ¯ä¸ªå‰ç¼€å’Œéƒ½ä¸ºéè´Ÿä¸”æ•´ä¸ªçš„å‰ç¼€å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚é‚£ä¹ˆä¸å¦¨å¤„ç†å‡ºæ¯ä¸ªä¸²çš„å‰ç¼€å’Œä»¥åŠæ¯ä¸ªçŠ¶æ€çš„ä¸²çš„å‰ç¼€å’Œä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;è€Œéå†ä¸€ä¸ªå­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å°†ä¼šå½¢æˆä¸€ä¸ªâ€œçˆ¬å±±â€çš„è¿‡ç¨‹ï¼Œè‹¥è¿™ä¸ªè¿‡ç¨‹ä¸­å‰ç¼€å’Œæ¥è§¦åˆ°äº† &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåˆæ³•çš„ç­”æ¡ˆå°†ä¼šå¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œè‹¥è¿™ä¸ªè¿‡ç¨‹ä¸­å‰ç¼€å’Œå˜ä¸ºäº†è´Ÿæ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªçŠ¶æ€å°±åºŸæ‰äº†â€”â€”ç­”æ¡ˆä¸å¯èƒ½å†å¢åŠ ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¯¹äºæ¯ä¸ªä¸²ï¼Œæˆ‘ä»¬éœ€è¦è®°å½•ä¸€ä¸‹å…¶å‘ä¸‹â€œç©¿è¿‡â€äº†æ¯ä¸ªå¹³é¢å‡ æ¬¡ã€‚ç„¶ååœ¨ dp è½¬ç§»çš„æ—¶å€™å°±å¯ä»¥åˆ¤å®šäº†ã€‚å¦‚æœä» &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„é«˜åº¦èµ°å‘ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä¼šèµ°åˆ°è‹¥å¹²æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆç­”æ¡ˆå¯¹åº”ç´¯è®¡ï¼Œè‹¥ä¼šç©¿åˆ° &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸‹é¢å»ï¼Œè¯´æ˜è¿™ä¸ªçŠ¶æ€å°±åºŸæ‰äº†ï¼Œåˆ¤æ‰å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb13&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb13-1&#34;&gt;&lt;a href=&#34;#cb13-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-2&#34;&gt;&lt;a href=&#34;#cb13-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-3&#34;&gt;&lt;a href=&#34;#cb13-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb13-4&#34;&gt;&lt;a href=&#34;#cb13-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-5&#34;&gt;&lt;a href=&#34;#cb13-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb13-6&#34;&gt;&lt;a href=&#34;#cb13-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-7&#34;&gt;&lt;a href=&#34;#cb13-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;22&lt;/span&gt;, maxs = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;21&lt;/span&gt; | &lt;span class=&#34;dv&#34;&gt;50&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-8&#34;&gt;&lt;a href=&#34;#cb13-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-9&#34;&gt;&lt;a href=&#34;#cb13-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; String {&lt;/span&gt;
&lt;span id=&#34;cb13-10&#34;&gt;&lt;a href=&#34;#cb13-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; minp, sum;&lt;/span&gt;
&lt;span id=&#34;cb13-11&#34;&gt;&lt;a href=&#34;#cb13-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    map&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; H;&lt;/span&gt;
&lt;span id=&#34;cb13-12&#34;&gt;&lt;a href=&#34;#cb13-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; L;&lt;/span&gt;
&lt;span id=&#34;cb13-13&#34;&gt;&lt;a href=&#34;#cb13-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; delta;&lt;/span&gt;
&lt;span id=&#34;cb13-14&#34;&gt;&lt;a href=&#34;#cb13-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; init(string s) {&lt;/span&gt;
&lt;span id=&#34;cb13-15&#34;&gt;&lt;a href=&#34;#cb13-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; p = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-16&#34;&gt;&lt;a href=&#34;#cb13-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        minp = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-17&#34;&gt;&lt;a href=&#34;#cb13-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        map&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt;&amp;gt; no;&lt;/span&gt;
&lt;span id=&#34;cb13-18&#34;&gt;&lt;a href=&#34;#cb13-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)s.size() - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-19&#34;&gt;&lt;a href=&#34;#cb13-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;) ++p;&lt;/span&gt;
&lt;span id=&#34;cb13-20&#34;&gt;&lt;a href=&#34;#cb13-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; --p;&lt;/span&gt;
&lt;span id=&#34;cb13-21&#34;&gt;&lt;a href=&#34;#cb13-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;)&amp;#39;&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-22&#34;&gt;&lt;a href=&#34;#cb13-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!no[p]) ++H[p];&lt;/span&gt;
&lt;span id=&#34;cb13-23&#34;&gt;&lt;a href=&#34;#cb13-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; no[p] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-24&#34;&gt;&lt;a href=&#34;#cb13-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            minp = min(minp, p);&lt;/span&gt;
&lt;span id=&#34;cb13-25&#34;&gt;&lt;a href=&#34;#cb13-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb13-26&#34;&gt;&lt;a href=&#34;#cb13-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        sum = p;&lt;/span&gt;
&lt;span id=&#34;cb13-27&#34;&gt;&lt;a href=&#34;#cb13-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (H.empty()) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-28&#34;&gt;&lt;a href=&#34;#cb13-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        delta = H.begin()-&amp;gt;first;&lt;/span&gt;
&lt;span id=&#34;cb13-29&#34;&gt;&lt;a href=&#34;#cb13-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; R = H.rbegin()-&amp;gt;first;&lt;/span&gt;
&lt;span id=&#34;cb13-30&#34;&gt;&lt;a href=&#34;#cb13-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        L.resize(R - delta + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb13-31&#34;&gt;&lt;a href=&#34;#cb13-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; p : H) L[p.first - delta] = p.second;&lt;/span&gt;
&lt;span id=&#34;cb13-32&#34;&gt;&lt;a href=&#34;#cb13-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-33&#34;&gt;&lt;a href=&#34;#cb13-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-34&#34;&gt;&lt;a href=&#34;#cb13-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x) {&lt;/span&gt;
&lt;span id=&#34;cb13-35&#34;&gt;&lt;a href=&#34;#cb13-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x -= delta;&lt;/span&gt;
&lt;span id=&#34;cb13-36&#34;&gt;&lt;a href=&#34;#cb13-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; || x &amp;gt;= (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)L.size()) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-37&#34;&gt;&lt;a href=&#34;#cb13-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; L[x];&lt;/span&gt;
&lt;span id=&#34;cb13-38&#34;&gt;&lt;a href=&#34;#cb13-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-39&#34;&gt;&lt;a href=&#34;#cb13-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} s[&lt;span class=&#34;dv&#34;&gt;22&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb13-40&#34;&gt;&lt;a href=&#34;#cb13-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-41&#34;&gt;&lt;a href=&#34;#cb13-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dp[maxs], sum[maxs], n;&lt;/span&gt;
&lt;span id=&#34;cb13-42&#34;&gt;&lt;a href=&#34;#cb13-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb13-43&#34;&gt;&lt;a href=&#34;#cb13-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb13-44&#34;&gt;&lt;a href=&#34;#cb13-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb13-45&#34;&gt;&lt;a href=&#34;#cb13-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin.tie(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb13-46&#34;&gt;&lt;a href=&#34;#cb13-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb13-47&#34;&gt;&lt;a href=&#34;#cb13-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb13-48&#34;&gt;&lt;a href=&#34;#cb13-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        string str; cin &amp;gt;&amp;gt; str;&lt;/span&gt;
&lt;span id=&#34;cb13-49&#34;&gt;&lt;a href=&#34;#cb13-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        s[i].init(str);&lt;/span&gt;
&lt;span id=&#34;cb13-50&#34;&gt;&lt;a href=&#34;#cb13-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-51&#34;&gt;&lt;a href=&#34;#cb13-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(S, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) &amp;amp; S) sum[S] += s[i].sum;&lt;/span&gt;
&lt;span id=&#34;cb13-52&#34;&gt;&lt;a href=&#34;#cb13-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(dp, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; dp);&lt;/span&gt;
&lt;span id=&#34;cb13-53&#34;&gt;&lt;a href=&#34;#cb13-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dp[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-54&#34;&gt;&lt;a href=&#34;#cb13-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-55&#34;&gt;&lt;a href=&#34;#cb13-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(S, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; n) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb13-56&#34;&gt;&lt;a href=&#34;#cb13-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (S &amp;amp; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))) {&lt;/span&gt;
&lt;span id=&#34;cb13-57&#34;&gt;&lt;a href=&#34;#cb13-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; F = S ^ (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb13-58&#34;&gt;&lt;a href=&#34;#cb13-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dp[F] == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-59&#34;&gt;&lt;a href=&#34;#cb13-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; nows = sum[F], cur = dp[F] + s[i].query(-nows);&lt;/span&gt;
&lt;span id=&#34;cb13-60&#34;&gt;&lt;a href=&#34;#cb13-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans = max(ans, cur);&lt;/span&gt;
&lt;span id=&#34;cb13-61&#34;&gt;&lt;a href=&#34;#cb13-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (nows + s[i].minp &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-62&#34;&gt;&lt;a href=&#34;#cb13-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            dp[S] = max(dp[S], cur);&lt;/span&gt;
&lt;span id=&#34;cb13-63&#34;&gt;&lt;a href=&#34;#cb13-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb13-64&#34;&gt;&lt;a href=&#34;#cb13-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb13-65&#34;&gt;&lt;a href=&#34;#cb13-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; ans &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-66&#34;&gt;&lt;a href=&#34;#cb13-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb13-67&#34;&gt;&lt;a href=&#34;#cb13-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;technocup-2022-elimination-round-1-and-codeforces-round-749-div.-1div.-2&#34;&gt;Technocup 2022 â€” Elimination Round 1 and Codeforces Round #749 (Div. 1+Div. 2)&lt;/h2&gt;
&lt;p&gt;A + B + C + D + Fï¼Œrk 352ï¼Œä¸Š CM äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---omkar-and-the-meaning-of-life&#34;&gt;1583D - Omkar and the Meaning of Life&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘å¯»æ‰¾æ¯ä¸ªå…ƒç´ åœ¨æ’åˆ—ä¸­çš„ä¸‹ä¸€ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œè¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(a_i = 2\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_j=1\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(j\neq i\)&lt;/span&gt;ï¼Œå¦‚æœæ‰¾åˆ°äº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåˆ™ä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{nxt}(k) = i\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(a_i = 1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_j = 2\)&lt;/span&gt; çš„æƒ…å†µåŒç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åä¸€ä¸ªæ‹“æ‰‘æ’åºå°±å¯ä»¥æ±‚å‡ºæ•´ä¸ªæ’åˆ—ã€‚è¯¢é—®æ¬¡æ•°æ­£å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚-Ñ†Ğ²ĞµÑ‚ĞµĞ½Ğ¸Ñ&#34;&gt;1583E - ĞœĞ¾Ğ¼ĞµĞ½Ñ‚ Ñ†Ğ²ĞµÑ‚ĞµĞ½Ğ¸Ñ&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸€å¼ æ— å‘å›¾ä¸Šæ„é€  &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¡å§‹æœ«ç‚¹ç»™å®šçš„è·¯å¾„ï¼Œä½¿å¾—æ¯æ¡è¾¹éƒ½è¢«è¦†ç›–å¶æ•°æ¬¡ï¼Œè¾“å‡ºæ„é€ æ–¹æ¡ˆæˆ–è€…è¾“å‡ºè¿˜éœ€è¦å¤šå°‘æ¡è·¯å¾„æ‰æœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€å¼ æ–°å›¾ï¼šå°†æ‰€æœ‰çš„ç‚¹ä¿ç•™ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡è¯¢é—®çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ç‚¹è¿è¾¹ï¼Œè‹¥è¿™å¼ å›¾ä¸­çš„å„ä¸ªè¿é€šåˆ†é‡éƒ½èƒ½å½¢æˆæ¬§æ‹‰å›è·¯ï¼Œåˆ™ä¸€å®šæœ‰è§£ã€‚ä¸ºä»€ä¹ˆï¼Ÿè€ƒè™‘åŸå›¾çš„ dfs ç”Ÿæˆæ ‘ï¼Œæ¯æ¬¡åœ¨æ–°å›¾ä¸Šèµ°ä¸€æ¡è¾¹ç›¸å½“äºåœ¨åŸå›¾ä¸Šé€šè¿‡æŸç§æ–¹å¼ä» &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œè€Œæ¬§æ‹‰å›è·¯ä»£è¡¨ç€æˆ‘æœ€ç»ˆåˆèµ°å›äº†ä¸€å¼€å§‹çš„èµ·ç‚¹ï¼Œå…¶æ¯æ¡è¾¹çš„ç»è¿‡æ¬¡æ•°å¿…ç„¶æ˜¯å¶æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ„é€ å°±ç›´æ¥åœ¨ dfs ç”Ÿæˆæ ‘ä¸Šæ‰¾è·¯å¾„å°±è¡Œäº†ï¼Œå€å¢å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---defender-of-childhood-dreams&#34;&gt;1586F - Defender of Childhood Dreams&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€å¼ ç«èµ›å›¾ï¼Œå…¶ä¸­è¾¹æ°¸è¿œä»ç¼–å·å°çš„ç‚¹è¿å‘ç¼–å·å¤§çš„ï¼Œç”¨æœ€å°‘çš„é¢œè‰²æŸ“è¿™äº›è¾¹ä½¿å¾—ä»»ä½•é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; çš„è·¯å¾„è‡³å°‘æœ‰ä¸¤ç§é¢œè‰²çš„è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;æ®è¯´æ˜¯ ZR CSP ä¸ƒè¿çš„åŸé¢˜ï¼Œäºã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ†å—ã€‚å°†æ‰€æœ‰ç‚¹æ¯ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªåˆ†ä¸ºä¸€å°å—ï¼Œæ¯ &lt;span class=&#34;math inline&#34;&gt;\(k^2\)&lt;/span&gt; ä¸ªåˆ†ä¸ºä¸€å¤§å—â€¦â€¦ä¾æ­¤ç±»æ¨ï¼Œå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å—å†…éƒ¨è¿ä¸€ç§é¢œè‰²çš„è¾¹ï¼Œå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k^2\)&lt;/span&gt; çš„å—å†…éƒ¨è¿ä¸€ç§é¢œè‰²çš„è¾¹â€¦â€¦ä¾æ­¤ç±»æ¨ã€‚æ‰€ä»¥ä¸€å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\lceil\log_k n \rceil\)&lt;/span&gt; ç§é¢œè‰²ï¼Œä»£ç å¾ˆçŸ­ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb14&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb14-1&#34;&gt;&lt;a href=&#34;#cb14-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k;&lt;/span&gt;
&lt;span id=&#34;cb14-2&#34;&gt;&lt;a href=&#34;#cb14-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-3&#34;&gt;&lt;a href=&#34;#cb14-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; getans(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y) {&lt;/span&gt;
&lt;span id=&#34;cb14-4&#34;&gt;&lt;a href=&#34;#cb14-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = k, ret = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-5&#34;&gt;&lt;a href=&#34;#cb14-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; ((x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / now != (y - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / now) now *= k, ++ret;&lt;/span&gt;
&lt;span id=&#34;cb14-6&#34;&gt;&lt;a href=&#34;#cb14-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb14-7&#34;&gt;&lt;a href=&#34;#cb14-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb14-8&#34;&gt;&lt;a href=&#34;#cb14-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb14-9&#34;&gt;&lt;a href=&#34;#cb14-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb14-10&#34;&gt;&lt;a href=&#34;#cb14-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(k);&lt;/span&gt;
&lt;span id=&#34;cb14-11&#34;&gt;&lt;a href=&#34;#cb14-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print((&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)ceil(log(n) / log(k)), &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb14-12&#34;&gt;&lt;a href=&#34;#cb14-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) print(getans(i, j), &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb14-13&#34;&gt;&lt;a href=&#34;#cb14-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb14-14&#34;&gt;&lt;a href=&#34;#cb14-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç»ç»å­äº†å±äºæ˜¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-750-div.2&#34;&gt;Codeforces Round #750 (Div.2)&lt;/h2&gt;
&lt;h3 id=&#34;d---vupsen-pupsen-and-0&#34;&gt;1582D - Vupsen, Pupsen and 0&lt;/h3&gt;
&lt;p&gt;ç»™å®šå‘é‡ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œæ±‚ä¸€ä¸ªå‘é‡ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a\cdot b = 0\)&lt;/span&gt;ï¼Œå…¶ä¸­å‘é‡ç»´æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(|a_i|\le 10^4\)&lt;/span&gt;ï¼Œè¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\sum|b_i|\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸¤ä¸¤é…å¯¹ï¼Œæœ€åä¸‰ä¸ªç‰¹åˆ¤ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---pchelyonok-and-segments&#34;&gt;1582E - Pchelyonok and Segments&lt;/h3&gt;
&lt;p&gt;é‡ç‚¹ï¼šæ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„èŒƒå›´ç„¶åç›´æ¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n\sqrt n)\)&lt;/span&gt; æš´åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{k(k + 1)}{2}\le n\)&lt;/span&gt;ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(k\le \sqrt{2n}\le 447\)&lt;/span&gt;ã€‚ç„¶åå°±å¯ä»¥è®¾è®¡ä¸€ä¸ª dpï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; ä¸ºå½“å‰è€ƒè™‘äº† &lt;span class=&#34;math inline&#34;&gt;\([i, n]\)&lt;/span&gt;ï¼Œæœ€å‰é¢çš„é€‰çš„ä¸€æ®µé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæœ€å¤§çš„å’Œã€‚ï¼ˆç±»ä¼¼ LIS çš„è´ªå¿ƒè®¾è®¡ï¼‰ç„¶åè½¬ç§»å°±éšä¾¿è½¬ç§»ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb15&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb15-1&#34;&gt;&lt;a href=&#34;#cb15-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-2&#34;&gt;&lt;a href=&#34;#cb15-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;, sqrtn = &lt;span class=&#34;dv&#34;&gt;500&lt;/span&gt;, INF = &lt;span class=&#34;fl&#34;&gt;2e9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-3&#34;&gt;&lt;a href=&#34;#cb15-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb15-4&#34;&gt;&lt;a href=&#34;#cb15-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll sum[maxn], f[maxn][sqrtn];&lt;/span&gt;
&lt;span id=&#34;cb15-5&#34;&gt;&lt;a href=&#34;#cb15-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb15-6&#34;&gt;&lt;a href=&#34;#cb15-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb15-7&#34;&gt;&lt;a href=&#34;#cb15-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb15-8&#34;&gt;&lt;a href=&#34;#cb15-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb15-9&#34;&gt;&lt;a href=&#34;#cb15-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n);&lt;/span&gt;
&lt;span id=&#34;cb15-10&#34;&gt;&lt;a href=&#34;#cb15-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]), sum[i] = sum[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + a[i];&lt;/span&gt;
&lt;span id=&#34;cb15-11&#34;&gt;&lt;a href=&#34;#cb15-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-12&#34;&gt;&lt;a href=&#34;#cb15-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (k * (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; &amp;lt;= n) ++k;&lt;/span&gt;
&lt;span id=&#34;cb15-13&#34;&gt;&lt;a href=&#34;#cb15-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        --k;&lt;/span&gt;
&lt;span id=&#34;cb15-14&#34;&gt;&lt;a href=&#34;#cb15-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) f[n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j] = -INF;&lt;/span&gt;
&lt;span id=&#34;cb15-15&#34;&gt;&lt;a href=&#34;#cb15-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = INF;&lt;/span&gt;
&lt;span id=&#34;cb15-16&#34;&gt;&lt;a href=&#34;#cb15-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb15-17&#34;&gt;&lt;a href=&#34;#cb15-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) {&lt;/span&gt;
&lt;span id=&#34;cb15-18&#34;&gt;&lt;a href=&#34;#cb15-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[i][j] = f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j];&lt;/span&gt;
&lt;span id=&#34;cb15-19&#34;&gt;&lt;a href=&#34;#cb15-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (j &amp;amp;&amp;amp; i + j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;= n &amp;amp;&amp;amp; sum[i + j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - sum[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;lt; f[i + j][j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;])&lt;/span&gt;
&lt;span id=&#34;cb15-20&#34;&gt;&lt;a href=&#34;#cb15-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    chkmax(f[i][j], sum[i + j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - sum[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb15-21&#34;&gt;&lt;a href=&#34;#cb15-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb15-22&#34;&gt;&lt;a href=&#34;#cb15-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb15-23&#34;&gt;&lt;a href=&#34;#cb15-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-24&#34;&gt;&lt;a href=&#34;#cb15-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j] &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ans = j;&lt;/span&gt;
&lt;span id=&#34;cb15-25&#34;&gt;&lt;a href=&#34;#cb15-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(ans, &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb15-26&#34;&gt;&lt;a href=&#34;#cb15-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb15-27&#34;&gt;&lt;a href=&#34;#cb15-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb15-28&#34;&gt;&lt;a href=&#34;#cb15-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-754-div.-2&#34;&gt;Codeforces Round #754 (Div. 2)&lt;/h2&gt;
&lt;p&gt;æ‰“çš„æœ‰ç‚¹å·®åŠ²ï¼ŒA + B + Cã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---treelabeling&#34;&gt;1605D - Treelabeling&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€æ£µæœªæ ‡å·çš„æ ‘ï¼Œæ±‚ä¸€ä¸ªæ ‡å·æ–¹å¼ä½¿å¾—ç›¸é‚»çš„ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„æœ€é«˜ä½ä¸ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æœ€é«˜ä½ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;åŸé¢˜æ„æ˜“è¢«ç¿»è¯‘æˆå¦‚ä¸Šï¼Œç°åœ¨è€ƒè™‘å¦‚ä½•æ„é€ ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æœ€é«˜ä½ï¼ˆä» &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å§‹ç¼–å·ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆç»™æ ‘äºŒåˆ†å›¾æŸ“è‰²ï¼Œç„¶åä»¤é»‘ç‚¹ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œç™½ç‚¹ä¸ªæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt;ï¼Œä¸å¦¨å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(w \le b\)&lt;/span&gt;ï¼Œåˆ™æ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(w\le \lfloor n / 2\rfloor\)&lt;/span&gt;ã€‚æ‰€ä»¥å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f(w) \le f(n) - 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè¿˜æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼Œå°±æ˜¯æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(f(x) = i\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸€å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2^i\)&lt;/span&gt; ä¸ªï¼Œå› æ­¤ç›´æ¥è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; çš„æ¯ä¸€ä½ï¼Œè‹¥ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œåˆ™ç›´æ¥å°†æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(f(x) = i\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åˆ†é…ç»™ç™½ç‚¹ï¼Œå‰©ä½™çš„åˆ†é…ç»™é»‘ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯è¿™æ ·å°±æ„é€ å®Œäº†ï¼Œæ­£ç¡®æ€§åº”è¯¥æ˜¯ååˆ†æ˜¾ç„¶çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---array-equalizer&#34;&gt;1605E - Array Equalizer&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\{b_i\}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æ˜¯ç»™å®šçš„ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; é™¤äº† &lt;span class=&#34;math inline&#34;&gt;\(b_1\)&lt;/span&gt; å…¶ä½™éƒ½ç»™å‡ºã€‚ä¸€æ¬¡æ“ä½œå¯ä»¥é€‰å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç„¶åå¯¹äºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\mid j\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b_j\)&lt;/span&gt; åŠ ä¸Šæˆ–å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(b_1\)&lt;/span&gt;ï¼Œé—®å°† &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt; å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\{b_i\}\)&lt;/span&gt; çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä»¤ &lt;span class=&#34;math inline&#34;&gt;\(b_i = b_i - a_i\)&lt;/span&gt;ï¼Œç„¶åé—®é¢˜å°±å˜ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\(\{0\}\)&lt;/span&gt; å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(\{b_i\}\)&lt;/span&gt; çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚ç„¶åé¦–å…ˆè€ƒè™‘åªæœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(b_1\)&lt;/span&gt; çš„æ—¶å€™ï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä¸éš¾å‘ç°ï¼Œåªéœ€è¦ä»å°åˆ°å¤§è€ƒè™‘å³å¯ã€‚æ¨¡æ‹Ÿä¸€ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_1\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_2\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_3\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_4\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_5\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class=&#34;math inline&#34;&gt;\(\cdots\)&lt;/span&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_1\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_2\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_3\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_4\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_5\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\cdots\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Add&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_1\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_2 - B_1\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_3 - B_1\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_4 - B_2\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(B_5 - B_1\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\cdots\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(B_1 = x\)&lt;/span&gt; çš„è¯ï¼Œæ¯æ¬¡æ“ä½œåŠ ä¸Šçš„æ•°éƒ½å½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(cx + d\)&lt;/span&gt;ï¼Œå¯¹æ“ä½œæ¬¡æ•°çš„è´¡çŒ®å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(|cx + d|\)&lt;/span&gt;ã€‚è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; æ˜¯å¯ä»¥æå‰é¢„å¤„ç†å‡ºæ¥çš„ã€‚ç„¶åçš„è¯ï¼Œç°åœ¨çš„ç›®æ ‡å°±æ˜¯æ±‚å‡ºä¸€å¨ &lt;span class=&#34;math inline&#34;&gt;\(|cx + d|\)&lt;/span&gt; çš„å’Œï¼Œå‘ç°è¿™ä¸ªå¯èƒ½ä¸å¤ªå¥½åšï¼Œæˆ‘ä»¬æ‹†å¼€ç»å¯¹å€¼ï¼Œåˆ†ç±»è®¨è®ºä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(cx + d &amp;gt; 0\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(x &amp;gt; -\dfrac dc\)&lt;/span&gt;ï¼Œè´¡çŒ®å°±ä¸º &lt;span class=&#34;math inline&#34;&gt;\(cx + d\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(cx + d&amp;lt; 0\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(x&amp;lt;-\dfrac dc\)&lt;/span&gt;ï¼Œè´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-cx - d\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¸Šè¿°æ¡ä»¶å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(c &amp;gt; 0\)&lt;/span&gt; æ—¶æˆç«‹ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(c &amp;lt; 0\)&lt;/span&gt; çš„æƒ…å†µï¼Œç›´æ¥ä¹˜ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; è½¬æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(c &amp;gt; 0\)&lt;/span&gt; å³å¯ã€‚è€Œ &lt;span class=&#34;math inline&#34;&gt;\(c = 0\)&lt;/span&gt; çš„æ—¶å€™ï¼Œç›´æ¥ç»Ÿè®¡ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„è´¡çŒ®å³å¯ã€‚æ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(-\dfrac dc\)&lt;/span&gt; æ’åºï¼Œå­˜å‚¨è¿™äº›ä¸€æ¬¡å‡½æ•°ï¼Œç„¶åå°±å¯ä»¥é¢„å¤„ç†ä¸€ä¸‹å‰ç¼€å’Œå’Œåç¼€å’Œï¼Œæ¯æ¬¡äºŒåˆ†ä¸€ä¸‹å°±å¯ä»¥çš„è§£äº†ã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;ã€‚æ‰€ä»¥é—®é¢˜å¯ä»¥å¾—åˆ°ç®€åŒ–å¾ˆå¤šã€‚&lt;/p&gt;
&lt;h2 id=&#34;technocup-2022-elimination-round-2-and-codeforces-round-755-div.-1-div.-2&#34;&gt;Technocup 2022 â€” Elimination Round 2 and Codeforces Round #755 (Div. 1, Div. 2)&lt;/h2&gt;
&lt;p&gt;div 1. A + Bã€‚&lt;/p&gt;
&lt;h3 id=&#34;b---guess-the-permutation&#34;&gt;1588B - Guess the Permutation&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\([1, n]\)&lt;/span&gt; çš„æœ‰åºæ’åˆ—ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(10^9\)&lt;/span&gt; çº§åˆ«ï¼‰ï¼Œç¿»è½¬äº† &lt;span class=&#34;math inline&#34;&gt;\([i, j - 1]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([j, k]\)&lt;/span&gt;ã€‚æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(40\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼Œä¸€æ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´çš„é€†åºå¯¹æ•°ï¼Œè¦æ±‚æœ€åç»™å‡º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯ä»¥é€šè¿‡äºŒåˆ†å¾—åˆ°ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¼¼ä¹ä¹Ÿå¯ä»¥äºŒåˆ†ï¼Œä½†æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2\log n\)&lt;/span&gt; å°±ä¼šçˆ†ç‚¸ã€‚æ‰€ä»¥åªè€ƒè™‘äºŒåˆ†å‡º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œç„¶åè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\([i, k]\)&lt;/span&gt; ä¸­é€†åºå¯¹çš„è´¡çŒ®ï¼Œä»¤ä¸¤ç«¯çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f(i, k) = (a - 1)a / 2 + (b - 1)b/2\)&lt;/span&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯¢é—®ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\([i + 1, n]\)&lt;/span&gt;ï¼Œå°±å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å€¼ï¼Œå…·ä½“åœ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a = f(i, k) - f(i - 1, k) + 1\)&lt;/span&gt;ï¼Œè¯æ˜è€ƒè™‘é€†åºå¯¹çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä¸éš¾äºŒåˆ†å‡º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„å€¼ï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---game-with-stones&#34;&gt;1588C - Game with Stones&lt;/h3&gt;
&lt;h2 id=&#34;codeforces-round-758-div.1-div.-2&#34;&gt;Codeforces Round #758 (Div.1 + Div. 2)&lt;/h2&gt;
&lt;p&gt;terrible roundã€‚A + B + Cï¼Œrk522ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---dominoes&#34;&gt;1608D - Dominoes&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªæŸ“è‰²æ–¹æ¡ˆåˆæ³•å½“ä¸”ä»…å½“ W å’Œ B çš„æ•°é‡ç›¸åŒï¼Œä»¥åŠ WW å’Œ BB çš„æ•°é‡ç›¸åŒã€‚è®¡ç®— W å’Œ B çš„æ•°é‡ï¼Œè‹¥å…¶å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œåˆ™æ˜¾ç„¶æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ï¼Œæ— è§£çš„æƒ…å†µå°±æ˜¯ WB å’Œ BW åŒæ—¶å­˜åœ¨å´æ²¡æœ‰ WW æˆ– BBã€‚å…¶ä»–éƒ½ä¸ºåˆæ³•æƒ…å†µï¼Œæ–¹æ¡ˆå¤§å®¶å¯ä»¥åœ¨è‰ç¨¿çº¸ä¸Šå°è¯•è¿›è¡Œæ„é€ ã€‚è®¾é—®å·æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(c_0\)&lt;/span&gt; ä¸ªï¼ŒW æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(c_B\)&lt;/span&gt; ä¸ªï¼Œåˆ™æ˜¾ç„¶æ€»æŸ“è‰²æ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dbinom{c_0}{n - c_B}\)&lt;/span&gt;ã€‚ç„¶åå¤„ç†ä¸€ä¸‹æ— è§£çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶å­˜åœ¨ WB å’Œ BW å´æ²¡æœ‰ WW æˆ– BB çš„æ–¹æ¡ˆæ•°å…¶å®å°±æ˜¯ç”¨ &lt;strong&gt;ä¸å­˜åœ¨ WW å’Œ BB çš„æ–¹æ¡ˆæ•°&lt;/strong&gt; å‡å» &lt;strong&gt;å…¨æ˜¯ WB&lt;/strong&gt; å’Œ &lt;strong&gt;å…¨æ˜¯ BW&lt;/strong&gt; çš„æƒ…å†µã€‚è®¾ ?? æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(c_P\)&lt;/span&gt; ä¸ªï¼Œåˆ™å¯¹äºç¬¬ä¸€ä¸ªâ€œä¸å­˜åœ¨ WW å’Œ BB çš„â€çš„æ–¹æ¡ˆæ•°å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2^{c_P}\)&lt;/span&gt;ï¼Œä¸”ä¸å­˜åœ¨ BB æˆ– WWï¼›å¯¹äºå…¨æ˜¯ WB çš„è‡³å¤šä¸€ç§ï¼Œä¸”ä¸èƒ½å­˜åœ¨ Bx æˆ– Wxï¼Œå…¨æ˜¯ BW åŒç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-global-round-18&#34;&gt;Codeforces Global Round 18&lt;/h2&gt;
&lt;p&gt;tiring and difficult round. A + B + Cã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---menorah&#34;&gt;1615C - Menorah&lt;/h3&gt;
&lt;p&gt;æ¯”è¾ƒå·§å¦™çš„é¢˜ã€‚æ³¨æ„åˆ°ä¸€æ¬¡å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ“ä½œå¯ä»¥è§†ä¸ºæ”¹å˜ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œç„¶åæ‰“ä¸Šå…¨å±€æ ‡è®°ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œç¬¬ä¸€æ¬¡æ“ä½œè¦æ“ä½œä¸€å¼€å§‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ï¼Œç¬¬äºŒæ¬¡æ“ä½œå°±å¿…é¡»æ“ä½œä¸€å¼€å§‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ã€‚ä¹‹åè‚¯å®šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1010\cdots\)&lt;/span&gt; äº¤æ›¿æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;é¢„å¤„ç†ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(same_{i, j}\)&lt;/span&gt; æ•°ç»„è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(a_k = i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\([a_k = b_k] = j\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æ•°é‡ï¼ˆå³ &lt;span class=&#34;math inline&#34;&gt;\(a = 1/0\)&lt;/span&gt;ï¼Œä¸ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ç›¸åŒ/ä¸åŒçš„æ•°é‡ï¼‰ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸€æ¬¡å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åŒçš„æ“ä½œä¼šä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åŒå‡ä¸€ï¼ŒåŒæ—¶ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸åŒåŠ ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥æœæˆ‘ä»¬è¿›è¡Œå¥‡æ•°æ¬¡æ“ä½œï¼Œé‚£ä¹ˆå…¨å±€ç¿»è½¬æ ‡è®°æ˜¯æœ‰çš„ï¼Œè¦æ±‚çš„å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(same_{1/0, 1} = 0\)&lt;/span&gt;ã€‚æ‰€ä»¥ä¸€å…±è¦è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(same_{1, 1} + same_{0, 1}\)&lt;/span&gt; æ¬¡æ“ä½œå°†æ‰€æœ‰çš„ç›¸åŒå˜ä¸ºä¸åŒï¼Œç„¶åå› ä¸ºæœ‰ç¿»è½¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚è¿™æ ·åšçš„å‰ææ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(same_{1,1} - same_{0, 1} = 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè‹¥è¿›è¡Œå¶æ•°æ¬¡æ“ä½œï¼ŒåŒç†ï¼Œæ²¡æœ‰å…¨å±€ç¿»è½¬æ ‡è®°ï¼Œè¦æ±‚çš„å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(same_{1/0, 0} = 0\)&lt;/span&gt;ã€‚æ‰€ä»¥ä¸€å…±è¦è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(same_{1, 0} + same_{0,0}\)&lt;/span&gt; æ¬¡æ“ä½œå°†æ‰€æœ‰çš„ä¸åŒå˜ä¸ºç›¸åŒï¼Œç­”æ¡ˆå°±èƒ½å¾—åˆ°äº†ã€‚è¿™æ ·åšçš„å‰ææ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(same_{1, 0} = same_{0, 0}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb16&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb16-1&#34;&gt;&lt;a href=&#34;#cb16-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-2&#34;&gt;&lt;a href=&#34;#cb16-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s1[maxn], s2[maxn];&lt;/span&gt;
&lt;span id=&#34;cb16-3&#34;&gt;&lt;a href=&#34;#cb16-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb16-4&#34;&gt;&lt;a href=&#34;#cb16-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb16-5&#34;&gt;&lt;a href=&#34;#cb16-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb16-6&#34;&gt;&lt;a href=&#34;#cb16-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb16-7&#34;&gt;&lt;a href=&#34;#cb16-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb16-8&#34;&gt;&lt;a href=&#34;#cb16-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n), read(s1 + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), read(s2 + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb16-9&#34;&gt;&lt;a href=&#34;#cb16-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; same[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;] = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb16-10&#34;&gt;&lt;a href=&#34;#cb16-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n)&lt;/span&gt;
&lt;span id=&#34;cb16-11&#34;&gt;&lt;a href=&#34;#cb16-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ++same[s1[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;][s1[i] == s2[i]];&lt;/span&gt;
&lt;span id=&#34;cb16-12&#34;&gt;&lt;a href=&#34;#cb16-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-13&#34;&gt;&lt;a href=&#34;#cb16-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (same[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - same[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans = same[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + same[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb16-14&#34;&gt;&lt;a href=&#34;#cb16-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (same[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] == same[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]) chkmin(ans, same[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] + same[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb16-15&#34;&gt;&lt;a href=&#34;#cb16-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(ans &amp;gt; n ? -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : ans);&lt;/span&gt;
&lt;span id=&#34;cb16-16&#34;&gt;&lt;a href=&#34;#cb16-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb16-17&#34;&gt;&lt;a href=&#34;#cb16-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb16-18&#34;&gt;&lt;a href=&#34;#cb16-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;d---xor-mas-tree&#34;&gt;1615D - X(or)-mas Tree&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€æ£µè¾¹å¸¦æƒæ ‘ï¼Œæœ‰äº›è¾¹æƒæœªç¡®å®šã€‚ç»™å®šå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\((a, b, c)\)&lt;/span&gt; çš„é™åˆ¶è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; è·¯å¾„ä¸Šçš„è¾¹æƒå¼‚æˆ–å’Œçš„ popcount çš„å¥‡å¶æ€§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ã€‚æ„é€ ä¸€ä¸ªç»™æœªå®šæƒè¾¹å®šæƒçš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{parity}(x)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{popcount}(x)\bmod 2\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥çŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{parity}(x\oplus y) = \operatorname{parity}(x)\oplus \operatorname{parity}(y)\)&lt;/span&gt;ã€‚æ‰€ä»¥å¹²è„†ç›´æ¥å…ˆå°†æ ‘ä¸Šçš„æ‰€æœ‰è¾¹æƒ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; å…ˆå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{parity}(d)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤æ ‘ä¸Šå‰ç¼€å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(r_u\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((a,b)\)&lt;/span&gt; è·¯å¾„çš„å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(r_a\oplus r_b\)&lt;/span&gt;ã€‚æ‰€ä»¥æˆ‘ä»¬ç°åœ¨å°±æœ‰äº†è‹¥å¹²æ¡å½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(r_a\oplus r_b = c\)&lt;/span&gt; çš„é™åˆ¶ï¼ˆå¯¹äºæ ‘ä¸Šå·²æœ‰çš„è¾¹ &lt;span class=&#34;math inline&#34;&gt;\((u,v, x)\)&lt;/span&gt; å¯ä»¥çœ‹ä½œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(r_u\oplus r_v = x\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ªé™åˆ¶ &lt;span class=&#34;math inline&#34;&gt;\(r_a\oplus r_b = c\)&lt;/span&gt;ï¼Œåœ¨æ–°å›¾ä¸Šå»ºä¸€æ¡è¾¹ &lt;span class=&#34;math inline&#34;&gt;\((a, b, c)\)&lt;/span&gt;ï¼Œç„¶åè€ƒè™‘äºŒåˆ†å›¾æŸ“è‰²ï¼ˆä¸€å¼€å§‹é’¦å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r_1\)&lt;/span&gt;ï¼‰ï¼Œè¿™æ ·å­å°±å¯ä»¥æ±‚å‡ºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(r_u\)&lt;/span&gt; å¹¶ä¸”åˆ¤æ–­çŸ›ç›¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---purple-crayon&#34;&gt;1615E - Purple Crayon&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šçº¢è“åŒæ–¹åœ¨ä¸€æ£µ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹çš„æ ‘ä¸Šæ¶‚è‰²ã€‚çº¢å…ˆæ¶‚ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªå­æ ‘å†…çš„ç‚¹æ¶‚æˆçº¢è‰²ï¼Œä½†æ¶‚çš„ä¸ªæ•°ä¸èƒ½è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚ç„¶åè“æ¶‚ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªå­æ ‘å†…çš„ç‚¹æ¶‚æˆè“è‰²ï¼Œä½†è¯¥å­æ ‘å†…ä¸èƒ½æœ‰çº¢è‰²èŠ‚ç‚¹ã€‚è®¾æœ€åç™½ã€çº¢ã€è“ä¸‰ç§é¢œè‰²çš„ç‚¹å„æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt;ã€&lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ä¸ªï¼Œåˆ™åˆ†æ•°å®šä¹‰ä¸º &lt;span class=&#34;math inline&#34;&gt;\(w(r - b)\)&lt;/span&gt;ã€‚çº¢æ–¹æƒ³æœ€å¤§åŒ–åˆ†æ•°ï¼Œè“æ–¹æƒ³æœ€å°åŒ–åˆ†æ•°ã€‚åŒæ–¹éƒ½ç»é¡¶èªæ˜ï¼Œé—®æœ€åçš„åˆ†æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ‹†å¼€å¼å­ï¼š&lt;span class=&#34;math inline&#34;&gt;\(w(r- b) = (n - r - b)(r - b) = r(n - r) - b(n - b)\)&lt;/span&gt;ã€‚æ‰€ä»¥å¯¹äºçº¢æ–¹ï¼Œä»–æƒ³è¦åšçš„å°±æ˜¯æœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(r(n - r)\)&lt;/span&gt; å’Œæœ€å°åŒ– &lt;span class=&#34;math inline&#34;&gt;\(b(n - b)\)&lt;/span&gt;ã€‚åˆ°äº†è“æ–¹è¿™é‡Œï¼Œä»–ä¸€å®šæ˜¯æƒ³æœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(b(n - b)\)&lt;/span&gt;ï¼Œå…¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(b = \lfloor n / 2\rfloor\)&lt;/span&gt; å¤„æœ‰æœ€å¤§å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œçº¢æ–¹é€‰æ‹©äº† &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘æ„å‘³ç€ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸Šçš„ç‚¹éƒ½ä¸èƒ½è¢«è“æ–¹æ¶‚è‰²ï¼Œç›¸å½“äºæ§åˆ¶äº†ä¸€æ¡é“¾ã€‚ä¸ºäº†ä½¿å¾—è“æ–¹èƒ½è¾¾åˆ°çš„æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(b(n - b)\)&lt;/span&gt; æœ€å°ï¼Œçº¢æ–¹çš„æœ€ä¼˜ç­–ç•¥ä¸€å®šæ˜¯å°½å¯èƒ½æœ€å°åŒ– &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„æœ€å¤§å€¼ã€‚æ‰€ä»¥è¯´ï¼Œ&lt;strong&gt;çº¢æ–¹å°½å¯èƒ½å¤šæ§åˆ¶ç‚¹ï¼Œä¸€å®šæ˜¯æœ€ä¼˜çš„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸”ï¼Œä¸ºäº†å°½å¯èƒ½å¤šæ§åˆ¶ç‚¹ï¼Œ&lt;strong&gt;çº¢æ–¹é€‰çš„ä¸€å®šæ˜¯å¶å­èŠ‚ç‚¹&lt;/strong&gt;ï¼Œè‹¥é€‰çš„ä¸æ˜¯å¶å­ï¼Œåˆ™é€‰ä¸€ä¸ªå„¿å­èŠ‚ç‚¹èƒ½æ§åˆ¶çš„èŠ‚ç‚¹è‚¯å®šæ›´å¤šã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»å¤§åˆ°å°å– &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ ¹é•¿é“¾ï¼Œå–çš„æ—¶å€™ç®—ä¸€ä¸‹è“æ–¹è¿˜èƒ½æ¶‚å¤šå°‘ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(b &amp;gt; \lfloor n / 2\rfloor\)&lt;/span&gt; åˆ™å– &lt;span class=&#34;math inline&#34;&gt;\(b = \lfloor n / 2\rfloor\)&lt;/span&gt;ã€‚ä¾æ­¤è®¡ç®—ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb17&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb17-1&#34;&gt;&lt;a href=&#34;#cb17-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-2&#34;&gt;&lt;a href=&#34;#cb17-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb17-3&#34;&gt;&lt;a href=&#34;#cb17-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k, son[maxn], h[maxn], fa[maxn], len[maxn], cnt;&lt;/span&gt;
&lt;span id=&#34;cb17-4&#34;&gt;&lt;a href=&#34;#cb17-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-5&#34;&gt;&lt;a href=&#34;#cb17-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs1(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pre) {&lt;/span&gt;
&lt;span id=&#34;cb17-6&#34;&gt;&lt;a href=&#34;#cb17-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    fa[u] = pre;&lt;/span&gt;
&lt;span id=&#34;cb17-7&#34;&gt;&lt;a href=&#34;#cb17-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; v : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb17-8&#34;&gt;&lt;a href=&#34;#cb17-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v == pre) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-9&#34;&gt;&lt;a href=&#34;#cb17-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs1(v, u);&lt;/span&gt;
&lt;span id=&#34;cb17-10&#34;&gt;&lt;a href=&#34;#cb17-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (h[v] &amp;gt; h[son[u]])&lt;/span&gt;
&lt;span id=&#34;cb17-11&#34;&gt;&lt;a href=&#34;#cb17-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            son[u] = v;&lt;/span&gt;
&lt;span id=&#34;cb17-12&#34;&gt;&lt;a href=&#34;#cb17-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-13&#34;&gt;&lt;a href=&#34;#cb17-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    h[u] = h[son[u]] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-14&#34;&gt;&lt;a href=&#34;#cb17-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-15&#34;&gt;&lt;a href=&#34;#cb17-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb17-16&#34;&gt;&lt;a href=&#34;#cb17-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-17&#34;&gt;&lt;a href=&#34;#cb17-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs2(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; topf) {&lt;/span&gt;
&lt;span id=&#34;cb17-18&#34;&gt;&lt;a href=&#34;#cb17-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!son[u]) {&lt;/span&gt;
&lt;span id=&#34;cb17-19&#34;&gt;&lt;a href=&#34;#cb17-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        len[++cnt] = h[topf];&lt;/span&gt;
&lt;span id=&#34;cb17-20&#34;&gt;&lt;a href=&#34;#cb17-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-21&#34;&gt;&lt;a href=&#34;#cb17-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-22&#34;&gt;&lt;a href=&#34;#cb17-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs2(son[u], topf);&lt;/span&gt;
&lt;span id=&#34;cb17-23&#34;&gt;&lt;a href=&#34;#cb17-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; v : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb17-24&#34;&gt;&lt;a href=&#34;#cb17-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v == son[u] || v == fa[u]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-25&#34;&gt;&lt;a href=&#34;#cb17-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs2(v, v);&lt;/span&gt;
&lt;span id=&#34;cb17-26&#34;&gt;&lt;a href=&#34;#cb17-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-27&#34;&gt;&lt;a href=&#34;#cb17-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-28&#34;&gt;&lt;a href=&#34;#cb17-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb17-29&#34;&gt;&lt;a href=&#34;#cb17-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb17-30&#34;&gt;&lt;a href=&#34;#cb17-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb17-31&#34;&gt;&lt;a href=&#34;#cb17-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, k);&lt;/span&gt;
&lt;span id=&#34;cb17-32&#34;&gt;&lt;a href=&#34;#cb17-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb17-33&#34;&gt;&lt;a href=&#34;#cb17-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u, v);&lt;/span&gt;
&lt;span id=&#34;cb17-34&#34;&gt;&lt;a href=&#34;#cb17-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb17-35&#34;&gt;&lt;a href=&#34;#cb17-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-36&#34;&gt;&lt;a href=&#34;#cb17-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dfs1(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;), dfs2(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb17-37&#34;&gt;&lt;a href=&#34;#cb17-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(len + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, len + cnt + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, greater&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;());&lt;/span&gt;
&lt;span id=&#34;cb17-38&#34;&gt;&lt;a href=&#34;#cb17-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ans = -&lt;span class=&#34;fl&#34;&gt;1e18&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-39&#34;&gt;&lt;a href=&#34;#cb17-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b = n;&lt;/span&gt;
&lt;span id=&#34;cb17-40&#34;&gt;&lt;a href=&#34;#cb17-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(a, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) {&lt;/span&gt;
&lt;span id=&#34;cb17-41&#34;&gt;&lt;a href=&#34;#cb17-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = min(n / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, b -= len[a]);&lt;/span&gt;
&lt;span id=&#34;cb17-42&#34;&gt;&lt;a href=&#34;#cb17-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        chkmax(ans, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * (n - a - x) * (a - x));&lt;/span&gt;
&lt;span id=&#34;cb17-43&#34;&gt;&lt;a href=&#34;#cb17-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb17-44&#34;&gt;&lt;a href=&#34;#cb17-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb17-45&#34;&gt;&lt;a href=&#34;#cb17-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb17-46&#34;&gt;&lt;a href=&#34;#cb17-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;hello-2022&#34;&gt;Hello 2022&lt;/h2&gt;
&lt;h3 id=&#34;c---hidden-permutations&#34;&gt;1621C - Hidden Permutations&lt;/h3&gt;
&lt;p&gt;äº¤äº’é¢˜ï¼ŒçŒœä¸€ä¸ªæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(n\le 10000\)&lt;/span&gt;ï¼‰ã€‚åˆå§‹æœ‰ä¸€ä¸ªæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(q_i = i\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯ä»¥è¯¢é—®ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(q_i\)&lt;/span&gt; çš„å€¼ï¼Œäº¤äº’åº“å›ç­”ä½ çš„è¯¢é—®ä¹‹åä¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ›¿æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(q_i&amp;#39; = q_{p_i}\)&lt;/span&gt;ã€‚æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ–½åŠ  &lt;span class=&#34;math inline&#34;&gt;\(q_i = q_{p_i}\)&lt;/span&gt; çš„å˜æ¢è¿™ä¸€è¿‡ç¨‹çš„æœ¬è´¨æ˜¯ä¸€ä¸ªç½®æ¢ã€‚ä¸å¦¨ç›¯ç€ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(q_i\)&lt;/span&gt; ä¸æ”¾ï¼Œæˆ‘ä»¬å‘ç°å…¶å˜æ¢ä¸‹å»ä¹‹åä¼šä¸º &lt;span class=&#34;math inline&#34;&gt;\(p_i, p_{p_i}, p_{p_{p_i}},\cdots\)&lt;/span&gt; ä¼šå½¢æˆä¸€ä¸ªç¯ï¼Œç¯ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(p_u = v\)&lt;/span&gt;ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ¯æ¬¡ç›¯ç€ä¸€ä¸ªæ²¡æœ‰æ±‚å‡ºç­”æ¡ˆçš„ä¸‹æ ‡è¯¢é—®ï¼ŒæŠŠè¿™éƒ¨åˆ†ç¯æ‰¾åˆ°ï¼Œè¿™é¢˜å°±è§£å†³äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¯¢é—®æ¬¡æ•°çš„ä¸Šç•Œåˆšå¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt;ï¼Œå¡çš„å¾ˆå‡†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---the-winter-hike&#34;&gt;1621D - The Winter Hike&lt;/h3&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(2n\times 2n\)&lt;/span&gt; çš„æ£‹ç›˜ï¼Œåˆå§‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; ä¸ªäººåœ¨å·¦ä¸Šè§’çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; æ­£æ–¹å½¢å†…ï¼ˆæ¯ä¸ªæ ¼å­é‡Œé¢ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; äººï¼‰ã€‚ç°è¦å°†è¿™ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; ä¸ªäººé€šè¿‡å¦‚ä¸‹æ–¹å¼ç§»åŠ¨åˆ°å³ä¸‹è§’çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; æ­£æ–¹å½¢å†…ï¼ˆæ¯ä¸ªæ ¼å­ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; äººï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰å®šä¸€è¡Œï¼Œå°†å…¶é‡Œé¢æ‰€æœ‰çš„äººå¾ªç¯å¾€å·¦/å³ç§»ä¸€æ ¼ã€‚å³å¯¹äºæœ‰äººçš„ &lt;span class=&#34;math inline&#34;&gt;\((x_0, y)\)&lt;/span&gt;ï¼Œæˆ‘ä»¬æ–½å˜æ¢ &lt;span class=&#34;math inline&#34;&gt;\((x_0, y)\to (x_0, y + 1)\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\((x_0, y)\to(x_0, y - 1)\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((x_0, 2n)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((x_0, 1)\)&lt;/span&gt; çš„ç‰¹åˆ¤ã€‚&lt;/li&gt;
&lt;li&gt;é€‰å®šä¸€åˆ—ï¼Œå°†å…¶é‡Œé¢æ‰€æœ‰çš„äººå¾ªç¯å¾€ä¸Š/ä¸‹ç§»ä¸€æ ¼ã€‚å³å¯¹äºæœ‰äººçš„ &lt;span class=&#34;math inline&#34;&gt;\((x, y_0)\)&lt;/span&gt;ï¼Œæˆ‘ä»¬æ–½å˜æ¢ &lt;span class=&#34;math inline&#34;&gt;\((x, y_0)\to (x + 1, y_0)\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\((x, y_0)\to(x - 1, y_0)\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((2n, y_0)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((1, y_0)\)&lt;/span&gt; çš„ç‰¹åˆ¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ“ä½œå¯ä»¥è¿›è¡Œä»»æ„æ¬¡ã€‚åŒæ—¶æœ‰äº›æ ¼å­é‡Œé¢æœ‰éšœç¢ï¼Œäººä¸èƒ½ç»è¿‡ï¼Œé™¤æ‰ &lt;span class=&#34;math inline&#34;&gt;\((x, y)\)&lt;/span&gt; çš„éšœç¢éœ€è¦èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(c_{x, y}\)&lt;/span&gt;ï¼Œå¯é™¤æ‰çš„éšœç¢æ•°ä¸é™ã€‚é—®æœ€å°èŠ±è´¹ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯ä¸€é“éå¸¸å·§å¦™çš„æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ï¼Œå‘ç°å³ä¸‹è§’çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; åŒºåŸŸæ˜¯å¿…é¡»é™¤æ‰çš„ã€‚ç„¶åè§‚å¯Ÿä¸€ä¸‹æ ·ä¾‹ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;ï¼Œå‘ç°å³ä¸‹è§’çš„æƒå€¼å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(12\)&lt;/span&gt;ï¼Œè¯´æ˜æˆ‘ä»¬åªæ‰£æ‰äº†ä¸€ä¸ªå¤šä½™çš„ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ã€‚ç„¶åæ³¨æ„åˆ°æŒ–æ‰ &lt;span class=&#34;math inline&#34;&gt;\((2, 3)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((3, 2)\)&lt;/span&gt; æˆ–è€… &lt;span class=&#34;math inline&#34;&gt;\((1, 4)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((4, 1)\)&lt;/span&gt; éƒ½æ˜¯å¯ä»¥çš„ã€‚æ–¹æ¡ˆå¯ä»¥è‡ªè¡Œå°è¯•æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å‘ç°ï¼Œæˆ‘ä»¬é™¤äº†å³ä¸‹è§’çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; è¦æŠ æ‰ï¼Œåªéœ€è¦åœ¨ä¸¤å— &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; åŒºåŸŸå››è§’çš„äº¤ç•Œæ ¼ç‚¹å¤„æŠ æ‰ä¸€ä¸ªç‚¹å°±å¯ä»¥äº†ã€‚è‡³äºæ–¹æ¡ˆæ„é€ ï¼Œå°±è€ƒè™‘ä¸€è¡Œè¡Œ/ä¸€åˆ—åˆ—çš„ç§»å…¥å³ä¸‹è§’çš„åŒºåŸŸï¼Œå¯ä»¥è‡ªè¡Œæƒ³è±¡ä¸€ä¸‹ã€‚è¿™äº›ç‚¹ä¸€å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\((1, 2n)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((2n, 1)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((1, n + 1)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((n + 1, 1)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((n, n + 1)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((n + 1, n)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((n, 2n)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((2n, n)\)&lt;/span&gt;ã€‚äºæ˜¯è¿™é¢˜å°±åšå®Œäº†ã€‚éå¸¸å¦™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---new-school&#34;&gt;1621E - New School&lt;/h3&gt;
&lt;p&gt;è¦å¼€åŠå­¦æ ¡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªè€å¸ˆï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç»„å­¦ç”Ÿã€‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»„å­¦ç”Ÿæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k_i\)&lt;/span&gt; äººã€‚è€å¸ˆçš„å¹´é¾„åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_1, \cdots, a_n\)&lt;/span&gt;ï¼Œå­¦ç”Ÿçš„å¹´é¾„åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b_{i, 1},\cdots, b_{i, k_i}\)&lt;/span&gt;ã€‚è¦æ±‚å®‰æ’è€å¸ˆåˆ°æ¯ç»„å­¦ç”Ÿï¼Œæ»¡è¶³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ç»„å­¦ç”Ÿéƒ½æ°å¥½æœ‰ä¸€ä¸ªè€å¸ˆã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªè€å¸ˆæœ€å¤šå¸¦ä¸€ä¸ªç»„ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ç»„å†…ï¼Œå­¦ç”Ÿçš„å¹³å‡å¹´é¾„ä¸è¶…è¿‡è€å¸ˆçš„å¹´é¾„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ªå­¦ç”Ÿï¼Œæ±‚å‡ºè‹¥å…¶ä¸æ¥ä¸Šè¯¾ï¼Œè¯¾ç¨‹èƒ½å¦è¢«å®‰æ’ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le n\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le a_i,b_{i,j}\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\le k_i\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\sum k_i\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å°†æ‰€æœ‰å­¦ç”Ÿç»„å’Œæ‰€æœ‰è€å¸ˆé™åºæ’åºã€‚åˆ™æœ‰è§£å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\forall 1\le i\le m\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(avr_i\le a_i\)&lt;/span&gt;ï¼Œè¯¥æƒ…å†µä¸‹æˆ‘ä»¬å°†å…¶ä¸€ä¸€å¯¹åº”å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è€Œå½“ä¸€ä¸ªå­¦ç”Ÿä¸æ¥æ—¶ï¼Œå…¶åªä¼šå½±å“ä¸€ä¸ªç»„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å¹³å‡å¹´é¾„ &lt;span class=&#34;math inline&#34;&gt;\(avr_i\)&lt;/span&gt;ã€‚å¯¹äºæ¯ä¸€ä¸ªå­¦ç”Ÿ &lt;span class=&#34;math inline&#34;&gt;\(b_{i, x}\)&lt;/span&gt;ï¼Œéƒ½å¯ä»¥äºŒåˆ†æ‰¾å‡ºæ²¡æœ‰ä»–ä¹‹åï¼Œæ•´ç»„äººçš„æ–°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚è¿™æ ·ä¸€æ¥ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\([j, i)\)&lt;/span&gt; å†…çš„ç»„éƒ½ä¼šå¾€ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹å‘å¹³ç§»ä¸€æ ¼ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ï¼Œå°±æ˜¯æ”¹å˜åçš„å±€é¢æ˜¯å¦åˆæ³•ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºæ”¹å˜ä¹‹åæ˜¯å¦åˆæ³•ï¼Œå¯ä»¥è®°ä¸‰ä¸ªå‰ç¼€å’Œæ•°ç»„ï¼ˆåˆ†åˆ«ç»´æŠ¤å½“å‰ä½ç½®ï¼Œå½“å‰ä½ç½®å¾€å·¦/å³å¹³ç§»ä¸€æ ¼åæ˜¯å¦åˆæ³•ï¼‰æ¥å®ç°ï¼Œè¯¦è§ä»£ç ã€‚å®ç°è¾ƒä¸ºå¤æ‚æ¶å¿ƒã€‚åŒæ—¶ï¼Œéœ€è¦é¿å¼€æµ®ç‚¹è¯¯å·®ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb18&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb18-1&#34;&gt;&lt;a href=&#34;#cb18-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-2&#34;&gt;&lt;a href=&#34;#cb18-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-3&#34;&gt;&lt;a href=&#34;#cb18-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pli = pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-4&#34;&gt;&lt;a href=&#34;#cb18-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ok[maxn], ok_suf[maxn], ok_pre[maxn], pos0[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-5&#34;&gt;&lt;a href=&#34;#cb18-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pair&amp;lt;pli, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; B[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-6&#34;&gt;&lt;a href=&#34;#cb18-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pli a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-7&#34;&gt;&lt;a href=&#34;#cb18-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; c[maxn];&lt;/span&gt;
&lt;span id=&#34;cb18-8&#34;&gt;&lt;a href=&#34;#cb18-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-9&#34;&gt;&lt;a href=&#34;#cb18-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;&amp;gt;(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; pli &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; pli &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a.first * b.second &amp;gt; b.first * a.second;}&lt;/span&gt;
&lt;span id=&#34;cb18-10&#34;&gt;&lt;a href=&#34;#cb18-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-11&#34;&gt;&lt;a href=&#34;#cb18-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve() {&lt;/span&gt;
&lt;span id=&#34;cb18-12&#34;&gt;&lt;a href=&#34;#cb18-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m; read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb18-13&#34;&gt;&lt;a href=&#34;#cb18-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i].first), a[i].second = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-14&#34;&gt;&lt;a href=&#34;#cb18-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb18-15&#34;&gt;&lt;a href=&#34;#cb18-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k; read(k); ll sum = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-16&#34;&gt;&lt;a href=&#34;#cb18-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        c[i].resize(k);&lt;/span&gt;
&lt;span id=&#34;cb18-17&#34;&gt;&lt;a href=&#34;#cb18-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) read(c[i][j]), sum += c[i][j];&lt;/span&gt;
&lt;span id=&#34;cb18-18&#34;&gt;&lt;a href=&#34;#cb18-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        B[i] = make_pair(pli(sum, k), i);&lt;/span&gt;
&lt;span id=&#34;cb18-19&#34;&gt;&lt;a href=&#34;#cb18-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-20&#34;&gt;&lt;a href=&#34;#cb18-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(a + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a + n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;&amp;gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-21&#34;&gt;&lt;a href=&#34;#cb18-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; cmp = [](&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a.first &amp;gt; b.first;};&lt;/span&gt;
&lt;span id=&#34;cb18-22&#34;&gt;&lt;a href=&#34;#cb18-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sort(B + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, B + m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cmp);&lt;/span&gt;
&lt;span id=&#34;cb18-23&#34;&gt;&lt;a href=&#34;#cb18-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb18-24&#34;&gt;&lt;a href=&#34;#cb18-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ok[i] = ok[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + (B[i].first &amp;gt; a[i]);&lt;span class=&#34;co&#34;&gt;//è®°å½•ä¸åˆæ³•çš„æƒ…å†µ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-25&#34;&gt;&lt;a href=&#34;#cb18-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ok_pre[i] = ok_pre[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + (B[i].first &amp;gt; a[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;span class=&#34;co&#34;&gt;//è®°å½•ä¸åˆæ³•çš„æƒ…å†µ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-26&#34;&gt;&lt;a href=&#34;#cb18-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ok_suf[i] = ok_suf[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + (B[i].first &amp;gt; a[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;span class=&#34;co&#34;&gt;//è®°å½•ä¸åˆæ³•çš„æƒ…å†µ&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-27&#34;&gt;&lt;a href=&#34;#cb18-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        pos0[B[i].second] = i;&lt;/span&gt;
&lt;span id=&#34;cb18-28&#34;&gt;&lt;a href=&#34;#cb18-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-29&#34;&gt;&lt;a href=&#34;#cb18-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb18-30&#34;&gt;&lt;a href=&#34;#cb18-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; x : c[i]) {&lt;/span&gt;
&lt;span id=&#34;cb18-31&#34;&gt;&lt;a href=&#34;#cb18-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            pli now(B[pos0[i]].first.first - x, B[pos0[i]].first.second - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-32&#34;&gt;&lt;a href=&#34;#cb18-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; to = lower_bound(B + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, B + m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, make_pair(now, i), cmp) - B;&lt;/span&gt;
&lt;span id=&#34;cb18-33&#34;&gt;&lt;a href=&#34;#cb18-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (to &amp;gt; pos0[i])&lt;/span&gt;
&lt;span id=&#34;cb18-34&#34;&gt;&lt;a href=&#34;#cb18-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                putchar((now &amp;gt; a[to - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] || ok[pos0[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + ok_pre[to - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - ok_pre[pos0[i]] + ok[m] - ok[to - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) ? &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; : &lt;span class=&#34;ch&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-35&#34;&gt;&lt;a href=&#34;#cb18-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; putchar((now &amp;gt; a[to] || ok[to - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + ok_suf[pos0[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - ok_suf[to - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + ok[m] - ok[pos0[i]]) ? &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; : &lt;span class=&#34;ch&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-36&#34;&gt;&lt;a href=&#34;#cb18-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb18-37&#34;&gt;&lt;a href=&#34;#cb18-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb18-38&#34;&gt;&lt;a href=&#34;#cb18-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb18-39&#34;&gt;&lt;a href=&#34;#cb18-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-40&#34;&gt;&lt;a href=&#34;#cb18-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb18-41&#34;&gt;&lt;a href=&#34;#cb18-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb18-42&#34;&gt;&lt;a href=&#34;#cb18-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb18-43&#34;&gt;&lt;a href=&#34;#cb18-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb18-44&#34;&gt;&lt;a href=&#34;#cb18-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) solve();&lt;/span&gt;
&lt;span id=&#34;cb18-45&#34;&gt;&lt;a href=&#34;#cb18-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb18-46&#34;&gt;&lt;a href=&#34;#cb18-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-764-div.-3&#34;&gt;Codeforces Round #764 (Div. 3)&lt;/h2&gt;
&lt;p&gt;éšç¼˜æ¥åšåšã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---interacdive-problem&#34;&gt;1624F - Interacdive Problem&lt;/h3&gt;
&lt;p&gt;äº¤äº’é¢˜ï¼ŒçŒœæ•°å­—ã€‚ç»™å®šä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(2 &amp;lt; n\le 1000\)&lt;/span&gt;ï¼‰ï¼Œè¦çŒœä¸€ä¸ªæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(1\le x &amp;lt; n\)&lt;/span&gt;ã€‚å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;`+ c`ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(x:=x + c\)&lt;/span&gt;ï¼Œç„¶åäº¤äº’å™¨è¿”å› &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle\left\lfloor\frac{x}{n}\right\rfloor\)&lt;/span&gt; çš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;! x&lt;/code&gt;ï¼Œè¾“å‡ºç­”æ¡ˆï¼Œ&lt;strong&gt;å½“å‰çš„&lt;/strong&gt; &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; æ¬¡è¯¢é—®ã€‚&lt;/p&gt;
&lt;p&gt;ç›´è§‰å‘Šè¯‰æˆ‘ä»¬ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2^{10} = 1024\)&lt;/span&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘äºŒåˆ†å‡ºè¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯æ¬¡å¯¹äºŒåˆ†å·¦å³ç«¯ç‚¹åŒæ—¶åŠ ä¸Šæˆ‘ä»¬ç»™äº¤äº’åº“åŠ ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬çš„æ€è·¯æ˜¯å°½å¯èƒ½æŠŠå½“å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¾€å…¶ä¸Šé¢çš„ç¬¬ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„å€æ•°å»å‡‘ï¼Œæ‰€ä»¥æ¯æ¬¡äºŒåˆ†çš„æ—¶å€™åŠ ä¸Šçš„éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n - mid\bmod n\)&lt;/span&gt;ã€‚ç„¶åå°±å¯ä»¥æ ¹æ®äº¤äº’åº“è¿”å›çš„å€¼æ¥ä¸€æ­¥æ­¥æ¡†æ­»èŒƒå›´ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb19&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb19-1&#34;&gt;&lt;a href=&#34;#cb19-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; add(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x) {&lt;/span&gt;
&lt;span id=&#34;cb19-2&#34;&gt;&lt;a href=&#34;#cb19-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot;+ &amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb19-3&#34;&gt;&lt;a href=&#34;#cb19-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; res; cin &amp;gt;&amp;gt; res;&lt;/span&gt;
&lt;span id=&#34;cb19-4&#34;&gt;&lt;a href=&#34;#cb19-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; res;&lt;/span&gt;
&lt;span id=&#34;cb19-5&#34;&gt;&lt;a href=&#34;#cb19-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb19-6&#34;&gt;&lt;a href=&#34;#cb19-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb19-7&#34;&gt;&lt;a href=&#34;#cb19-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb19-8&#34;&gt;&lt;a href=&#34;#cb19-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb19-9&#34;&gt;&lt;a href=&#34;#cb19-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r = n;&lt;/span&gt;
&lt;span id=&#34;cb19-10&#34;&gt;&lt;a href=&#34;#cb19-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt; r - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb19-11&#34;&gt;&lt;a href=&#34;#cb19-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-12&#34;&gt;&lt;a href=&#34;#cb19-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a = n - mid % n;&lt;/span&gt;
&lt;span id=&#34;cb19-13&#34;&gt;&lt;a href=&#34;#cb19-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; res = add(a);&lt;/span&gt;
&lt;span id=&#34;cb19-14&#34;&gt;&lt;a href=&#34;#cb19-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        l += a, r += a, mid += a;&lt;/span&gt;
&lt;span id=&#34;cb19-15&#34;&gt;&lt;a href=&#34;#cb19-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (res == l / n) r = mid;&lt;/span&gt;
&lt;span id=&#34;cb19-16&#34;&gt;&lt;a href=&#34;#cb19-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; l = mid; &lt;/span&gt;
&lt;span id=&#34;cb19-17&#34;&gt;&lt;a href=&#34;#cb19-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb19-18&#34;&gt;&lt;a href=&#34;#cb19-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;st&#34;&gt;&amp;quot;! &amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; l &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb19-19&#34;&gt;&lt;a href=&#34;#cb19-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb19-20&#34;&gt;&lt;a href=&#34;#cb19-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;g---minor-tree&#34;&gt;1624G - MinOr Tree&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€å¼ æ— å‘å›¾ï¼Œå®šä¹‰å…¶ç”Ÿæˆæ ‘çš„è¾¹æƒä¸º OR å’Œï¼Œé—®æœ€å°ç”Ÿæˆæ ‘çš„è¾¹æƒ OR å’Œã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä»é«˜åˆ°ä½æŒ‰ä½è´ªå¿ƒï¼Œç”¨å¹¶æŸ¥é›†åˆ¤æ–­è¯¥ä½æ˜¯ä¸æ˜¯å¿…é¡»å–ï¼Œä¸æ˜¯çš„è¯å°±ä¸å–ã€‚å…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(ans = 2^{30} - 1\)&lt;/span&gt;ï¼Œç„¶åæ¯æ¬¡å…ˆå°† &lt;span class=&#34;math inline&#34;&gt;\(ans\)&lt;/span&gt; çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½å»æ‰ï¼Œçœ‹èƒ½å¦æ»¡è¶³å­˜åœ¨ç”Ÿæˆæ ‘ï¼Œè‹¥èƒ½å­˜åœ¨åˆ™ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½ä¸å–ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(m\log a\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb20&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb20-1&#34;&gt;&lt;a href=&#34;#cb20-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-2&#34;&gt;&lt;a href=&#34;#cb20-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; edge {&lt;/span&gt;
&lt;span id=&#34;cb20-3&#34;&gt;&lt;a href=&#34;#cb20-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v, w;&lt;/span&gt;
&lt;span id=&#34;cb20-4&#34;&gt;&lt;a href=&#34;#cb20-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} e[maxn];&lt;/span&gt;
&lt;span id=&#34;cb20-5&#34;&gt;&lt;a href=&#34;#cb20-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, fa[maxn];&lt;/span&gt;
&lt;span id=&#34;cb20-6&#34;&gt;&lt;a href=&#34;#cb20-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb20-7&#34;&gt;&lt;a href=&#34;#cb20-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; find(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; fa[u] == u ? u : fa[u] = find(fa[u]);}&lt;/span&gt;
&lt;span id=&#34;cb20-8&#34;&gt;&lt;a href=&#34;#cb20-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb20-9&#34;&gt;&lt;a href=&#34;#cb20-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; merge(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v) {&lt;/span&gt;
&lt;span id=&#34;cb20-10&#34;&gt;&lt;a href=&#34;#cb20-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    u = find(u), v = find(v);&lt;/span&gt;
&lt;span id=&#34;cb20-11&#34;&gt;&lt;a href=&#34;#cb20-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (u == v) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-12&#34;&gt;&lt;a href=&#34;#cb20-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; fa[u] = v, &lt;span class=&#34;kw&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-13&#34;&gt;&lt;a href=&#34;#cb20-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb20-14&#34;&gt;&lt;a href=&#34;#cb20-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb20-15&#34;&gt;&lt;a href=&#34;#cb20-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; mask) {&lt;/span&gt;
&lt;span id=&#34;cb20-16&#34;&gt;&lt;a href=&#34;#cb20-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) fa[i] = i;&lt;/span&gt;
&lt;span id=&#34;cb20-17&#34;&gt;&lt;a href=&#34;#cb20-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; size = n;&lt;/span&gt;
&lt;span id=&#34;cb20-18&#34;&gt;&lt;a href=&#34;#cb20-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb20-19&#34;&gt;&lt;a href=&#34;#cb20-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((e[i].w | mask) != mask) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-20&#34;&gt;&lt;a href=&#34;#cb20-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (merge(e[i].u, e[i].v)) --size;&lt;/span&gt;
&lt;span id=&#34;cb20-21&#34;&gt;&lt;a href=&#34;#cb20-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb20-22&#34;&gt;&lt;a href=&#34;#cb20-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; size == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-23&#34;&gt;&lt;a href=&#34;#cb20-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb20-24&#34;&gt;&lt;a href=&#34;#cb20-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb20-25&#34;&gt;&lt;a href=&#34;#cb20-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb20-26&#34;&gt;&lt;a href=&#34;#cb20-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb20-27&#34;&gt;&lt;a href=&#34;#cb20-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb20-28&#34;&gt;&lt;a href=&#34;#cb20-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb20-29&#34;&gt;&lt;a href=&#34;#cb20-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) read(e[i].u, e[i].v, e[i].w);&lt;/span&gt;
&lt;span id=&#34;cb20-30&#34;&gt;&lt;a href=&#34;#cb20-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;30&lt;/span&gt;) - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-31&#34;&gt;&lt;a href=&#34;#cb20-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, &lt;span class=&#34;dv&#34;&gt;29&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb20-32&#34;&gt;&lt;a href=&#34;#cb20-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans ^= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; i);&lt;/span&gt;
&lt;span id=&#34;cb20-33&#34;&gt;&lt;a href=&#34;#cb20-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!check(ans)) ans ^= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; i);&lt;/span&gt;
&lt;span id=&#34;cb20-34&#34;&gt;&lt;a href=&#34;#cb20-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb20-35&#34;&gt;&lt;a href=&#34;#cb20-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(ans);&lt;/span&gt;
&lt;span id=&#34;cb20-36&#34;&gt;&lt;a href=&#34;#cb20-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb20-37&#34;&gt;&lt;a href=&#34;#cb20-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb20-38&#34;&gt;&lt;a href=&#34;#cb20-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-765-div.-2&#34;&gt;Codeforces Round #765 (Div. 2)&lt;/h2&gt;
&lt;p&gt;è¡¥å®Œäº†ï¼&lt;/p&gt;
&lt;h3 id=&#34;d---binary-spiders&#34;&gt;1625D - Binary Spiders&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ•°é›† &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œå¤§å° &lt;span class=&#34;math inline&#34;&gt;\(n\le 3\times 10^5\)&lt;/span&gt;ï¼Œè¦æ±‚é€‰å‡ºä¸€ä¸ªå¤§å°æœ€å¤§çš„å­é›† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä½¿å¾—å…¶ä¸­å…ƒç´ ä¸¤ä¸¤å¼‚æˆ–çš„å€¼éƒ½å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ã€‚æ„é€ æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°ä¸¤ä¸ªæ•°å­—å¼‚æˆ–èµ·æ¥å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶æ˜¯å…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹ï¼Œæœ€é«˜çš„ä¸ç›¸åŒçš„ä½å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„æœ€é«˜ä½ã€‚å³ä»–ä»¬åœ¨ Trie ä¸Šçš„ LCA å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„æœ€é«˜ä½ã€‚ä¸‹é¢ä»¤è¿™ä¸ªç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(up\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Trie ä¸Šé€’å½’æ±‚è§£é—®é¢˜ã€‚ç‚¹å¯¹åˆ†ä¸ºåœ¨å·¦å³å­æ ‘å†…éƒ¨å’Œè·¨è¶Šè¯¥èŠ‚ç‚¹ä¸¤ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“å‰ Trie è¡¨ç¤ºçš„ä½æ•°å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(up\)&lt;/span&gt;ï¼Œæ­¤æ—¶å·¦å³å­æ ‘å†…éƒ¨çš„ç‚¹å¯¹éƒ½æœ‰å¸Œæœ›å¼‚æˆ–å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ï¼Œè€Œè·¨è¶Šè¯¥èŠ‚ç‚¹çš„é“å®šå¤§äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt;ï¼Œæ‰€ä»¥é€’å½’ä¸‹å»åšç„¶åæŠŠä¸¤è¾¹ç­”æ¡ˆåˆå¹¶ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰ Trie è¡¨ç¤ºçš„ä½æ•°ç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(up\)&lt;/span&gt;ï¼Œæ­¤æ—¶æˆ‘ä»¬è¦ä¹ˆåœ¨è¯¥å­æ ‘ä¸­é€‰å‡ºä¸€ä¸ªå¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„å…ƒç´ ï¼Œè¦ä¹ˆæ‰¾ä¸€å¯¹è·¨è¶Šå·¦å³å­æ ‘çš„å¼‚æˆ–å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„æ•°å¯¹ï¼Œç„¶åå°±ä¸ç”¨é€’å½’ä¸‹å»äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹åº”è¯¥æ˜¯è‡ªè¯æ˜çš„ã€‚æ‰¾å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„å…ƒç´ å¾ˆç®€å•ï¼Œä¸€ç›´å¾€å³å­æ ‘æ‰¾æœ€å¤§çš„å³å¯ã€‚æ‰¾å¼‚æˆ–å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; çš„ä¹Ÿå¾ˆç®€å•ï¼Œå°†ä¸€ä¸ªå­æ ‘å†…çš„æ‰€æœ‰æ•°å­—æå‡ºæ¥ï¼ŒæŒ¨ä¸ªåœ¨å³è¾¹æŸ¥æœ€å¤§å¼‚æˆ–å¯¹ï¼Œå°±å¯ä»¥æ‰¾åˆ°äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(K = 0\)&lt;/span&gt; çš„æƒ…å†µéœ€è¦ç‰¹åˆ¤ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb21&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb21-1&#34;&gt;&lt;a href=&#34;#cb21-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-2&#34;&gt;&lt;a href=&#34;#cb21-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, K, a[maxn], up;&lt;/span&gt;
&lt;span id=&#34;cb21-3&#34;&gt;&lt;a href=&#34;#cb21-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ch[maxn * &lt;span class=&#34;dv&#34;&gt;30&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], val[maxn * &lt;span class=&#34;dv&#34;&gt;30&lt;/span&gt;], tot, root;&lt;/span&gt;
&lt;span id=&#34;cb21-4&#34;&gt;&lt;a href=&#34;#cb21-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-5&#34;&gt;&lt;a href=&#34;#cb21-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; insert(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; id, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k) {&lt;/span&gt;
&lt;span id=&#34;cb21-6&#34;&gt;&lt;a href=&#34;#cb21-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!u) u = ++tot;&lt;/span&gt;
&lt;span id=&#34;cb21-7&#34;&gt;&lt;a href=&#34;#cb21-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; val[u] = id, &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt;();&lt;/span&gt;
&lt;span id=&#34;cb21-8&#34;&gt;&lt;a href=&#34;#cb21-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c = (x &amp;gt;&amp;gt; k) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-9&#34;&gt;&lt;a href=&#34;#cb21-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    insert(ch[u][c], id, x, k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-10&#34;&gt;&lt;a href=&#34;#cb21-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-11&#34;&gt;&lt;a href=&#34;#cb21-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb21-12&#34;&gt;&lt;a href=&#34;#cb21-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-13&#34;&gt;&lt;a href=&#34;#cb21-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; getval(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k) {&lt;/span&gt;
&lt;span id=&#34;cb21-14&#34;&gt;&lt;a href=&#34;#cb21-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!u) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;();&lt;/span&gt;
&lt;span id=&#34;cb21-15&#34;&gt;&lt;a href=&#34;#cb21-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;{val[u]};&lt;/span&gt;
&lt;span id=&#34;cb21-16&#34;&gt;&lt;a href=&#34;#cb21-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; r1 = getval(ch[u][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), r2 = getval(ch[u][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-17&#34;&gt;&lt;a href=&#34;#cb21-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; xx : r2) r1.push_back(xx);&lt;/span&gt;
&lt;span id=&#34;cb21-18&#34;&gt;&lt;a href=&#34;#cb21-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; r1;&lt;/span&gt;
&lt;span id=&#34;cb21-19&#34;&gt;&lt;a href=&#34;#cb21-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb21-20&#34;&gt;&lt;a href=&#34;#cb21-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-21&#34;&gt;&lt;a href=&#34;#cb21-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x) {&lt;/span&gt;
&lt;span id=&#34;cb21-22&#34;&gt;&lt;a href=&#34;#cb21-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; val[u];&lt;/span&gt;
&lt;span id=&#34;cb21-23&#34;&gt;&lt;a href=&#34;#cb21-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c = ((x &amp;gt;&amp;gt; k) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ^ &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-24&#34;&gt;&lt;a href=&#34;#cb21-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!ch[u][c]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; query(ch[u][c ^ &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, x);&lt;/span&gt;
&lt;span id=&#34;cb21-25&#34;&gt;&lt;a href=&#34;#cb21-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; query(ch[u][c], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, x);&lt;/span&gt;
&lt;span id=&#34;cb21-26&#34;&gt;&lt;a href=&#34;#cb21-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb21-27&#34;&gt;&lt;a href=&#34;#cb21-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-28&#34;&gt;&lt;a href=&#34;#cb21-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k) {&lt;/span&gt;
&lt;span id=&#34;cb21-29&#34;&gt;&lt;a href=&#34;#cb21-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;lt; up || !u) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;();&lt;/span&gt;
&lt;span id=&#34;cb21-30&#34;&gt;&lt;a href=&#34;#cb21-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;gt; up) {&lt;/span&gt;
&lt;span id=&#34;cb21-31&#34;&gt;&lt;a href=&#34;#cb21-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; r1 = solve(ch[u][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), r2 = solve(ch[u][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-32&#34;&gt;&lt;a href=&#34;#cb21-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; xx : r2) r1.push_back(xx);&lt;/span&gt;
&lt;span id=&#34;cb21-33&#34;&gt;&lt;a href=&#34;#cb21-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; r1;&lt;/span&gt;
&lt;span id=&#34;cb21-34&#34;&gt;&lt;a href=&#34;#cb21-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == up) {&lt;/span&gt;
&lt;span id=&#34;cb21-35&#34;&gt;&lt;a href=&#34;#cb21-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; vec1 = getval(ch[u][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), vec2 = getval(ch[u][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), ans;&lt;/span&gt;
&lt;span id=&#34;cb21-36&#34;&gt;&lt;a href=&#34;#cb21-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vec1.size()) {&lt;/span&gt;
&lt;span id=&#34;cb21-37&#34;&gt;&lt;a href=&#34;#cb21-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[vec2.back()] &amp;gt;= K) ans.push_back(vec2.back());&lt;/span&gt;
&lt;span id=&#34;cb21-38&#34;&gt;&lt;a href=&#34;#cb21-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb21-39&#34;&gt;&lt;a href=&#34;#cb21-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb21-40&#34;&gt;&lt;a href=&#34;#cb21-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vec2.size()) {&lt;/span&gt;
&lt;span id=&#34;cb21-41&#34;&gt;&lt;a href=&#34;#cb21-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[vec1.back()] &amp;gt;= K) ans.push_back(vec1.back());&lt;/span&gt;
&lt;span id=&#34;cb21-42&#34;&gt;&lt;a href=&#34;#cb21-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb21-43&#34;&gt;&lt;a href=&#34;#cb21-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb21-44&#34;&gt;&lt;a href=&#34;#cb21-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; flag = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-45&#34;&gt;&lt;a href=&#34;#cb21-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; x1 : vec1) {&lt;/span&gt;
&lt;span id=&#34;cb21-46&#34;&gt;&lt;a href=&#34;#cb21-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x2 = query(ch[u][&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], k - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a[x1]);&lt;/span&gt;
&lt;span id=&#34;cb21-47&#34;&gt;&lt;a href=&#34;#cb21-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((a[x1] ^ a[x2]) &amp;gt;= K) {&lt;/span&gt;
&lt;span id=&#34;cb21-48&#34;&gt;&lt;a href=&#34;#cb21-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                flag = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-49&#34;&gt;&lt;a href=&#34;#cb21-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans.push_back(x1), ans.push_back(x2);&lt;/span&gt;
&lt;span id=&#34;cb21-50&#34;&gt;&lt;a href=&#34;#cb21-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-51&#34;&gt;&lt;a href=&#34;#cb21-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb21-52&#34;&gt;&lt;a href=&#34;#cb21-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb21-53&#34;&gt;&lt;a href=&#34;#cb21-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!flag) {&lt;/span&gt;
&lt;span id=&#34;cb21-54&#34;&gt;&lt;a href=&#34;#cb21-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[vec1.back()] &amp;gt;= K) ans.push_back(vec1.back());&lt;/span&gt;
&lt;span id=&#34;cb21-55&#34;&gt;&lt;a href=&#34;#cb21-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb21-56&#34;&gt;&lt;a href=&#34;#cb21-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb21-57&#34;&gt;&lt;a href=&#34;#cb21-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-58&#34;&gt;&lt;a href=&#34;#cb21-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb21-59&#34;&gt;&lt;a href=&#34;#cb21-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb21-60&#34;&gt;&lt;a href=&#34;#cb21-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb21-61&#34;&gt;&lt;a href=&#34;#cb21-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, K);&lt;/span&gt;
&lt;span id=&#34;cb21-62&#34;&gt;&lt;a href=&#34;#cb21-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, &lt;span class=&#34;dv&#34;&gt;30&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((K &amp;gt;&amp;gt; i) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb21-63&#34;&gt;&lt;a href=&#34;#cb21-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        up = i;&lt;/span&gt;
&lt;span id=&#34;cb21-64&#34;&gt;&lt;a href=&#34;#cb21-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-65&#34;&gt;&lt;a href=&#34;#cb21-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-66&#34;&gt;&lt;a href=&#34;#cb21-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (K == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb21-67&#34;&gt;&lt;a href=&#34;#cb21-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(n);&lt;/span&gt;
&lt;span id=&#34;cb21-68&#34;&gt;&lt;a href=&#34;#cb21-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) print(i, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-69&#34;&gt;&lt;a href=&#34;#cb21-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-70&#34;&gt;&lt;a href=&#34;#cb21-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-71&#34;&gt;&lt;a href=&#34;#cb21-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]), insert(root, i, a[i], &lt;span class=&#34;dv&#34;&gt;30&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-72&#34;&gt;&lt;a href=&#34;#cb21-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; ans = solve(root, &lt;span class=&#34;dv&#34;&gt;30&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-73&#34;&gt;&lt;a href=&#34;#cb21-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!ans.size()) print(-&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-74&#34;&gt;&lt;a href=&#34;#cb21-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb21-75&#34;&gt;&lt;a href=&#34;#cb21-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(ans.size());&lt;/span&gt;
&lt;span id=&#34;cb21-76&#34;&gt;&lt;a href=&#34;#cb21-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; x : ans) print(x, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb21-77&#34;&gt;&lt;a href=&#34;#cb21-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb21-78&#34;&gt;&lt;a href=&#34;#cb21-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb21-79&#34;&gt;&lt;a href=&#34;#cb21-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;e1---cats-on-the-upgrade-easy-version&#34;&gt;1625E1 - Cats on the Upgrade (easy version)&lt;/h3&gt;
&lt;p&gt;ç»™å‡ºå¦‚ä¸‹å®šä¹‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯åˆæ³•çš„æ‹¬å·åºåˆ—ï¼ˆRBSï¼‰å½“ä¸”ä»…å½“å…¶èƒ½é€šè¿‡æ¯æ¬¡å»æ‰ä¸€ä¸ª &lt;code&gt;.&lt;/code&gt; æˆ–è€…ä¸€ä¸ªè¿ç»­çš„ &lt;code&gt;()&lt;/code&gt; å˜æˆç©ºä¸²ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ª RBS è¢«ç§°ä¸ºâ€œç®€å•çš„â€å½“ä¸”ä»…å½“å…¶å¼€å¤´å’Œç»“å°¾å‡ä¸ä¸º&lt;code&gt;.&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åç»™å®šä¸€ä¸ªé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åªåŒ…å«å­—ç¬¦ &lt;code&gt;(&lt;/code&gt; å’Œ &lt;code&gt;)&lt;/code&gt; çš„å­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ã€‚è¦æ±‚å®Œæˆå¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(l, r\)&lt;/span&gt;ï¼Œä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(S_l\)&lt;/span&gt; ä¸º &lt;code&gt;(&lt;/code&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt; ä¸º &lt;code&gt;)&lt;/code&gt;ï¼Œå…¶ä¸­é—´çš„å­—ç¬¦å‡ä¸º &lt;code&gt;.&lt;/code&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\(S_l\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_r\)&lt;/span&gt; è®¾ä¸º &lt;code&gt;.&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(l, r\)&lt;/span&gt;ï¼Œè¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(S_{[l\cdots r]}\)&lt;/span&gt; æœ‰å¤šå°‘è¿ç»­å­æ®µä¸ºç®€å•çš„ RBSï¼Œä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(S_{[l\cdots r]}\)&lt;/span&gt; ä¸ºç®€å• RBSã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 3\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le q\le 3\times10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;easy version æ— ä¿®æ”¹æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;é™æ€é—®é¢˜çš„è¯æˆ‘ä»¬ä¸å¦¨è®° &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; ä¸ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾çš„ RBS çš„æ•°é‡ï¼Œè¿™ä¸ªä¸œè¥¿å¾ˆå¥½ DP å‡ºæ¥ï¼Œç„¶ååšä¸ªå‰ç¼€å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_i\)&lt;/span&gt;ï¼Œç„¶åä¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(S_r - S_{l}\)&lt;/span&gt; ç®—é‡äº†æŸäº›ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œå¤šç®— RBS çš„å·¦ç«¯ç‚¹åº”è¯¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([1, l - 1]\)&lt;/span&gt;ï¼Œå³ç«¯ç‚¹åº”è¯¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt;ï¼Œè¿™äº›ä¸œè¥¿éœ€è¦å‡æ‰ã€‚è€Œï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œè®¾è¿™æ ·çš„ RBS ä¸º &lt;span class=&#34;math inline&#34;&gt;\([i,j]\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\([i, l - 1]\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\([l, j]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([j + 1, r]\)&lt;/span&gt; éƒ½åº”è¯¥æ˜¯ RBSã€‚æ‰€ä»¥è¿™äº›å½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\([i,j]\)&lt;/span&gt; çš„ RBS çš„æ•°é‡åº”è¯¥æ˜¯å½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\([i, l -1]\)&lt;/span&gt; çš„ RBS çš„æ•°é‡ä¹˜ä¸Šå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\([l, j]\)&lt;/span&gt; çš„ RBS çš„æ•°é‡ï¼Œå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(p_{l - 1}\times (p_r - p_{l - 1})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e2---cats-on-the-upgrade-hard-version&#34;&gt;1625E2 - Cats on the Upgrade (hard version)&lt;/h3&gt;
&lt;p&gt;hard version å¸¦ä¸Šä¿®æ”¹æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢è¿™ç§åšæ³•çš„æ‰©å±•æ€§åº”è¯¥æ˜¯ä¸å¤ªå¥½çš„ã€‚è€ƒè™‘å»ºå‡ºæ‹¬å·æ ‘ï¼ˆæˆ–è€…è¯´ï¼Œæ£®æ—ï¼Œé‚£äº›ä¸åˆæ³•çš„å­—ç¬¦å°±ç›´æ¥æ‰”æ‰ï¼‰ï¼Œä¸€å¯¹å·¦å³æ‹¬å·æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç±»ä¼¼ä¸‹é¢è¿™å¼ å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s4.ax1x.com/2022/01/28/7zM1Ej.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ¯æ¬¡è¯¢é—®è‚¯å®šéƒ½æ˜¯è¯¢é—®æ ‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…è‹¥å¹²ä¸ªåŒå±‚ç›¸é‚»èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯æ¬¡æ“ä½œéƒ½æ˜¯åˆ é™¤å¶å­èŠ‚ç‚¹ã€‚æˆ‘ä»¬è€ƒè™‘å¦‚ä½•å¯¹äºä¸€ä¸ªèŠ‚ç‚¹è®¡ç®—&lt;strong&gt;åªé€‰å…¶å„¿å­èƒ½æ„æˆ RBS çš„æ•°é‡&lt;/strong&gt; &lt;span class=&#34;math inline&#34;&gt;\(g_u\)&lt;/span&gt;ï¼Œå‘ç°å…¶å°±æ˜¯é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ªå„¿å­ã€ä¸¤ä¸ªç›¸é‚»å„¿å­ã€ä¸‰ä¸ªç›¸é‚»å„¿å­â€¦â€¦ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå„¿å­çš„è¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g_u = x(x+1)/2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä»£è¡¨çš„ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; å†…çš„ RBS æ•°é‡çš„è¯ï¼Œå…¶æ˜æ˜¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_{uæ˜¯vç¥–å…ˆ} g_v + g_u\)&lt;/span&gt;ã€‚æ‰€ä»¥ï¼Œå¯¹äºä¸€æ¬¡è¯¢é—®çš„ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt;ï¼Œå…¶è‚¯å®šåŒ…å«äº†ä¸€ä¸ªåŒå±‚çš„ç‚¹é›† &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œå…¶ç­”æ¡ˆå°±å†åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(|A|\times (|A| + 1) / 2\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯¹äºä¸€æ¬¡ä¿®æ”¹æ“ä½œï¼Œæˆ‘ä»¬æ€è€ƒå…¶æ”¹å˜äº†ä»€ä¹ˆï¼šæ— éå°±æ˜¯çˆ¶äº²èŠ‚ç‚¹çš„å„¿å­æ•°é‡å‡å°ï¼Œæˆ‘ä»¬éœ€è¦ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹çš„ &lt;span class=&#34;math inline&#34;&gt;\(g_u\)&lt;/span&gt;ï¼Œæ”¯æŒå•ä¿®åŒºæŸ¥ï¼›ç„¶åç»´æŠ¤æ¯ä¸ªç‚¹çš„å„¿å­ï¼ŒåŒæ ·æ˜¯å•ä¿®åŒºæŸ¥ï¼Œç”¨æ ‘çŠ¶æ•°ç»„å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™åº”è¯¥æ˜¯æœ€ç®€æ´çš„åšæ³•äº†ã€‚å…·ä½“çœ‹ä»£ç ï¼Œç›®å‰ä¸º CF æœ€ä¼˜è§£ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb22&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb22-1&#34;&gt;&lt;a href=&#34;#cb22-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-2&#34;&gt;&lt;a href=&#34;#cb22-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-3&#34;&gt;&lt;a href=&#34;#cb22-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb22-4&#34;&gt;&lt;a href=&#34;#cb22-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, q;&lt;/span&gt;
&lt;span id=&#34;cb22-5&#34;&gt;&lt;a href=&#34;#cb22-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-6&#34;&gt;&lt;a href=&#34;#cb22-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; bit {&lt;/span&gt;
&lt;span id=&#34;cb22-7&#34;&gt;&lt;a href=&#34;#cb22-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;ll&amp;gt; s; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; sz;&lt;/span&gt;
&lt;span id=&#34;cb22-8&#34;&gt;&lt;a href=&#34;#cb22-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; build(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; SZ) {sz = SZ + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;, s.resize(sz); &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;}&lt;/span&gt;
&lt;span id=&#34;cb22-9&#34;&gt;&lt;a href=&#34;#cb22-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; add(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, ll v) {&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; x &amp;lt; sz; x += (x &amp;amp; -x)) s[x] += v; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;}&lt;/span&gt;
&lt;span id=&#34;cb22-10&#34;&gt;&lt;a href=&#34;#cb22-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x) {ll ret = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; x; x -= (x &amp;amp; -x)) ret += s[x]; &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;}&lt;/span&gt;
&lt;span id=&#34;cb22-11&#34;&gt;&lt;a href=&#34;#cb22-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} T, t[maxn];&lt;/span&gt;
&lt;span id=&#34;cb22-12&#34;&gt;&lt;a href=&#34;#cb22-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-13&#34;&gt;&lt;a href=&#34;#cb22-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; son[maxn], fa[maxn], bel[maxn], ord[maxn], size[maxn];&lt;/span&gt;
&lt;span id=&#34;cb22-14&#34;&gt;&lt;a href=&#34;#cb22-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb22-15&#34;&gt;&lt;a href=&#34;#cb22-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb22-16&#34;&gt;&lt;a href=&#34;#cb22-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, q);&lt;/span&gt;
&lt;span id=&#34;cb22-17&#34;&gt;&lt;a href=&#34;#cb22-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-18&#34;&gt;&lt;a href=&#34;#cb22-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, now = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-19&#34;&gt;&lt;a href=&#34;#cb22-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb22-20&#34;&gt;&lt;a href=&#34;#cb22-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s[i] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-21&#34;&gt;&lt;a href=&#34;#cb22-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ord[++cnt] = ++son[now];&lt;/span&gt;
&lt;span id=&#34;cb22-22&#34;&gt;&lt;a href=&#34;#cb22-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            fa[cnt] = now, bel[i] = cnt, now = cnt;&lt;/span&gt;
&lt;span id=&#34;cb22-23&#34;&gt;&lt;a href=&#34;#cb22-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now != &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-24&#34;&gt;&lt;a href=&#34;#cb22-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            bel[i] = now;&lt;/span&gt;
&lt;span id=&#34;cb22-25&#34;&gt;&lt;a href=&#34;#cb22-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            now = fa[now];&lt;/span&gt;
&lt;span id=&#34;cb22-26&#34;&gt;&lt;a href=&#34;#cb22-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb22-27&#34;&gt;&lt;a href=&#34;#cb22-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb22-28&#34;&gt;&lt;a href=&#34;#cb22-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    T.build(cnt);&lt;/span&gt;
&lt;span id=&#34;cb22-29&#34;&gt;&lt;a href=&#34;#cb22-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt) {&lt;/span&gt;
&lt;span id=&#34;cb22-30&#34;&gt;&lt;a href=&#34;#cb22-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        T.add(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * son[i] * (son[i] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-31&#34;&gt;&lt;a href=&#34;#cb22-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        t[i].build(son[i]);&lt;/span&gt;
&lt;span id=&#34;cb22-32&#34;&gt;&lt;a href=&#34;#cb22-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb22-33&#34;&gt;&lt;a href=&#34;#cb22-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, cnt, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) size[fa[i]] += (++size[i]);&lt;/span&gt;
&lt;span id=&#34;cb22-34&#34;&gt;&lt;a href=&#34;#cb22-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (q--) {&lt;/span&gt;
&lt;span id=&#34;cb22-35&#34;&gt;&lt;a href=&#34;#cb22-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; op, l, r; read(op, l, r);&lt;/span&gt;
&lt;span id=&#34;cb22-36&#34;&gt;&lt;a href=&#34;#cb22-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (op == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb22-37&#34;&gt;&lt;a href=&#34;#cb22-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = bel[l];&lt;/span&gt;
&lt;span id=&#34;cb22-38&#34;&gt;&lt;a href=&#34;#cb22-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            t[fa[now]].add(ord[now], &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-39&#34;&gt;&lt;a href=&#34;#cb22-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            T.add(fa[now], -son[fa[now]]--);&lt;/span&gt;
&lt;span id=&#34;cb22-40&#34;&gt;&lt;a href=&#34;#cb22-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb22-41&#34;&gt;&lt;a href=&#34;#cb22-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            l = bel[l], r = bel[r];&lt;/span&gt;
&lt;span id=&#34;cb22-42&#34;&gt;&lt;a href=&#34;#cb22-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll ans = T.query(r + size[r] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - T.query(l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-43&#34;&gt;&lt;a href=&#34;#cb22-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ll cnt = ord[r] - ord[l] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - t[fa[l]].query(ord[r]) + t[fa[l]].query(ord[l] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb22-44&#34;&gt;&lt;a href=&#34;#cb22-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans += cnt * (cnt + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-45&#34;&gt;&lt;a href=&#34;#cb22-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            print(ans);&lt;/span&gt;
&lt;span id=&#34;cb22-46&#34;&gt;&lt;a href=&#34;#cb22-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb22-47&#34;&gt;&lt;a href=&#34;#cb22-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb22-48&#34;&gt;&lt;a href=&#34;#cb22-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb22-49&#34;&gt;&lt;a href=&#34;#cb22-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-766-div.-2&#34;&gt;Codeforces Round #766 (Div. 2)&lt;/h2&gt;
&lt;p&gt;è¡¥å®Œäº†ï¼Œå¥½ï¼&lt;/p&gt;
&lt;h3 id=&#34;d---not-adding&#34;&gt;1627D - Not Adding&lt;/h3&gt;
&lt;p&gt;æ³¨æ„åˆ°æ‰€è°“çš„åŠ å…¥æ•°å­—çš„é¡ºåºå…¶å®æ— å…³ç´§è¦ï¼Œä¸ºäº†å°½å¯èƒ½å¤šçš„åŠ æ•°ï¼Œæˆ‘ä»¬ä»å¤§åˆ°å°æšä¸¾åŠ çš„è¿™ä¸ªæ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œç„¶åæšä¸¾å€æ•° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚æˆ‘ä»¬åªéœ€è¦ä¿è¯æ•°ç»„å†…æœ‰æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb23&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb23-1&#34;&gt;&lt;a href=&#34;#cb23-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;, N = &lt;span class=&#34;fl&#34;&gt;1e6&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-2&#34;&gt;&lt;a href=&#34;#cb23-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[maxn], n, maxx, ans;&lt;/span&gt;
&lt;span id=&#34;cb23-3&#34;&gt;&lt;a href=&#34;#cb23-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb23-4&#34;&gt;&lt;a href=&#34;#cb23-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; gcd(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; b ? gcd(b, a % b) : a;}&lt;/span&gt;
&lt;span id=&#34;cb23-5&#34;&gt;&lt;a href=&#34;#cb23-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb23-6&#34;&gt;&lt;a href=&#34;#cb23-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb23-7&#34;&gt;&lt;a href=&#34;#cb23-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb23-8&#34;&gt;&lt;a href=&#34;#cb23-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb23-9&#34;&gt;&lt;a href=&#34;#cb23-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x; read(x);&lt;/span&gt;
&lt;span id=&#34;cb23-10&#34;&gt;&lt;a href=&#34;#cb23-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vis[x] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-11&#34;&gt;&lt;a href=&#34;#cb23-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        chkmax(maxx, x);&lt;/span&gt;
&lt;span id=&#34;cb23-12&#34;&gt;&lt;a href=&#34;#cb23-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb23-13&#34;&gt;&lt;a href=&#34;#cb23-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, maxx, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb23-14&#34;&gt;&lt;a href=&#34;#cb23-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[i]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-15&#34;&gt;&lt;a href=&#34;#cb23-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, f = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-16&#34;&gt;&lt;a href=&#34;#cb23-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * i; j &amp;lt;= N; j += i) {&lt;/span&gt;
&lt;span id=&#34;cb23-17&#34;&gt;&lt;a href=&#34;#cb23-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[j]) {&lt;/span&gt;
&lt;span id=&#34;cb23-18&#34;&gt;&lt;a href=&#34;#cb23-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb23-19&#34;&gt;&lt;a href=&#34;#cb23-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) f = j / i;&lt;/span&gt;
&lt;span id=&#34;cb23-20&#34;&gt;&lt;a href=&#34;#cb23-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; f = gcd(f, j / i);&lt;/span&gt;
&lt;span id=&#34;cb23-21&#34;&gt;&lt;a href=&#34;#cb23-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb23-22&#34;&gt;&lt;a href=&#34;#cb23-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb23-23&#34;&gt;&lt;a href=&#34;#cb23-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; f == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) vis[i] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, ++ans;&lt;/span&gt;
&lt;span id=&#34;cb23-24&#34;&gt;&lt;a href=&#34;#cb23-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb23-25&#34;&gt;&lt;a href=&#34;#cb23-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(ans);&lt;/span&gt;
&lt;span id=&#34;cb23-26&#34;&gt;&lt;a href=&#34;#cb23-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb23-27&#34;&gt;&lt;a href=&#34;#cb23-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;e---not-escaping&#34;&gt;1627E - Not Escaping&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å±‚æ¥¼ï¼Œæ¯å±‚æ¥¼æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªæˆ¿é—´ï¼Œè¦æ±‚ä» &lt;span class=&#34;math inline&#34;&gt;\((1,1)\to(n,m)\)&lt;/span&gt;ã€‚èµ°æ³•æœ‰ä¸¤ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨åŒä¸€æ¥¼å±‚å¹³ç§»ï¼Œå¦‚ &lt;span class=&#34;math inline&#34;&gt;\((i, j_1)\to(i, j_2)\)&lt;/span&gt;ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x_i\cdot|j_2 - j_1|\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡æ¢¯å­ä» &lt;span class=&#34;math inline&#34;&gt;\((a_i,b_i)\to(c_i,d_i)\)&lt;/span&gt;ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-h_i\)&lt;/span&gt;ã€‚ä¿è¯æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;lt;c_i\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®æœ€å°ä»£ä»·æˆ–è€…è¾“å‡ºæ— è§£ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le n,m\le 10^5\)&lt;/span&gt;ï¼Œæ¢¯å­æ€»æ•° &lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le x_i,h_i\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šä¼šå‘ç°ï¼Œæœ‰ç”¨çš„ç‚¹ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(2k + 2\)&lt;/span&gt; ä¸ªï¼ˆèµ·ç‚¹ï¼Œç»ˆç‚¹å’Œæ¢¯å­çš„ç«¯ç‚¹ï¼‰ï¼Œå¹¶ä¸”æ¢¯å­éƒ½æ˜¯è‡ªä¸‹è€Œä¸Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬ä»ä¸‹å¾€ä¸Šä¸€å±‚ä¸€å±‚çš„ dpï¼Œç”¨å½“å‰å±‚çš„ dp å€¼æ›´æ–°å½“å‰å±‚ï¼Œç„¶åæœ‰æ¢¯å­çš„å°±å¾€ä¸Šæ›´æ–°ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb24&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb24-1&#34;&gt;&lt;a href=&#34;#cb24-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-2&#34;&gt;&lt;a href=&#34;#cb24-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pil = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, ll&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-3&#34;&gt;&lt;a href=&#34;#cb24-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-4&#34;&gt;&lt;a href=&#34;#cb24-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll INF = &lt;span class=&#34;bn&#34;&gt;0x3f3f3f3f3f3f3f3f&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-5&#34;&gt;&lt;a href=&#34;#cb24-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll x[maxn], dp[maxn];&lt;/span&gt;
&lt;span id=&#34;cb24-6&#34;&gt;&lt;a href=&#34;#cb24-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; ladder {&lt;/span&gt;
&lt;span id=&#34;cb24-7&#34;&gt;&lt;a href=&#34;#cb24-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, b, c, d, h;&lt;/span&gt;
&lt;span id=&#34;cb24-8&#34;&gt;&lt;a href=&#34;#cb24-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ladder() {}&lt;/span&gt;
&lt;span id=&#34;cb24-9&#34;&gt;&lt;a href=&#34;#cb24-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ladder(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _b, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _c, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _d, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _h) : a(_a), b(_b), c(_c), d(_d), h(_h) {}&lt;/span&gt;
&lt;span id=&#34;cb24-10&#34;&gt;&lt;a href=&#34;#cb24-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;};&lt;/span&gt;
&lt;span id=&#34;cb24-11&#34;&gt;&lt;a href=&#34;#cb24-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;ladder&amp;gt; lad[maxn];&lt;/span&gt;
&lt;span id=&#34;cb24-12&#34;&gt;&lt;a href=&#34;#cb24-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, ll&amp;gt; row[maxn];&lt;/span&gt;
&lt;span id=&#34;cb24-13&#34;&gt;&lt;a href=&#34;#cb24-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb24-14&#34;&gt;&lt;a href=&#34;#cb24-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve() {&lt;/span&gt;
&lt;span id=&#34;cb24-15&#34;&gt;&lt;a href=&#34;#cb24-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, k; read(n, m, k);&lt;/span&gt;
&lt;span id=&#34;cb24-16&#34;&gt;&lt;a href=&#34;#cb24-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(x[i]), vector&amp;lt;ladder&amp;gt;().swap(lad[i]), map&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, ll&amp;gt;().swap(row[i]);&lt;/span&gt;
&lt;span id=&#34;cb24-17&#34;&gt;&lt;a href=&#34;#cb24-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) {&lt;/span&gt;
&lt;span id=&#34;cb24-18&#34;&gt;&lt;a href=&#34;#cb24-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, b, c, d, h; read(a, b, c, d, h);&lt;/span&gt;
&lt;span id=&#34;cb24-19&#34;&gt;&lt;a href=&#34;#cb24-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        lad[a].push_back(ladder(a, b, c, d, h));&lt;/span&gt;
&lt;span id=&#34;cb24-20&#34;&gt;&lt;a href=&#34;#cb24-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        row[a][b] = INF, row[c][d] = INF;&lt;/span&gt;
&lt;span id=&#34;cb24-21&#34;&gt;&lt;a href=&#34;#cb24-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb24-22&#34;&gt;&lt;a href=&#34;#cb24-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    row[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, row[n][m] = INF;&lt;/span&gt;
&lt;span id=&#34;cb24-23&#34;&gt;&lt;a href=&#34;#cb24-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb24-24&#34;&gt;&lt;a href=&#34;#cb24-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (row[i].size() &amp;gt;= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb24-25&#34;&gt;&lt;a href=&#34;#cb24-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            pil last = *row[i].begin();&lt;/span&gt;
&lt;span id=&#34;cb24-26&#34;&gt;&lt;a href=&#34;#cb24-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; it = ++(row[i].begin()); it != row[i].end(); last = *it++)&lt;/span&gt;
&lt;span id=&#34;cb24-27&#34;&gt;&lt;a href=&#34;#cb24-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmin(it-&amp;gt;second, last.second + x[i] * myabs(last.first - it-&amp;gt;first));&lt;/span&gt;
&lt;span id=&#34;cb24-28&#34;&gt;&lt;a href=&#34;#cb24-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            last = *row[i].rbegin();&lt;/span&gt;
&lt;span id=&#34;cb24-29&#34;&gt;&lt;a href=&#34;#cb24-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; it = ++(row[i].rbegin()); it != row[i].rend(); last = *it++)&lt;/span&gt;
&lt;span id=&#34;cb24-30&#34;&gt;&lt;a href=&#34;#cb24-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmin(it-&amp;gt;second, last.second + x[i] * myabs(last.first - it-&amp;gt;first));&lt;/span&gt;
&lt;span id=&#34;cb24-31&#34;&gt;&lt;a href=&#34;#cb24-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb24-32&#34;&gt;&lt;a href=&#34;#cb24-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; ld : lad[i])&lt;/span&gt;
&lt;span id=&#34;cb24-33&#34;&gt;&lt;a href=&#34;#cb24-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (row[ld.a][ld.b] &amp;lt; INF) chkmin(row[ld.c][ld.d], row[ld.a][ld.b] - ld.h);&lt;/span&gt;
&lt;span id=&#34;cb24-34&#34;&gt;&lt;a href=&#34;#cb24-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb24-35&#34;&gt;&lt;a href=&#34;#cb24-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (row[n][m] &amp;lt; INF) print(row[n][m]);&lt;/span&gt;
&lt;span id=&#34;cb24-36&#34;&gt;&lt;a href=&#34;#cb24-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; print(&lt;span class=&#34;st&#34;&gt;&amp;quot;NO ESCAPE&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb24-37&#34;&gt;&lt;a href=&#34;#cb24-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb24-38&#34;&gt;&lt;a href=&#34;#cb24-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb24-39&#34;&gt;&lt;a href=&#34;#cb24-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb24-40&#34;&gt;&lt;a href=&#34;#cb24-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb24-41&#34;&gt;&lt;a href=&#34;#cb24-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) solve();&lt;/span&gt;
&lt;span id=&#34;cb24-42&#34;&gt;&lt;a href=&#34;#cb24-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb24-43&#34;&gt;&lt;a href=&#34;#cb24-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;f---not-splitting&#34;&gt;1627F - Not Splitting&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\times k\)&lt;/span&gt; çš„æ–¹æ ¼ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(500\)&lt;/span&gt; çš„å¶æ•°ï¼‰ï¼Œå¹¶ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^5\)&lt;/span&gt;ï¼‰å¯¹ç›¸é‚»ç‚¹å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((r_{i,1}, c_{i,1})\leftrightarrow (r_{i,2}, c_{i,2})\)&lt;/span&gt;ã€‚ç„¶åå°†è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\times k\)&lt;/span&gt; æ–¹æ ¼åˆ‡åˆ†ä¸ºå…¨ç­‰çš„ä¸¤å—ï¼Œä½¿å¾—æœ€å¤šçš„çº¦æŸæ¡ä»¶èƒ½è¢«æ»¡è¶³ï¼ˆå³ç‚¹å¯¹ä¸­çš„ä¸¤ä¸ªç‚¹åœ¨ä¸€å—ä¸Šï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://espresso.codeforces.com/0012ed54311c86b8968d6963561d937ba08d1737.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™ä¸ªåˆ‡åˆ†çš„ç—•è¿¹åº”è¯¥æ˜¯å…³äºæ–¹æ ¼ä¸­å¿ƒå¯¹ç§°çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨å°†å…¶çœ‹æˆä¸€ä¸ªæœ€çŸ­è·¯æ¨¡å‹ã€‚å°†å…¶è§†ä½œä¸€ä¸ªç½‘æ ¼å›¾ï¼Œè‹¥å…¶æœ‰é™åˆ¶æ¡ä»¶ï¼Œåˆ™è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå¦åˆ™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åå°±ä» &lt;span class=&#34;math inline&#34;&gt;\((k/2, k/2)\)&lt;/span&gt; å‡ºå‘ï¼Œä»¥å››å‘¨ä¸ºç»ˆç‚¹ï¼Œè·‘æœ€çŸ­è·¯å³å¯ã€‚éœ€è¦æ³¨æ„çš„çš„æ˜¯æˆ‘ä»¬è®¤ä¸ºç»è¿‡äº† &lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; å°±ç­‰åŒäºç»è¿‡äº† &lt;span class=&#34;math inline&#34;&gt;\((k - x, k - y)\)&lt;/span&gt;ï¼Œå› ä¸ºè¦å…³äºæ–¹æ ¼ä¸­å¿ƒå¯¹ç§°ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯ä¸€é“éå¸¸æœ‰æ„æ€çš„é¢˜ï¼&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb25&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb25-1&#34;&gt;&lt;a href=&#34;#cb25-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define mktp &lt;/span&gt;make_tuple&lt;/span&gt;
&lt;span id=&#34;cb25-2&#34;&gt;&lt;a href=&#34;#cb25-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb25-3&#34;&gt;&lt;a href=&#34;#cb25-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; node {&lt;/span&gt;
&lt;span id=&#34;cb25-4&#34;&gt;&lt;a href=&#34;#cb25-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, y, w;&lt;/span&gt;
&lt;span id=&#34;cb25-5&#34;&gt;&lt;a href=&#34;#cb25-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    node() {}&lt;/span&gt;
&lt;span id=&#34;cb25-6&#34;&gt;&lt;a href=&#34;#cb25-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    node(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; xx, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; yy, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ww) : x(xx), y(yy), w(ww) {}&lt;/span&gt;
&lt;span id=&#34;cb25-7&#34;&gt;&lt;a href=&#34;#cb25-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;&amp;lt;(node rhs) &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb25-8&#34;&gt;&lt;a href=&#34;#cb25-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; w &amp;gt; rhs.w;&lt;/span&gt;
&lt;span id=&#34;cb25-9&#34;&gt;&lt;a href=&#34;#cb25-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb25-10&#34;&gt;&lt;a href=&#34;#cb25-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;};&lt;/span&gt;
&lt;span id=&#34;cb25-11&#34;&gt;&lt;a href=&#34;#cb25-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb25-12&#34;&gt;&lt;a href=&#34;#cb25-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;tuple&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; mp;&lt;/span&gt;
&lt;span id=&#34;cb25-13&#34;&gt;&lt;a href=&#34;#cb25-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb25-14&#34;&gt;&lt;a href=&#34;#cb25-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fx[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb25-15&#34;&gt;&lt;a href=&#34;#cb25-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fy[] = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb25-16&#34;&gt;&lt;a href=&#34;#cb25-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; vis[&lt;span class=&#34;dv&#34;&gt;510&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;510&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb25-17&#34;&gt;&lt;a href=&#34;#cb25-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb25-18&#34;&gt;&lt;a href=&#34;#cb25-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb25-19&#34;&gt;&lt;a href=&#34;#cb25-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb25-20&#34;&gt;&lt;a href=&#34;#cb25-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb25-21&#34;&gt;&lt;a href=&#34;#cb25-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, k; read(n, k);&lt;/span&gt;
&lt;span id=&#34;cb25-22&#34;&gt;&lt;a href=&#34;#cb25-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        map&amp;lt;tuple&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;().swap(mp);&lt;/span&gt;
&lt;span id=&#34;cb25-23&#34;&gt;&lt;a href=&#34;#cb25-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, k) vis[i][j] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-24&#34;&gt;&lt;a href=&#34;#cb25-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb25-25&#34;&gt;&lt;a href=&#34;#cb25-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r1, c1, r2, c2; read(r1, c1, r2, c2);&lt;/span&gt;
&lt;span id=&#34;cb25-26&#34;&gt;&lt;a href=&#34;#cb25-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r1 &amp;gt; r2) myswap(r1, r2);&lt;/span&gt;
&lt;span id=&#34;cb25-27&#34;&gt;&lt;a href=&#34;#cb25-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (c1 &amp;gt; c2) myswap(c1, c2);&lt;/span&gt;
&lt;span id=&#34;cb25-28&#34;&gt;&lt;a href=&#34;#cb25-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r1 == r2) mp[mktp(r1 - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, c1, r1, c1)]++, mp[mktp(r1, c1, r1 - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, c1)]++;&lt;/span&gt;
&lt;span id=&#34;cb25-29&#34;&gt;&lt;a href=&#34;#cb25-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (c1 == c2) mp[mktp(r1, c1 - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r1, c1)]++, mp[mktp(r1, c1, r1, c1 - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)]++;&lt;/span&gt;
&lt;span id=&#34;cb25-30&#34;&gt;&lt;a href=&#34;#cb25-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb25-31&#34;&gt;&lt;a href=&#34;#cb25-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        priority_queue&amp;lt;node&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb25-32&#34;&gt;&lt;a href=&#34;#cb25-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        q.push(node(k &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb25-33&#34;&gt;&lt;a href=&#34;#cb25-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb25-34&#34;&gt;&lt;a href=&#34;#cb25-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; now = q.top(); q.pop();&lt;/span&gt;
&lt;span id=&#34;cb25-35&#34;&gt;&lt;a href=&#34;#cb25-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[now.x][now.y]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-36&#34;&gt;&lt;a href=&#34;#cb25-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            vis[now.x][now.y] = vis[k - now.x][k - now.y] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-37&#34;&gt;&lt;a href=&#34;#cb25-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!now.x || now.x == k || !now.y || now.y == k) {&lt;/span&gt;
&lt;span id=&#34;cb25-38&#34;&gt;&lt;a href=&#34;#cb25-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                print(n - now.w);&lt;/span&gt;
&lt;span id=&#34;cb25-39&#34;&gt;&lt;a href=&#34;#cb25-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-40&#34;&gt;&lt;a href=&#34;#cb25-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb25-41&#34;&gt;&lt;a href=&#34;#cb25-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(d, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb25-42&#34;&gt;&lt;a href=&#34;#cb25-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tx = now.x + fx[d], ty = now.y + fy[d];&lt;/span&gt;
&lt;span id=&#34;cb25-43&#34;&gt;&lt;a href=&#34;#cb25-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tx &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; || tx &amp;gt; k || ty &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; || ty &amp;gt; k) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-44&#34;&gt;&lt;a href=&#34;#cb25-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[tx][ty]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-45&#34;&gt;&lt;a href=&#34;#cb25-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                q.push(node(tx, ty, now.w + mp[mktp(now.x, now.y, tx, ty)] + mp[mktp(k - now.x, k - now.y, k - tx, k - ty)]));&lt;/span&gt;
&lt;span id=&#34;cb25-46&#34;&gt;&lt;a href=&#34;#cb25-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb25-47&#34;&gt;&lt;a href=&#34;#cb25-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb25-48&#34;&gt;&lt;a href=&#34;#cb25-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb25-49&#34;&gt;&lt;a href=&#34;#cb25-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb25-50&#34;&gt;&lt;a href=&#34;#cb25-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;educational-codeforces-round-121-rated-for-div.-2&#34;&gt;Educational Codeforces Round 121 (Rated for Div. 2)&lt;/h2&gt;
&lt;p&gt;VP on 22/07/15ï¼ŒA + B + C + Dã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---a-random-code-problem&#34;&gt;1626F - A Random Code Problem&lt;/h3&gt;
&lt;p&gt;ç»™å®šæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å’Œæ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb26&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb26-1&#34;&gt;&lt;a href=&#34;#cb26-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb26-2&#34;&gt;&lt;a href=&#34;#cb26-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt;= k; ++i) {&lt;/span&gt;
&lt;span id=&#34;cb26-3&#34;&gt;&lt;a href=&#34;#cb26-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; idx = rnd.next(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb26-4&#34;&gt;&lt;a href=&#34;#cb26-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans += a[idx];&lt;/span&gt;
&lt;span id=&#34;cb26-5&#34;&gt;&lt;a href=&#34;#cb26-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a[idx] -= (a[idx] % i);&lt;/span&gt;
&lt;span id=&#34;cb26-6&#34;&gt;&lt;a href=&#34;#cb26-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ±‚ &lt;code&gt;ans&lt;/code&gt; çš„æœŸæœ›ã€‚&lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æ»¡è¶³é€’æ¨å…³ç³» &lt;span class=&#34;math inline&#34;&gt;\(a_i = (xa_{i-1} + y)\bmod M\)&lt;/span&gt;ï¼Œè¾“å‡ºæœŸæœ›ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(n^k\)&lt;/span&gt; åå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡çš„ç»“æœã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 10^7; 1\le k\le 17\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(n^k\)&lt;/span&gt; æœ¬è´¨ä¸Šè¦æˆ‘ä»¬æ±‚çš„å°±æ˜¯æ¯ä¸ªä¸‹æ ‡åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; äº§ç”Ÿçš„è´¡çŒ®ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨å…ˆä¸è€ƒè™‘éš¾ä»¥å¤„ç†çš„ &lt;code&gt;a[idx] -= (a[idx] % i);&lt;/code&gt; è¿™å¥ï¼Œåªè€ƒè™‘éšæœºä¸‹æ ‡äº§ç”Ÿçš„è´¡çŒ®ï¼Œå‘ç°å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1}^k\sum\limits_{j=0}^{n-1}a_jn^{i-1}n^{k-i} = n^{k-1}k\sum a_i\)&lt;/span&gt;ï¼Œè€Œæ¯ä¸ªä½ç½®ä¼¼ä¹åˆæ˜¯å¯ä»¥ç‹¬ç«‹è€ƒè™‘çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(L = \operatorname{lcm}(1,2,\cdots, k)\)&lt;/span&gt;ï¼Œä¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æœ€å¤šå°±å‡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\lfloor a_i/L\rfloor L\)&lt;/span&gt;ï¼Œä¸å¦¨è®¾ &lt;span class=&#34;math inline&#34;&gt;\(a_i = x\times L + y\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(xL\)&lt;/span&gt; æ˜¯ä¸€å®šä¼šè¢«ç»Ÿè®¡å…¥ç­”æ¡ˆçš„ï¼Œæ‰€ä»¥æ ¹æ®ä¸Šé¢çš„æƒ³æ³•ï¼Œç­”æ¡ˆæ€»è¦åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(n^{k-1}kL\sum\lfloor a_i/L\rfloor\)&lt;/span&gt;ã€‚æ¥ä¸‹æ¥å°±å¤„ç† &lt;span class=&#34;math inline&#34;&gt;\(y = a_i\bmod L\)&lt;/span&gt; çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ dpï¼šè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¬¡ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°ï¼Œæ­¤æ—¶ä¸¤ç»´çš„å¤§å°åˆ†åˆ«æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt;ï¼Œæ˜¯è¶³å¤Ÿçš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i+1,j}\leftarrow f_{i+1, j} + (n-1)f_{i,j}\)&lt;/span&gt;ï¼Œå¯¹åº”çš„æ˜¯è¿™æ¬¡ä¸é€‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i+1, j - j\bmod i}\leftarrow f_{i+1, j - j \bmod i} + f_{i,j}\)&lt;/span&gt;ï¼Œå¯¹åº”çš„æ˜¯é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åŒæ—¶ï¼Œè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; äº§ç”Ÿçš„è´¡çŒ®ï¼Œä¸éš¾å‘ç°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n^{k-i}\times f_{i,j}\times j\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯¹åº”ç´¯åŠ ä¸€ä¸‹å³å¯ã€‚åˆå§‹æ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{1, j}\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-767-div.-1-and-div.-2&#34;&gt;Codeforces Round #767 (Div. 1 and Div. 2)&lt;/h2&gt;
&lt;p&gt;èƒ½è¡¥çš„è¡¥å®Œäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---xor-ÑĞµÑ‚ĞºĞ°&#34;&gt;1628C - XOR-ÑĞµÑ‚ĞºĞ°&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„è½¬åŒ–å°±æ˜¯æ¯ä¸ªæ ¼å­å†…çš„æ•°éƒ½è¦è´¡çŒ®å¥‡æ•°æ¬¡ï¼Œç„¶åè€ƒè™‘æ„é€ ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb27&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb27-1&#34;&gt;&lt;a href=&#34;#cb27-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-2&#34;&gt;&lt;a href=&#34;#cb27-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, vis[maxn][maxn], a[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb27-3&#34;&gt;&lt;a href=&#34;#cb27-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-4&#34;&gt;&lt;a href=&#34;#cb27-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fx[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; ,&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb27-5&#34;&gt;&lt;a href=&#34;#cb27-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fy[] = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; ,&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb27-6&#34;&gt;&lt;a href=&#34;#cb27-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb27-7&#34;&gt;&lt;a href=&#34;#cb27-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb27-8&#34;&gt;&lt;a href=&#34;#cb27-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb27-9&#34;&gt;&lt;a href=&#34;#cb27-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb27-10&#34;&gt;&lt;a href=&#34;#cb27-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n);&lt;/span&gt;
&lt;span id=&#34;cb27-11&#34;&gt;&lt;a href=&#34;#cb27-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-12&#34;&gt;&lt;a href=&#34;#cb27-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i][j]), vis[i][j] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-13&#34;&gt;&lt;a href=&#34;#cb27-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb27-14&#34;&gt;&lt;a href=&#34;#cb27-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j]) {&lt;/span&gt;
&lt;span id=&#34;cb27-15&#34;&gt;&lt;a href=&#34;#cb27-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans ^= a[i][j];&lt;/span&gt;
&lt;span id=&#34;cb27-16&#34;&gt;&lt;a href=&#34;#cb27-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; k &amp;lt; &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;; ++k) {&lt;/span&gt;
&lt;span id=&#34;cb27-17&#34;&gt;&lt;a href=&#34;#cb27-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tx = i + fx[k], ty = j + fy[k];&lt;/span&gt;
&lt;span id=&#34;cb27-18&#34;&gt;&lt;a href=&#34;#cb27-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tx &amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; || ty &amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; || tx &amp;gt; n || ty &amp;gt; n) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-19&#34;&gt;&lt;a href=&#34;#cb27-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    vis[tx][ty] ^= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-20&#34;&gt;&lt;a href=&#34;#cb27-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb27-21&#34;&gt;&lt;a href=&#34;#cb27-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb27-22&#34;&gt;&lt;a href=&#34;#cb27-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb27-23&#34;&gt;&lt;a href=&#34;#cb27-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(ans);&lt;/span&gt;
&lt;span id=&#34;cb27-24&#34;&gt;&lt;a href=&#34;#cb27-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb27-25&#34;&gt;&lt;a href=&#34;#cb27-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb27-26&#34;&gt;&lt;a href=&#34;#cb27-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢è¿™ä¸ªæ„é€ çš„æ–¹æ³•å°±æ˜¯ä»ç¬¬äºŒè¡Œå¼€å§‹éå†æ¯ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((i, j)\)&lt;/span&gt;ï¼Œå¦‚æœé‡åˆ° &lt;span class=&#34;math inline&#34;&gt;\((i - 1, j)\)&lt;/span&gt; åªè¢«è¦†ç›–äº†å¶æ•°æ¬¡ï¼Œåˆ™æˆ‘ä»¬è´ªå¿ƒçš„ç›´æ¥é€‰ä¸Š &lt;span class=&#34;math inline&#34;&gt;\((i, j)\)&lt;/span&gt; è®©å…¶è¢«è¦†ç›–å¥‡æ•°æ¬¡ã€‚å¯ä»¥å‘ç°åé¢çš„è¿‡ç¨‹ä¸­ &lt;span class=&#34;math inline&#34;&gt;\((i - 1, j)\)&lt;/span&gt; ä¸ä¼šå†è¢«è®¿é—®ã€‚äºæ˜¯è¿™ä¸ªæ„é€ æ–¹æ³•çš„æ­£ç¡®æ€§è¢«æˆåŠŸè¯´æ˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d1---game-on-sum-easy-version&#34;&gt;1628D1 - Game on Sum (Easy Version)&lt;/h3&gt;
&lt;p&gt;Alice å’Œ Bob åœ¨ç©ä¸€ä¸ªæ¸¸æˆï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; è½®ï¼Œä»–ä»¬è½®æµå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ“ä½œï¼Œå·²çŸ¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åˆå§‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚æ¯ä¸ªå›åˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Alice å…ˆé€‰æ‹©ä¸€ä¸ªå®æ•° &lt;span class=&#34;math inline&#34;&gt;\(t\in[0, k]\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Bob é€‰æ‹©è®© &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x+t\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(x-t\)&lt;/span&gt;ï¼Œä½†æ˜¯è‡³å°‘è¦æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªå›åˆé€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(x + t\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Alice æƒ³æœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼ŒBob æƒ³æœ€å°åŒ– &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚åŒæ–¹ç»é¡¶èªæ˜ï¼Œé—®æœ€ç»ˆçš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 7\)&lt;/span&gt; å–æ¨¡çš„ç»“æœã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le n\le 2000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 10^9 + 7\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶ Bob ä¼šé€‰æ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡å¢åŠ æ“ä½œã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{n, m}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; è½®æ¸¸æˆä¸­ Bob é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡å¢åŠ æ“ä½œåæœ€ç»ˆçš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ Alice å½“å‰é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œåˆ™ Bob è¦é€‰ä½¿å¾—åˆ†æ•°æœ€å°çš„ä¸€ç§æ–¹æ¡ˆï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(f_{n, m}= \min\{f_{n - 1, m} - t, f_{n - 1, m - 1} + t\}\)&lt;/span&gt;ã€‚è€Œ Alice ä¸ºäº†ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(f_{n, m}\)&lt;/span&gt; æœ€å¤§åŒ–ï¼Œæ•…å…¶ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ã€‚è¿™é‡Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_{n - 1, m} - t = f_{n - 1, m - 1} + t\)&lt;/span&gt; æ—¶ä¼šæœ€ä¼˜ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(t = \dfrac{f_{n - 1, m} - f_{n - 1, m - 1}}{2}\)&lt;/span&gt;ã€‚æ‰€ä»¥è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_{n, m} = \frac{f_{n - 1, m} + f_{n - 1, m - 1}}{2}
\]&lt;/span&gt; è¾¹ç•Œæ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{n, n} = nk\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{n, 0} = 0\)&lt;/span&gt;ã€‚ç›´æ¥ DP å³å¯ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d2---game-on-sum-hard-version&#34;&gt;1628D2 - Game on Sum (Hard Version)&lt;/h3&gt;
&lt;p&gt;å°†ä¸Šé¢çš„æ¡ä»¶æ”¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\le m\le n\le 10^6\)&lt;/span&gt;ï¼Œå‰©ä½™ä¸å˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢é‚£ä¸ªä¸œè¥¿ç»™äº†æˆ‘ä»¬ä»€ä¹ˆå¯ç¤ºå‘¢ï¼Ÿå¯ä»¥å•ç‹¬è€ƒè™‘æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_{i, i}\)&lt;/span&gt; äº§ç”Ÿçš„è´¡çŒ®ï¼è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(ik\)&lt;/span&gt; ä¸€çœ‹å°±æ˜¯ä¸€å±‚å±‚å¾€ä¸‹é¢åƒæ¨è¾‰ä¸‰è§’ä¸€æ ·æ‰©æ•£ã€‚éšä¾¿æ¨ä¸€ä¸‹å¼å­å°±å¯ä»¥å¾—åˆ° &lt;span class=&#34;math display&#34;&gt;\[
f_{n,m} = \sum_{i = 1}^m\frac{ki}{2^{n - i}}\binom{n - i - 1}{m - i}
\]&lt;/span&gt; &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; è§£å†³äº†ã€‚éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(n = m\)&lt;/span&gt; çš„æƒ…å†µï¼Œéœ€è¦ç›´æ¥è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(nk\)&lt;/span&gt;ï¼Œä»£ç å°±ä¸æ”¾äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-768-div.-1-and-div.-2&#34;&gt;Codeforces Round #768 (Div. 1 and Div. 2)&lt;/h2&gt;
&lt;p&gt;æ‰“å¾—å¥½åƒæœ‰ç‚¹å·®çš„ç¦»è°±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;b---range-and-partition&#34;&gt;1630B - Range and Partition&lt;/h3&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt; å’Œæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œè¦æ±‚æ‰¾åˆ°ä¸€ä¸ªé•¿åº¦æœ€çŸ­çš„åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([x, y]\)&lt;/span&gt; ä½¿å¾—èƒ½å°† &lt;span class=&#34;math inline&#34;&gt;\(\{a_i\}\)&lt;/span&gt; æ°å¥½åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µï¼Œä½¿å¾—æ¯ä¸€æ®µä¸­ &lt;span class=&#34;math inline&#34;&gt;\(\in[x,y]\)&lt;/span&gt; çš„å…ƒç´ æ•°é‡ä¸¥æ ¼å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(\notin [x,y]\)&lt;/span&gt; çš„å…ƒç´ æ•°é‡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1&amp;lt;k\le n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le a_i\le n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆè€ƒè™‘å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([x, y]\)&lt;/span&gt; æ˜¯å¦åˆæ³•ã€‚ä¸å¦¨è®¾ &lt;span class=&#34;math inline&#34;&gt;\(b_i = \begin{cases}1&amp;amp;a_i\in[x,y]\\-1&amp;amp;a_i\notin[x,y\end{cases}\)&lt;/span&gt;ï¼Œç„¶åæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(S = \sum_{i = 1}^n b_i\)&lt;/span&gt;ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(S \ge k\)&lt;/span&gt; æ—¶åˆæ³•ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºåˆ’åˆ†å‡ºçš„æ¯ä¸€æ®µå†…ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; çš„å’Œéƒ½è‡³å°‘ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ‰€ä»¥æ€»ä½“çš„ &lt;span class=&#34;math inline&#34;&gt;\(S\ge k\)&lt;/span&gt; æ—¶å°±æ˜¯åˆæ³•çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªåŒºé—´æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡äºŒåˆ†æˆ–è€…åŒæŒ‡é’ˆæ±‚å‡ºæ¥ï¼Œç„¶åéšä¾¿æ„é€ ä¸€ä¸‹åˆ†æ®µæ–¹å¼å°±æœ‰äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---paint-the-middle&#34;&gt;1630C - Paint the Middle&lt;/h3&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œä¸€å¼€å§‹ &lt;span class=&#34;math inline&#34;&gt;\(c_i = 0\)&lt;/span&gt;ã€‚å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(1\le i &amp;lt; j &amp;lt; k\le n\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(c_i = c_j = c_k = 0\land a_i = a_k\)&lt;/span&gt;ï¼Œç„¶å &lt;span class=&#34;math inline&#34;&gt;\(c_j:=1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®è‹¥å¹²æ¬¡æ“ä½œä¹‹åæœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(\sum_{i = 1}^nc_i\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(3\le n\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥åšæ³•æ¥è‡ª&lt;a href=&#34;https://codeforces.com/blog/entry/99384?#comment-881614&#34;&gt;è¯„è®ºåŒº&lt;/a&gt;ã€‚DPï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸ºåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(f_1 = 0\)&lt;/span&gt;ã€‚æœ‰å¦‚ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ç§è½¬ç§»åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; çš„åŠæ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; å‡ºç°è¿‡ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(j &amp;lt; i\)&lt;/span&gt;ï¼‰ï¼Œè€ƒè™‘å°† &lt;span class=&#34;math inline&#34;&gt;\((j, i)\)&lt;/span&gt; å…¨éƒ¨æ¶‚è‰²ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_i = f_j + (i - j - 1)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_k\)&lt;/span&gt; å‡ºç°è¿‡ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(k &amp;lt; j &amp;lt; i\)&lt;/span&gt;ï¼‰ï¼Œè€ƒè™‘å– &lt;span class=&#34;math inline&#34;&gt;\(f_j\)&lt;/span&gt; çš„æœ€ä¼˜è§£ä½†æ˜¯ç•™ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(c_k\)&lt;/span&gt; ä¸æ¶‚ï¼Œç„¶åå†æ¶‚ä¸Š &lt;span class=&#34;math inline&#34;&gt;\([j, i)\)&lt;/span&gt;ï¼ŒåŒæ ·æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_i = f_j + i - j - 1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç›´æ¥ç»§æ‰¿ &lt;span class=&#34;math inline&#34;&gt;\(f_{i - 1}\)&lt;/span&gt;ï¼Œå†™è§„èŒƒä¸€ç‚¹å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_i = f_{i - 1} + (i - (i - 1) - 1)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯è‹¥æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm {first}(a_i)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ç¬¬ä¸€æ¬¡å‡ºç°æ—¶çš„ä¸‹æ ‡ï¼Œåˆ™è½¬ç§»æ–¹ç¨‹å°±æœ‰äº†ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_i = \max_{\mathrm{first}(a_i)\le j &amp;lt; i}\{f_{j} - j \} + i - 1
\]&lt;/span&gt; æ­¤æ—¶è¿™ä¸ªåšæ³•æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚æ”¹å†™è½¬ç§»æ–¹ç¨‹ï¼š &lt;span class=&#34;math display&#34;&gt;\[
f_i - i = \max_{\mathrm{first}(a_i)\le j &amp;lt; i\lor j = i - 1}\{f_{j} - j \} - 1
\]&lt;/span&gt; ä¸éš¾å‘ç°è¿™å¯ä»¥æ‹¿ä¸€ä¸ªç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i - i\)&lt;/span&gt; çš„æœ€å¤§å€¼çš„çº¿æ®µæ ‘æ¥ä¼˜åŒ–ï¼Œäºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚ä»£ç å¤ªå¼±æ™ºä¸æ”¾äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-769-div.-2&#34;&gt;Codeforces Round #769 (Div. 2)&lt;/h2&gt;
&lt;p&gt;æ‰“çš„å¾ˆå·®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---new-year-concert&#34;&gt;1632D - New Year Concert&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ­£æ•´æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æ­£æ•´æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f(b_1,b_2,\cdots,b_k)\)&lt;/span&gt; ä¸ºä½¿å¾—å¯¹äºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\leq l\le r\le k\)&lt;/span&gt;ï¼Œéƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\{b_l,b_{l+1},\dots,b_r\}\neq r-l+1\)&lt;/span&gt; çš„æœ€å°‘æ“ä½œæ¬¡æ•°ï¼Œå…¶ä¸­ä¸€æ¬¡æ“ä½œå¯ä»¥å°†æ•°ç»„ä¸­çš„ä¸€ä¸ªæ•°æ”¹ä¸ºä»»æ„æ­£æ•´æ•°ã€‚ç°åœ¨ï¼Œè¯·æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f(a_1),f(a_1,a_2),\cdots,f(a_1,a_2,\cdots,a_n)\)&lt;/span&gt; çš„å€¼ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le a_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸€ä¸ªä¸ªæ¥å¤„ç†ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([1, i]\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œè‹¥ä¸å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\gcd\{a_l, \cdots, a_i\} = i - l + 1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_i = f_{i - 1}\)&lt;/span&gt;ï¼Œå¦åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_i = f_{i - 1} + 1\)&lt;/span&gt;ï¼Œå¹¶ä¸”éœ€è¦ä¿®æ”¹ &lt;span class=&#34;math inline&#34;&gt;\(a_l\)&lt;/span&gt; ä¸ºä¸€å¤§è´¨æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æŸ¥æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt;ï¼Œæ ¹æ®åç¼€ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; çš„å•è°ƒä¸å¢æ€§ï¼Œä¸”ä¸åŒåç¼€ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt; åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(\log)\)&lt;/span&gt; ç§ï¼Œæ‰€ä»¥å¯ä»¥äºŒåˆ†ã€‚è¿™é‡Œä½¿ç”¨ ST è¡¨æ¥æŸ¥è¯¢åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb28&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb28-1&#34;&gt;&lt;a href=&#34;#cb28-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-2&#34;&gt;&lt;a href=&#34;#cb28-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, a[maxn], f[maxn], st[&lt;span class=&#34;dv&#34;&gt;21&lt;/span&gt;][maxn], lg[maxn];&lt;/span&gt;
&lt;span id=&#34;cb28-3&#34;&gt;&lt;a href=&#34;#cb28-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-4&#34;&gt;&lt;a href=&#34;#cb28-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; gcd(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; b ? gcd(b, a % b) : a;}&lt;/span&gt;
&lt;span id=&#34;cb28-5&#34;&gt;&lt;a href=&#34;#cb28-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-6&#34;&gt;&lt;a href=&#34;#cb28-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r) {&lt;/span&gt;
&lt;span id=&#34;cb28-7&#34;&gt;&lt;a href=&#34;#cb28-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; len = lg[r - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb28-8&#34;&gt;&lt;a href=&#34;#cb28-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; gcd(st[len][l], st[len][r - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; len) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb28-9&#34;&gt;&lt;a href=&#34;#cb28-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb28-10&#34;&gt;&lt;a href=&#34;#cb28-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb28-11&#34;&gt;&lt;a href=&#34;#cb28-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb28-12&#34;&gt;&lt;a href=&#34;#cb28-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n);&lt;/span&gt;
&lt;span id=&#34;cb28-13&#34;&gt;&lt;a href=&#34;#cb28-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]), lg[i] = i &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; ? lg[i &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, st[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i] = a[i];&lt;/span&gt;
&lt;span id=&#34;cb28-14&#34;&gt;&lt;a href=&#34;#cb28-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, lg[n]) FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; j)) st[j][i] = gcd(st[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i], st[j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i + (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; (j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))]);&lt;/span&gt;
&lt;span id=&#34;cb28-15&#34;&gt;&lt;a href=&#34;#cb28-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb28-16&#34;&gt;&lt;a href=&#34;#cb28-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = f[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb28-17&#34;&gt;&lt;a href=&#34;#cb28-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = i; j &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; ) {&lt;/span&gt;
&lt;span id=&#34;cb28-18&#34;&gt;&lt;a href=&#34;#cb28-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; g = query(j, i), now = j;&lt;/span&gt;
&lt;span id=&#34;cb28-19&#34;&gt;&lt;a href=&#34;#cb28-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DEC(k, lg[n], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (j &amp;gt; (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; k) &amp;amp;&amp;amp; query(j - (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; k), i) == g)&lt;/span&gt;
&lt;span id=&#34;cb28-20&#34;&gt;&lt;a href=&#34;#cb28-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                j -= (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; k);&lt;/span&gt;
&lt;span id=&#34;cb28-21&#34;&gt;&lt;a href=&#34;#cb28-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (g &amp;lt;= i - j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; g &amp;gt;= i - now + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb28-22&#34;&gt;&lt;a href=&#34;#cb28-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                f[i] = f[i - g] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-23&#34;&gt;&lt;a href=&#34;#cb28-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-24&#34;&gt;&lt;a href=&#34;#cb28-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb28-25&#34;&gt;&lt;a href=&#34;#cb28-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            --j;&lt;/span&gt;
&lt;span id=&#34;cb28-26&#34;&gt;&lt;a href=&#34;#cb28-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb28-27&#34;&gt;&lt;a href=&#34;#cb28-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(f[i], &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb28-28&#34;&gt;&lt;a href=&#34;#cb28-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb28-29&#34;&gt;&lt;a href=&#34;#cb28-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb28-30&#34;&gt;&lt;a href=&#34;#cb28-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;e---distance-tree&#34;&gt;1632E - Distance Tree&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯æ¡è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå®šä¹‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(d(v)\)&lt;/span&gt; ä¸ºèŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„è·ç¦»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; ä¸ºåœ¨ä»»æ„ä¸¤ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a, b\)&lt;/span&gt; é—´æ·»åŠ ä¸€æ¡æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„è¾¹åï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\max_{1\le v\le n}\{d(v)\}\)&lt;/span&gt; çš„æœ€å°å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\forall x\in[1, n]\)&lt;/span&gt;ï¼Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt;ã€‚&lt;del&gt;Easy ver. &lt;span class=&#34;math inline&#34;&gt;\(2\le n,\sum n\le 3000\)&lt;/span&gt;â€‹&lt;/del&gt;ã€‚Hard ver. &lt;span class=&#34;math inline&#34;&gt;\(2\le n,\sum n\le 3\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ç®€å•è§‚å¯Ÿå¯ä»¥å‘ç°åŠ çš„è¿™æ¡è¾¹çš„ä¸€ä¸ªç«¯ç‚¹ä¸€å®šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ç‚¹ï¼Œå¯ä»¥åè¯ã€‚æ¥ä¸‹æ¥é’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åä¼šå‘ç°æ­£ç€åšä¼¼ä¹æœ‰ç‚¹éš¾æã€‚ä¸å¦¨æ€è€ƒä¸€ä¸‹å¦‚æœç»™å®šäº†ä¸€ä¸ªè·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; ç„¶ååæ¨è¾¹æƒ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„èŒƒå›´ï¼Œé¦–å…ˆå‘ç°è¿è¾¹ä¸€å®šè¿æ·±åº¦å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; çš„è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œè®¾è¿™äº›ç‚¹æ„æˆçš„ç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(K(y)\)&lt;/span&gt;ï¼Œåˆ™è€ƒè™‘ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; è¿å“ªä¸ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; èƒ½å¤Ÿä½¿å¾—æœ€å¤§çš„è·ç¦»å°½é‡å°ã€‚å‘ç°è¿ &lt;span class=&#34;math inline&#34;&gt;\(K(y)\)&lt;/span&gt; çš„ç›´å¾„ä¸­ç‚¹æ˜¯æœ€ä¼˜çš„ï¼Œå› ä¸ºéœ€è¦æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(x + \operatorname{dis}(v, u)\le y\)&lt;/span&gt;ã€‚è€Œ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{dis}(v, u)\)&lt;/span&gt; çš„æœ€å¤§å€¼åœ¨å½“ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ä¸ºç›´å¾„ä¸­ç‚¹æ—¶å–åˆ°æœ€å°ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(\lceil \mathrm{diameter} / 2 \rceil\)&lt;/span&gt;ï¼Œä¸å¦¨è®¾å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(y)\)&lt;/span&gt;ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„æ ‘å½¢ dp æ¥æ±‚å‡ºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(f(y)\)&lt;/span&gt;ï¼Œç„¶åç”±äº &lt;span class=&#34;math inline&#34;&gt;\(f(y)\)&lt;/span&gt; éš &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; çš„å¢å¤§è€Œå•è°ƒä¸å¢ï¼Œæ‰€ä»¥å¯ä»¥åŒæŒ‡é’ˆ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; æ±‚å‡ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;DP çš„æµç¨‹å¦‚ä¸‹ï¼šå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæ‰¾åˆ°ä¸¤ä¸ªæ·±åº¦æœ€å¤§çš„å„¿å­ï¼ˆå³é•¿é“¾ï¼‰ï¼Œè®¾ä¸¤ä¸ªé“¾åº•çš„æ·±åº¦åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(a\ge b\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f(b - 1)\)&lt;/span&gt; å°±å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(a + b - 2d_u\)&lt;/span&gt; æ¥æ›´æ–°äº†ï¼Œä»£ç ä¸­å†™çš„ä¸å¤ªä¸€æ ·ã€‚ç„¶åå†å¯¹æ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ¥ä¸€ä¸ªåç¼€æœ€å¤§å€¼å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb29&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb29-1&#34;&gt;&lt;a href=&#34;#cb29-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-2&#34;&gt;&lt;a href=&#34;#cb29-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb29-3&#34;&gt;&lt;a href=&#34;#cb29-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, f[maxn];&lt;/span&gt;
&lt;span id=&#34;cb29-4&#34;&gt;&lt;a href=&#34;#cb29-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb29-5&#34;&gt;&lt;a href=&#34;#cb29-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; d) {&lt;/span&gt;
&lt;span id=&#34;cb29-6&#34;&gt;&lt;a href=&#34;#cb29-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, b = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-7&#34;&gt;&lt;a href=&#34;#cb29-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; v : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb29-8&#34;&gt;&lt;a href=&#34;#cb29-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v == fa) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-9&#34;&gt;&lt;a href=&#34;#cb29-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c = dfs(v, u, d + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-10&#34;&gt;&lt;a href=&#34;#cb29-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (c &amp;gt; a) b = a, a = c;&lt;/span&gt;
&lt;span id=&#34;cb29-11&#34;&gt;&lt;a href=&#34;#cb29-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; chkmax(b, c);&lt;/span&gt;
&lt;span id=&#34;cb29-12&#34;&gt;&lt;a href=&#34;#cb29-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb29-13&#34;&gt;&lt;a href=&#34;#cb29-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (b + d) chkmax(f[b + d - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], (a + b + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb29-14&#34;&gt;&lt;a href=&#34;#cb29-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a;&lt;/span&gt;
&lt;span id=&#34;cb29-15&#34;&gt;&lt;a href=&#34;#cb29-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb29-16&#34;&gt;&lt;a href=&#34;#cb29-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb29-17&#34;&gt;&lt;a href=&#34;#cb29-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb29-18&#34;&gt;&lt;a href=&#34;#cb29-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb29-19&#34;&gt;&lt;a href=&#34;#cb29-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb29-20&#34;&gt;&lt;a href=&#34;#cb29-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n);&lt;/span&gt;
&lt;span id=&#34;cb29-21&#34;&gt;&lt;a href=&#34;#cb29-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;().swap(G[i]), f[i] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-22&#34;&gt;&lt;a href=&#34;#cb29-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb29-23&#34;&gt;&lt;a href=&#34;#cb29-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; read(u, v);&lt;/span&gt;
&lt;span id=&#34;cb29-24&#34;&gt;&lt;a href=&#34;#cb29-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb29-25&#34;&gt;&lt;a href=&#34;#cb29-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb29-26&#34;&gt;&lt;a href=&#34;#cb29-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim = dfs(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb29-27&#34;&gt;&lt;a href=&#34;#cb29-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, n - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) chkmax(f[i], f[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb29-28&#34;&gt;&lt;a href=&#34;#cb29-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-29&#34;&gt;&lt;a href=&#34;#cb29-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb29-30&#34;&gt;&lt;a href=&#34;#cb29-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (i + f[ans] &amp;gt; ans) ++ans;&lt;/span&gt;
&lt;span id=&#34;cb29-31&#34;&gt;&lt;a href=&#34;#cb29-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            print(min(ans, lim), &lt;span class=&#34;st&#34;&gt;&amp;quot; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;[i == n]);&lt;/span&gt;
&lt;span id=&#34;cb29-32&#34;&gt;&lt;a href=&#34;#cb29-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb29-33&#34;&gt;&lt;a href=&#34;#cb29-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb29-34&#34;&gt;&lt;a href=&#34;#cb29-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb29-35&#34;&gt;&lt;a href=&#34;#cb29-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;educational-codeforces-round-122-rated-for-div.-2&#34;&gt;Educational Codeforces Round 122 (Rated for Div. 2)&lt;/h2&gt;
&lt;p&gt;VP on 22/07/15ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---spanning-tree-queries&#34;&gt;1633E - Spanning Tree Queries&lt;/h3&gt;
&lt;p&gt;VP æ—¶æƒ³åˆ°æ­£è§£äº†ï¼Œä½†æ˜¯æ²¡å†™å‡ºæ¥ã€‚è¯´å‡ ä¸ªç»†èŠ‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†ç•Œç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{w_i+w_j}{2}\)&lt;/span&gt;ï¼Œé¿å…å°æ•°ç‚¹å‡ºé—®é¢˜ï¼Œè€ƒè™‘ç›´æ¥ &lt;span class=&#34;math inline&#34;&gt;\(w_i\leftarrow 2w_i\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº†ä¿è¯é€‰çš„å°½å¯èƒ½å¤šå‡å‡½æ•°é˜²æ­¢å‡ºé”…ï¼ŒKruskal ç»™è¾¹æ’åºçš„æ—¶å€™ç¬¬äºŒå…³é”®å­—æ˜¯åŸè¾¹æƒé™åºã€‚&lt;/li&gt;
&lt;li&gt;æœ€åä½¿ç”¨ &lt;code&gt;upper_bound&lt;/code&gt; æŸ¥æ‰¾å¯¹åº”çš„åˆ†ç•Œç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;åŒæ—¶ &lt;span class=&#34;math inline&#34;&gt;\(w_i\)&lt;/span&gt; ä½œä¸ºè½¬æŠ˜ç‚¹æœ¬èº«ä¹Ÿè¦åŠ è¿›å»ï¼Œæ‰€æœ‰åˆ†ç•Œç‚¹è¦å»é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;f---perfect-matching&#34;&gt;1633F - Perfect Matching&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šäº¤äº’é¢˜ï¼Œåˆå§‹æ ¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼ŒåŠ¨æ€æ·»åŠ å¶å­ï¼Œé—®æœ‰æ— å®Œç¾åŒ¹é…ï¼Œä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; æ¬¡è¦æ±‚æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ ‘ä¸å˜çš„è¯ï¼ŒåŒ¹é…ä¸€å®šæ˜¯ä»å¶å­å¼€å§‹åŒ¹é…çš„ï¼Œç„¶åéš”ä¸€æ¡é€‰ä¸€æ¡ã€‚é‚£ä¹ˆç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; è¿æ¥å…¶çˆ¶äº²çš„è¾¹æœ‰æ²¡æœ‰è¢«é€‰ï¼Œä½¿ç”¨æ ‘å‰– + çº¿æ®µæ ‘ç»´æŠ¤ï¼Œæä¸€ä¸ªå–å + åŒºé—´å’Œå³å¯ï¼Œæœ€åçœ‹ä¸‹è¾¹çš„æ•°é‡æ˜¯ä¸æ˜¯ç‚¹æ•° &lt;span class=&#34;math inline&#34;&gt;\(/2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€Œè¿™ä¸ªé¢˜åŠ¨æ€æ·»åŠ å¶å­ï¼Œæ‰€ä»¥ç›´æ¥åšå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-global-round-19&#34;&gt;Codeforces Global Round 19&lt;/h2&gt;
&lt;h3 id=&#34;d---yet-another-minimization-problem&#34;&gt;1637D - Yet Another Minimization Problem&lt;/h3&gt;
&lt;p&gt;å€¼åŸŸå¾ˆå°ï¼Œæ‹†åˆ†è´¡çŒ®ä¹‹åå‘ç°å¯ä»¥å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, s_1}\)&lt;/span&gt;ï¼Œç„¶åå°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; dp äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---best-pair&#34;&gt;1637E - Best Pair&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆè¿™é¢˜æœ‰ä¸€ä¸ªéå¸¸å…³é”®çš„æ€§è´¨å°±æ˜¯ï¼Œ&lt;strong&gt;ä¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(cnt_i\)&lt;/span&gt; åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt; ç§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(cnt_x\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_y\le cnt_x\)&lt;/span&gt;ï¼Œè¿™æ ·å­å¤æ‚åº¦å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ï¼Œä»å¤§åˆ°å°æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å½¢æˆ bad pair çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼ˆå¯ä»¥ç”¨ &lt;code&gt;set&lt;/code&gt; ç»´æŠ¤ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt;ï¼‰ï¼Œè¿™æ ·çš„å¤æ‚åº¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---towers&#34;&gt;1637F - Towers&lt;/h3&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹çš„é«˜åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(h_i\)&lt;/span&gt;ã€‚å¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ä¸Šå»ºä»»æ„å¤šä¸ªå¡”ï¼Œå¯¹äºæ¯ä¸ªå¡”å¯ä»¥æŒ‡å®šå…¶èƒ½é‡ &lt;span class=&#34;math inline&#34;&gt;\(e\)&lt;/span&gt; å’Œå…¶æ‰€åœ¨ç‚¹çš„ç¼–å·ã€‚å»ºç«‹èƒ½é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(e\)&lt;/span&gt; çš„å¡”æ¶ˆè€— &lt;span class=&#34;math inline&#34;&gt;\(e\)&lt;/span&gt; æšé‡‘å¸ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ¥æ”¶åˆ°ä¿¡å·å½“ä¸”ä»…å½“å­˜åœ¨ä¿¡å·å¡”åœ¨ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å’Œç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼ˆå…è®¸ &lt;span class=&#34;math inline&#34;&gt;\(x = u\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(x = v\)&lt;/span&gt;ï¼Œä½†æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(u\ne v\)&lt;/span&gt;ï¼‰ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\min(e_u, e_v)\ge h_x\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åœ¨é“¾ &lt;span class=&#34;math inline&#34;&gt;\((u, v)\)&lt;/span&gt; ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;æ±‚ä¸€ä¸ªè®©æ‰€æœ‰ç‚¹æ¥æ”¶åˆ°ä¿¡å·çš„æœ€å°ä»£ä»·ã€‚&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le h_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒç‰›é€¼çš„è´ªå¿ƒã€‚ç»è¿‡è§‚å¯Ÿå¯çŸ¥åªæœ‰å¶å­èŠ‚ç‚¹æ”¾ä¿¡å·å¡”æ˜¯æœ€ä¼˜çš„ï¼Œå¦åˆ™ä¸€å®šå¯ä»¥è°ƒæ•´åˆ°åªæ”¾å¶å­èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; å€¼æœ€å¤§çš„ä¸ºæ ¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©ä¸¤ä¸ªå¶å­ &lt;span class=&#34;math inline&#34;&gt;\(x, y\)&lt;/span&gt; æ”¾ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(h_{\max}\)&lt;/span&gt; çš„å¡”ï¼Œç„¶å &lt;span class=&#34;math inline&#34;&gt;\(x, y\)&lt;/span&gt; é“¾ä¸Šæ‰€æœ‰çš„ç‚¹éƒ½ä¼šè¢«è¦†ç›–æ‰ã€‚äºæ˜¯ï¼Œå‰©ä¸‹çš„æ‰€æœ‰ç‚¹éƒ½åªéœ€è¦æœ‰æŸä¸ªå­æ ‘çš„ä¿¡å·å¡”å¤§äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(h_u\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è´ªå¿ƒï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†… &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; çš„æœ€å¤§å€¼ï¼Œç„¶åå¯¹äºå¶å­èŠ‚ç‚¹ï¼Œç­”æ¡ˆåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(h_u\)&lt;/span&gt;ï¼Œå¯¹äºéå¶å­èŠ‚ç‚¹ï¼Œè‹¥å…¶ä¸æ˜¯æ ¹ï¼Œç­”æ¡ˆåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(\max(0, h_u - \max_{v\in son(u)} f_v)\)&lt;/span&gt;ï¼Œè‹¥å…¶æ˜¯æ ¹ï¼Œç­”æ¡ˆåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(2h_u\)&lt;/span&gt; å‡å»å­æ ‘å†…æœ€å¤§çš„ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; å€¼ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ï¼Œå¾ˆä¼˜ç§€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-771-div.-2&#34;&gt;Codeforces Round #771 (Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;d---big-brush&#34;&gt;1638D - Big Brush&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæŸ“äº†è‰²çš„ç½‘æ ¼ï¼Œè¦æ±‚æ„é€ æ–¹æ¡ˆä»ç©ºç™½æŸ“æˆè¿™æ ·ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ¬¡å¯ä»¥æ¶‚ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(2\times 2\)&lt;/span&gt;ï¼Œå¯ä»¥è¦†ç›–ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n,m\le 1000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ—¶å…‰å€’æµï¼Œåˆ«äººæ¶‚è‰²æˆ‘ä»¬åˆ®åˆ®ä¹ã€‚æˆ‘ä»¬å¯ä»¥ä»è‹¥å¹²ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(2\times 2\)&lt;/span&gt; ä¸ºèµ·ç‚¹æ¥è¿›è¡Œæ“ä½œï¼Œæ²¡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2\times 2\)&lt;/span&gt; å°±è¯´æ˜æ— è§£ã€‚ç„¶åå°± bfs å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---colorful-operations&#34;&gt;1638E - Colorful Operations&lt;/h3&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ—ï¼Œåˆå§‹æ—¶æ‰€æœ‰å…ƒç´ çš„å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ï¼Œé¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚ä½ éœ€è¦å®ç°ä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Color l r c&lt;/code&gt; ï¼šæŠŠ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; è¿™æ®µçš„å…ƒç´ é¢œè‰²æ”¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Add c x&lt;/code&gt;ï¼šæŠŠæ‰€æœ‰é¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„å…ƒç´ å€¼éƒ½åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Query i&lt;/code&gt;ï¼šè¾“å‡ºå…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¢œè‰²æ®µå‡æ‘Šå‚»é€¼é¢˜ï¼ŒæŠ€ä¸å¦‚äººç”˜æ‹œä¸‹é£ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¯¹äºä¿®æ”¹åŒç§é¢œè‰²çš„æ“ä½œï¼Œå¯¹å…¶ç»´æŠ¤ä¸€ä¸ªå…¨å±€åŠ æ ‡è®°ã€‚å¹¶ç”¨ä¸€ä¸ªçº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹æ‰€æœ‰çš„å…ƒç´ çš„å€¼ï¼Œè¾“å‡ºçš„æ—¶å€™å°±è¾“å‡ºå•ç‚¹ä¿®æ”¹ + tag å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œä¿®æ”¹é¢œè‰²çš„æ“ä½œå°±ç¡¬é€’å½’ï¼Œæ‰¾åˆ°ä¸€æ®µç›¸åŒé¢œè‰²çš„æ®µä¹‹ååŠ ä¸ŠåŸæ¥çš„ tag å†å‡å»æ–°çš„ tagã€‚ç”±äºä¸€æ¬¡æŸ“è‰²æ“ä½œæœ€å¤šæ·»åŠ ä¸€æ¬¡è¿ç»­æ®µï¼Œæ‰€ä»¥ä¸€æ¬¡æ“ä½œå‡æ‘Šå¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€» &lt;span class=&#34;math inline&#34;&gt;\(O((n + q)\log n)\)&lt;/span&gt;ï¼Œéšä¾¿ç»´æŠ¤ä¸€ä¸‹å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-772-div.-2&#34;&gt;Codeforces Round #772 (Div. 2)&lt;/h2&gt;
&lt;p&gt;æ‰“å‡ºäº†æœ‰å²ä»¥æ¥æœ€é«˜çš„ perfï¼ŒA + B + C + D + Eã€‚&lt;/p&gt;
&lt;h3 id=&#34;f---closest-pair&#34;&gt;1635F - Closest Pair&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªäºŒå…ƒç»„ &lt;span class=&#34;math inline&#34;&gt;\((x_i, w_i)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(|x_i|,w_i\le 10^9\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 3\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; å‡åºã€‚&lt;span class=&#34;math inline&#34;&gt;\(q\le 3\times 10^5\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼Œç»™å‡º &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math display&#34;&gt;\[
\min_{l\le i&amp;lt;j\le r}|x_i - x_j|(w_i + w_j)
\]&lt;/span&gt; ä¸€çœ¼æ•°æ®ç»“æ„é¢˜ï¼Œé™æ€è¯¢é—®è€ƒè™‘ç¦»çº¿ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å“ªäº› &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt; æ˜¯ä¸ä¼˜çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(x_p &amp;lt; x_q\land w_p &amp;gt; w_q\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä½œä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸€å®šæ¯” &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; ä¼˜ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(x_p &amp;lt; x_q\land w_p&amp;lt;w_q\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; ä½œä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸€å®šæ¯” &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä¼˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(L_i = \max\{j:j&amp;lt;i\land w_j\le w_i\}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(R_i = \min\{j:j&amp;gt;i\land w_j\le w_i\}\)&lt;/span&gt;ï¼Œç­”æ¡ˆå°±åªèƒ½å–å½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\([i, R_i]\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\([L_i, i]\)&lt;/span&gt; çš„åŒºé—´ã€‚è¿™æ ·çš„åŒºé—´ä¸€å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;å…ˆç”¨å•è°ƒæ ˆæ±‚å‡ºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(L_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(R_i\)&lt;/span&gt;ï¼Œå†è®¡ç®—å‡ºè¿™ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; ä¸ªåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l_i, r_i]\)&lt;/span&gt; çš„ä»·å€¼ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt;ï¼Œåœ¨æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r_i\)&lt;/span&gt; ä¸ŠæŒ‚ä¸Šæ ‡è®° &lt;span class=&#34;math inline&#34;&gt;\((l_i, c_i)\)&lt;/span&gt;ï¼Œåœ¨æ¯ä¸ªè¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\((i, ql, qr)\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(qr\)&lt;/span&gt; ä¸ŠæŒ‚ä¸Šæ ‡è®° &lt;span class=&#34;math inline&#34;&gt;\((ql, i)\)&lt;/span&gt;ã€‚ç„¶åæ‰«æçº¿æ‰«å³ç«¯ç‚¹ï¼Œçº¿æ®µæ ‘æˆ–è€…æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ä¸€ä¸‹ RMQ å’Œå•ç‚¹ä¿®æ”¹ï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb30&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb30-1&#34;&gt;&lt;a href=&#34;#cb30-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-2&#34;&gt;&lt;a href=&#34;#cb30-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pll = pair&amp;lt;ll, ll&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-3&#34;&gt;&lt;a href=&#34;#cb30-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-4&#34;&gt;&lt;a href=&#34;#cb30-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, L[maxn], R[maxn], stk[maxn], top;&lt;/span&gt;
&lt;span id=&#34;cb30-5&#34;&gt;&lt;a href=&#34;#cb30-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll t[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], ans[maxn];&lt;/span&gt;
&lt;span id=&#34;cb30-6&#34;&gt;&lt;a href=&#34;#cb30-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pll a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb30-7&#34;&gt;&lt;a href=&#34;#cb30-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pll&amp;gt; op[maxn], q[maxn];&lt;/span&gt;
&lt;span id=&#34;cb30-8&#34;&gt;&lt;a href=&#34;#cb30-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-9&#34;&gt;&lt;a href=&#34;#cb30-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il ll calc(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; myabs(a[i].first - a[j].first) * (a[i].second + a[j].second);}&lt;/span&gt;
&lt;span id=&#34;cb30-10&#34;&gt;&lt;a href=&#34;#cb30-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-11&#34;&gt;&lt;a href=&#34;#cb30-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define L &lt;/span&gt;(k&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;&amp;lt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb30-12&#34;&gt;&lt;a href=&#34;#cb30-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define R &lt;/span&gt;(L&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;|&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb30-13&#34;&gt;&lt;a href=&#34;#cb30-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define M &lt;/span&gt;((i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;+&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;j)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb30-14&#34;&gt;&lt;a href=&#34;#cb30-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-15&#34;&gt;&lt;a href=&#34;#cb30-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; modify(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, ll v) {&lt;/span&gt;
&lt;span id=&#34;cb30-16&#34;&gt;&lt;a href=&#34;#cb30-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i == j) {&lt;/span&gt;
&lt;span id=&#34;cb30-17&#34;&gt;&lt;a href=&#34;#cb30-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        chkmin(t[k], v);&lt;/span&gt;
&lt;span id=&#34;cb30-18&#34;&gt;&lt;a href=&#34;#cb30-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-19&#34;&gt;&lt;a href=&#34;#cb30-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-20&#34;&gt;&lt;a href=&#34;#cb30-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= M) modify(i, M, L, x, v);&lt;/span&gt;
&lt;span id=&#34;cb30-21&#34;&gt;&lt;a href=&#34;#cb30-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; modify(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R, x, v);&lt;/span&gt;
&lt;span id=&#34;cb30-22&#34;&gt;&lt;a href=&#34;#cb30-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    t[k] = min(t[L], t[R]);&lt;/span&gt;
&lt;span id=&#34;cb30-23&#34;&gt;&lt;a href=&#34;#cb30-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-24&#34;&gt;&lt;a href=&#34;#cb30-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb30-25&#34;&gt;&lt;a href=&#34;#cb30-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-26&#34;&gt;&lt;a href=&#34;#cb30-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y) {&lt;/span&gt;
&lt;span id=&#34;cb30-27&#34;&gt;&lt;a href=&#34;#cb30-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= i &amp;amp;&amp;amp; y &amp;gt;= j) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; t[k];&lt;/span&gt;
&lt;span id=&#34;cb30-28&#34;&gt;&lt;a href=&#34;#cb30-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;fl&#34;&gt;2e18&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-29&#34;&gt;&lt;a href=&#34;#cb30-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;lt;= M) chkmin(ret, query(i, M, L, x, y));&lt;/span&gt;
&lt;span id=&#34;cb30-30&#34;&gt;&lt;a href=&#34;#cb30-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (y &amp;gt; M) chkmin(ret, query(M + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, j, R, x, y));&lt;/span&gt;
&lt;span id=&#34;cb30-31&#34;&gt;&lt;a href=&#34;#cb30-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb30-32&#34;&gt;&lt;a href=&#34;#cb30-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb30-33&#34;&gt;&lt;a href=&#34;#cb30-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-34&#34;&gt;&lt;a href=&#34;#cb30-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef L&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-35&#34;&gt;&lt;a href=&#34;#cb30-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef R&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-36&#34;&gt;&lt;a href=&#34;#cb30-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#undef M&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-37&#34;&gt;&lt;a href=&#34;#cb30-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-38&#34;&gt;&lt;a href=&#34;#cb30-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb30-39&#34;&gt;&lt;a href=&#34;#cb30-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb30-40&#34;&gt;&lt;a href=&#34;#cb30-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i].first, a[i].second);&lt;/span&gt;
&lt;span id=&#34;cb30-41&#34;&gt;&lt;a href=&#34;#cb30-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb30-42&#34;&gt;&lt;a href=&#34;#cb30-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, r; read(l, r);&lt;/span&gt;
&lt;span id=&#34;cb30-43&#34;&gt;&lt;a href=&#34;#cb30-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        q[r].push_back({l, i});&lt;/span&gt;
&lt;span id=&#34;cb30-44&#34;&gt;&lt;a href=&#34;#cb30-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-45&#34;&gt;&lt;a href=&#34;#cb30-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb30-46&#34;&gt;&lt;a href=&#34;#cb30-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; a[stk[top]].second &amp;gt; a[i].second) --top;&lt;/span&gt;
&lt;span id=&#34;cb30-47&#34;&gt;&lt;a href=&#34;#cb30-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        L[i] = stk[top], stk[++top] = i;&lt;/span&gt;
&lt;span id=&#34;cb30-48&#34;&gt;&lt;a href=&#34;#cb30-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-49&#34;&gt;&lt;a href=&#34;#cb30-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    top = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-50&#34;&gt;&lt;a href=&#34;#cb30-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb30-51&#34;&gt;&lt;a href=&#34;#cb30-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (top &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; a[stk[top]].second &amp;gt; a[i].second) --top;&lt;/span&gt;
&lt;span id=&#34;cb30-52&#34;&gt;&lt;a href=&#34;#cb30-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        R[i] = stk[top], stk[++top] = i;&lt;/span&gt;
&lt;span id=&#34;cb30-53&#34;&gt;&lt;a href=&#34;#cb30-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-54&#34;&gt;&lt;a href=&#34;#cb30-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb30-55&#34;&gt;&lt;a href=&#34;#cb30-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (L[i]) op[i].push_back({L[i], calc(L[i], i)});&lt;/span&gt;
&lt;span id=&#34;cb30-56&#34;&gt;&lt;a href=&#34;#cb30-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (R[i]) op[R[i]].push_back({i, calc(i, R[i])});&lt;/span&gt;
&lt;span id=&#34;cb30-57&#34;&gt;&lt;a href=&#34;#cb30-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-58&#34;&gt;&lt;a href=&#34;#cb30-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb30-59&#34;&gt;&lt;a href=&#34;#cb30-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(t, &lt;span class=&#34;bn&#34;&gt;0x3f&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; t);&lt;/span&gt;
&lt;span id=&#34;cb30-60&#34;&gt;&lt;a href=&#34;#cb30-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb30-61&#34;&gt;&lt;a href=&#34;#cb30-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : op[i]) modify(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb30-62&#34;&gt;&lt;a href=&#34;#cb30-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : q[i]) ans[p.second] = query(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, p.first, i);&lt;/span&gt;
&lt;span id=&#34;cb30-63&#34;&gt;&lt;a href=&#34;#cb30-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb30-64&#34;&gt;&lt;a href=&#34;#cb30-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) print(ans[i]);&lt;/span&gt;
&lt;span id=&#34;cb30-65&#34;&gt;&lt;a href=&#34;#cb30-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb30-66&#34;&gt;&lt;a href=&#34;#cb30-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;educational-codeforces-round-123-rated-for-div.-2&#34;&gt;Educational Codeforces Round 123 (Rated for Div. 2)&lt;/h2&gt;
&lt;p&gt;ä¸‹å°åˆ†åœºã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-773-div.-1&#34;&gt;Codeforces Round #773 (Div. 1)&lt;/h2&gt;
&lt;h3 id=&#34;b---repetitions-decoding&#34;&gt;1641B - Repetitions Decoding&lt;/h3&gt;
&lt;p&gt;å…¶å®è¿™é¢˜å‡ºçš„å¾ˆä¸é”™æ¥ç€ï¼Œä½†æ˜¯æ¯’ç˜¤æ˜¯çœŸçš„æ¯’ç˜¤ã€‚&lt;/p&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 500\)&lt;/span&gt;ï¼‰çš„æ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œå¯ä»¥è¿›è¡Œå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\((x, c)\)&lt;/span&gt; çš„æ“ä½œï¼šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_x\)&lt;/span&gt; åé¢æ’å…¥&lt;strong&gt;ä¸¤ä¸ªè¿ç»­çš„&lt;/strong&gt;æ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(x\in[0, \text{the length of }a]\)&lt;/span&gt;ï¼‰ã€‚æ„é€ æ“ä½œæ–¹æ¡ˆä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æœ€åå¯ä»¥æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªè¿ç»­çš„å­æ®µï¼Œè¿™äº›å­æ®µæ»¡è¶³ï¼šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2k\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºä»»æ„æ­£æ•´æ•°ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(\forall i\in [1, k]\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_i = a_{i + k}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(\sum n^2\le 2.5\times 10^5\)&lt;/span&gt;ï¼Œæ“ä½œæ¬¡æ•°éœ€ &lt;span class=&#34;math inline&#34;&gt;\(\le 2n^2\)&lt;/span&gt;ï¼Œè‹¥æ— è§£åˆ™æŠ¥å‘Šä¹‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæ³¨æ„åˆ°æ¯ç§æ•°å­—çš„å‡ºç°æ¬¡æ•°å¿…é¡»ä¸ºå¶æ•°æ¬¡ï¼Œå› ä¸ºæ·»åŠ æ•°å­—ä¸€å®šæ˜¯ç»™æŸç§æ•°å­—æ·»åŠ ä¸¤ä¸ªï¼Œè‹¥å­˜åœ¨å‡ºç°äº†å¥‡æ•°æ¬¡çš„æ•°å­—åˆ™æ— è®ºå¦‚ä½•éƒ½æ²¡åŠæ³•æ‰¾åˆ°ä¸ä¹‹é…å¯¹çš„æ•°ï¼Œæ‰€ä»¥æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¯ä»¥æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªå‰ç¼€åšç¿»è½¬æ“ä½œï¼Œå…·ä½“åœ°ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;pre class=&#34;plain&#34;&gt;&lt;code&gt;1 2 3 1 3 2
1 2 3 - 1 2 3 3 2 1 - 1 3 2 // è¿™ä¸€æ­¥å¯ä»¥é€šè¿‡ 3 æ¬¡æ“ä½œå®ç°
(1 2 3 | 1 2 3) - 3 2 1 1 3 2 // å³æˆ‘ä»¬æ„é€ ä¸€ä¸ªå›æ–‡ä¸²ï¼Œç„¶åå°†å‰é¢çš„åˆå¹¶åˆ°ä¸€æ®µï¼Œå‰ç¼€å°±æˆåŠŸè¢«ç¿»è½¬äº†ã€‚&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€Œé€šè¿‡è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ”¾åœ¨ä¸€èµ·ï¼Œå†åè½¬ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre class=&#34;plain&#34;&gt;&lt;code&gt;(1 2 3 | 1 2 3) - (3 2 1 1 | 3 2 1 1) - 1 1 2 3 - 3 2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å°±é¡ºç†æˆç« çš„åœ¨ä¸€èµ·äº†ï¼Œå¯ä»¥æ”¾åœ¨ä¸€æ®µæ¶ˆæ‰äº†ã€‚&lt;/p&gt;
&lt;pre class=&#34;plain&#34;&gt;&lt;code&gt;(1 2 3 | 1 2 3) - (3 2 1 1 | 3 2 1 1) - (1 | 1) 2 3 3 2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±è§£å†³ &lt;code&gt;2 3 3 2&lt;/code&gt; å°±è¡Œäº†ï¼Œæ€è·¯æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™æ ·çš„æ“ä½œï¼Œæˆ‘ä»¬å°±èƒ½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„æ“ä½œæ¬¡æ•°ä¸‹ï¼Œå°†ä¸¤ä¸ªæ•°â€œä¸¤ä¸¤åˆå¹¶â€ï¼Œè§£å†³è¿™é“é¢˜ç›®ã€‚&lt;/p&gt;
&lt;p&gt;è¾“å‡ºæ–¹æ¡ˆæ¯”è¾ƒæ¯’ç˜¤ï¼Œå¤§å®¶å†™çš„æ—¶å€™éœ€è¦æ³¨æ„ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb34&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb34-1&#34;&gt;&lt;a href=&#34;#cb34-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-2&#34;&gt;&lt;a href=&#34;#cb34-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;505&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-3&#34;&gt;&lt;a href=&#34;#cb34-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, a[maxn], alreadyLen, now;&lt;/span&gt;
&lt;span id=&#34;cb34-4&#34;&gt;&lt;a href=&#34;#cb34-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pii&amp;gt; op;&lt;/span&gt;
&lt;span id=&#34;cb34-5&#34;&gt;&lt;a href=&#34;#cb34-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb34-6&#34;&gt;&lt;a href=&#34;#cb34-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;map&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; vis;&lt;/span&gt;
&lt;span id=&#34;cb34-7&#34;&gt;&lt;a href=&#34;#cb34-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb34-8&#34;&gt;&lt;a href=&#34;#cb34-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; rev(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pos) {&lt;/span&gt;
&lt;span id=&#34;cb34-9&#34;&gt;&lt;a href=&#34;#cb34-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, now + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, pos - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) op.push_back({i - now + alreadyLen + pos - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, a[i]});&lt;/span&gt;
&lt;span id=&#34;cb34-10&#34;&gt;&lt;a href=&#34;#cb34-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ans.push_back(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * (pos - now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb34-11&#34;&gt;&lt;a href=&#34;#cb34-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    alreadyLen += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * (pos - now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-12&#34;&gt;&lt;a href=&#34;#cb34-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    reverse(a + now + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a + pos);&lt;/span&gt;
&lt;span id=&#34;cb34-13&#34;&gt;&lt;a href=&#34;#cb34-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-14&#34;&gt;&lt;a href=&#34;#cb34-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb34-15&#34;&gt;&lt;a href=&#34;#cb34-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb34-16&#34;&gt;&lt;a href=&#34;#cb34-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb34-17&#34;&gt;&lt;a href=&#34;#cb34-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb34-18&#34;&gt;&lt;a href=&#34;#cb34-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb34-19&#34;&gt;&lt;a href=&#34;#cb34-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n);&lt;/span&gt;
&lt;span id=&#34;cb34-20&#34;&gt;&lt;a href=&#34;#cb34-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;decltype&lt;/span&gt;(vis)().swap(vis);&lt;/span&gt;
&lt;span id=&#34;cb34-21&#34;&gt;&lt;a href=&#34;#cb34-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(a[i]), ++vis[a[i]];&lt;/span&gt;
&lt;span id=&#34;cb34-22&#34;&gt;&lt;a href=&#34;#cb34-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; flg = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-23&#34;&gt;&lt;a href=&#34;#cb34-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : vis) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (p.second &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) flg = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-24&#34;&gt;&lt;a href=&#34;#cb34-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!flg) {&lt;/span&gt;
&lt;span id=&#34;cb34-25&#34;&gt;&lt;a href=&#34;#cb34-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            print(-&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-26&#34;&gt;&lt;a href=&#34;#cb34-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-27&#34;&gt;&lt;a href=&#34;#cb34-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb34-28&#34;&gt;&lt;a href=&#34;#cb34-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;decltype&lt;/span&gt;(op)().swap(op);&lt;/span&gt;
&lt;span id=&#34;cb34-29&#34;&gt;&lt;a href=&#34;#cb34-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;decltype&lt;/span&gt;(ans)().swap(ans);&lt;/span&gt;
&lt;span id=&#34;cb34-30&#34;&gt;&lt;a href=&#34;#cb34-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        alreadyLen = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, now = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-31&#34;&gt;&lt;a href=&#34;#cb34-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb34-32&#34;&gt;&lt;a href=&#34;#cb34-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (now &amp;lt; n) {&lt;/span&gt;
&lt;span id=&#34;cb34-33&#34;&gt;&lt;a href=&#34;#cb34-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (now == n - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb34-34&#34;&gt;&lt;a href=&#34;#cb34-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans.push_back(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-35&#34;&gt;&lt;a href=&#34;#cb34-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-36&#34;&gt;&lt;a href=&#34;#cb34-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb34-37&#34;&gt;&lt;a href=&#34;#cb34-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pos = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-38&#34;&gt;&lt;a href=&#34;#cb34-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, now + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[i] == a[now + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) {&lt;/span&gt;
&lt;span id=&#34;cb34-39&#34;&gt;&lt;a href=&#34;#cb34-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                pos = i;&lt;/span&gt;
&lt;span id=&#34;cb34-40&#34;&gt;&lt;a href=&#34;#cb34-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-41&#34;&gt;&lt;a href=&#34;#cb34-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb34-42&#34;&gt;&lt;a href=&#34;#cb34-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            rev(pos), rev(pos + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-43&#34;&gt;&lt;a href=&#34;#cb34-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back(&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-44&#34;&gt;&lt;a href=&#34;#cb34-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            now += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-45&#34;&gt;&lt;a href=&#34;#cb34-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb34-46&#34;&gt;&lt;a href=&#34;#cb34-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb34-47&#34;&gt;&lt;a href=&#34;#cb34-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(op.size());&lt;/span&gt;
&lt;span id=&#34;cb34-48&#34;&gt;&lt;a href=&#34;#cb34-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : op) print(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb34-49&#34;&gt;&lt;a href=&#34;#cb34-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(ans.size());&lt;/span&gt;
&lt;span id=&#34;cb34-50&#34;&gt;&lt;a href=&#34;#cb34-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; x : ans) print(x, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-51&#34;&gt;&lt;a href=&#34;#cb34-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb34-52&#34;&gt;&lt;a href=&#34;#cb34-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb34-53&#34;&gt;&lt;a href=&#34;#cb34-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb34-54&#34;&gt;&lt;a href=&#34;#cb34-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-781-div.-2&#34;&gt;Codeforces Round #781 (Div. 2)&lt;/h2&gt;
&lt;p&gt;rnmé€€é’±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;c---tree-infection&#34;&gt;1665C - Tree Infection&lt;/h3&gt;
&lt;p&gt;&lt;del&gt;è¯»é”™é¢˜å°±ä¸€ç›´æƒ³å‘—ï¼Œæƒ³å‘—ï¼Œå“ˆå“ˆã€‚&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥è½¬åŒ–æˆä¸€ä¸ªèŠ‚ç‚¹çš„å„¿å­ä¸ªæ•°çš„é—®é¢˜ã€‚æ˜¾ç„¶ä»å„¿å­æœ€å¤šçš„æŒ¨ä¸ªç‚¹ä¼ æŸ“ã€‚æ‰€ä»¥æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d---gcd-guess&#34;&gt;1665D - GCD Guess&lt;/h3&gt;
&lt;p&gt;çŒœ &lt;span class=&#34;math inline&#34;&gt;\(1\le x\le 10^9\)&lt;/span&gt;ï¼Œæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡å¯ä»¥æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(x + a, x + b)\)&lt;/span&gt;ã€‚è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(a\ne b,1\le a,b\le 2\times 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; æ¬¡è¯¢é—®éå¸¸çµæ€§ï¼Œç›¸å½“äºæ˜ç¤ºæˆ‘ä»¬è¦æŒ‰ä½è€ƒè™‘ã€‚å…·ä½“åœ°æˆ‘ä»¬å¯ä»¥æ€è€ƒ &lt;span class=&#34;math inline&#34;&gt;\(x\bmod 2^k\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬çŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(x\bmod 2^0 = 0\)&lt;/span&gt;ï¼Œè€ƒè™‘å¦‚ä½•ä» &lt;span class=&#34;math inline&#34;&gt;\(x\bmod 2^k\)&lt;/span&gt; æ¨å¾— &lt;span class=&#34;math inline&#34;&gt;\(x\bmod 2^{k+1}\)&lt;/span&gt;ã€‚å…¶ä¸­é—´çš„å·®å€¼è¦ä¹ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; è¦ä¹ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2^k\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x \bmod 2^k = r\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(\gcd(x + 2^k - r, 2^{k + 1})\)&lt;/span&gt;ï¼Œè‹¥ç»“æœä¸º &lt;span class=&#34;math inline&#34;&gt;\(2^{k + 1}\)&lt;/span&gt; åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(x\bmod 2^{k + 1} = r + 2^k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°è¯¢é—®å°±æ˜¯é—® &lt;span class=&#34;math inline&#34;&gt;\(\gcd(x + 2^k - r, x + 2^k + 2^{k+1}-r)\)&lt;/span&gt;ï¼Œå¯ä»¥å‘ç°åˆšå¥½é—® &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; æ¬¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---minimizor&#34;&gt;1665E - MinimizOR&lt;/h3&gt;
&lt;p&gt;é™æ€æŸ¥è¯¢åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; å†… &lt;span class=&#34;math inline&#34;&gt;\(\min_{i\ne j,l\le i,j\le r}\{a_i\lor a_j\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le a_i&amp;lt; 2^{30}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç‰›é€¼ç»“è®ºé¢˜ã€‚ã€‚ç»“è®ºæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; 2^k\)&lt;/span&gt; çš„æ•°å­—ä¸­çš„ç­”æ¡ˆåªå¯èƒ½ä»æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k + 1\)&lt;/span&gt; ä¸ªæ•°å­—ä¸­äº§ç”Ÿã€‚äºæ˜¯çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹åŒºé—´å†…æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(31\)&lt;/span&gt; ä¸ªæ•°å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ç”¨å½’çº³æ³•è¯æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(k = 1\)&lt;/span&gt; æ—¶ï¼Œæ‰€æœ‰æ•°éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œæ˜¾ç„¶æˆç«‹ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸‹é¢è¯´æ˜ &lt;span class=&#34;math inline&#34;&gt;\(k\to k + 1\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;è‹¥ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(\le 1\)&lt;/span&gt;ï¼Œåˆ™è¿™ä¸€ä½æœ€åæˆ–èµ·æ¥è‚¯å®šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œé—®é¢˜å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; 2^k\)&lt;/span&gt; çš„æƒ…å†µï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k + 1\)&lt;/span&gt; ä¸ªæ•°å­—å³å¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k + 2\)&lt;/span&gt; ä¸ªè‚¯å®šä¹Ÿå¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½æˆ‘ä»¬è´ªå¿ƒåœ°å¼ºåˆ¶å…¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œæ•…ç­”æ¡ˆåªä¸ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ•°å­—æœ‰å…³ã€‚æ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(k + 2\)&lt;/span&gt; ä¸ªä¹Ÿèƒ½æ»¡è¶³éœ€æ±‚ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯æ¯•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;educational-codeforces-round-126-rated-for-div.-2&#34;&gt;Educational Codeforces Round 126 (Rated for Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;e---narrow-components&#34;&gt;1661E - Narrow Components&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(3\times n\)&lt;/span&gt; çš„ 0-1 çŸ©é˜µï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\([l_i, r_i]\)&lt;/span&gt; åˆ—å†…çš„å››è¿é€šå—ä¸ªæ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 5\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚åœ¨æ¯ä¸ªåŒºé—´å¯¹åº”çš„èŠ‚ç‚¹å†…ç»´æŠ¤å·¦ç«¯ç‚¹/å³ç«¯ç‚¹å¯¹åº”çš„å¹¶æŸ¥é›†ï¼Œç„¶åå¯¹åº”åˆå¹¶å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ç»†èŠ‚ï¼Œåˆå¹¶çš„æ—¶å€™è¦å¼€ 12 ä¸ªèŠ‚ç‚¹åˆ†åˆ«å¯¹åº”å·¦åŒºé—´/å³åŒºé—´çš„å·¦å³ç«¯ç‚¹ã€‚è€Œä¸ºäº†é˜²æ­¢æœ‰è¿é€šå—ä»å·¦è¾¹è¿åˆ°å³è¾¹æ‰€ä»¥è€ƒè™‘ä»¤å…¶å¹¶æŸ¥é›†ç¼–å·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\sim 6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb35&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb35-1&#34;&gt;&lt;a href=&#34;#cb35-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Node {&lt;/span&gt;
&lt;span id=&#34;cb35-2&#34;&gt;&lt;a href=&#34;#cb35-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l[&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;], r[&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;], lc[&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;], rc[&lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;], sum;&lt;/span&gt;
&lt;span id=&#34;cb35-3&#34;&gt;&lt;a href=&#34;#cb35-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; init(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pos) {&lt;/span&gt;
&lt;span id=&#34;cb35-4&#34;&gt;&lt;a href=&#34;#cb35-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) lc[i] = rc[i] = a[i][pos] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, sum += lc[i], fa[i] = i;&lt;/span&gt;
&lt;span id=&#34;cb35-5&#34;&gt;&lt;a href=&#34;#cb35-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (lc[i] == lc[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;amp;&amp;amp; lc[i]) sum -= merge(i, i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb35-6&#34;&gt;&lt;a href=&#34;#cb35-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) l[i] = r[i] = find(i);&lt;/span&gt;
&lt;span id=&#34;cb35-7&#34;&gt;&lt;a href=&#34;#cb35-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb35-8&#34;&gt;&lt;a href=&#34;#cb35-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} t[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], tmp;&lt;/span&gt;
&lt;span id=&#34;cb35-9&#34;&gt;&lt;a href=&#34;#cb35-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb35-10&#34;&gt;&lt;a href=&#34;#cb35-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;Node merge(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;l, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Node &amp;amp;r) {&lt;/span&gt;
&lt;span id=&#34;cb35-11&#34;&gt;&lt;a href=&#34;#cb35-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    tmp.sum = l.sum + r.sum;&lt;/span&gt;
&lt;span id=&#34;cb35-12&#34;&gt;&lt;a href=&#34;#cb35-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) tmp.lc[i] = l.lc[i], tmp.rc[i] = r.rc[i];&lt;/span&gt;
&lt;span id=&#34;cb35-13&#34;&gt;&lt;a href=&#34;#cb35-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) tmp.l[i] = tmp.r[i] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb35-14&#34;&gt;&lt;a href=&#34;#cb35-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb35-15&#34;&gt;&lt;a href=&#34;#cb35-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m * &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) fa[i] = i;&lt;/span&gt;
&lt;span id=&#34;cb35-16&#34;&gt;&lt;a href=&#34;#cb35-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb35-17&#34;&gt;&lt;a href=&#34;#cb35-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        merge(i, l.l[i]), merge(i + m, l.r[i]);&lt;/span&gt;
&lt;span id=&#34;cb35-18&#34;&gt;&lt;a href=&#34;#cb35-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        merge(i + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * m, r.l[i] + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * m), merge(i + &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; * m, r.r[i] + m * &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb35-19&#34;&gt;&lt;a href=&#34;#cb35-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb35-20&#34;&gt;&lt;a href=&#34;#cb35-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l.rc[i] == r.lc[i] &amp;amp;&amp;amp; l.rc[i]) &lt;/span&gt;
&lt;span id=&#34;cb35-21&#34;&gt;&lt;a href=&#34;#cb35-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp.sum -= merge(i + m, i + m * &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb35-22&#34;&gt;&lt;a href=&#34;#cb35-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(b, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; b);&lt;/span&gt;
&lt;span id=&#34;cb35-23&#34;&gt;&lt;a href=&#34;#cb35-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb35-24&#34;&gt;&lt;a href=&#34;#cb35-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!b[find(i)]) b[find(i)] = i;&lt;/span&gt;
&lt;span id=&#34;cb35-25&#34;&gt;&lt;a href=&#34;#cb35-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp.l[i] = b[find(i)];&lt;/span&gt;
&lt;span id=&#34;cb35-26&#34;&gt;&lt;a href=&#34;#cb35-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb35-27&#34;&gt;&lt;a href=&#34;#cb35-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, m * &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m * &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb35-28&#34;&gt;&lt;a href=&#34;#cb35-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!b[find(i)]) b[find(i)] = i - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * m;&lt;/span&gt;
&lt;span id=&#34;cb35-29&#34;&gt;&lt;a href=&#34;#cb35-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp.r[i - m * &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;] = b[find(i)];&lt;/span&gt;
&lt;span id=&#34;cb35-30&#34;&gt;&lt;a href=&#34;#cb35-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb35-31&#34;&gt;&lt;a href=&#34;#cb35-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; tmp;&lt;/span&gt;
&lt;span id=&#34;cb35-32&#34;&gt;&lt;a href=&#34;#cb35-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;f---teleporters&#34;&gt;1661F - Teleporters&lt;/h3&gt;
&lt;p&gt;ä¸€æ¡ç›´çº¿ä¸Šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n+1\)&lt;/span&gt; ä¸ªä¼ é€æœºï¼Œä½äºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(0,a_1,a_2,a_3,...,a_n\)&lt;/span&gt;ã€‚å¦‚æœåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹å’Œ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; ç‚¹éƒ½æœ‰ä¼ é€æœºï¼Œé‚£ä¹ˆå¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹ä¼ é€åˆ° &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; ç‚¹ï¼Œèƒ½é‡å¼€é”€ä¸º &lt;span class=&#34;math inline&#34;&gt;\((x-y)^2\)&lt;/span&gt;ã€‚ç°å¯ä»¥åœ¨æ•´ç‚¹å®‰è£…é¢å¤–çš„ä¼ é€æœºï¼Œè¦æ±‚ä½¿å¾—ä» &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¼ é€åˆ° &lt;span class=&#34;math inline&#34;&gt;\(a_n\)&lt;/span&gt; çš„ä»£ä»· &lt;span class=&#34;math inline&#34;&gt;\(\le m\)&lt;/span&gt;ã€‚é—®æœ€å°‘å®‰è£…å¤šå°‘é¢å¤–ä¼ é€æœºã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le a_1&amp;lt;a_2&amp;lt;\cdots&amp;lt;a_n\le 10^9\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_n\le m\le 10^{18}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®å‡å€¼ä¸ç­‰å¼ï¼Œåœ¨æœ€ä¼˜ç­–ç•¥ä¸‹ï¼Œæˆ‘ä»¬ä¸€å®šæ˜¯å°†ä¼ é€æœºå°½å¯èƒ½â€œå¹³å‡â€å®‰æ’ã€‚æ‰€ä»¥æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; åˆ†çš„æ®µå¯ä»¥ç‹¬ç«‹è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(x, k)\)&lt;/span&gt; è¡¨ç¤ºè€ƒè™‘é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ä¸€æ®µï¼Œæ”¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªä¼ é€æœºï¼Œèƒ½è¾¾åˆ°çš„æœ€å°ä»£ä»·ï¼Œåˆ™æˆ‘ä»¬åˆ’åˆ†å‡ºçš„ &lt;span class=&#34;math inline&#34;&gt;\(k + 1\)&lt;/span&gt; æ®µçš„é•¿åº¦è‚¯å®šè¦ä¹ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\left\lfloor\dfrac{x}{k + 1}\right\rfloor\)&lt;/span&gt;ï¼Œè¦ä¹ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\left\lceil\dfrac{x}{k + 1}\right\rceil\)&lt;/span&gt;ã€‚å‰è€…æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k + 1 - x\bmod(k + 1)\)&lt;/span&gt; æ®µï¼Œåè€…æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\bmod(k + 1)\)&lt;/span&gt; æ®µã€‚æ‰€ä»¥f &lt;span class=&#34;math display&#34;&gt;\[
f(x, k) = (x\bmod(k + 1))\cdot\left\lceil\frac{x}{k + 1}\right\rceil^2 +(k + 1 - x\bmod(k + 1))\cdot\left\lfloor\dfrac{x}{k + 1}\right\rfloor^2
\]&lt;/span&gt; è€Œå¦‚æœä¸è€ƒè™‘æ•´ç‚¹é™åˆ¶çš„è¯ï¼Œè¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ˜¯å…³äº &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æœ‰å‡¸æ€§çš„ï¼Œå³æ¯ä¸€æ®µæ¯å¢åŠ ä¸€ä¸ªä¼ é€æœºï¼Œä»£ä»·çš„å‡å°‘é‡æ˜¯ä¸å¢çš„ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæ ¹æ®æˆ‘ä»¬çš„ç›´è§‰ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½ä¼šå¾€èƒ½å‡å°‘æœ€å¤šä»£ä»·çš„ä¸€æ®µåŠ ä¼ é€æœºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥äºŒåˆ†ä¸€ä¸ªæœ€å°çš„å‡å°‘é‡ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œå¯¹äºæ¯ä¸€æ®µï¼ŒäºŒåˆ†æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f(x, k - 1) - f(x, k)\ge d\)&lt;/span&gt; çš„æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¹¶ä¸”åœ¨è¿™æ®µæ”¾ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªä¼ é€æœºã€‚è®¾è¿™æ ·å­çš„æ€»ä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(g(d)\)&lt;/span&gt;ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥äºŒåˆ†å‡ºä¸€ä¸ªåˆšå¥½ &lt;span class=&#34;math inline&#34;&gt;\(\le m\)&lt;/span&gt; çš„æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; æ˜¯ä¸ä¸€å®šè¦å…¨éƒ¨åŠ è¿›å»çš„ï¼Œæœ‰å¯èƒ½æˆ‘ä»¬å¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(d + 1\)&lt;/span&gt; çš„åŸºç¡€ä¸Šæ”¾å‡ ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; å°±å¯ä»¥ä½¿å¾—æ€»ä»£ä»· &lt;span class=&#34;math inline&#34;&gt;\(\le m\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å…ˆç®—å‡º &lt;span class=&#34;math inline&#34;&gt;\(g(d + 1)\)&lt;/span&gt; ç„¶åå†æ”¾ &lt;span class=&#34;math inline&#34;&gt;\(\left\lceil\dfrac{g(d + 1) - m}{d}\right\rceil\)&lt;/span&gt; ä¸ªä¼ é€æœºå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb36&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb36-1&#34;&gt;&lt;a href=&#34;#cb36-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-2&#34;&gt;&lt;a href=&#34;#cb36-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-3&#34;&gt;&lt;a href=&#34;#cb36-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, a[maxn];&lt;/span&gt;
&lt;span id=&#34;cb36-4&#34;&gt;&lt;a href=&#34;#cb36-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll m;&lt;/span&gt;
&lt;span id=&#34;cb36-5&#34;&gt;&lt;a href=&#34;#cb36-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pll = pair&amp;lt;ll, ll&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-6&#34;&gt;&lt;a href=&#34;#cb36-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb36-7&#34;&gt;&lt;a href=&#34;#cb36-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il ll f(ll x, ll k) {&lt;/span&gt;
&lt;span id=&#34;cb36-8&#34;&gt;&lt;a href=&#34;#cb36-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; (x % (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) * ((x + k) / (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) * ((x + k) / (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) + (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - (x % (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;))) * (x / (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) * (x / (k + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;));&lt;/span&gt;
&lt;span id=&#34;cb36-9&#34;&gt;&lt;a href=&#34;#cb36-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb36-10&#34;&gt;&lt;a href=&#34;#cb36-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb36-11&#34;&gt;&lt;a href=&#34;#cb36-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pll calc(ll x, ll d) {&lt;/span&gt;
&lt;span id=&#34;cb36-12&#34;&gt;&lt;a href=&#34;#cb36-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll l = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r = x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, ret = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-13&#34;&gt;&lt;a href=&#34;#cb36-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt;= r) {&lt;/span&gt;
&lt;span id=&#34;cb36-14&#34;&gt;&lt;a href=&#34;#cb36-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-15&#34;&gt;&lt;a href=&#34;#cb36-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (f(x, mid - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - f(x, mid) &amp;gt;= d)&lt;/span&gt;
&lt;span id=&#34;cb36-16&#34;&gt;&lt;a href=&#34;#cb36-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ret = mid, l = mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-17&#34;&gt;&lt;a href=&#34;#cb36-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; r = mid - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-18&#34;&gt;&lt;a href=&#34;#cb36-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb36-19&#34;&gt;&lt;a href=&#34;#cb36-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; {f(x, ret), ret};&lt;/span&gt;
&lt;span id=&#34;cb36-20&#34;&gt;&lt;a href=&#34;#cb36-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb36-21&#34;&gt;&lt;a href=&#34;#cb36-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb36-22&#34;&gt;&lt;a href=&#34;#cb36-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pll check(ll mid) {&lt;/span&gt;
&lt;span id=&#34;cb36-23&#34;&gt;&lt;a href=&#34;#cb36-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pll res;&lt;/span&gt;
&lt;span id=&#34;cb36-24&#34;&gt;&lt;a href=&#34;#cb36-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb36-25&#34;&gt;&lt;a href=&#34;#cb36-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; now = calc(a[i], mid);&lt;/span&gt;
&lt;span id=&#34;cb36-26&#34;&gt;&lt;a href=&#34;#cb36-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        res.first += now.first, res.second += now.second;&lt;/span&gt;
&lt;span id=&#34;cb36-27&#34;&gt;&lt;a href=&#34;#cb36-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb36-28&#34;&gt;&lt;a href=&#34;#cb36-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; res;&lt;/span&gt;
&lt;span id=&#34;cb36-29&#34;&gt;&lt;a href=&#34;#cb36-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb36-30&#34;&gt;&lt;a href=&#34;#cb36-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb36-31&#34;&gt;&lt;a href=&#34;#cb36-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb36-32&#34;&gt;&lt;a href=&#34;#cb36-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    is &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb36-33&#34;&gt;&lt;a href=&#34;#cb36-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) is &amp;gt;&amp;gt; a[i];&lt;/span&gt;
&lt;span id=&#34;cb36-34&#34;&gt;&lt;a href=&#34;#cb36-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) a[i] -= a[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb36-35&#34;&gt;&lt;a href=&#34;#cb36-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    is &amp;gt;&amp;gt; m;&lt;/span&gt;
&lt;span id=&#34;cb36-36&#34;&gt;&lt;a href=&#34;#cb36-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = &lt;span class=&#34;fl&#34;&gt;1e18&lt;/span&gt;, d;&lt;/span&gt;
&lt;span id=&#34;cb36-37&#34;&gt;&lt;a href=&#34;#cb36-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt;= r) {&lt;/span&gt;
&lt;span id=&#34;cb36-38&#34;&gt;&lt;a href=&#34;#cb36-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-39&#34;&gt;&lt;a href=&#34;#cb36-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (check(mid).first &amp;lt;= m) l = mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, d = mid;&lt;/span&gt;
&lt;span id=&#34;cb36-40&#34;&gt;&lt;a href=&#34;#cb36-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; r = mid - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-41&#34;&gt;&lt;a href=&#34;#cb36-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb36-42&#34;&gt;&lt;a href=&#34;#cb36-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; res = check(d + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb36-43&#34;&gt;&lt;a href=&#34;#cb36-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; res.second + (res.first - m + d - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / d;&lt;/span&gt;
&lt;span id=&#34;cb36-44&#34;&gt;&lt;a href=&#34;#cb36-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb36-45&#34;&gt;&lt;a href=&#34;#cb36-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-796&#34;&gt;Codeforces Round #796&lt;/h2&gt;
&lt;h3 id=&#34;c---sanae-and-giant-robot&#34;&gt;1687C - Sanae and Giant Robot&lt;/h3&gt;
&lt;p&gt;ç»™å®šæ•°åˆ— &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l_i, r_i]\)&lt;/span&gt;ï¼Œæ¯æ¬¡æ“ä½œçš„æ—¶å€™å¯ä»¥é€‰æ‹©ä¸€ä¸ªåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(\forall l\le i\le r\)&lt;/span&gt; æ‰§è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(a_i\leftarrow b_i\)&lt;/span&gt;ï¼Œå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\displaystyle\sum_{i=l}^r a_i\)&lt;/span&gt; ä¸å˜ã€‚é—®èƒ½å¦ç»è¿‡è‹¥å¹²æ¬¡æ“ä½œå°† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€è€ƒ &lt;span class=&#34;math inline&#34;&gt;\(b_i = 0\)&lt;/span&gt; çš„æƒ…å†µã€‚åˆ™è‹¥æˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„å‰ç¼€å’Œçš„è¯ï¼Œæˆ‘ä»¬æ¯æ¬¡å°±å¯ä»¥é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(s_r - s_{l - 1} = 0\)&lt;/span&gt; çš„åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\(s_l,s_{l+1},\cdots,s_{r - 1}\)&lt;/span&gt; å…¨éƒ¨èµ‹å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s_r\)&lt;/span&gt;ã€‚è€Œæœ€ç»ˆçš„ç›®æ ‡æ˜¯è®©æ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(s_i = 0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å°±æ¯æ¬¡é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(s_{l-1} = s_r = 0\)&lt;/span&gt; çš„åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\([l, r - 1]\)&lt;/span&gt; å†…çš„ &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt; å…¨éƒ¨èµ‹å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚å¯ä»¥éšä¾¿ç»´æŠ¤ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼ˆä¾‹å¦‚ä½¿ç”¨ &lt;code&gt;set&lt;/code&gt; + bfsï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(b_i\ne 0\)&lt;/span&gt; çš„æƒ…å†µå‘¢ï¼Ÿå°† &lt;span class=&#34;math inline&#34;&gt;\(a_i \leftarrow a_i - b_i\)&lt;/span&gt; ä¹‹åå°±èƒ½å˜æˆå’Œä¸Šé¢ä¸€æ ·çš„é—®é¢˜äº†ã€‚æ¯ä¸ªç‚¹è‡³å¤šè¢«åˆ é™¤ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O((n+m)\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb37&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb37-1&#34;&gt;&lt;a href=&#34;#cb37-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb37-2&#34;&gt;&lt;a href=&#34;#cb37-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;fastio.hpp&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb37-3&#34;&gt;&lt;a href=&#34;#cb37-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb37-4&#34;&gt;&lt;a href=&#34;#cb37-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb37-5&#34;&gt;&lt;a href=&#34;#cb37-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb37-6&#34;&gt;&lt;a href=&#34;#cb37-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; YangTY::fastIO::is;&lt;/span&gt;
&lt;span id=&#34;cb37-7&#34;&gt;&lt;a href=&#34;#cb37-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; YangTY::fastIO::os;&lt;/span&gt;
&lt;span id=&#34;cb37-8&#34;&gt;&lt;a href=&#34;#cb37-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb37-9&#34;&gt;&lt;a href=&#34;#cb37-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb37-10&#34;&gt;&lt;a href=&#34;#cb37-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, deg[maxn];&lt;/span&gt;
&lt;span id=&#34;cb37-11&#34;&gt;&lt;a href=&#34;#cb37-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb37-12&#34;&gt;&lt;a href=&#34;#cb37-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb37-13&#34;&gt;&lt;a href=&#34;#cb37-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; e[maxn];&lt;/span&gt;
&lt;span id=&#34;cb37-14&#34;&gt;&lt;a href=&#34;#cb37-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb37-15&#34;&gt;&lt;a href=&#34;#cb37-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb37-16&#34;&gt;&lt;a href=&#34;#cb37-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; is &amp;gt;&amp;gt; T;&lt;/span&gt;
&lt;span id=&#34;cb37-17&#34;&gt;&lt;a href=&#34;#cb37-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb37-18&#34;&gt;&lt;a href=&#34;#cb37-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        is &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;&lt;/span&gt;
&lt;span id=&#34;cb37-19&#34;&gt;&lt;a href=&#34;#cb37-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) is &amp;gt;&amp;gt; a[i];&lt;/span&gt;
&lt;span id=&#34;cb37-20&#34;&gt;&lt;a href=&#34;#cb37-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) is &amp;gt;&amp;gt; b[i], a[i] -= b[i], a[i] += a[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb37-21&#34;&gt;&lt;a href=&#34;#cb37-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        set&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; S;&lt;/span&gt;
&lt;span id=&#34;cb37-22&#34;&gt;&lt;a href=&#34;#cb37-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) S.insert(i), vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;().swap(G[i]);&lt;/span&gt;
&lt;span id=&#34;cb37-23&#34;&gt;&lt;a href=&#34;#cb37-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb37-24&#34;&gt;&lt;a href=&#34;#cb37-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;l = e[i].first, &amp;amp;r = e[i].second;&lt;/span&gt;
&lt;span id=&#34;cb37-25&#34;&gt;&lt;a href=&#34;#cb37-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            is &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;&lt;/span&gt;
&lt;span id=&#34;cb37-26&#34;&gt;&lt;a href=&#34;#cb37-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            G[l - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;].push_back(i), G[r].push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb37-27&#34;&gt;&lt;a href=&#34;#cb37-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            deg[i] = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb37-28&#34;&gt;&lt;a href=&#34;#cb37-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb37-29&#34;&gt;&lt;a href=&#34;#cb37-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        queue&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb37-30&#34;&gt;&lt;a href=&#34;#cb37-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!a[i]) q.push(i), S.erase(i);&lt;/span&gt;
&lt;span id=&#34;cb37-31&#34;&gt;&lt;a href=&#34;#cb37-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb37-32&#34;&gt;&lt;a href=&#34;#cb37-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = q.front(); q.pop();&lt;/span&gt;
&lt;span id=&#34;cb37-33&#34;&gt;&lt;a href=&#34;#cb37-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; id : G[x]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!--deg[id]) {&lt;/span&gt;
&lt;span id=&#34;cb37-34&#34;&gt;&lt;a href=&#34;#cb37-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = e[id].first, r = e[id].second;&lt;/span&gt;
&lt;span id=&#34;cb37-35&#34;&gt;&lt;a href=&#34;#cb37-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; lt = S.lower_bound(l), rt = S.upper_bound(r);&lt;/span&gt;
&lt;span id=&#34;cb37-36&#34;&gt;&lt;a href=&#34;#cb37-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; it = lt; it != rt; ++it) q.push(*it);&lt;/span&gt;
&lt;span id=&#34;cb37-37&#34;&gt;&lt;a href=&#34;#cb37-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                S.erase(lt, rt);&lt;/span&gt;
&lt;span id=&#34;cb37-38&#34;&gt;&lt;a href=&#34;#cb37-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb37-39&#34;&gt;&lt;a href=&#34;#cb37-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb37-40&#34;&gt;&lt;a href=&#34;#cb37-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        os &amp;lt;&amp;lt; (S.empty() ? &lt;span class=&#34;st&#34;&gt;&amp;quot;YES&amp;quot;&lt;/span&gt; : &lt;span class=&#34;st&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb37-41&#34;&gt;&lt;a href=&#34;#cb37-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb37-42&#34;&gt;&lt;a href=&#34;#cb37-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb37-43&#34;&gt;&lt;a href=&#34;#cb37-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;d---cute-number&#34;&gt;1687D - Cute number&lt;/h3&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; ä¸ºä¸¥æ ¼å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æœ€å°å®Œå…¨å¹³æ–¹æ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g(x)\)&lt;/span&gt; ä¸ºå°äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æœ€å¤§å®Œå…¨å¹³æ–¹æ•°ã€‚å®šä¹‰ä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ˜¯å¯çˆ±çš„ï¼Œå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(x - g(x) &amp;lt; f(x) - x\)&lt;/span&gt;ã€‚ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ­£æ•´æ•°åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œæ±‚ä¸€ä¸ªæœ€å°çš„éè´Ÿæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\forall 1\le i\le n\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_i + k\)&lt;/span&gt; ä¸ºå¯çˆ±çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le a_i\le 2\times 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¤§åŠ›è§‚å¯Ÿï¼Œæ ¹æ® &lt;span class=&#34;math inline&#34;&gt;\((x^2)&amp;#39; = 2x\)&lt;/span&gt; å¾—åˆ°å¯çˆ±çš„æ•°ä¸€å®šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\([k^2, k^2 + k]\)&lt;/span&gt; å†…ï¼Œæˆä¸€æ®µä¸€æ®µçš„åˆ†å¸ƒï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µå¯çˆ±çš„æ•°çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i + 1\)&lt;/span&gt;ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µä¸å¯çˆ±çš„æ•°é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ã€‚ä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\([k^2, k^2 + k]\)&lt;/span&gt; ä¸ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(a_1 + k\)&lt;/span&gt; åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(a_n\)&lt;/span&gt; æ®µçš„æ®µå¤´çš„è¯ï¼Œä¸€å®šæ˜¯å¯ä»¥çš„ã€‚æ‰€ä»¥æšä¸¾æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; a_n\)&lt;/span&gt; çš„æ®µåˆ¤æ–­æ˜¯å¦å¯ä»¥å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(a_1 + k\)&lt;/span&gt; åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸€å…±ä¼šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i + 1\)&lt;/span&gt; ä¸ªå¯å–çš„å€¼ï¼Œè€Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; é€æ¸å˜åŒ–çš„æ—¶å€™ï¼ŒæŸä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i + k\)&lt;/span&gt; å¯èƒ½ä¼šä»å¯çˆ±å˜åˆ°ä¸å¯çˆ±ï¼Œä¹Ÿæœ‰å¯èƒ½ä»ä¸å¯çˆ±å˜å¾—å¯çˆ±ã€‚ä¹Ÿå³ï¼šæˆ‘ä»¬è¦æŠŠæ‰€æœ‰ä¸å¯çˆ±çš„æ•°å˜å¾—å¯çˆ±ï¼Œä¹Ÿä¸èƒ½æŠŠä»»ä½•å¯çˆ±çš„æ•°å˜å¾—ä¸å¯çˆ±ã€‚ä¸éš¾å‘ç°è¿™å®é™…ä¸Šç»™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å¡äº†ä¸€ä¸ªä¸Šä¸‹ç•Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•è®¡ç®—ï¼Ÿåˆå§‹æ—¶ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a_1 + k\)&lt;/span&gt; ä¸ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µæ®µé¦–ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(k=i^2 - a_1\)&lt;/span&gt;ï¼Œè€ƒè™‘å¯¹äºæ¯ä¸ªä¸å¯çˆ±çš„æ®µï¼Œæ‰¾åˆ°é‡Œé¢æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œè¿™é™åˆ¶äº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ä¸‹ç•Œï¼›å¯¹æ¯ä¸ªå¯çˆ±çš„æ®µæ‰¾åˆ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œè¿™é™åˆ¶äº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ä¸Šç•Œã€‚ç”±äºæ¯æ®µé•¿åº¦éƒ½ &lt;span class=&#34;math inline&#34;&gt;\(\ge i\)&lt;/span&gt;ï¼Œæ‰€ä»¥ä¸€å…±åªä¼šæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{a_n}{i}\)&lt;/span&gt; æ®µã€‚æ‰€ä»¥æ€»æ—¶é—´å¤æ‚åº¦è°ƒå’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_n\log a_n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb38&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb38-1&#34;&gt;&lt;a href=&#34;#cb38-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define int &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-2&#34;&gt;&lt;a href=&#34;#cb38-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-3&#34;&gt;&lt;a href=&#34;#cb38-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;4e6&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;, N = &lt;span class=&#34;fl&#34;&gt;4e6&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-4&#34;&gt;&lt;a href=&#34;#cb38-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, a[maxn], vis[maxn], pre[maxn], suf[maxn];&lt;/span&gt;
&lt;span id=&#34;cb38-5&#34;&gt;&lt;a href=&#34;#cb38-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb38-6&#34;&gt;&lt;a href=&#34;#cb38-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;signed&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb38-7&#34;&gt;&lt;a href=&#34;#cb38-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb38-8&#34;&gt;&lt;a href=&#34;#cb38-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; a[i], vis[a[i] - a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-9&#34;&gt;&lt;a href=&#34;#cb38-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    pre[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, suf[N] = N;&lt;/span&gt;
&lt;span id=&#34;cb38-10&#34;&gt;&lt;a href=&#34;#cb38-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, N) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[i]) pre[i] = i; &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; pre[i] = pre[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb38-11&#34;&gt;&lt;a href=&#34;#cb38-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    DEC(i, N - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[i]) suf[i] = i; &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; suf[i] = suf[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb38-12&#34;&gt;&lt;a href=&#34;#cb38-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, a[n]) {&lt;/span&gt;
&lt;span id=&#34;cb38-13&#34;&gt;&lt;a href=&#34;#cb38-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i * (i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;lt; a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-14&#34;&gt;&lt;a href=&#34;#cb38-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lb = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, rb = i;&lt;/span&gt;
&lt;span id=&#34;cb38-15&#34;&gt;&lt;a href=&#34;#cb38-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;gt; i * i) lb = a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - i * i;&lt;/span&gt;
&lt;span id=&#34;cb38-16&#34;&gt;&lt;a href=&#34;#cb38-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = i;&lt;/span&gt;
&lt;span id=&#34;cb38-17&#34;&gt;&lt;a href=&#34;#cb38-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, i, a[n]) {&lt;/span&gt;
&lt;span id=&#34;cb38-18&#34;&gt;&lt;a href=&#34;#cb38-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (pre[r] &amp;gt;= l)&lt;/span&gt;
&lt;span id=&#34;cb38-19&#34;&gt;&lt;a href=&#34;#cb38-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmin(rb, r - pre[r]);&lt;/span&gt;
&lt;span id=&#34;cb38-20&#34;&gt;&lt;a href=&#34;#cb38-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            l += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-21&#34;&gt;&lt;a href=&#34;#cb38-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (suf[r + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;lt; l)&lt;/span&gt;
&lt;span id=&#34;cb38-22&#34;&gt;&lt;a href=&#34;#cb38-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                chkmax(lb, l - suf[r + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb38-23&#34;&gt;&lt;a href=&#34;#cb38-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            r += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-24&#34;&gt;&lt;a href=&#34;#cb38-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (l &amp;gt; a[n] - a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-25&#34;&gt;&lt;a href=&#34;#cb38-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb38-26&#34;&gt;&lt;a href=&#34;#cb38-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (lb &amp;lt;= rb) {&lt;/span&gt;
&lt;span id=&#34;cb38-27&#34;&gt;&lt;a href=&#34;#cb38-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cout &amp;lt;&amp;lt; i * i + lb - a[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb38-28&#34;&gt;&lt;a href=&#34;#cb38-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-29&#34;&gt;&lt;a href=&#34;#cb38-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb38-30&#34;&gt;&lt;a href=&#34;#cb38-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb38-31&#34;&gt;&lt;a href=&#34;#cb38-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb38-32&#34;&gt;&lt;a href=&#34;#cb38-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-801-div.-2-and-epic-institute-of-technology-round&#34;&gt;Codeforces Round #801 (Div. 2) and EPIC Institute of Technology Round&lt;/h2&gt;
&lt;h3 id=&#34;d12---tree-queries-hard-version&#34;&gt;1695D1/2 - Tree Queries (Hard Version)&lt;/h3&gt;
&lt;p&gt;åŸé¢˜åœ°å€ï¼š&lt;a href=&#34;https://atcoder.jp/contests/apc001/tasks/apc001_e&#34;&gt;AtCoder&lt;/a&gt;ï¼Œ&lt;a href=&#34;https://www.luogu.com.cn/problem/AT3912&#34;&gt;æ´›è°·&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n = 1\)&lt;/span&gt; æˆ‘ä»¬å¯ä»¥ç‰¹åˆ¤æ‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n\le 2000\)&lt;/span&gt; çš„ D1ï¼Œå‘ç°æˆ‘ä»¬å¯ä»¥æšä¸¾æ ¹ç„¶åé’¦å®šé€‰æ‹©ä¹‹ï¼Œä¹‹åè´ªå¿ƒæ‰«ä¸€éæ ‘è®¡ç®—ç­”æ¡ˆã€‚å…·ä½“åœ°ï¼Œè‹¥é‡åˆ°äº†åº¦æ•° &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{deg}(u)\ge 3\)&lt;/span&gt; çš„èŠ‚ç‚¹ï¼ˆå³åˆ†å‰ï¼‰ï¼Œåˆ™è‡³å°‘è¦æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{deg}(u) - 2\)&lt;/span&gt; ä¸ªå­æ ‘å†…æœ‰é€‰æ‹©çš„ç‚¹ï¼ˆå¦åˆ™æ— æ³•å°†æ‰€æœ‰çš„å­æ ‘åŒºåˆ†å¼€æ¥ï¼‰ã€‚è¿™ä¸ªä¸œè¥¿å¯ä»¥ç¨å¾® dp ä¸€ä¸‹æ¥åšï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†…æœ‰æ²¡æœ‰é€‰ç‚¹ï¼Œåˆ™&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb39&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb39-1&#34;&gt;&lt;a href=&#34;#cb39-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-2&#34;&gt;&lt;a href=&#34;#cb39-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-3&#34;&gt;&lt;a href=&#34;#cb39-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb39-4&#34;&gt;&lt;a href=&#34;#cb39-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-5&#34;&gt;&lt;a href=&#34;#cb39-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb39-6&#34;&gt;&lt;a href=&#34;#cb39-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-7&#34;&gt;&lt;a href=&#34;#cb39-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; il T chkmin(T &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; T &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a = (b &amp;lt; a ? b : a);}&lt;/span&gt;
&lt;span id=&#34;cb39-8&#34;&gt;&lt;a href=&#34;#cb39-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e3&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-9&#34;&gt;&lt;a href=&#34;#cb39-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, f[maxn];&lt;/span&gt;
&lt;span id=&#34;cb39-10&#34;&gt;&lt;a href=&#34;#cb39-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb39-11&#34;&gt;&lt;a href=&#34;#cb39-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-12&#34;&gt;&lt;a href=&#34;#cb39-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa) {&lt;/span&gt;
&lt;span id=&#34;cb39-13&#34;&gt;&lt;a href=&#34;#cb39-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, ret = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-14&#34;&gt;&lt;a href=&#34;#cb39-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    f[u] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-15&#34;&gt;&lt;a href=&#34;#cb39-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : G[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v != fa) {&lt;/span&gt;
&lt;span id=&#34;cb39-16&#34;&gt;&lt;a href=&#34;#cb39-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret += dfs(v, u);&lt;/span&gt;
&lt;span id=&#34;cb39-17&#34;&gt;&lt;a href=&#34;#cb39-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp += !f[v], f[u] |= f[v];&lt;/span&gt;
&lt;span id=&#34;cb39-18&#34;&gt;&lt;a href=&#34;#cb39-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb39-19&#34;&gt;&lt;a href=&#34;#cb39-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tmp &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ret += tmp - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, f[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-20&#34;&gt;&lt;a href=&#34;#cb39-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb39-21&#34;&gt;&lt;a href=&#34;#cb39-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb39-22&#34;&gt;&lt;a href=&#34;#cb39-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb39-23&#34;&gt;&lt;a href=&#34;#cb39-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb39-24&#34;&gt;&lt;a href=&#34;#cb39-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb39-25&#34;&gt;&lt;a href=&#34;#cb39-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; cin &amp;gt;&amp;gt; T;&lt;/span&gt;
&lt;span id=&#34;cb39-26&#34;&gt;&lt;a href=&#34;#cb39-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb39-27&#34;&gt;&lt;a href=&#34;#cb39-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb39-28&#34;&gt;&lt;a href=&#34;#cb39-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;().swap(G[i]);&lt;/span&gt;
&lt;span id=&#34;cb39-29&#34;&gt;&lt;a href=&#34;#cb39-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb39-30&#34;&gt;&lt;a href=&#34;#cb39-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cout &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-31&#34;&gt;&lt;a href=&#34;#cb39-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-32&#34;&gt;&lt;a href=&#34;#cb39-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb39-33&#34;&gt;&lt;a href=&#34;#cb39-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb39-34&#34;&gt;&lt;a href=&#34;#cb39-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; cin &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;&lt;/span&gt;
&lt;span id=&#34;cb39-35&#34;&gt;&lt;a href=&#34;#cb39-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb39-36&#34;&gt;&lt;a href=&#34;#cb39-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb39-37&#34;&gt;&lt;a href=&#34;#cb39-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans = &lt;span class=&#34;fl&#34;&gt;1e9&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-38&#34;&gt;&lt;a href=&#34;#cb39-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) chkmin(ans, dfs(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb39-39&#34;&gt;&lt;a href=&#34;#cb39-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; ans &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-40&#34;&gt;&lt;a href=&#34;#cb39-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb39-41&#34;&gt;&lt;a href=&#34;#cb39-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb39-42&#34;&gt;&lt;a href=&#34;#cb39-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶åä¼šå‘ç°ï¼Œæˆ‘ä»¬è¿™æ ·åšçš„æœ¬è´¨æ˜¯ï¼Œå¯¹äºä¸€ä¸ªä»¥ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸ºæ ¹çš„å­æ ‘ï¼Œæˆ‘ä»¬ä¿è¯äº†ä»–çš„å¤–é¢è‡³å°‘æœ‰ä¸€ä¸ªç‚¹è¢«é€‰ï¼ˆå³è‡³å°‘é€‰äº†æ ¹ï¼‰ï¼Œä»¥ç¡®å®š &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ä½ç½®ã€‚è€Œå½“æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªåº¦æ•° &lt;span class=&#34;math inline&#34;&gt;\(\ge 3\)&lt;/span&gt; çš„ç‚¹ä½œä¸ºæ ¹æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å³ä½¿ä¸é€‰æ ¹ï¼Œå¯¹äºæ ¹çš„æ¯ä¸€ä¸ªå­æ ‘éƒ½å¯ä»¥æ»¡è¶³ä¸Šè¿°æ€§è´¨ï¼ˆå­æ ‘å¤–é¢ä¹Ÿè‡³å°‘é€‰äº†ä¸€ä¸ªç‚¹ï¼‰ï¼Œæ‰€ä»¥éšä¾¿é€‰ä¸€ä¸ªåº¦æ•° &lt;span class=&#34;math inline&#34;&gt;\(\ge 3\)&lt;/span&gt; çš„æ ¹è·‘ä¸€éè¿™ä¸ª dp å°±èƒ½å¾—åˆ°ç­”æ¡ˆï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™å°±ä¸é€‰æ ¹äº†ï¼‰ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb40&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb40-1&#34;&gt;&lt;a href=&#34;#cb40-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-2&#34;&gt;&lt;a href=&#34;#cb40-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb40-3&#34;&gt;&lt;a href=&#34;#cb40-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb40-4&#34;&gt;&lt;a href=&#34;#cb40-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-5&#34;&gt;&lt;a href=&#34;#cb40-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb40-6&#34;&gt;&lt;a href=&#34;#cb40-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;2e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-7&#34;&gt;&lt;a href=&#34;#cb40-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, f[maxn], ans;&lt;/span&gt;
&lt;span id=&#34;cb40-8&#34;&gt;&lt;a href=&#34;#cb40-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb40-9&#34;&gt;&lt;a href=&#34;#cb40-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-10&#34;&gt;&lt;a href=&#34;#cb40-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa) {&lt;/span&gt;
&lt;span id=&#34;cb40-11&#34;&gt;&lt;a href=&#34;#cb40-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tmp = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-12&#34;&gt;&lt;a href=&#34;#cb40-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : G[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v != fa) {&lt;/span&gt;
&lt;span id=&#34;cb40-13&#34;&gt;&lt;a href=&#34;#cb40-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(v, u);&lt;/span&gt;
&lt;span id=&#34;cb40-14&#34;&gt;&lt;a href=&#34;#cb40-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        tmp += !f[v], f[u] |= f[v];&lt;/span&gt;
&lt;span id=&#34;cb40-15&#34;&gt;&lt;a href=&#34;#cb40-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb40-16&#34;&gt;&lt;a href=&#34;#cb40-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tmp &amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans += tmp - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, f[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-17&#34;&gt;&lt;a href=&#34;#cb40-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-18&#34;&gt;&lt;a href=&#34;#cb40-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb40-19&#34;&gt;&lt;a href=&#34;#cb40-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb40-20&#34;&gt;&lt;a href=&#34;#cb40-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb40-21&#34;&gt;&lt;a href=&#34;#cb40-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb40-22&#34;&gt;&lt;a href=&#34;#cb40-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; cin &amp;gt;&amp;gt; T;&lt;/span&gt;
&lt;span id=&#34;cb40-23&#34;&gt;&lt;a href=&#34;#cb40-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb40-24&#34;&gt;&lt;a href=&#34;#cb40-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb40-25&#34;&gt;&lt;a href=&#34;#cb40-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;().swap(G[i]), f[i] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-26&#34;&gt;&lt;a href=&#34;#cb40-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb40-27&#34;&gt;&lt;a href=&#34;#cb40-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            cout &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-28&#34;&gt;&lt;a href=&#34;#cb40-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-29&#34;&gt;&lt;a href=&#34;#cb40-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb40-30&#34;&gt;&lt;a href=&#34;#cb40-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb40-31&#34;&gt;&lt;a href=&#34;#cb40-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; cin &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;&lt;/span&gt;
&lt;span id=&#34;cb40-32&#34;&gt;&lt;a href=&#34;#cb40-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb40-33&#34;&gt;&lt;a href=&#34;#cb40-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb40-34&#34;&gt;&lt;a href=&#34;#cb40-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; rt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-35&#34;&gt;&lt;a href=&#34;#cb40-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (G[i].size() &amp;gt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb40-36&#34;&gt;&lt;a href=&#34;#cb40-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            rt = i;&lt;/span&gt;
&lt;span id=&#34;cb40-37&#34;&gt;&lt;a href=&#34;#cb40-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-38&#34;&gt;&lt;a href=&#34;#cb40-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb40-39&#34;&gt;&lt;a href=&#34;#cb40-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-40&#34;&gt;&lt;a href=&#34;#cb40-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!rt) cout &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-41&#34;&gt;&lt;a href=&#34;#cb40-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; cout &amp;lt;&amp;lt; (dfs(rt, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;), ans) &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-42&#34;&gt;&lt;a href=&#34;#cb40-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb40-43&#34;&gt;&lt;a href=&#34;#cb40-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb40-44&#34;&gt;&lt;a href=&#34;#cb40-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr /&gt;
&lt;p&gt;å½“ç„¶æœ¬é¢˜è¿˜å¯ä»¥ä»å¦å¤–ä¸€ä¸ªè§’åº¦å‡ºå‘ï¼Œå³æ€è€ƒé—®é¢˜çš„ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬è€ƒè™‘é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…³é”®ç‚¹ä¹‹åï¼Œä»€ä¹ˆæƒ…å†µä¸‹èƒ½åŒºåˆ†æ¯ä¸ªç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è‹¥ä»¤é€‰å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…³é”®ç‚¹åœ¨æ ‘ä¸Šç”Ÿæˆä¸€å¼ â€œè¿é€šå­å›¾â€ï¼Œè¿é€šå­å›¾å†…éƒ¨çš„ç‚¹æ˜¯ä¸¤ä¸¤å¯åŒºåˆ†çš„ï¼Œè€Œåˆ™å…¶ä¼¸å‡ºå»çš„å­æ ‘ä¸­ï¼ŒåŒä¸€æ·±åº¦çš„ç‚¹æ˜¯ä¸å¯åŒºåˆ†çš„ã€‚æ‰€ä»¥&lt;strong&gt;è¿é€šå­å›¾ä¼¸å‡ºå»çš„éƒ¨åˆ†å¿…é¡»æ˜¯é“¾&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå›åˆ°åŸé—®é¢˜ï¼Œæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥é’¦å®šä¸€å¼€å§‹é€‰æ‹©æ‰€æœ‰å¶å­ä½œä¸ºå…³é”®ç‚¹ï¼Œå³å°†è¿é€šå­å›¾åˆå§‹åŒ–ä¸ºæ•´æ£µæ ‘ï¼Œç„¶åä¼šæ³¨æ„åˆ°æˆ‘ä»¬å¯ä»¥åˆ ä¸€äº›åŸæ ‘ä¸­ä»å¶å­è¿åˆ°å†…éƒ¨ç‚¹çš„é“¾ï¼ŒåŒæ—¶ä¸ç ´åä¸Šé¢â€œä¼¸å‡ºå»çš„éƒ¨åˆ†è¦æ˜¯é“¾â€çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä»å¶å­èŠ‚ç‚¹å¾€ä¸Šæœï¼Œæœåˆ°åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge 3\)&lt;/span&gt; çš„èŠ‚ç‚¹åœä¸‹æ¥æ‰“æ ‡è®°ï¼ˆæ„å‘³ç€è¿™ä¸ªå­æ ‘é‡Œé¢å¯ä»¥åˆ æ‰ä¸€æ¡é“¾ï¼‰ã€‚ç”¨æ€»å¶å­æ•°é‡å‡å»æ‰“äº†æ ‡è®°çš„ç‚¹çš„æ•°é‡å°±æ˜¯ç­”æ¡ˆã€‚æ³¨æ„ç‰¹åˆ¤é“¾çš„æƒ…å†µï¼Œä¸‹é¢ä»£ç æ˜¯ APC001E çš„ï¼Œå’Œ CF çš„æœ‰äº›è®¸å‡ºå…¥ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb41&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb41-1&#34;&gt;&lt;a href=&#34;#cb41-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-2&#34;&gt;&lt;a href=&#34;#cb41-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb41-3&#34;&gt;&lt;a href=&#34;#cb41-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-4&#34;&gt;&lt;a href=&#34;#cb41-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb41-5&#34;&gt;&lt;a href=&#34;#cb41-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-6&#34;&gt;&lt;a href=&#34;#cb41-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, vis[maxn], ans;&lt;/span&gt;
&lt;span id=&#34;cb41-7&#34;&gt;&lt;a href=&#34;#cb41-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb41-8&#34;&gt;&lt;a href=&#34;#cb41-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-9&#34;&gt;&lt;a href=&#34;#cb41-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa) {&lt;/span&gt;
&lt;span id=&#34;cb41-10&#34;&gt;&lt;a href=&#34;#cb41-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (G[u].size() &amp;gt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; u;&lt;/span&gt;
&lt;span id=&#34;cb41-11&#34;&gt;&lt;a href=&#34;#cb41-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : G[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v != fa) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; dfs(v, u);&lt;/span&gt;
&lt;span id=&#34;cb41-12&#34;&gt;&lt;a href=&#34;#cb41-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; u;&lt;/span&gt;
&lt;span id=&#34;cb41-13&#34;&gt;&lt;a href=&#34;#cb41-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb41-14&#34;&gt;&lt;a href=&#34;#cb41-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb41-15&#34;&gt;&lt;a href=&#34;#cb41-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb41-16&#34;&gt;&lt;a href=&#34;#cb41-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb41-17&#34;&gt;&lt;a href=&#34;#cb41-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb41-18&#34;&gt;&lt;a href=&#34;#cb41-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb41-19&#34;&gt;&lt;a href=&#34;#cb41-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; cin &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;&lt;/span&gt;
&lt;span id=&#34;cb41-20&#34;&gt;&lt;a href=&#34;#cb41-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++u, ++v;&lt;/span&gt;
&lt;span id=&#34;cb41-21&#34;&gt;&lt;a href=&#34;#cb41-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb41-22&#34;&gt;&lt;a href=&#34;#cb41-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb41-23&#34;&gt;&lt;a href=&#34;#cb41-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (G[i].size() == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) vis[dfs(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, ++ans;&lt;/span&gt;
&lt;span id=&#34;cb41-24&#34;&gt;&lt;a href=&#34;#cb41-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) ans -= vis[i];&lt;/span&gt;
&lt;span id=&#34;cb41-25&#34;&gt;&lt;a href=&#34;#cb41-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; (ans ? ans : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb41-26&#34;&gt;&lt;a href=&#34;#cb41-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb41-27&#34;&gt;&lt;a href=&#34;#cb41-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;e---ambiguous-dominoes&#34;&gt;1695E - Ambiguous Dominoes&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå¤šç±³è¯ºéª¨ç‰Œï¼Œæ¯å¼ éª¨ç‰Œä¸Šæœ‰ä¸¤ä¸ªæ•°å­—ï¼Œè¦æ±‚æ„é€ ä¸¤ä¸ªå°†è¿™ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªéª¨ç‰Œä¸é‡å æ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(m\times k = 2n\)&lt;/span&gt; çš„æ£‹ç›˜ &lt;span class=&#34;math inline&#34;&gt;\(a_{m\times k}\)&lt;/span&gt; ä¸­çš„æ–¹æ¡ˆï¼Œæ»¡è¶³å¯¹åº”ä½ç½®ä¸Šçš„æ•°å­—ä¸€æ ·ï¼Œä¸”è¦æ±‚ä¸¤ç§æ–¹æ¡ˆä¸­éª¨ç‰Œçš„ä½ç½®å…¨éƒ¨ä¸ä¸€æ ·ï¼Œæˆ–æŠ¥å‘Šæ— è§£ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 3\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ç‚¹æµæ°“äº†å“ˆï¼Œç‰›é€¼æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯å¼ å¤šç±³è¯ºéª¨ç‰Œ &lt;span class=&#34;math inline&#34;&gt;\((x_i, y_i)\)&lt;/span&gt;ï¼Œè¿ä¸€æ¡æ— å‘è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(x\to y\)&lt;/span&gt;ã€‚ç„¶åä¼šå‘ç°ï¼Œè‹¥ä¸€ä¸ªè¿é€šåˆ†é‡é‡Œé¢æ°å¥½åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ¡è¾¹ï¼Œè¯´æ˜è¿™æ¡è¾¹ä»£è¡¨çš„å¤šç±³è¯ºéª¨ç‰Œåªæœ‰ä¸€ç§æ‘†æ³•ï¼Œå› æ­¤æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™æ€»èƒ½æ„é€ å‡ºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(2\times k\)&lt;/span&gt; çš„æ£‹ç›˜ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºè¿é€šåˆ†é‡å†…è¾¹æ•°ï¼‰ï¼Œè§ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éšä¾¿å¯¹è¿™å¼ å›¾è¿›è¡Œæ¬§æ‹‰éå†ï¼ˆå°±æ˜¯ dfs éå†æ²¡æœ‰éå†çš„è¾¹ï¼Œç„¶åå°†ç»è¿‡çš„è¾¹å­˜ä¸‹æ¥ï¼‰ï¼Œç„¶åä¼šå‘ç°æ¯æ¡è¾¹éƒ½æ°å¥½åœ¨è¿™ä¸ªæ¬§æ‹‰åºä¸­å‡ºç°ä¸¤æ¬¡ï¼ˆè€ƒè™‘æ¬§æ‹‰åºçš„æ€§è´¨ï¼‰ï¼Œå¹¶ä¸”&lt;strong&gt;ä¸¤æ¬¡å‡ºç°çš„ä½ç½®çš„å¥‡å¶æ€§ä¸ä¸€æ ·&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•è¯æ˜ï¼Ÿè€ƒè™‘è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(e=u\to v\)&lt;/span&gt;ï¼Œè‹¥æˆ‘ä»¬çš„ dfs ç›´æ¥è¿”å›ï¼Œåˆ™æ¬§æ‹‰åºåˆ—ä¸­ä¼šå½¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(e,e\)&lt;/span&gt;ï¼Œä¸¤æ¬¡å‡ºç°ä½ç½®çš„å¥‡å¶æ€§æ˜¾ç„¶ä¸åŒã€‚å¦‚æœè¿˜è¦ç»§ç»­éå†ï¼Œç”±äºæˆ‘ä»¬ä¹‹åéå†çš„è¾¹ä¸€å®šç»å†äº†å›æº¯è¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(e\)&lt;/span&gt; ä¸­é—´å¤¹ç€å¶æ•°æ¡è¾¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(e\)&lt;/span&gt; å‡ºç°ä½ç½®çš„å¥‡å¶æ€§ä»ç„¶ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè€ƒè™‘ç‚¹çš„éå†åºï¼Œåˆ™æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2k + 1\)&lt;/span&gt; çš„é¦–å°¾ç›¸æ¥çš„åºåˆ—ï¼ˆè¿˜æ˜¯è€ƒè™‘æ¬§æ‹‰åºçš„æ€§è´¨ï¼‰ï¼Œç„¶åå°†æœ€åä¸€ä¸ªå…ƒç´ å»æ‰å¹¶å°†å…¶ä¾æ¬¡é¡ºæ—¶é’ˆæ”¾å…¥ &lt;span class=&#34;math inline&#34;&gt;\(2\times k\)&lt;/span&gt; çš„æ£‹ç›˜ä¸­ï¼Œç°åœ¨éª¨ç‰Œä»¬å¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¡è¾¹å°±å½¢æˆäº†é•¿ &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; çš„ç¯ã€‚å› ä¸ºæ¯å¼ éª¨ç‰Œ&lt;strong&gt;å‡ºç°ä½ç½®çš„å¥‡å¶æ€§ä¸ä¸€æ ·&lt;/strong&gt;ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¸¤ç§æ„é€ æ€»ä¼šæ˜¯åˆæ³•çš„ï¼ˆå›¾æºå®˜æ–¹é¢˜è§£ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://espresso.codeforces.com/8d975bc11693b0864bbc0b6e19423e4954b1b282.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯å¯¹äºä¸€ä¸ªè¿é€šå—æˆ‘ä»¬å°±æå®šäº†ã€‚å¯¹äºå¤šä¸ªè¿é€šå—çš„æƒ…å†µï¼ŒæŠŠå¾—åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(2\times k\)&lt;/span&gt; æ£‹ç›˜ä»¬æ‹¼ä¸€èµ·å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://espresso.codeforces.com/211398dfdf9487ee70a6b189aa834b35c0dd601f.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆå¯èƒ½æœ‰ä¸Šé¢çš„å›¾æ›´å¥½ç†è§£äº›ï¼‰&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb42&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb42-1&#34;&gt;&lt;a href=&#34;#cb42-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-2&#34;&gt;&lt;a href=&#34;#cb42-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-3&#34;&gt;&lt;a href=&#34;#cb42-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb42-4&#34;&gt;&lt;a href=&#34;#cb42-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb42-5&#34;&gt;&lt;a href=&#34;#cb42-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-6&#34;&gt;&lt;a href=&#34;#cb42-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb42-7&#34;&gt;&lt;a href=&#34;#cb42-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;3e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-8&#34;&gt;&lt;a href=&#34;#cb42-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; head[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], to[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], nxt[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;], cnte = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-9&#34;&gt;&lt;a href=&#34;#cb42-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, vis[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], vise[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb42-10&#34;&gt;&lt;a href=&#34;#cb42-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-11&#34;&gt;&lt;a href=&#34;#cb42-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; add(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v) {&lt;/span&gt;
&lt;span id=&#34;cb42-12&#34;&gt;&lt;a href=&#34;#cb42-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    to[++cnte] = v;&lt;/span&gt;
&lt;span id=&#34;cb42-13&#34;&gt;&lt;a href=&#34;#cb42-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    nxt[cnte] = head[u];&lt;/span&gt;
&lt;span id=&#34;cb42-14&#34;&gt;&lt;a href=&#34;#cb42-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    head[u] = cnte;&lt;/span&gt;
&lt;span id=&#34;cb42-15&#34;&gt;&lt;a href=&#34;#cb42-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-16&#34;&gt;&lt;a href=&#34;#cb42-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb42-17&#34;&gt;&lt;a href=&#34;#cb42-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-18&#34;&gt;&lt;a href=&#34;#cb42-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; path;&lt;/span&gt;
&lt;span id=&#34;cb42-19&#34;&gt;&lt;a href=&#34;#cb42-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-20&#34;&gt;&lt;a href=&#34;#cb42-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; pre) {&lt;/span&gt;
&lt;span id=&#34;cb42-21&#34;&gt;&lt;a href=&#34;#cb42-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    path.push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb42-22&#34;&gt;&lt;a href=&#34;#cb42-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[u]) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-23&#34;&gt;&lt;a href=&#34;#cb42-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vis[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-24&#34;&gt;&lt;a href=&#34;#cb42-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = head[u]; i; i = nxt[i]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vise[i]) {&lt;/span&gt;
&lt;span id=&#34;cb42-25&#34;&gt;&lt;a href=&#34;#cb42-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vise[i] = vise[i ^ &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-26&#34;&gt;&lt;a href=&#34;#cb42-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(to[i], i);&lt;/span&gt;
&lt;span id=&#34;cb42-27&#34;&gt;&lt;a href=&#34;#cb42-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        path.push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb42-28&#34;&gt;&lt;a href=&#34;#cb42-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-29&#34;&gt;&lt;a href=&#34;#cb42-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-30&#34;&gt;&lt;a href=&#34;#cb42-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb42-31&#34;&gt;&lt;a href=&#34;#cb42-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-32&#34;&gt;&lt;a href=&#34;#cb42-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ans[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;][maxn];&lt;/span&gt;
&lt;span id=&#34;cb42-33&#34;&gt;&lt;a href=&#34;#cb42-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; sol1[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;][maxn], sol2[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;][maxn];&lt;/span&gt;
&lt;span id=&#34;cb42-34&#34;&gt;&lt;a href=&#34;#cb42-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb42-35&#34;&gt;&lt;a href=&#34;#cb42-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb42-36&#34;&gt;&lt;a href=&#34;#cb42-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb42-37&#34;&gt;&lt;a href=&#34;#cb42-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb42-38&#34;&gt;&lt;a href=&#34;#cb42-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb42-39&#34;&gt;&lt;a href=&#34;#cb42-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, y; cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;&lt;/span&gt;
&lt;span id=&#34;cb42-40&#34;&gt;&lt;a href=&#34;#cb42-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        add(x, y), add(y, x);&lt;/span&gt;
&lt;span id=&#34;cb42-41&#34;&gt;&lt;a href=&#34;#cb42-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-42&#34;&gt;&lt;a href=&#34;#cb42-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; col = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-43&#34;&gt;&lt;a href=&#34;#cb42-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[i]) {&lt;/span&gt;
&lt;span id=&#34;cb42-44&#34;&gt;&lt;a href=&#34;#cb42-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;().swap(path);&lt;/span&gt;
&lt;span id=&#34;cb42-45&#34;&gt;&lt;a href=&#34;#cb42-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb42-46&#34;&gt;&lt;a href=&#34;#cb42-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (path.size() == &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;-1&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-47&#34;&gt;&lt;a href=&#34;#cb42-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (path.size() &amp;lt; &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-48&#34;&gt;&lt;a href=&#34;#cb42-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        path.pop_back();&lt;/span&gt;
&lt;span id=&#34;cb42-49&#34;&gt;&lt;a href=&#34;#cb42-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = path.size() &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-50&#34;&gt;&lt;a href=&#34;#cb42-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; it = path.begin();&lt;/span&gt;
&lt;span id=&#34;cb42-51&#34;&gt;&lt;a href=&#34;#cb42-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, k) ans[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][i + col] = *it++;&lt;/span&gt;
&lt;span id=&#34;cb42-52&#34;&gt;&lt;a href=&#34;#cb42-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, k, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][i + col] = *it++;&lt;/span&gt;
&lt;span id=&#34;cb42-53&#34;&gt;&lt;a href=&#34;#cb42-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; i &amp;lt;= k; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) sol1[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + i] = sol1[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + i] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;, sol1[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = sol1[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;L&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-54&#34;&gt;&lt;a href=&#34;#cb42-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;; i &amp;lt;= k; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) sol2[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + i] = sol2[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + i] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;R&amp;#39;&lt;/span&gt;, sol2[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = sol2[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;L&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-55&#34;&gt;&lt;a href=&#34;#cb42-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) sol1[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + k] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;, sol1[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + k] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;D&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-56&#34;&gt;&lt;a href=&#34;#cb42-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; sol2[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + k] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;, sol2[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + k] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;D&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-57&#34;&gt;&lt;a href=&#34;#cb42-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        sol2[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][col + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;, sol2[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][col + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;D&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-58&#34;&gt;&lt;a href=&#34;#cb42-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        col += k;&lt;/span&gt;
&lt;span id=&#34;cb42-59&#34;&gt;&lt;a href=&#34;#cb42-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-60&#34;&gt;&lt;a href=&#34;#cb42-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; col &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-61&#34;&gt;&lt;a href=&#34;#cb42-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb42-62&#34;&gt;&lt;a href=&#34;#cb42-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, col) cout &amp;lt;&amp;lt; ans[i][j] &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-63&#34;&gt;&lt;a href=&#34;#cb42-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-64&#34;&gt;&lt;a href=&#34;#cb42-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-65&#34;&gt;&lt;a href=&#34;#cb42-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb42-66&#34;&gt;&lt;a href=&#34;#cb42-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, col) cout &amp;lt;&amp;lt; sol1[i][j];&lt;/span&gt;
&lt;span id=&#34;cb42-67&#34;&gt;&lt;a href=&#34;#cb42-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-68&#34;&gt;&lt;a href=&#34;#cb42-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-69&#34;&gt;&lt;a href=&#34;#cb42-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb42-70&#34;&gt;&lt;a href=&#34;#cb42-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, col) cout &amp;lt;&amp;lt; sol2[i][j];&lt;/span&gt;
&lt;span id=&#34;cb42-71&#34;&gt;&lt;a href=&#34;#cb42-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-72&#34;&gt;&lt;a href=&#34;#cb42-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb42-73&#34;&gt;&lt;a href=&#34;#cb42-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb42-74&#34;&gt;&lt;a href=&#34;#cb42-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-802-div.-2&#34;&gt;Codeforces Round #802 (Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;e---serega-the-pirate&#34;&gt;1700E - Serega the Pirate&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å®¹æ˜“åˆ¤ï¼Œä¸‹é¢è€ƒè™‘å¦‚ä½•åˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä»¥åŠå¯¹æ–¹æ¡ˆè®¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°æ•´ä¸ªçŸ©é˜µå¯è§£ç­‰ä»·äºå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„æ ¼å­éƒ½å­˜åœ¨æƒå€¼å°äºä»–çš„æ ¼å­ä¸å…¶å››è”é€šï¼Œå……åˆ†æ€§å¯ä½¿ç”¨å½’çº³è¯æ˜ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±å°†é‚£äº›å››å‘¨ä¸å­˜åœ¨æ¯”ä»–å°ä¸” &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 1\)&lt;/span&gt; çš„æ ¼å­ä¸ºåçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ¬¡äº¤æ¢æˆ‘ä»¬æœ€å¤šå¯ä»¥æ”¹å˜ &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; ä¸ªæ ¼å­çš„çŠ¶æ€ï¼ˆä¸¤ä¸ªæœ¬èº«ï¼Œä»¥åŠä»–ä»¬å››å‘¨ï¼‰ï¼Œæ‰€ä»¥åç‚¹å¤šäº &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; ä¸ªç­”æ¡ˆå¿…ç„¶æ˜¯ Noã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”ï¼Œä¸€æ¬¡äº¤æ¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬äº¤æ¢çš„å…¶ä¸­ä¸€ä¸ªç‚¹å¿…ç„¶æ˜¯æŸä¸ªåç‚¹æˆ–å…¶æ—è¾¹çš„å››ä¸ªæ ¼å­ï¼Œä¸€å…± &lt;span class=&#34;math inline&#34;&gt;\(5\)&lt;/span&gt; ä¸ªæ ¼å­ï¼Œè€ƒè™‘æšä¸¾ä¹‹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; æšä¸¾å¦ä¸€ä¸ªç‚¹ï¼Œäº¤æ¢çš„æ—¶å€™æˆ‘ä»¬åªéœ€åˆ¤æ–­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰çš„åç‚¹æ˜¯å¦è¢«éƒ½è¦†ç›–åˆ°äº†ï¼ˆæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; ä¸ªï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;äº¤æ¢ä¹‹åå½±å“åˆ°çš„æ ¼å­æ˜¯å¦åˆæ³•ï¼ˆæœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; ä¸ªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt;ï¼Œå¸¦ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(20\times 5\)&lt;/span&gt; çš„å¸¸æ•°ã€‚ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„æƒ…å†µè·‘çš„æ—¶å€™é¡ºä¾¿å°±å¯ä»¥è®¡æ•°ï¼Œå¦‚æœè·‘ä¸å‡ºæ¥é‚£ä¹ˆå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…å®ç°éœ€è¦æ³¨æ„å¸¸æ•°é—®é¢˜ï¼Œä»¥åŠ&lt;strong&gt;è·‘ç‚¹å¯¹çš„æ—¶å€™è¦å»é‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb43&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb43-1&#34;&gt;&lt;a href=&#34;#cb43-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-2&#34;&gt;&lt;a href=&#34;#cb43-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-3&#34;&gt;&lt;a href=&#34;#cb43-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb43-4&#34;&gt;&lt;a href=&#34;#cb43-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define szof&lt;/span&gt;(a)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;((&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a).size())&lt;/span&gt;
&lt;span id=&#34;cb43-5&#34;&gt;&lt;a href=&#34;#cb43-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-6&#34;&gt;&lt;a href=&#34;#cb43-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb43-7&#34;&gt;&lt;a href=&#34;#cb43-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-8&#34;&gt;&lt;a href=&#34;#cb43-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, ans;&lt;/span&gt;
&lt;span id=&#34;cb43-9&#34;&gt;&lt;a href=&#34;#cb43-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; &amp;gt; a, vis, val;&lt;/span&gt;
&lt;span id=&#34;cb43-10&#34;&gt;&lt;a href=&#34;#cb43-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pii&amp;gt; bad;&lt;/span&gt;
&lt;span id=&#34;cb43-11&#34;&gt;&lt;a href=&#34;#cb43-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fx[] = {&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb43-12&#34;&gt;&lt;a href=&#34;#cb43-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fy[] = {&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb43-13&#34;&gt;&lt;a href=&#34;#cb43-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-14&#34;&gt;&lt;a href=&#34;#cb43-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; bound(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y) {&lt;/span&gt;
&lt;span id=&#34;cb43-15&#34;&gt;&lt;a href=&#34;#cb43-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;lt;= m &amp;amp;&amp;amp; x &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; y &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-16&#34;&gt;&lt;a href=&#34;#cb43-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb43-17&#34;&gt;&lt;a href=&#34;#cb43-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-18&#34;&gt;&lt;a href=&#34;#cb43-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y) {&lt;/span&gt;
&lt;span id=&#34;cb43-19&#34;&gt;&lt;a href=&#34;#cb43-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a[x][y] == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; ||&lt;/span&gt;
&lt;span id=&#34;cb43-20&#34;&gt;&lt;a href=&#34;#cb43-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;           (x + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;= n &amp;amp;&amp;amp; a[x][y] &amp;gt; a[x + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][y]) ||&lt;/span&gt;
&lt;span id=&#34;cb43-21&#34;&gt;&lt;a href=&#34;#cb43-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;           (x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; a[x][y] &amp;gt; a[x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][y]) ||&lt;/span&gt;
&lt;span id=&#34;cb43-22&#34;&gt;&lt;a href=&#34;#cb43-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;           (y + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;= m &amp;amp;&amp;amp; a[x][y] &amp;gt; a[x][y + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) ||&lt;/span&gt;
&lt;span id=&#34;cb43-23&#34;&gt;&lt;a href=&#34;#cb43-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;           (y - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; a[x][y] &amp;gt; a[x][y - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb43-24&#34;&gt;&lt;a href=&#34;#cb43-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb43-25&#34;&gt;&lt;a href=&#34;#cb43-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-26&#34;&gt;&lt;a href=&#34;#cb43-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x1, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y1, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x2, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; y2) {&lt;/span&gt;
&lt;span id=&#34;cb43-27&#34;&gt;&lt;a href=&#34;#cb43-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    swap(a[x1][y1], a[x2][y2]);&lt;/span&gt;
&lt;span id=&#34;cb43-28&#34;&gt;&lt;a href=&#34;#cb43-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-29&#34;&gt;&lt;a href=&#34;#cb43-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb43-30&#34;&gt;&lt;a href=&#34;#cb43-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = x1 + fx[k], y = y1 + fy[k];&lt;/span&gt;
&lt;span id=&#34;cb43-31&#34;&gt;&lt;a href=&#34;#cb43-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!bound(x, y) || vis[x][y]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-32&#34;&gt;&lt;a href=&#34;#cb43-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vis[x][y] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt += val[x][y] - (!check(x, y));&lt;/span&gt;
&lt;span id=&#34;cb43-33&#34;&gt;&lt;a href=&#34;#cb43-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb43-34&#34;&gt;&lt;a href=&#34;#cb43-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb43-35&#34;&gt;&lt;a href=&#34;#cb43-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = x2 + fx[k], y = y2 + fy[k];&lt;/span&gt;
&lt;span id=&#34;cb43-36&#34;&gt;&lt;a href=&#34;#cb43-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!bound(x, y) || vis[x][y]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-37&#34;&gt;&lt;a href=&#34;#cb43-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vis[x][y] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt += val[x][y] - (!check(x, y));&lt;/span&gt;
&lt;span id=&#34;cb43-38&#34;&gt;&lt;a href=&#34;#cb43-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb43-39&#34;&gt;&lt;a href=&#34;#cb43-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb43-40&#34;&gt;&lt;a href=&#34;#cb43-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = x1 + fx[k], y = y1 + fy[k];&lt;/span&gt;
&lt;span id=&#34;cb43-41&#34;&gt;&lt;a href=&#34;#cb43-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (bound(x, y)) vis[x][y] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-42&#34;&gt;&lt;a href=&#34;#cb43-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x = x2 + fx[k], y = y2 + fy[k];&lt;/span&gt;
&lt;span id=&#34;cb43-43&#34;&gt;&lt;a href=&#34;#cb43-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (bound(x, y)) vis[x][y] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-44&#34;&gt;&lt;a href=&#34;#cb43-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb43-45&#34;&gt;&lt;a href=&#34;#cb43-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    swap(a[x1][y1], a[x2][y2]);&lt;/span&gt;
&lt;span id=&#34;cb43-46&#34;&gt;&lt;a href=&#34;#cb43-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; cnt == bad.size();&lt;/span&gt;
&lt;span id=&#34;cb43-47&#34;&gt;&lt;a href=&#34;#cb43-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb43-48&#34;&gt;&lt;a href=&#34;#cb43-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-49&#34;&gt;&lt;a href=&#34;#cb43-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;unordered_set&amp;lt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;&amp;gt; S;&lt;/span&gt;
&lt;span id=&#34;cb43-50&#34;&gt;&lt;a href=&#34;#cb43-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb43-51&#34;&gt;&lt;a href=&#34;#cb43-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb43-52&#34;&gt;&lt;a href=&#34;#cb43-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb43-53&#34;&gt;&lt;a href=&#34;#cb43-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;&lt;/span&gt;
&lt;span id=&#34;cb43-54&#34;&gt;&lt;a href=&#34;#cb43-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a.resize(n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), vis.resize(n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), val.resize(n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb43-55&#34;&gt;&lt;a href=&#34;#cb43-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb43-56&#34;&gt;&lt;a href=&#34;#cb43-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[i].resize(m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), vis[i].resize(m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), val[i].resize(m + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb43-57&#34;&gt;&lt;a href=&#34;#cb43-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) cin &amp;gt;&amp;gt; a[i][j];&lt;/span&gt;
&lt;span id=&#34;cb43-58&#34;&gt;&lt;a href=&#34;#cb43-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb43-59&#34;&gt;&lt;a href=&#34;#cb43-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(x, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(y, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!check(x, y)) bad.push_back({x, y}), val[x][y] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-60&#34;&gt;&lt;a href=&#34;#cb43-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (bad.size() &amp;gt; &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-61&#34;&gt;&lt;a href=&#34;#cb43-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (bad.empty()) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;0&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-62&#34;&gt;&lt;a href=&#34;#cb43-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb43-63&#34;&gt;&lt;a href=&#34;#cb43-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = bad[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;].first + fx[k], y = bad[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;].second + fy[k];&lt;/span&gt;
&lt;span id=&#34;cb43-64&#34;&gt;&lt;a href=&#34;#cb43-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!bound(x, y)) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-65&#34;&gt;&lt;a href=&#34;#cb43-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb43-66&#34;&gt;&lt;a href=&#34;#cb43-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; hsh1 = ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * (x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * m + y) * (n * m)) + ((i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * m + j),&lt;/span&gt;
&lt;span id=&#34;cb43-67&#34;&gt;&lt;a href=&#34;#cb43-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    hsh2 = ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * (i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * m + j) * (n * m)) + ((x - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) * m + y);&lt;/span&gt;
&lt;span id=&#34;cb43-68&#34;&gt;&lt;a href=&#34;#cb43-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!S.count(hsh1) &amp;amp;&amp;amp; !S.count(hsh2)) ans += check(x, y, i, j), S.insert(hsh1), S.insert(hsh2);&lt;/span&gt;
&lt;span id=&#34;cb43-69&#34;&gt;&lt;a href=&#34;#cb43-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb43-70&#34;&gt;&lt;a href=&#34;#cb43-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb43-71&#34;&gt;&lt;a href=&#34;#cb43-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!ans) puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb43-72&#34;&gt;&lt;a href=&#34;#cb43-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;1 &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb43-73&#34;&gt;&lt;a href=&#34;#cb43-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb43-74&#34;&gt;&lt;a href=&#34;#cb43-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeforces-round-807-div-2.&#34;&gt;Codeforces Round #807 (Div 2.)&lt;/h2&gt;
&lt;h3 id=&#34;f---mark-and-the-online-exam&#34;&gt;1705F - Mark and the Online Exam&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šçŒœä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\le 1000\)&lt;/span&gt; çš„ 0-1 åºåˆ—ï¼Œæœ€å¤šçŒœ &lt;span class=&#34;math inline&#34;&gt;\(675\)&lt;/span&gt; æ¬¡ï¼Œäº¤äº’åº“ä¼šè¿”å›çŒœå¯¹çš„ä½ç½®æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/T183641&#34;&gt;åŸé¢˜&lt;/a&gt;ï¼Œ&lt;a href=&#34;https://www.luogu.com.cn/problem/P7848&#34;&gt;åŸé¢˜&lt;/a&gt;ï¼Œ&lt;a href=&#34;https://www.luogu.com.cn/blog/1973224568qq/kao-shi-2021-coe-iii-d#&#34;&gt;é¢˜è§£&lt;/a&gt;ï¼Œå…¶å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n=5000\)&lt;/span&gt; çš„é™åˆ¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(q\le 1026\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(n / \log n\)&lt;/span&gt; çº§åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„æµ…ç¿»è¯‘ä¸€ä¸‹å®˜æ–¹é¢˜è§£çš„ &lt;span class=&#34;math inline&#34;&gt;\(q \approx 2/3n\)&lt;/span&gt; çš„åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆé¢„å¤„ç†è¯¢é—® &lt;code&gt;TTT...TTT&lt;/code&gt; å’Œ &lt;code&gt;TFTFTF...TF&lt;/code&gt;ï¼Œç„¶åå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i= 1,2,\cdots, \lfloor n /3\rfloor\)&lt;/span&gt;ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(2i - 1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(2i\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œå…·ä½“åœ°æˆ‘ä»¬å°†å…¶è®¾ä¸º &lt;code&gt;F&lt;/code&gt;ï¼Œå…¶ä»–éƒ½æ˜¯ &lt;code&gt;T&lt;/code&gt;ï¼Œç„¶åç®—å¾—çš„ç­”æ¡ˆå’Œå…¨ &lt;code&gt;T&lt;/code&gt; çš„æ¯”è¾ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(+2\)&lt;/span&gt;ï¼Œåˆ™ä¸¤ä¸ªéƒ½æ˜¯ &lt;code&gt;F&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œåˆ™ä¸¤ä¸ªéƒ½æ˜¯ &lt;code&gt;T&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œåˆ™è¦ä¹ˆ &lt;code&gt;FT&lt;/code&gt; è¦ä¹ˆ &lt;code&gt;TR&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºå¦å¤–ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€æ¬¡é¢å¤–çš„è¯¢é—®æ¥åˆ¤æ–­ï¼Œå³å°†å…¶ä¸ &lt;code&gt;TFTFTF...&lt;/code&gt; çš„æ¯”è¾ƒï¼š &lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\mathrm{TFTF}...\mathrm{TF}...\mathrm{T}...\mathrm{TF}\\
\mathrm{TFTF}...\mathrm{\color{red}FT}...\mathrm{\color{red}F}...\mathrm{TF}\\
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç­”æ¡ˆä¸º &lt;code&gt;TFT&lt;/code&gt;ï¼Œåˆ™å·®è·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-3\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ç­”æ¡ˆä¸º &lt;code&gt;TFF&lt;/code&gt;ï¼Œåˆ™å·®è·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ç­”æ¡ˆä¸º &lt;code&gt;FTT&lt;/code&gt;ï¼Œåˆ™å·®è·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(+1\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ç­”æ¡ˆä¸º &lt;code&gt;FTF&lt;/code&gt;ï¼Œåˆ™å·®è·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(+3\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¾€å³è¾¹å¤šè¯¢é—®ä¸€ä½å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†ã€‚è§£å†³ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªä½ç½®éœ€è¦ä¸¤ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; çš„çº§åˆ«å¤§æ¦‚æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2/3q\)&lt;/span&gt;ï¼Œè¶³ä»¥é€šè¿‡æœ¬é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb44&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb44-1&#34;&gt;&lt;a href=&#34;#cb44-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-2&#34;&gt;&lt;a href=&#34;#cb44-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb44-3&#34;&gt;&lt;a href=&#34;#cb44-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-4&#34;&gt;&lt;a href=&#34;#cb44-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb44-5&#34;&gt;&lt;a href=&#34;#cb44-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-6&#34;&gt;&lt;a href=&#34;#cb44-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(string s) {&lt;/span&gt;
&lt;span id=&#34;cb44-7&#34;&gt;&lt;a href=&#34;#cb44-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; s &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb44-8&#34;&gt;&lt;a href=&#34;#cb44-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout.flush();&lt;/span&gt;
&lt;span id=&#34;cb44-9&#34;&gt;&lt;a href=&#34;#cb44-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x; cin &amp;gt;&amp;gt; x;&lt;/span&gt;
&lt;span id=&#34;cb44-10&#34;&gt;&lt;a href=&#34;#cb44-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x == n) puts(n &amp;gt; &lt;span class=&#34;dv&#34;&gt;100&lt;/span&gt; ? &lt;span class=&#34;st&#34;&gt;&amp;quot;sb&amp;quot;&lt;/span&gt; : &lt;span class=&#34;st&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;), exit(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb44-11&#34;&gt;&lt;a href=&#34;#cb44-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; x;&lt;/span&gt;
&lt;span id=&#34;cb44-12&#34;&gt;&lt;a href=&#34;#cb44-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb44-13&#34;&gt;&lt;a href=&#34;#cb44-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-14&#34;&gt;&lt;a href=&#34;#cb44-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb44-15&#34;&gt;&lt;a href=&#34;#cb44-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb44-16&#34;&gt;&lt;a href=&#34;#cb44-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    string allT(n, &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;), ans(n, &lt;span class=&#34;ch&#34;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb44-17&#34;&gt;&lt;a href=&#34;#cb44-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cntT = query(allT);&lt;/span&gt;
&lt;span id=&#34;cb44-18&#34;&gt;&lt;a href=&#34;#cb44-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-19&#34;&gt;&lt;a href=&#34;#cb44-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    string allTF(n, &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb44-20&#34;&gt;&lt;a href=&#34;#cb44-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt; n; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) allTF[i] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-21&#34;&gt;&lt;a href=&#34;#cb44-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cntTF = query(allTF);&lt;/span&gt;
&lt;span id=&#34;cb44-22&#34;&gt;&lt;a href=&#34;#cb44-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-23&#34;&gt;&lt;a href=&#34;#cb44-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-24&#34;&gt;&lt;a href=&#34;#cb44-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (r &amp;gt;= l) {&lt;/span&gt;
&lt;span id=&#34;cb44-25&#34;&gt;&lt;a href=&#34;#cb44-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r == l) {&lt;/span&gt;
&lt;span id=&#34;cb44-26&#34;&gt;&lt;a href=&#34;#cb44-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            string s(allT);&lt;/span&gt;
&lt;span id=&#34;cb44-27&#34;&gt;&lt;a href=&#34;#cb44-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            s[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-28&#34;&gt;&lt;a href=&#34;#cb44-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = query(s);&lt;/span&gt;
&lt;span id=&#34;cb44-29&#34;&gt;&lt;a href=&#34;#cb44-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;gt; cntT) ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-30&#34;&gt;&lt;a href=&#34;#cb44-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-31&#34;&gt;&lt;a href=&#34;#cb44-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ++l, --r;&lt;/span&gt;
&lt;span id=&#34;cb44-32&#34;&gt;&lt;a href=&#34;#cb44-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb44-33&#34;&gt;&lt;a href=&#34;#cb44-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            string s(allT);&lt;/span&gt;
&lt;span id=&#34;cb44-34&#34;&gt;&lt;a href=&#34;#cb44-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            s[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, s[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-35&#34;&gt;&lt;a href=&#34;#cb44-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = query(s) - cntT;&lt;/span&gt;
&lt;span id=&#34;cb44-36&#34;&gt;&lt;a href=&#34;#cb44-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb44-37&#34;&gt;&lt;a href=&#34;#cb44-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans[l] = ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-38&#34;&gt;&lt;a href=&#34;#cb44-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                l += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-39&#34;&gt;&lt;a href=&#34;#cb44-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == -&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb44-40&#34;&gt;&lt;a href=&#34;#cb44-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans[l] = ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-41&#34;&gt;&lt;a href=&#34;#cb44-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                l += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-42&#34;&gt;&lt;a href=&#34;#cb44-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb44-43&#34;&gt;&lt;a href=&#34;#cb44-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (r == l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb44-44&#34;&gt;&lt;a href=&#34;#cb44-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    s = allT, s[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-45&#34;&gt;&lt;a href=&#34;#cb44-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = query(s);&lt;/span&gt;
&lt;span id=&#34;cb44-46&#34;&gt;&lt;a href=&#34;#cb44-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k &amp;gt; cntT) ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-47&#34;&gt;&lt;a href=&#34;#cb44-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;, ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-48&#34;&gt;&lt;a href=&#34;#cb44-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    l += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-49&#34;&gt;&lt;a href=&#34;#cb44-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb44-50&#34;&gt;&lt;a href=&#34;#cb44-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    s = allTF;&lt;/span&gt;
&lt;span id=&#34;cb44-51&#34;&gt;&lt;a href=&#34;#cb44-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    s[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, s[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-52&#34;&gt;&lt;a href=&#34;#cb44-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (s[r] == &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;) s[r] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-53&#34;&gt;&lt;a href=&#34;#cb44-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; s[r] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-54&#34;&gt;&lt;a href=&#34;#cb44-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-55&#34;&gt;&lt;a href=&#34;#cb44-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = query(s) - cntTF;&lt;/span&gt;
&lt;span id=&#34;cb44-56&#34;&gt;&lt;a href=&#34;#cb44-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;, ans[r] = s[r];&lt;/span&gt;
&lt;span id=&#34;cb44-57&#34;&gt;&lt;a href=&#34;#cb44-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;, ans[r] = allTF[r];&lt;/span&gt;
&lt;span id=&#34;cb44-58&#34;&gt;&lt;a href=&#34;#cb44-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;, ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, ans[r] = s[r];&lt;/span&gt;
&lt;span id=&#34;cb44-59&#34;&gt;&lt;a href=&#34;#cb44-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; ans[l] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;T&amp;#39;&lt;/span&gt;, ans[l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = &lt;span class=&#34;ch&#34;&gt;&amp;#39;F&amp;#39;&lt;/span&gt;, ans[r] = allTF[r];&lt;/span&gt;
&lt;span id=&#34;cb44-60&#34;&gt;&lt;a href=&#34;#cb44-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb44-61&#34;&gt;&lt;a href=&#34;#cb44-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    l += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, --r;&lt;/span&gt;
&lt;span id=&#34;cb44-62&#34;&gt;&lt;a href=&#34;#cb44-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                }&lt;/span&gt;
&lt;span id=&#34;cb44-63&#34;&gt;&lt;a href=&#34;#cb44-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb44-64&#34;&gt;&lt;a href=&#34;#cb44-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb44-65&#34;&gt;&lt;a href=&#34;#cb44-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb44-66&#34;&gt;&lt;a href=&#34;#cb44-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    query(ans);&lt;/span&gt;
&lt;span id=&#34;cb44-67&#34;&gt;&lt;a href=&#34;#cb44-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb44-68&#34;&gt;&lt;a href=&#34;#cb44-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;codeton-round-2&#34;&gt;CodeTON Round 2&lt;/h2&gt;
&lt;h3 id=&#34;f---colouring-game&#34;&gt;1704F - Colouring Game&lt;/h3&gt;
&lt;p&gt;åœ¨æœ‰ &lt;code&gt;RB&lt;/code&gt; å’Œ &lt;code&gt;BR&lt;/code&gt; çš„æ—¶å€™ï¼ŒåŒæ–¹ç­–ç•¥éƒ½æ˜¯å…ˆç›´æ¥å»æ¶ˆè¿™ä¸ªï¼Œå› ä¸ºè¿™æ ·èƒ½å°½å¯èƒ½æ¶ˆè€—å¯¹é¢çš„å­—æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ²¡æœ‰ç›¸é‚»çº¢è“æ–¹æ ¼ä¹‹åï¼Œè¿™ä¸ªè‚¯å®šå°±æ˜¯åæ‰‹å¿…èƒœäº†ã€‚æ‰€ä»¥åªè€ƒè™‘ç¬¬ä¸€é˜¶æ®µï¼Œå…¬å¹³ç»„åˆæ¸¸æˆï¼Œæ±‚ SGï¼Œæ‰“è¡¨&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-813-div.-2&#34;&gt;Codeforces Round #813 (Div. 2)&lt;/h2&gt;
&lt;h3 id=&#34;e2---lcm-sum-hard-version&#34;&gt;1712E2 - LCM Sum (hard version)&lt;/h3&gt;
&lt;p&gt;é¢˜æ„ï¼šé—®æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(l\le i&amp;lt; j &amp;lt; k\le r\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{lcm}(i,j,k)\ge i + j + k\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\((i,j,k)\)&lt;/span&gt; å¯¹æ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(T\le 2\times 10^5\)&lt;/span&gt; ç»„è¯¢é—®ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(l,r\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ E1ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; å¾ˆå°çš„æƒ…å†µã€‚é¦–å…ˆè½¬åŒ–ä¸ºæ•° &lt;span class=&#34;math inline&#34;&gt;\([i,j,k] &amp;lt; i + j +k\)&lt;/span&gt; çš„æƒ…å†µï¼Œè€Œè¿™æ ·çš„ &lt;span class=&#34;math inline&#34;&gt;\([i,j,k]\)&lt;/span&gt; æ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; 3k\)&lt;/span&gt;ï¼Œæ‰€ä»¥å–å€¼åªèƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(2k\)&lt;/span&gt;ã€‚é‚£ä¹ˆè€ƒè™‘æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\([i,j,k] = k\)&lt;/span&gt; çš„æƒ…å†µå¾ˆå¥½å¤„ç†ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; éœ€è¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å› æ•°ï¼Œæ­¤æ—¶æ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;lt;i + j + k\)&lt;/span&gt;ï¼Œå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{lcm} = 2k\)&lt;/span&gt; çš„æƒ…å†µï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i,j,k\)&lt;/span&gt; åªå¯èƒ½å½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(3t,4t,6t\)&lt;/span&gt; æˆ–è€… &lt;span class=&#34;math inline&#34;&gt;\(6t, 10t, 15t\)&lt;/span&gt; çš„å½¢å¼ï¼ˆæ‰“è¡¨å¯ä»¥å‘ç°ï¼‰ï¼Œä¸‹é¢ç»™å‡ºè¯æ˜ï¼š&lt;/p&gt;
&lt;p&gt;å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i+j &amp;gt; k \land i &amp;lt; j\)&lt;/span&gt;ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;gt; k / 2\)&lt;/span&gt;ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(2k = j\times p\)&lt;/span&gt;ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(k/2 &amp;lt; 2k/p &amp;lt; k\)&lt;/span&gt;ï¼Œè§£å¾— &lt;span class=&#34;math inline&#34;&gt;\(2&amp;lt;p&amp;lt;4\)&lt;/span&gt;ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(p = 3\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(j = 2k/3\)&lt;/span&gt;ã€‚ç”± &lt;span class=&#34;math inline&#34;&gt;\(i + j &amp;gt; k\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i &amp;gt; k / 3\)&lt;/span&gt;ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(2k = i \times q\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(k / 3 &amp;lt; 2k/q &amp;lt; k\)&lt;/span&gt;ï¼Œè§£å¾— &lt;span class=&#34;math inline&#34;&gt;\(3&amp;lt;q&amp;lt;6\)&lt;/span&gt;ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(q= 4\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(5\)&lt;/span&gt;ï¼Œå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(i = k / 2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(2k / 5\)&lt;/span&gt;ã€‚è¯æ¯•ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(15\mid k\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(6\mid k\)&lt;/span&gt; çš„æ—¶å€™ï¼Œç‰¹åˆ¤ä¸€ä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb45&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb45-1&#34;&gt;&lt;a href=&#34;#cb45-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-2&#34;&gt;&lt;a href=&#34;#cb45-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-3&#34;&gt;&lt;a href=&#34;#cb45-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb45-4&#34;&gt;&lt;a href=&#34;#cb45-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define szof&lt;/span&gt;(a)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;((&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a).size())&lt;/span&gt;
&lt;span id=&#34;cb45-5&#34;&gt;&lt;a href=&#34;#cb45-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-6&#34;&gt;&lt;a href=&#34;#cb45-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb45-7&#34;&gt;&lt;a href=&#34;#cb45-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb45-8&#34;&gt;&lt;a href=&#34;#cb45-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;4e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;, N = &lt;span class=&#34;fl&#34;&gt;4e5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb45-9&#34;&gt;&lt;a href=&#34;#cb45-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; fact[maxn];&lt;/span&gt;
&lt;span id=&#34;cb45-10&#34;&gt;&lt;a href=&#34;#cb45-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-11&#34;&gt;&lt;a href=&#34;#cb45-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll binom(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; (n - &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) * (n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) * n / &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt;;}&lt;/span&gt;
&lt;span id=&#34;cb45-12&#34;&gt;&lt;a href=&#34;#cb45-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-13&#34;&gt;&lt;a href=&#34;#cb45-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; r) { &lt;span class=&#34;co&#34;&gt;// count lcm(i, j, k) &amp;lt; i + j + k&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-14&#34;&gt;&lt;a href=&#34;#cb45-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb45-15&#34;&gt;&lt;a href=&#34;#cb45-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(k, l + &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, r) {&lt;/span&gt;
&lt;span id=&#34;cb45-16&#34;&gt;&lt;a href=&#34;#cb45-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb45-17&#34;&gt;&lt;a href=&#34;#cb45-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x : fact[k]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (x &amp;gt;= l &amp;amp;&amp;amp; x &amp;lt; k) ++cnt;&lt;/span&gt;
&lt;span id=&#34;cb45-18&#34;&gt;&lt;a href=&#34;#cb45-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret += cnt * (cnt - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;) / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;; &lt;span class=&#34;co&#34;&gt;// lcm = k&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-19&#34;&gt;&lt;a href=&#34;#cb45-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k % &lt;span class=&#34;dv&#34;&gt;6&lt;/span&gt; == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; k / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; &amp;gt;= l) ++ret;&lt;/span&gt;
&lt;span id=&#34;cb45-20&#34;&gt;&lt;a href=&#34;#cb45-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (k % &lt;span class=&#34;dv&#34;&gt;15&lt;/span&gt; == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; k * &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; / &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt; &amp;gt;= l) ++ret; &lt;span class=&#34;co&#34;&gt;// lcm = 2k&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-21&#34;&gt;&lt;a href=&#34;#cb45-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb45-22&#34;&gt;&lt;a href=&#34;#cb45-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb45-23&#34;&gt;&lt;a href=&#34;#cb45-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb45-24&#34;&gt;&lt;a href=&#34;#cb45-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb45-25&#34;&gt;&lt;a href=&#34;#cb45-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb45-26&#34;&gt;&lt;a href=&#34;#cb45-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, N) &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = i; j &amp;lt;= N; j += i) fact[j].emplace_back(i);&lt;/span&gt;
&lt;span id=&#34;cb45-27&#34;&gt;&lt;a href=&#34;#cb45-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; cin &amp;gt;&amp;gt; T;&lt;/span&gt;
&lt;span id=&#34;cb45-28&#34;&gt;&lt;a href=&#34;#cb45-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb45-29&#34;&gt;&lt;a href=&#34;#cb45-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; l, r; cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;&lt;/span&gt;
&lt;span id=&#34;cb45-30&#34;&gt;&lt;a href=&#34;#cb45-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; binom(r - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) - solve(l, r) &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb45-31&#34;&gt;&lt;a href=&#34;#cb45-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb45-32&#34;&gt;&lt;a href=&#34;#cb45-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb45-33&#34;&gt;&lt;a href=&#34;#cb45-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¯¹äº E2ï¼Œæˆ‘ä»¬å°†ä¸Šé¢è¿™ä¸ªè¿‡ç¨‹ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å³å¯ï¼Œå€’åºæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt;ï¼Œç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚ç›¸å½“äºæˆ‘ä»¬å…¶å®éœ€è¦ç»´æŠ¤å› æ•°é›†åˆçš„å¤§å°ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(x(x-1)/2\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((x+1)x/2\)&lt;/span&gt; ä¹‹é—´ç›¸å·® &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæ‰€ä»¥ç”¨æ ‘çŠ¶æ•°ç»„è¿˜æ˜¯æ¯”è¾ƒå¥½ç»´æŠ¤çš„ã€‚è€Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{lcm} = 2k\)&lt;/span&gt; çš„æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬æšä¸¾çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ‰€ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(3\mid i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(6\mid i\)&lt;/span&gt; çš„æ—¶å€™åˆ¤ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;codeforces-round-815-div.-2&#34;&gt;Codeforces Round #815 (Div. 2)&lt;/h2&gt;
&lt;p&gt;A FST äº†ï¼Œæœ¬æ¥èƒ½æ‰“å‡º 2400+ çš„ perf çš„ &lt;img src=&#34;https://å•§.tk/tuu&#34; /&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e---misha-and-paintings&#34;&gt;1720E - Misha and Paintings&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; çš„çŸ©é˜µï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 500\)&lt;/span&gt;ï¼Œæ¯ä¸ªä½ç½®æœ‰ä¸€ä¸ªå€¼ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(1\le v\le n^2\)&lt;/span&gt;ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ä¸ªå­æ–¹é˜µç„¶åç›´æ¥æŸ“è‰²ï¼Œè¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(1\le x\le n^2\)&lt;/span&gt;ã€‚ç°åœ¨ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé—®æœ€å°‘å¤šå°‘æ¬¡æ“ä½œä½¿å¾—çŸ©é˜µä¸­ä¸åŒçš„æ•°åˆšå¥½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œè®¾ä¸€å¼€å§‹æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç§ä¸åŒçš„æ•°ï¼Œåˆ™è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(m \le k\)&lt;/span&gt;ï¼Œåˆ™æ˜¾ç„¶ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(k - m\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(k &amp;lt; m\)&lt;/span&gt; çš„æƒ…å†µï¼Œä¸‹é¢ç»™å‡ºç­”æ¡ˆä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; çš„æ„é€ è¯æ˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é€‰ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; çš„å°½å¯èƒ½å¤§çš„æ­£æ–¹å½¢ï¼Œå°†é‡Œé¢å…¨éƒ¨æ¶‚ä¸ºä¸€ä¸ªæœªå‡ºç°çš„é¢œè‰²ï¼Œä½¿å¾—ç°åœ¨ä¸åŒçš„æ•°æ° &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; ä¸ªã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç„¶åè¿™ä¸ªæ­£æ–¹å½¢çš„å³ä¸‹è§’å¼€å§‹ï¼ˆç›¸å½“äº &lt;span class=&#34;math inline&#34;&gt;\((L + 1, L + 1)\)&lt;/span&gt; æ‰©å±•ï¼‰ï¼Œæ¶‚ä¸ºä¸€ä¸ªæœªå‡ºç°çš„é¢œè‰²ï¼Œä½¿å¾—ç°åœ¨ä¸åŒçš„æ•°æ° &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°è¿™æ ·ç›¸å½“äºä¸€æ¬¡æ‰©å±•ä¸¤æ ¼ï¼Œæœ€åä¸åŒçš„æ•°åªå¯èƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæˆ– &lt;span class=&#34;math inline&#34;&gt;\(k - 1\)&lt;/span&gt; ä¸ªï¼Œå¯¹äºåè€…æˆ‘ä»¬æŠŠæ¶‚çš„é¢œè‰²å˜ä¸ºä¸€ä¸ªå·²å‡ºç°çš„å³å¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯åªéœ€è¦åˆ¤æ–­ç­”æ¡ˆæ˜¯å¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚äºæ˜¯éœ€è¦å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; ä¸ªæ­£æ–¹å½¢æ‰¾åˆ°å…¶å®Œå…¨åŒ…å«äº†å¤šå°‘æ•°å­—ï¼Œè¿™ä¸ªå¯ä»¥ç”¨äºŒç»´å‰ç¼€å’Œä»€ä¹ˆçš„å¤„ç†ä¸€ä¸‹ã€‚æ€»æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt;ã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>CF715B Complete The Graph</title>
        <link>https://oi.imyangty.com/sol-cf715b/</link>
        <pubDate>Wed, 17 Aug 2022 22:52:06 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-cf715b/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg57.webp" alt="Featured image of post CF715B Complete The Graph" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; è¾¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¿®æ”¹ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¡è¾¹ä¸­è¾¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„è¾¹ï¼Œ ä½¿æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(s\to t\)&lt;/span&gt; çš„æœ€çŸ­è·¯é•¿åº¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt;ï¼Œä¸”è¾“å‡ºç­”æ¡ˆçš„æ—¶å€™è¾¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„è¾¹çš„æƒå€¼å¿…é¡»åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([1,10^{18}]\)&lt;/span&gt; å†…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 1000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le m\le 10000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le L\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆè§† &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æƒè¾¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œè·‘ä¸€é &lt;span class=&#34;math inline&#34;&gt;\(s\to t\)&lt;/span&gt; æœ€çŸ­è·¯ï¼Œè‹¥æ­¤æ—¶æœ€çŸ­è·¯ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;L\)&lt;/span&gt; åˆ™ä¸€å®šæ— è§£ã€‚å¦åˆ™æˆ‘ä»¬å°è¯•è¿›è¡Œå¦‚ä¸‹æ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;å†è·‘ä¸€éæœ€çŸ­è·¯ï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{dis}_1(u)\)&lt;/span&gt;ã€‚å‡è®¾å½“å‰åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt;ï¼Œä¸”ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; è¾¹ï¼Œç”±äºæˆ‘ä»¬è·‘ Dijkstra æ˜¯å·²ç»ç¡®å®š &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{dis}_1(u)\)&lt;/span&gt; çš„ï¼Œåˆ™ä»¤è¾¹æƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max(1, L - \mathrm{dis}_0(t) - \mathrm{dis}_1(u) +\mathrm{dis}_0(v))\)&lt;/span&gt;ï¼Œå¦‚æœæœ€åè·‘å‡ºæ¥äº† &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; åˆ™æœ‰è§£ï¼Œå¦åˆ™æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ­£ç¡®æ–°ï¼šè€ƒè™‘æˆ‘ä»¬è¿™æ ·å®šè¾¹æƒä¼šä½¿å¾—æœ€å &lt;span class=&#34;math inline&#34;&gt;\(s\to t\)&lt;/span&gt; çš„ä»»æ„å« &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æƒè¾¹çš„è·¯å¾„é•¿åº¦éƒ½ &lt;span class=&#34;math inline&#34;&gt;\(\ge L\)&lt;/span&gt;ï¼Œæœ€åä¸€æ¬¡è¿™æ ·èµ‹è¾¹æƒçš„æ—¶å€™å°±ç›¸å½“äºç›´æ¥ç¡¬ç‚¹äº†ä¸€æ¡æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1005&lt;/span&gt;, maxm = &lt;span class=&#34;dv&#34;&gt;10005&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt; G[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m, S, T, L, vis[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll dis[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;][maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Edge {&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; ll w;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} e[maxm];&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; Dijkstra0(ll (&amp;amp;dis)[maxn]) {&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    priority_queue&amp;lt;pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;, vector&amp;lt;pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt;, greater&amp;lt;pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(dis, &lt;span class=&#34;bn&#34;&gt;0x3f&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; dis);&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(vis, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; vis);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dis[S] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, q.push({&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, S});&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u = q.top().second; q.pop();&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[u]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vis[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v = p.first; ll w = e[p.second].w;&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!w) w = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dis[u] + w &amp;lt; dis[v]) {&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                dis[v] = dis[u] + w;&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                q.push({dis[v], v});&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; Dijkstra1(ll (&amp;amp;dis)[maxn], ll (&amp;amp;d)[maxn]) {&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    priority_queue&amp;lt;pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;, vector&amp;lt;pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt;, greater&amp;lt;pair&amp;lt;ll, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(dis, &lt;span class=&#34;bn&#34;&gt;0x3f&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; dis);&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(vis, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; vis);&lt;/span&gt;
&lt;span id=&#34;cb1-41&#34;&gt;&lt;a href=&#34;#cb1-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    dis[S] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, q.push({&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, S});&lt;/span&gt;
&lt;span id=&#34;cb1-42&#34;&gt;&lt;a href=&#34;#cb1-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb1-43&#34;&gt;&lt;a href=&#34;#cb1-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u = q.top().second; q.pop();&lt;/span&gt;
&lt;span id=&#34;cb1-44&#34;&gt;&lt;a href=&#34;#cb1-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[u]) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-45&#34;&gt;&lt;a href=&#34;#cb1-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vis[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-46&#34;&gt;&lt;a href=&#34;#cb1-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : G[u]) {&lt;/span&gt;
&lt;span id=&#34;cb1-47&#34;&gt;&lt;a href=&#34;#cb1-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v = p.first; ll &amp;amp;w = e[p.second].w;&lt;/span&gt;
&lt;span id=&#34;cb1-48&#34;&gt;&lt;a href=&#34;#cb1-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!w) w = max(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;, L - d[T] - dis[u] + d[v]);&lt;/span&gt;
&lt;span id=&#34;cb1-49&#34;&gt;&lt;a href=&#34;#cb1-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dis[u] + w &amp;lt; dis[v]) {&lt;/span&gt;
&lt;span id=&#34;cb1-50&#34;&gt;&lt;a href=&#34;#cb1-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                dis[v] = dis[u] + w;&lt;/span&gt;
&lt;span id=&#34;cb1-51&#34;&gt;&lt;a href=&#34;#cb1-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                q.push({dis[v], v});&lt;/span&gt;
&lt;span id=&#34;cb1-52&#34;&gt;&lt;a href=&#34;#cb1-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-53&#34;&gt;&lt;a href=&#34;#cb1-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-54&#34;&gt;&lt;a href=&#34;#cb1-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-55&#34;&gt;&lt;a href=&#34;#cb1-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-56&#34;&gt;&lt;a href=&#34;#cb1-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-57&#34;&gt;&lt;a href=&#34;#cb1-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-58&#34;&gt;&lt;a href=&#34;#cb1-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-59&#34;&gt;&lt;a href=&#34;#cb1-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; L &amp;gt;&amp;gt; S &amp;gt;&amp;gt; T;&lt;/span&gt;
&lt;span id=&#34;cb1-60&#34;&gt;&lt;a href=&#34;#cb1-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb1-61&#34;&gt;&lt;a href=&#34;#cb1-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cin &amp;gt;&amp;gt; e[i].u &amp;gt;&amp;gt; e[i].v &amp;gt;&amp;gt; e[i].w;&lt;/span&gt;
&lt;span id=&#34;cb1-62&#34;&gt;&lt;a href=&#34;#cb1-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[e[i].u].emplace_back(e[i].v, i);&lt;/span&gt;
&lt;span id=&#34;cb1-63&#34;&gt;&lt;a href=&#34;#cb1-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[e[i].v].emplace_back(e[i].u, i);&lt;/span&gt;
&lt;span id=&#34;cb1-64&#34;&gt;&lt;a href=&#34;#cb1-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-65&#34;&gt;&lt;a href=&#34;#cb1-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Dijkstra0(dis[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb1-66&#34;&gt;&lt;a href=&#34;#cb1-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dis[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;][T] &amp;gt; L) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-67&#34;&gt;&lt;a href=&#34;#cb1-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Dijkstra1(dis[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], dis[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb1-68&#34;&gt;&lt;a href=&#34;#cb1-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dis[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][T] != L) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-69&#34;&gt;&lt;a href=&#34;#cb1-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;YES&amp;quot;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-70&#34;&gt;&lt;a href=&#34;#cb1-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, e[i].u, e[i].v, e[i].w);&lt;/span&gt;
&lt;span id=&#34;cb1-71&#34;&gt;&lt;a href=&#34;#cb1-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-72&#34;&gt;&lt;a href=&#34;#cb1-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>AGC027D - Modulo Matrix</title>
        <link>https://oi.imyangty.com/sol-agc027d/</link>
        <pubDate>Wed, 17 Aug 2022 22:02:34 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-agc027d/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg01.webp" alt="Featured image of post AGC027D - Modulo Matrix" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;æ„é€ ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\times n\)&lt;/span&gt; çš„çŸ©é˜µï¼Œè¦æ±‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰å…ƒç´ äº’å¼‚ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le a_{i,j}\le 10^{15}\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å¯¹äºä»»æ„ä¸¤ç›¸é‚»æ•°å­— &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\max(x,y)\bmod \min(x, y)\)&lt;/span&gt; ä¸ºå®šå€¼ï¼Œä¸”ä¸ºæ­£æ•´æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 500\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;ç›´è§‰ä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬ä¼šè®©è¿™ä¸ªå€¼å°½å¯èƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œè€ŒçŸ©é˜µ + ç›¸é‚»æç¤ºæˆ‘ä»¬è¿›è¡Œé»‘ç™½æŸ“è‰²ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå°±æœ‰äº†ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ„é€ ï¼šåœ¨æ‰€æœ‰é»‘æ ¼å­é‡Œé¢å¡«ä¸Šæ‰€æœ‰çš„è´¨æ•°ï¼Œç™½æ ¼å­å¡«ä¸Šå››å‘¨ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{lcm} + 1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å‰ &lt;span class=&#34;math inline&#34;&gt;\(250000\)&lt;/span&gt; ä¸ªè´¨æ•°å››ä¸ªå– &lt;span class=&#34;math inline&#34;&gt;\(\mathrm{lcm}\)&lt;/span&gt; çš„çº§åˆ«å·²ç»ä¼šçˆ†æ‰ &lt;span class=&#34;math inline&#34;&gt;\(10^{15}\)&lt;/span&gt; çš„èŒƒå›´ï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å…¶å®æˆ‘ä»¬ä¸éœ€è¦è¿™ä¹ˆå¤šä¸åŒçš„è´¨æ•°ï¼Œæˆ‘ä»¬è‹¥æ˜¯å°†æ¯ä¸ªä¸»å¯¹è§’çº¿å’Œå‰¯å¯¹è§’çº¿åˆ†é…ä¸€ä¸ªè´¨æ•°ï¼Œç„¶åä»¤é»‘æ ¼å­é‡Œé¢å¡«ä¸Šå¯¹åº”è´¨æ•°çš„ç§¯ï¼Œæ‰“è¡¨å‘ç°ç™½æ ¼å­çš„ä¸Šç•Œè¿˜æ˜¯å¯ä»¥ç¬¦åˆè¦æ±‚çš„ï¼Œäº‹å®ä¸Šæœ‰ä¸€ä¸ªéå¸¸æ¾çš„ä¸Šç•Œã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2\log V)\)&lt;/span&gt;ã€‚éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(n = 2\)&lt;/span&gt; çš„ caseã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; N = &lt;span class=&#34;fl&#34;&gt;2e4&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; isp[N + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;], p[N + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;], ptot;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; sieve() {&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, N) {&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!isp[i]) p[++ptot] = i;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; j = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; j &amp;lt;= ptot &amp;amp;&amp;amp; i * p[j] &amp;lt;= N; ++j) {&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            isp[i * p[j]] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i % p[j] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;505&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll p1[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], p2[maxn &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], ans[maxn][maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll lcm(ll x, ll y) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; (!x || !y) ? (x + y) : (x / __gcd(x, y) * y);}&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    sieve();&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n;&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;4 7&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; 23 10&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; it = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt;= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) p1[i] = p[it++];&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = ((&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - n) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; - n : &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; - n; i &amp;lt;= n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) p2[i + n] = p[it++];&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((i + j) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ans[i][j] = p1[i + j] * p2[i - j + n];&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!((i + j) &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) ans[i][j] = lcm(lcm(ans[i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j], ans[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;][j]), lcm(ans[i][j + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], ans[i][j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;])) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cout &amp;lt;&amp;lt; ans[i][j] &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cout &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>CF317C Balance</title>
        <link>https://oi.imyangty.com/sol-cf317c/</link>
        <pubDate>Mon, 04 Jul 2022 14:20:31 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-cf317c/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg7.webp" alt="Featured image of post CF317C Balance" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªæ°´æ¡¶ç¼–å·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt;ï¼Œæ¯ä¸ªæ°´æ¡¶çš„å®¹é‡ä¸ºæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ã€‚æ°´æ¡¶ä¹‹é—´æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(e\)&lt;/span&gt; æ¡åŒå‘ç®¡é“ï¼ˆå¯èƒ½é‡å¤ï¼‰ï¼Œä¸€æ¬¡æ“ä½œå¯ä»¥ä»ä¸€ä¸ªæ°´æ¡¶é€šè¿‡ç®¡é“è¾“é€ä»»æ„éè´Ÿæ•´æ•°é‡çš„æ°´åˆ°å¦ä¸€ä¸ªæ°´æ¡¶ï¼Œä½†è¦ä¿è¯ä»»æ„æ—¶åˆ»æ°´æ¡¶ä¸­çš„æ°´é‡ä¸è¶…è¿‡å®¹é‡ã€‚ç°ç»™å®šä¸€ä¸ªåˆå§‹å±€é¢ &lt;span class=&#34;math inline&#34;&gt;\(\big&amp;lt;a_i\big&amp;gt;\)&lt;/span&gt;ï¼ˆè¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªæ°´æ¡¶çš„æ°´é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ï¼‰å’Œä¸€ä¸ªç›®æ ‡å±€é¢&lt;span class=&#34;math inline&#34;&gt;\(\big&amp;lt;b_i\big&amp;gt;\)&lt;/span&gt;ï¼Œé—®æ˜¯å¦å¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(2n^2\)&lt;/span&gt; æ¬¡æ“ä½œå†…ä»åˆå§‹å±€é¢åˆ°è¾¾ç›®æ ‡å±€é¢ã€‚å¦‚æœå¯ä»¥è¾“å‡ºæ–¹æ¡ˆï¼Œå¦åˆ™è¾“å‡º &lt;code&gt;NO&lt;/code&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(1\le n \le300,1\le v \le 10^9,0\le e \le50000\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le a_i,b_i\le v\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;é‚£ä¹ˆé¦–å…ˆæ˜ç¡®ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;lt;b_i\)&lt;/span&gt; çš„ç‚¹æ˜¯éœ€è¦åˆ«çš„ç‚¹å¼•å…¥çš„ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;gt;b_i\)&lt;/span&gt; çš„ç‚¹æ˜¯éœ€è¦ä¾›ç»™ç»™åˆ«çš„ç‚¹çš„ã€‚é¦–å…ˆå¯¹äºæ¯ä¸ªè¿é€šå— &lt;span class=&#34;math inline&#34;&gt;\(\sum a_i\ne \sum b_i\)&lt;/span&gt; åˆ™ä¸€å®šæ— è§£ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥å°†é—®é¢˜æ”¾åœ¨ç”Ÿæˆæ ‘ä¸Šè€ƒè™‘ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„æ“ä½œæ¬¡æ•°è¿˜æ˜¯æ¯”è¾ƒæ¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæœ‰ä¸€ä¸ªæœ€æœ´ç´ çš„æ€è·¯å°±æ˜¯æšä¸¾è¿™äº› &lt;span class=&#34;math inline&#34;&gt;\(a_i &amp;lt; b_i\)&lt;/span&gt; çš„ç‚¹ï¼Œç„¶åè®©åŒä¸€è¿é€šå—å†…çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_i &amp;gt; b_i\)&lt;/span&gt; ç‚¹å¯¹å…¶è¿›è¡Œä¾›ç»™ï¼Œç”±äºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„é™åˆ¶ï¼Œæœ€å¤šéœ€è¦è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(2(n-1)\)&lt;/span&gt; æ¬¡ï¼ˆä¸€æ¬¡ä¸è¡Œå’±å°±ä¸¤æ¬¡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åŒæ—¶æˆ‘ä»¬ä¹Ÿæœ‰æ›´ä¼˜çš„æ€è·¯ï¼šä»å¶å­èŠ‚ç‚¹å¼€å§‹ï¼Œè‹¥å…¶æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_i &amp;lt; b_i\)&lt;/span&gt;ï¼Œåˆ™ä»å…¶é‚»è¿‘èŠ‚ç‚¹â€œå¸è¡€â€ä»¥æ»¡è¶³è‡ªå·±çš„æ¡ä»¶ï¼Œè‹¥é‚»è¿‘èŠ‚ç‚¹ä¸å¤Ÿå°±é€’å½’ç»§ç»­å¸ï¼Œç„¶åæ»¡è¶³äº†è¿™ä¸ªå¶å­èŠ‚ç‚¹çš„é™åˆ¶åï¼Œåˆ æ‰è¿™ä¸ªå¶å­èŠ‚ç‚¹ã€‚é—®é¢˜ä¾¿å˜æˆäº†è§„æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; çš„å­é—®é¢˜ï¼ˆå½“ç„¶å‰ææ˜¯æœ‰è§£ï¼‰ï¼Œè€Œä¸€æ¬¡è¿™æ ·çš„è°ƒæ•´æœ€å¤šéœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(n-1\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ‰€ä»¥è¿™æ ·åšä¸Šç•Œå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çš„äº†ï¼ˆè€Œä¸”æ„Ÿè§‰æ¯”è¾ƒæ¾ï¼‰ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(a_i &amp;gt; b_i\)&lt;/span&gt; çš„ç‚¹å°±é€’å½’é‡Šæ”¾å³å¯ï¼Œæ€è·¯ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç ç»†èŠ‚ç¨å¾®æœ‰ä¸€ç‚¹å°å¤šï¼Œéœ€è¦å¥½å¥½å®ç°ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define debug&lt;/span&gt;(...)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;fprintf(stderr,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;ot&#34;&gt;__VA_ARGS__&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;305&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, V, m, a[maxn], b[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn], T[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[maxn], deg[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; suma, sumb;&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;queue&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; q;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Op {&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, y, d;&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Op(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _y = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _d = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) : x(_x), y(_y), d(_d) {}&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;};&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;Op&amp;gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs0(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u) {&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vis[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    suma += a[u], sumb += b[u];&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : G[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[v]) {&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        T[u].push_back(v), T[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++deg[u], ++deg[v];&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs0(v);&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (deg[u] == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) q.push(u);&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dfs1(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; in) { &lt;span class=&#34;co&#34;&gt;// è¿”å›æ¶ˆåŒ–äº†çš„æµé‡&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ta = a[u] + in, orga = a[u], out = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ta &amp;gt;= &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; ta &amp;lt;= V) {&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[u] = ta;&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (in &amp;gt;= &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) ans.push_back(Op(fa, u, in));&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; ans.push_back(Op(u, fa, -in));&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; in;&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ta &amp;lt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) { &lt;span class=&#34;co&#34;&gt;// in &amp;lt; 0 fa å¸è¡€ u&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : T[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v != fa &amp;amp;&amp;amp; vis[v] != &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cur = dfs1(v, u, ta);&lt;/span&gt;
&lt;span id=&#34;cb1-41&#34;&gt;&lt;a href=&#34;#cb1-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ta -= cur, out += cur;&lt;/span&gt;
&lt;span id=&#34;cb1-42&#34;&gt;&lt;a href=&#34;#cb1-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ta &amp;gt;= &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-43&#34;&gt;&lt;a href=&#34;#cb1-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-44&#34;&gt;&lt;a href=&#34;#cb1-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[u] = max(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, ta);&lt;/span&gt;
&lt;span id=&#34;cb1-45&#34;&gt;&lt;a href=&#34;#cb1-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans.push_back(Op(u, fa, orga - a[u] - out));&lt;/span&gt;
&lt;span id=&#34;cb1-46&#34;&gt;&lt;a href=&#34;#cb1-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a[u] - orga + out;&lt;/span&gt;
&lt;span id=&#34;cb1-47&#34;&gt;&lt;a href=&#34;#cb1-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ta &amp;gt; V) {&lt;/span&gt;
&lt;span id=&#34;cb1-48&#34;&gt;&lt;a href=&#34;#cb1-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : T[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v != fa &amp;amp;&amp;amp; vis[v] != &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-49&#34;&gt;&lt;a href=&#34;#cb1-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cur = dfs1(v, u, ta - V);&lt;/span&gt;
&lt;span id=&#34;cb1-50&#34;&gt;&lt;a href=&#34;#cb1-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ta -= cur, out += cur;&lt;/span&gt;
&lt;span id=&#34;cb1-51&#34;&gt;&lt;a href=&#34;#cb1-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (ta &amp;lt;= V) &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-52&#34;&gt;&lt;a href=&#34;#cb1-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-53&#34;&gt;&lt;a href=&#34;#cb1-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        a[u] = min(V, ta);&lt;/span&gt;
&lt;span id=&#34;cb1-54&#34;&gt;&lt;a href=&#34;#cb1-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans.push_back(Op(fa, u, a[u] - orga + out));&lt;/span&gt;
&lt;span id=&#34;cb1-55&#34;&gt;&lt;a href=&#34;#cb1-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a[u] - orga + out;&lt;/span&gt;
&lt;span id=&#34;cb1-56&#34;&gt;&lt;a href=&#34;#cb1-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-57&#34;&gt;&lt;a href=&#34;#cb1-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-58&#34;&gt;&lt;a href=&#34;#cb1-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-59&#34;&gt;&lt;a href=&#34;#cb1-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-60&#34;&gt;&lt;a href=&#34;#cb1-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-61&#34;&gt;&lt;a href=&#34;#cb1-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; V &amp;gt;&amp;gt; m;&lt;/span&gt;
&lt;span id=&#34;cb1-62&#34;&gt;&lt;a href=&#34;#cb1-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; a[i];&lt;/span&gt;
&lt;span id=&#34;cb1-63&#34;&gt;&lt;a href=&#34;#cb1-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) cin &amp;gt;&amp;gt; b[i];&lt;/span&gt;
&lt;span id=&#34;cb1-64&#34;&gt;&lt;a href=&#34;#cb1-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb1-65&#34;&gt;&lt;a href=&#34;#cb1-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v;&lt;/span&gt;
&lt;span id=&#34;cb1-66&#34;&gt;&lt;a href=&#34;#cb1-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        cin &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;&lt;/span&gt;
&lt;span id=&#34;cb1-67&#34;&gt;&lt;a href=&#34;#cb1-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb1-68&#34;&gt;&lt;a href=&#34;#cb1-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-69&#34;&gt;&lt;a href=&#34;#cb1-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[i]) {&lt;/span&gt;
&lt;span id=&#34;cb1-70&#34;&gt;&lt;a href=&#34;#cb1-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        suma = sumb = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-71&#34;&gt;&lt;a href=&#34;#cb1-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs0(i);&lt;/span&gt;
&lt;span id=&#34;cb1-72&#34;&gt;&lt;a href=&#34;#cb1-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (suma != sumb) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; puts(&lt;span class=&#34;st&#34;&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-73&#34;&gt;&lt;a href=&#34;#cb1-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!q.empty()) {&lt;/span&gt;
&lt;span id=&#34;cb1-74&#34;&gt;&lt;a href=&#34;#cb1-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u = q.front(); q.pop();&lt;/span&gt;
&lt;span id=&#34;cb1-75&#34;&gt;&lt;a href=&#34;#cb1-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v = -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-76&#34;&gt;&lt;a href=&#34;#cb1-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;vv : T[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (vis[vv] != &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-77&#34;&gt;&lt;a href=&#34;#cb1-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                v = vv;&lt;/span&gt;
&lt;span id=&#34;cb1-78&#34;&gt;&lt;a href=&#34;#cb1-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-79&#34;&gt;&lt;a href=&#34;#cb1-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-80&#34;&gt;&lt;a href=&#34;#cb1-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v == -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;continue&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-81&#34;&gt;&lt;a href=&#34;#cb1-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            dfs1(v, u, a[u] - b[u]);&lt;/span&gt;
&lt;span id=&#34;cb1-82&#34;&gt;&lt;a href=&#34;#cb1-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            a[u] = b[u];&lt;/span&gt;
&lt;span id=&#34;cb1-83&#34;&gt;&lt;a href=&#34;#cb1-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            vis[u] = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-84&#34;&gt;&lt;a href=&#34;#cb1-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (--deg[v] == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) q.push(v);&lt;/span&gt;
&lt;span id=&#34;cb1-85&#34;&gt;&lt;a href=&#34;#cb1-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-86&#34;&gt;&lt;a href=&#34;#cb1-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-87&#34;&gt;&lt;a href=&#34;#cb1-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; ans.size() &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb1-88&#34;&gt;&lt;a href=&#34;#cb1-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;o : ans) cout &amp;lt;&amp;lt; o.x &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; o.y &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;lt;&amp;lt; o.d &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-89&#34;&gt;&lt;a href=&#34;#cb1-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-90&#34;&gt;&lt;a href=&#34;#cb1-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>P3557 [POI2013]GRA-Tower Defense Game</title>
        <link>https://oi.imyangty.com/sol-luogu-p3557/</link>
        <pubDate>Mon, 04 Jul 2022 12:10:26 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-luogu-p3557/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg25.webp" alt="Featured image of post P3557 [POI2013]GRA-Tower Defense Game" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;æœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¡è¾¹çš„å›¾ï¼Œæ¯æ¡è¾¹è·ç¦»æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå·²çŸ¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæ”»å‡»è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å¡”å¯ä»¥æ‰“åˆ°æ•´ä¸ªåœ°å›¾ï¼Œè®©æ„é€ ä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—ç”¨å°äºç­‰äº &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæ”»å‡»è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; çš„å¡”æ‰“åˆ°æ•´ä¸ªåœ°å›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 5\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(0\le m\le 10^6\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;ã€‚ã€‚ã€‚ä¹Œé±¼å­ä¹±ææ„é€ ç‰›é€¼é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¾æ¬¡é€‰æ‹©æœªè¢«è¦†ç›–çš„ç‚¹å¼€å§‹è¦†ç›–å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¯æ˜ï¼šè€ƒè™‘æ”»å‡»è·ç¦»æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„æ—¶å€™ï¼Œæ¯ä¸ªç‚¹éƒ½è‡³å°‘ä¸ä¸€ä¸ªæ”»å‡»å¡”ç›¸è¿ã€‚é‚£ä¹ˆæ‰€ä»¥æˆ‘ä»¬çš„é€‰æ³•ä¸€å®šèƒ½è¦†ç›–è¿™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªé€‰äº†çš„å¡”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;bits/stdc++.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; std;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;5e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; vis[maxn], n, m, k;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; G[maxn], ans;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; dfs(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; fa, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; dep) {&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vis[u] = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (dep &amp;gt;= &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;v : G[u]) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (v != fa) dfs(v, u, dep + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ios::sync_with_stdio(&lt;span class=&#34;kw&#34;&gt;false&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; k;&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m) {&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, v; cin &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        G[u].push_back(v), G[v].push_back(u);&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!vis[i]) {&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        dfs(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ans.push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    cout &amp;lt;&amp;lt; ans.size() &amp;lt;&amp;lt; endl;&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;x : ans) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>P5884 [IOI2014]game æ¸¸æˆ</title>
        <link>https://oi.imyangty.com/sol-luogu-p5884/</link>
        <pubDate>Sun, 30 Jan 2022 18:04:55 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-luogu-p5884/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg19.webp" alt="Featured image of post P5884 [IOI2014]game æ¸¸æˆ" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;äº¤äº’é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;TW æœ‰èˆªç©ºç½‘ï¼Œå¯æŠ½è±¡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0,\cdots, n - 1\)&lt;/span&gt; ç¼–å·ç‚¹çš„æ— å‘å›¾ï¼ŒA é—® B è¿™å¼ å›¾æ˜¯å¦è¿é€šï¼ŒB æƒ³åšæ¸¸æˆæ¥å›ç­”ä»–ã€‚&lt;/p&gt;
&lt;p&gt;A å¯ä»¥é—® &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; è¾¹æ˜¯å¦å­˜åœ¨ï¼ŒB ä¼šç«‹åˆ»å›ç­”è¿™ä¸ªé—®é¢˜ã€‚A ä¸€å…±ä¼šé—® &lt;span class=&#34;math inline&#34;&gt;\(n(n - 1)/2\)&lt;/span&gt; ä¸ªé—®é¢˜ï¼Œå¯ä»¥çŸ¥é“çš„æ˜¯åœ¨é—®å®Œæœ€åä¸€ä¸ªé—®é¢˜å A å°±ä¼šçŸ¥é“å…¶æ˜¯å¦è¿é€šã€‚B çš„ç›®æ ‡æ˜¯åŠ¨æ€æ„é€ è¿™å¼ å›¾ï¼Œè®© A åœ¨é—®æœ€åä¸€ä¸ªé—®é¢˜ä¹‹å‰è¿˜ä¸çŸ¥é“æ•´å¼ å›¾æ˜¯å¦è¿é€šã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œå®ç° &lt;code&gt;void initialize(int n)&lt;/code&gt; å’Œ &lt;code&gt;int hasEdge(int u, int v)&lt;/code&gt; ä¸¤ä¸ªå‡½æ•°å¸®åŠ© B è·èƒœã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;åœ¨è¯¢é—®æœ€åä¸€æ¡è¾¹ä¹‹å‰å›¾åº”è¯¥æ˜¯å½¢æˆäº†ä¸¤ä¸ªè¿é€šå—ï¼Œè€Œä¸”ä¸¤ä¸ªè¿é€šå—ä¹‹é—´çš„ç‚¹éƒ½æ²¡æœ‰ä»»ä½•è¿è¾¹ã€‚é‚£ä¹ˆå¯¹äºéå¼ºåˆ¶åœ¨çº¿çš„æƒ…å†µï¼Œåªéœ€è¦æ„é€ ä¸€å¼ å®Œå…¨å›¾ç„¶åæŠŠæœ€åä¸€ä¸ªç‚¹æŠ æ‰å³å¯ã€‚ç„¶åè¿™é¢˜å°±åšå®Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¯¹äºåŸé¢˜ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“ä»–æœ€åä¸€ä¸ªè¯¢é—®ä¼šæ˜¯ä»€ä¹ˆçš„ï¼Œæ‰€ä»¥ä¸Šé¢è¿™ä¸ªåšæ³•æ˜æ˜¾è¡Œä¸é€šã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è€ƒè™‘å°†è¿™ä¸ªå›¾æ„é€ æˆä¸€æ£µæ ‘ï¼Œå¹¶ä¸”åœ¨æœ€åçš„è¯¢é—®å†ç»™å‡ºæ ‘è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªç‚¹åˆ°å…¶ä»–ç‚¹ä¸­çš„æœ€åä¸€æ¡è¾¹çš„æ—¶å€™å†è¿ä¸Šã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;quot;game.h&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;1505&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; max(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;gt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; initialize(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n) {}&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; hasEdge(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ++cnt[max(u, v)] == max(u, v);}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>UOJ#604. ã€UER 9ã€‘èµ¶è·¯</title>
        <link>https://oi.imyangty.com/sol-uoj604/</link>
        <pubDate>Wed, 26 Jan 2022 13:24:23 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-uoj604/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg44.webp" alt="Featured image of post UOJ#604. ã€UER 9ã€‘èµ¶è·¯" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™å®šäºŒç»´å¹³é¢ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(2\le n\le 500\)&lt;/span&gt;ï¼‰ï¼Œè¦æ±‚æ„é€ ä¸€æ¡ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ä¸è‡ªäº¤çš„è·¯å¾„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä¸å¦¨è€ƒè™‘åˆ†æ²»ã€‚è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{solve}(s, t, A)\)&lt;/span&gt; è¡¨ç¤ºå½“å‰è¦è§£å†³ä» &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œç»è¿‡çš„ç‚¹é›†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;éšä¾¿ä» &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­æŒ‘ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å‡ºæ¥ï¼Œç„¶åä» &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¿ä¸€æ¡ç›´çº¿ï¼Œç„¶åå°† &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­å‰©ä¸‹çš„ç‚¹æŒ‰åœ¨ç›´çº¿çš„å·¦ä¾§/å³ä¾§åˆ’åˆ†åˆ° &lt;span class=&#34;math inline&#34;&gt;\(A_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(A_2\)&lt;/span&gt; ä¸­ã€‚è¿™é‡Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; åœ¨ç›´çº¿å³ä¾§ï¼Œåä¹‹åŒç†ã€‚ç„¶åé€’å½’æ±‚è§£ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{solve}(s, p, A_1)\)&lt;/span&gt;ï¼Œå³æˆ‘ä»¬å…ˆèµ°å·¦ä¾§çš„ç‚¹ï¼Œä¸­é€”è¦ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œä¹‹åå†èµ°å³ä¾§çš„ç‚¹ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{solve}(p, t, A_2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(A_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(A_2\)&lt;/span&gt; ä¸­çš„è·¯å¾„æ˜¯ä¸€å®šä¸ä¼šæœ‰äº¤çš„ï¼Œæ ¹æ®æˆ‘ä»¬çš„æ„é€ ï¼Œå‘ç°å…¶ä¸€å®šæœ‰è§£ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯å°±è¿™æ ·åšï¼Œç”¨å‰ç§¯åˆ¤ä¸€ä¸‹æ–¹å‘å•¥çš„ï¼Œå°±æå®šäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; ll = &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;dv&#34;&gt;505&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Point {&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x, y;&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Point() {}&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Point(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _x, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; _y) : x(_x), y(_y) {}&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; Point &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;-(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Point &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Point &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Point(a.x - b.x, a.y - b.y);}&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; ll &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;^(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Point &amp;amp;a, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Point &amp;amp;b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * a.x * b.y - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * a.y * b.x;}&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} p[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; check(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; c) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ((p[b] - p[a]) ^ (p[c] - p[a])) &amp;gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;}&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; s, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; t, vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; v) {&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; a[&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;; i &amp;lt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;)v.size(); ++i) a[check(s, v[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], v[i])].push_back(v[i]);&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; k = check(s, v[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], t);&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[k ^ &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;].size()) solve(s, v[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], a[k ^ &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]);&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    print(v[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (a[k].size()) solve(v[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], t, a[k]);&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; read(T);&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--) {&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(n);&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) read(p[i].x, p[i].y);&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vector&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt; tmp;&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) tmp.push_back(i);&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        print(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;), solve(&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n, tmp), print(n, &lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>GYM103495D. Pattern Lock</title>
        <link>https://oi.imyangty.com/sol-gym103495d/</link>
        <pubDate>Tue, 25 Jan 2022 20:50:33 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-gym103495d/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg15.webp" alt="Featured image of post GYM103495D. Pattern Lock" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; çš„ç‚¹é˜µï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\le n,m\le 500\)&lt;/span&gt;ï¼Œè¦æ±‚æ„é€ ä¸€æ¡å“ˆå¯†é¡¿é“¾ï¼Œä½¿å¾—å½¢æˆçš„è§’éƒ½æ˜¯é”è§’ä¸”è¾¹å’Œç‚¹ä»…åœ¨ç«¯ç‚¹å¤„ç›¸äº¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;è¿™é¢˜æäº†å¥½ä¹…é”™è¯¯ç­”æ¡ˆã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œä¸¤åˆ—ä¹‹é—´çš„å¤§è·¨çº¿åªèƒ½è·¨ä¸€åˆ—ï¼Œä¸ç„¶æ€»æœ‰æœºä¼šç¢°åˆ°ä¸­é—´çš„ç‚¹ï¼Œå¯„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s4.ax1x.com/2022/01/25/7bssYQ.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;äº‹å®å°±æ˜¯ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸åŒæ—¶ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œç„¶åä¸¤ä¸¤åˆ†ç»„è¿™æ ·æ¥åšã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; åŒæ—¶ä¸ºå¥‡æ•°çš„å°±æŠŠä¸Šé¢é‚£ä¸ªé­”æ”¹ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s4.ax1x.com/2022/01/25/7b69ET.png&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; pii = pair&amp;lt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&amp;gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pii&amp;gt; ans;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n, m;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;vector&amp;lt;pii&amp;gt; calc() {&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    vector&amp;lt;pii&amp;gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret.push_back({&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt;; i &amp;lt;= n; i += &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back({i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back({i, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back({i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back({i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back({i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret.push_back({i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n, m);&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;bool&lt;/span&gt; flg = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; ((m &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;amp;&amp;amp; !(n &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) swap(n, m), flg = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (n == &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) swap(n, m), flg = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, (m &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? m / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : m / &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (j &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back({n, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            DEC(i, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans.push_back({i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j});&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans.push_back({i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back({n, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j});&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        } &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; {&lt;/span&gt;
&lt;span id=&#34;cb1-41&#34;&gt;&lt;a href=&#34;#cb1-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back({&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-42&#34;&gt;&lt;a href=&#34;#cb1-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb1-43&#34;&gt;&lt;a href=&#34;#cb1-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans.push_back({i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j});&lt;/span&gt;
&lt;span id=&#34;cb1-44&#34;&gt;&lt;a href=&#34;#cb1-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                ans.push_back({i, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;});&lt;/span&gt;
&lt;span id=&#34;cb1-45&#34;&gt;&lt;a href=&#34;#cb1-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-46&#34;&gt;&lt;a href=&#34;#cb1-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back({&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt; * j});&lt;/span&gt;
&lt;span id=&#34;cb1-47&#34;&gt;&lt;a href=&#34;#cb1-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-48&#34;&gt;&lt;a href=&#34;#cb1-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-49&#34;&gt;&lt;a href=&#34;#cb1-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (m &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-50&#34;&gt;&lt;a href=&#34;#cb1-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        vector&amp;lt;pii&amp;gt; tmp = calc();&lt;/span&gt;
&lt;span id=&#34;cb1-51&#34;&gt;&lt;a href=&#34;#cb1-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : tmp) {&lt;/span&gt;
&lt;span id=&#34;cb1-52&#34;&gt;&lt;a href=&#34;#cb1-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (m % &lt;span class=&#34;dv&#34;&gt;4&lt;/span&gt; == &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;) p.first = n - p.first + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-53&#34;&gt;&lt;a href=&#34;#cb1-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            p.second += m - &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-54&#34;&gt;&lt;a href=&#34;#cb1-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans.push_back(p);&lt;/span&gt;
&lt;span id=&#34;cb1-55&#34;&gt;&lt;a href=&#34;#cb1-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-56&#34;&gt;&lt;a href=&#34;#cb1-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-57&#34;&gt;&lt;a href=&#34;#cb1-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;kw&#34;&gt;auto&lt;/span&gt; &amp;amp;p : ans) {&lt;/span&gt;
&lt;span id=&#34;cb1-58&#34;&gt;&lt;a href=&#34;#cb1-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!flg) print(p.first, p.second);&lt;/span&gt;
&lt;span id=&#34;cb1-59&#34;&gt;&lt;a href=&#34;#cb1-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; print(p.second, p.first);&lt;/span&gt;
&lt;span id=&#34;cb1-60&#34;&gt;&lt;a href=&#34;#cb1-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-61&#34;&gt;&lt;a href=&#34;#cb1-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; output(), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-62&#34;&gt;&lt;a href=&#34;#cb1-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>ICPC Shanghai 2019 D Spanning Tree Removal</title>
        <link>https://oi.imyangty.com/sol-nc202122/</link>
        <pubDate>Mon, 01 Nov 2021 10:29:16 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-nc202122/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg31.webp" alt="Featured image of post ICPC Shanghai 2019 D Spanning Tree Removal" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/problem/202122&#34;&gt;ç‰›å®¢ä¼ é€é—¨&lt;/a&gt;ã€‚ç»™å®šä¸€å¼ å®Œå…¨å›¾ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€æ£µç”Ÿæˆæ ‘ç„¶åä»å›¾ä¸­åˆ é™¤ã€‚é—®æœ€å¤šèƒ½è¿›è¡Œå‡ æ¬¡è¿™æ ·çš„æ“ä½œï¼Œå¹¶è¾“å‡ºæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;æ“ä½œæ¬¡æ•°æ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n / 2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ„é€ å‡º &lt;span class=&#34;math inline&#34;&gt;\(n / 2\)&lt;/span&gt; æ¡è¾¹ä¸ç›¸äº¤çš„é“¾ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(\{x, x + 1, x - 1, x + 2, x - 2, x + 3,\cdots\}\)&lt;/span&gt; è¿™æ ·æ„é€ ã€‚å¾ªç¯ç§»ä½ &lt;span class=&#34;math inline&#34;&gt;\(n / 2\)&lt;/span&gt; æ¬¡å°±å¯ä»¥æ„é€ å‡ºæ‰€æœ‰éœ€è¦çš„ç”Ÿæˆæ ‘ã€‚å…·ä½“å¯ä»¥çœ‹ä»£ç ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T; scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;T);&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(kase, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, T) {&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; n; scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;n);&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;Case #&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;: &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, kase, n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now = i, sgn = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) {&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; nxt = (now + sgn * j - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; + n) % n + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, now, nxt);&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                sgn = -sgn, now = nxt;&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            }&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>CF431D Random Task</title>
        <link>https://oi.imyangty.com/sol-cf431d/</link>
        <pubDate>Sun, 31 Oct 2021 17:21:37 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-cf431d/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg66.webp" alt="Featured image of post CF431D Random Task" /&gt;&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(0\le m\le 10^{18}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 64\)&lt;/span&gt;ï¼‰ï¼Œæ±‚ä»»æ„ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\([n + 1, 2n]\)&lt;/span&gt; ä¸­æ°æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{popcount}(x) = k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;ç ”ç©¶ä¸€ä¸‹æ€§è´¨ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(S(n) = \{n + 1, n + 2, \cdots, 2n\}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f(n) = \sum_{x\in S(n)}[\operatorname{popcount}(x) = k]\)&lt;/span&gt;ã€‚ç„¶åç”±äº &lt;span class=&#34;math inline&#34;&gt;\(S(n) - S(n - 1) = \{2n - 1, 2n\} - \{n\}\)&lt;/span&gt;ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{popcount}(n) = \operatorname{popcount}(2n)\)&lt;/span&gt;ã€‚å› æ­¤è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f(n)\)&lt;/span&gt; æ˜¯éä¸¥æ ¼é€’å¢çš„ï¼Œå…·æœ‰å¯äºŒåˆ†æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨çš„é—®é¢˜å˜ä¸ºç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å¦‚ä½•æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(f(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è²Œä¼¼å¯ä»¥æ•°ä½ dpã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯è¿™é¢˜å°±è§£å†³äº†ã€‚å¤æ‚åº¦ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll m, k;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll f[&lt;span class=&#34;dv&#34;&gt;80&lt;/span&gt;][&lt;span class=&#34;dv&#34;&gt;80&lt;/span&gt;], a[&lt;span class=&#34;dv&#34;&gt;80&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll solve(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; now, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; cnt, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; lim) {&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!now) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; (cnt == k);&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (~f[now][cnt] &amp;amp;&amp;amp; !lim) &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; f[now][cnt];&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; up = lim ? a[now] : &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll res = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, up)&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (cnt + (i == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;lt;= k)&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            res += solve(now - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, cnt + (i == &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;), lim &amp;amp;&amp;amp; (i == up));&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!lim) f[now][cnt] = res;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; res;&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;ll check(ll mid) {&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (ll x = mid &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt;; x; x &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) a[++a[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]] = (x &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll ret = solve(a[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    a[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (ll x = mid; x; x &amp;gt;&amp;gt;= &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) a[++a[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;]] = (x &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ret -= solve(a[&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;], &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld&lt;/span&gt;&lt;span class=&#34;st&#34;&gt; &lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;m, &amp;amp;k);&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    memset(f, -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt; f);&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll l = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, r = (ll)&lt;span class=&#34;fl&#34;&gt;1e18&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (l &amp;lt; r) {&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll mid = (l + r) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, tmp = check(mid);&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tmp == m)&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, mid), &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (tmp &amp;lt; m) l = mid + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; r = mid;&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
        </item>
        <item>
        <title>NOIP2020 é¢˜è§£</title>
        <link>https://oi.imyangty.com/sol-noip2020/</link>
        <pubDate>Tue, 09 Mar 2021 19:25:17 +0800</pubDate>
        
        <guid>https://oi.imyangty.com/sol-noip2020/</guid>
        <description>&lt;img src="https://yangty-pic.oss-cn-beijing.aliyuncs.com/bg33.webp" alt="Featured image of post NOIP2020 é¢˜è§£" /&gt;&lt;h2 id=&#34;t1-æ’æ°´ç³»ç»Ÿ&#34;&gt;T1 æ’æ°´ç³»ç»Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸æƒ³è¯´ä»€ä¹ˆï¼Œæ‹“æ‰‘æ’åºå³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;implementation&#34;&gt;Implementation&lt;/h3&gt;
&lt;p&gt;å®ç°çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹ï¼Œå¯ä»¥ç›´æ¥å°†æ‰€æœ‰çš„åˆ†æ•°ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(60^{11}\)&lt;/span&gt; ä¸ºåˆ†æ¯è¿›è¡Œè¿ç®—ï¼Œç„¶åéœ€è¦ç”¨ä¸¤ä¸ª &lt;code&gt;long long&lt;/code&gt; æ¥å®ç°ä¸€ä¸ª &lt;code&gt;Bigint&lt;/code&gt; ç±»ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb1&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb1-1&#34;&gt;&lt;a href=&#34;#cb1-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-2&#34;&gt;&lt;a href=&#34;#cb1-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cctype&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-3&#34;&gt;&lt;a href=&#34;#cb1-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define il &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-4&#34;&gt;&lt;a href=&#34;#cb1-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb1-5&#34;&gt;&lt;a href=&#34;#cb1-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(a);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(b);&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb1-6&#34;&gt;&lt;a href=&#34;#cb1-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-7&#34;&gt;&lt;a href=&#34;#cb1-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; fastIO {&lt;/span&gt;
&lt;span id=&#34;cb1-8&#34;&gt;&lt;a href=&#34;#cb1-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxc = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;23&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-9&#34;&gt;&lt;a href=&#34;#cb1-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; ibuf[maxc], *__p1 = ibuf, *__p2 = ibuf;&lt;/span&gt;
&lt;span id=&#34;cb1-10&#34;&gt;&lt;a href=&#34;#cb1-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; getchar() {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; __p1 == __p2 &amp;amp;&amp;amp; (__p2 = (__p1 = ibuf) + fread(ibuf, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, maxc, stdin), __p1 == __p2) ? EOF : *__p1++;}&lt;/span&gt;
&lt;span id=&#34;cb1-11&#34;&gt;&lt;a href=&#34;#cb1-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;template&lt;/span&gt;&amp;lt;&lt;span class=&#34;kw&#34;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; read(T &amp;amp;n) {&lt;/span&gt;
&lt;span id=&#34;cb1-12&#34;&gt;&lt;a href=&#34;#cb1-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; n = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-13&#34;&gt;&lt;a href=&#34;#cb1-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-14&#34;&gt;&lt;a href=&#34;#cb1-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (!isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb1-15&#34;&gt;&lt;a href=&#34;#cb1-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        x |= (c == &lt;span class=&#34;ch&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;), c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-16&#34;&gt;&lt;a href=&#34;#cb1-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (isdigit(c))&lt;/span&gt;
&lt;span id=&#34;cb1-17&#34;&gt;&lt;a href=&#34;#cb1-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        n = n * &lt;span class=&#34;dv&#34;&gt;10&lt;/span&gt; + c - &lt;span class=&#34;ch&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;, c = getchar();&lt;/span&gt;
&lt;span id=&#34;cb1-18&#34;&gt;&lt;a href=&#34;#cb1-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    n = x ? -n : n;&lt;/span&gt;
&lt;span id=&#34;cb1-19&#34;&gt;&lt;a href=&#34;#cb1-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-20&#34;&gt;&lt;a href=&#34;#cb1-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} &lt;span class=&#34;co&#34;&gt;// namespace fastIO&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-21&#34;&gt;&lt;a href=&#34;#cb1-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-22&#34;&gt;&lt;a href=&#34;#cb1-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;kw&#34;&gt;namespace&lt;/span&gt; fastIO;&lt;/span&gt;
&lt;span id=&#34;cb1-23&#34;&gt;&lt;a href=&#34;#cb1-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-24&#34;&gt;&lt;a href=&#34;#cb1-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb1-25&#34;&gt;&lt;a href=&#34;#cb1-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-26&#34;&gt;&lt;a href=&#34;#cb1-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Bigint {&lt;/span&gt;
&lt;span id=&#34;cb1-27&#34;&gt;&lt;a href=&#34;#cb1-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;at&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll base = &lt;span class=&#34;fl&#34;&gt;1e15&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-28&#34;&gt;&lt;a href=&#34;#cb1-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    ll upper, lower;&lt;/span&gt;
&lt;span id=&#34;cb1-29&#34;&gt;&lt;a href=&#34;#cb1-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Bigint(ll u, ll l) : upper(u), lower(l) {}&lt;/span&gt;
&lt;span id=&#34;cb1-30&#34;&gt;&lt;a href=&#34;#cb1-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; Bigint &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Bigint &amp;amp;lhs, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Bigint &amp;amp;rhs) {&lt;/span&gt;
&lt;span id=&#34;cb1-31&#34;&gt;&lt;a href=&#34;#cb1-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Bigint(lhs.upper + rhs.upper + (lhs.lower + rhs.lower) / base, (lhs.lower + rhs.lower) % base);&lt;/span&gt;
&lt;span id=&#34;cb1-32&#34;&gt;&lt;a href=&#34;#cb1-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-33&#34;&gt;&lt;a href=&#34;#cb1-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; Bigint &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;*(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Bigint &amp;amp;lhs, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll &amp;amp;rhs) {&lt;/span&gt;
&lt;span id=&#34;cb1-34&#34;&gt;&lt;a href=&#34;#cb1-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Bigint(lhs.upper * rhs + lhs.lower * rhs / base, lhs.lower * rhs % base);&lt;/span&gt;
&lt;span id=&#34;cb1-35&#34;&gt;&lt;a href=&#34;#cb1-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-36&#34;&gt;&lt;a href=&#34;#cb1-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; Bigint &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;/(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Bigint &amp;amp;lhs, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll &amp;amp;rhs) {&lt;/span&gt;
&lt;span id=&#34;cb1-37&#34;&gt;&lt;a href=&#34;#cb1-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Bigint(lhs.upper / rhs, (lhs.lower + lhs.upper % rhs * base) / rhs);&lt;/span&gt;
&lt;span id=&#34;cb1-38&#34;&gt;&lt;a href=&#34;#cb1-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-39&#34;&gt;&lt;a href=&#34;#cb1-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; ll &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;%(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Bigint &amp;amp;lhs, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll &amp;amp;rhs) {&lt;/span&gt;
&lt;span id=&#34;cb1-40&#34;&gt;&lt;a href=&#34;#cb1-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; (lhs.upper % rhs * base + lhs.lower) % rhs;&lt;/span&gt;
&lt;span id=&#34;cb1-41&#34;&gt;&lt;a href=&#34;#cb1-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-42&#34;&gt;&lt;a href=&#34;#cb1-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; print() {&lt;/span&gt;
&lt;span id=&#34;cb1-43&#34;&gt;&lt;a href=&#34;#cb1-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (upper) printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld%015lld&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, upper, lower);&lt;/span&gt;
&lt;span id=&#34;cb1-44&#34;&gt;&lt;a href=&#34;#cb1-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, lower);&lt;/span&gt;
&lt;span id=&#34;cb1-45&#34;&gt;&lt;a href=&#34;#cb1-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-46&#34;&gt;&lt;a href=&#34;#cb1-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;};&lt;/span&gt;
&lt;span id=&#34;cb1-47&#34;&gt;&lt;a href=&#34;#cb1-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-48&#34;&gt;&lt;a href=&#34;#cb1-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-49&#34;&gt;&lt;a href=&#34;#cb1-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = &lt;span class=&#34;fl&#34;&gt;1e5&lt;/span&gt; + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;, maxm = &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt; * maxn;&lt;/span&gt;
&lt;span id=&#34;cb1-50&#34;&gt;&lt;a href=&#34;#cb1-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; prime[] = {&lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;};&lt;/span&gt;
&lt;span id=&#34;cb1-51&#34;&gt;&lt;a href=&#34;#cb1-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; head[maxn], to[maxm], nxt[maxm], n, m, cnte;&lt;/span&gt;
&lt;span id=&#34;cb1-52&#34;&gt;&lt;a href=&#34;#cb1-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; oud[maxn], ind[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-53&#34;&gt;&lt;a href=&#34;#cb1-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-54&#34;&gt;&lt;a href=&#34;#cb1-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;il &lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; add(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; v) {&lt;/span&gt;
&lt;span id=&#34;cb1-55&#34;&gt;&lt;a href=&#34;#cb1-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    to[++cnte] = v;&lt;/span&gt;
&lt;span id=&#34;cb1-56&#34;&gt;&lt;a href=&#34;#cb1-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    nxt[cnte] = head[u];&lt;/span&gt;
&lt;span id=&#34;cb1-57&#34;&gt;&lt;a href=&#34;#cb1-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    head[u] = cnte;&lt;/span&gt;
&lt;span id=&#34;cb1-58&#34;&gt;&lt;a href=&#34;#cb1-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-59&#34;&gt;&lt;a href=&#34;#cb1-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb1-60&#34;&gt;&lt;a href=&#34;#cb1-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-61&#34;&gt;&lt;a href=&#34;#cb1-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;struct&lt;/span&gt; Frac {&lt;/span&gt;
&lt;span id=&#34;cb1-62&#34;&gt;&lt;a href=&#34;#cb1-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Bigint upper, lower;&lt;/span&gt;
&lt;span id=&#34;cb1-63&#34;&gt;&lt;a href=&#34;#cb1-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Frac(Bigint x = Bigint(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;), Bigint y = Bigint(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)) : upper(x), lower(y) {}&lt;/span&gt;
&lt;span id=&#34;cb1-64&#34;&gt;&lt;a href=&#34;#cb1-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; Frac &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;+(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Frac &amp;amp;lhs, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Frac &amp;amp;rhs) {&lt;/span&gt;
&lt;span id=&#34;cb1-65&#34;&gt;&lt;a href=&#34;#cb1-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Frac(lhs.upper + rhs.upper, lhs.lower);&lt;/span&gt;
&lt;span id=&#34;cb1-66&#34;&gt;&lt;a href=&#34;#cb1-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-67&#34;&gt;&lt;a href=&#34;#cb1-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    il &lt;span class=&#34;kw&#34;&gt;friend&lt;/span&gt; Frac &lt;span class=&#34;kw&#34;&gt;operator&lt;/span&gt;/(&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; Frac &amp;amp;lhs, &lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; ll &amp;amp;rhs) {&lt;/span&gt;
&lt;span id=&#34;cb1-68&#34;&gt;&lt;a href=&#34;#cb1-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; Frac(lhs.upper / rhs, lhs.lower);&lt;/span&gt;
&lt;span id=&#34;cb1-69&#34;&gt;&lt;a href=&#34;#cb1-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-70&#34;&gt;&lt;a href=&#34;#cb1-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;} f[maxn];&lt;/span&gt;
&lt;span id=&#34;cb1-71&#34;&gt;&lt;a href=&#34;#cb1-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-72&#34;&gt;&lt;a href=&#34;#cb1-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; q[maxn], qhead = &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, qtail = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-73&#34;&gt;&lt;a href=&#34;#cb1-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb1-74&#34;&gt;&lt;a href=&#34;#cb1-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main() {&lt;/span&gt;
&lt;span id=&#34;cb1-75&#34;&gt;&lt;a href=&#34;#cb1-75&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    Bigint base(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-76&#34;&gt;&lt;a href=&#34;#cb1-76&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;11&lt;/span&gt;) base = base * &lt;span class=&#34;dv&#34;&gt;60&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-77&#34;&gt;&lt;a href=&#34;#cb1-77&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    read(n), read(m);&lt;/span&gt;
&lt;span id=&#34;cb1-78&#34;&gt;&lt;a href=&#34;#cb1-78&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb1-79&#34;&gt;&lt;a href=&#34;#cb1-79&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        read(oud[i]);&lt;/span&gt;
&lt;span id=&#34;cb1-80&#34;&gt;&lt;a href=&#34;#cb1-80&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(j, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, oud[i]) {&lt;/span&gt;
&lt;span id=&#34;cb1-81&#34;&gt;&lt;a href=&#34;#cb1-81&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; to; read(to);&lt;/span&gt;
&lt;span id=&#34;cb1-82&#34;&gt;&lt;a href=&#34;#cb1-82&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            add(i, to), ++ind[to];&lt;/span&gt;
&lt;span id=&#34;cb1-83&#34;&gt;&lt;a href=&#34;#cb1-83&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-84&#34;&gt;&lt;a href=&#34;#cb1-84&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        f[i] = Frac(Bigint(&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;), base);&lt;/span&gt;
&lt;span id=&#34;cb1-85&#34;&gt;&lt;a href=&#34;#cb1-85&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-86&#34;&gt;&lt;a href=&#34;#cb1-86&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, m)&lt;/span&gt;
&lt;span id=&#34;cb1-87&#34;&gt;&lt;a href=&#34;#cb1-87&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        q[++qtail] = i, f[i].upper = base;&lt;/span&gt;
&lt;span id=&#34;cb1-88&#34;&gt;&lt;a href=&#34;#cb1-88&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (qhead &amp;lt;= qtail) {&lt;/span&gt;
&lt;span id=&#34;cb1-89&#34;&gt;&lt;a href=&#34;#cb1-89&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; u = q[qhead++];&lt;/span&gt;
&lt;span id=&#34;cb1-90&#34;&gt;&lt;a href=&#34;#cb1-90&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        Frac add;&lt;/span&gt;
&lt;span id=&#34;cb1-91&#34;&gt;&lt;a href=&#34;#cb1-91&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (oud[u]) add = f[u] / oud[u];&lt;/span&gt;
&lt;span id=&#34;cb1-92&#34;&gt;&lt;a href=&#34;#cb1-92&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = head[u]; i; i = nxt[i]) {&lt;/span&gt;
&lt;span id=&#34;cb1-93&#34;&gt;&lt;a href=&#34;#cb1-93&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; &amp;amp;v = to[i];&lt;/span&gt;
&lt;span id=&#34;cb1-94&#34;&gt;&lt;a href=&#34;#cb1-94&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[v] = f[v] + add;&lt;/span&gt;
&lt;span id=&#34;cb1-95&#34;&gt;&lt;a href=&#34;#cb1-95&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!--ind[v])&lt;/span&gt;
&lt;span id=&#34;cb1-96&#34;&gt;&lt;a href=&#34;#cb1-96&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                q[++qtail] = v;&lt;/span&gt;
&lt;span id=&#34;cb1-97&#34;&gt;&lt;a href=&#34;#cb1-97&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-98&#34;&gt;&lt;a href=&#34;#cb1-98&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-99&#34;&gt;&lt;a href=&#34;#cb1-99&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n) {&lt;/span&gt;
&lt;span id=&#34;cb1-100&#34;&gt;&lt;a href=&#34;#cb1-100&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (!oud[i]) {&lt;/span&gt;
&lt;span id=&#34;cb1-101&#34;&gt;&lt;a href=&#34;#cb1-101&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            FOR(j, &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-102&#34;&gt;&lt;a href=&#34;#cb1-102&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (f[i].upper % prime[j] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; f[i].lower % prime[j] == &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb1-103&#34;&gt;&lt;a href=&#34;#cb1-103&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;                    f[i].upper = f[i].upper / prime[j], f[i].lower = f[i].lower / prime[j];&lt;/span&gt;
&lt;span id=&#34;cb1-104&#34;&gt;&lt;a href=&#34;#cb1-104&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f[i].upper.print(), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;), f[i].lower.print(), putchar(&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;&amp;#39;&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb1-105&#34;&gt;&lt;a href=&#34;#cb1-105&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb1-106&#34;&gt;&lt;a href=&#34;#cb1-106&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb1-107&#34;&gt;&lt;a href=&#34;#cb1-107&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb1-108&#34;&gt;&lt;a href=&#34;#cb1-108&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;t2-å­—ç¬¦ä¸²åŒ¹é…&#34;&gt;T2 å­—ç¬¦ä¸²åŒ¹é…&lt;/h2&gt;
&lt;h3 id=&#34;description&#34;&gt;Description&lt;/h3&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A^i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; æ‹¼æ¥è€Œæˆçš„å­—ç¬¦ä¸²ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt; ä¸ºéç©ºå­—ç¬¦ä¸²ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(S = (AB)^kC\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(F(A)\le F(C)\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(F(A)\)&lt;/span&gt; æ„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸­å‡ºç°æ¬¡æ•°ä¸ºå¥‡æ•°çš„å­—ç¬¦æ•°é‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;solution&#34;&gt;Solution&lt;/h3&gt;
&lt;p&gt;ç›´æ¥è¯´ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; åšæ³•ã€‚å­—ç¬¦ä¸²ä¸‹æ ‡ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; çš„é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåˆ™è¿™ä¸ªå¾ªç¯å‰ç¼€çš„é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(ik\)&lt;/span&gt;ã€‚ç°åœ¨çš„&lt;strong&gt;ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ä¸çŸ¥é“æœ‰å¤šå°‘ä¸ªåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„å­—ç¬¦ä¸² &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; æœ‰é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„å¾ªç¯èŠ‚çš„å……è¦æ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(S_{[1, n - m]} = S_{[m + 1, n]}\)&lt;/span&gt;ï¼ˆè¿™æ˜¯ KMP ç›¸å…³é¢˜ç›®çš„ç»å…¸å¥—è·¯ï¼‰ã€‚ä½“ç°åœ¨æœ¬é¢˜ä¸­å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(S_{[1, (k - 1)i]} = S_{i + 1, ki}\)&lt;/span&gt;ã€‚å³ä» &lt;span class=&#34;math inline&#34;&gt;\(i + 1\)&lt;/span&gt; å¼€å§‹é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\((k - 1)i\)&lt;/span&gt; çš„å­ä¸²ä¸é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\((k - 1)i\)&lt;/span&gt; çš„å‰ç¼€ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_{[i +1, ki]}\)&lt;/span&gt; å…¶å®å³ä¸ºåç¼€ &lt;span class=&#34;math inline&#34;&gt;\(i + 1\)&lt;/span&gt; çš„å‰ç¼€ã€‚è€ƒè™‘ Z ç®—æ³•ã€‚åˆ™å¦‚æœæœ‰ &lt;span class=&#34;math inline&#34;&gt;\((k - 1)i\le Z_{i + 1}\)&lt;/span&gt;ï¼Œå³è¿™ä¸ªå‰ç¼€çš„é•¿åº¦ä¸å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(Z_{i+ 1}\)&lt;/span&gt;ï¼Œåˆ™æ ¹æ® &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt; çš„å®šä¹‰ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(S_{[1, (k - 1)i]} = S_{i + 1, ki}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{Z_{i + 1}}{i} + 1\)&lt;/span&gt; ä¸ªåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å–å€¼ã€‚å½“ç„¶ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt; è¦éç©ºï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(Z_{i + 1}\)&lt;/span&gt; è¦ä¸ &lt;span class=&#34;math inline&#34;&gt;\(n - i - 1\)&lt;/span&gt; å– &lt;span class=&#34;math inline&#34;&gt;\(\min\)&lt;/span&gt;ã€‚è‡³æ­¤ï¼Œåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ä¸ªæ•°å¾—åˆ°äº†è§£å†³ã€‚ä¸‹é¢çš„é—®é¢˜å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(F(A)\le F(C)\)&lt;/span&gt; çš„é™å®šã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(F(C)\)&lt;/span&gt;ã€‚å¾ˆæ˜æ˜¾ï¼Œå…¶ä¸ºæ•´ä¸²é™¤æ‰äº†é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(ik\)&lt;/span&gt; çš„å‰ç¼€ä¹‹åå¾—åˆ°çš„åç¼€ã€‚ç°åœ¨åˆ† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å¥‡å¶æ€§è®¨è®ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¥‡æ•°æ—¶ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(F(C) = F(\mathrm{suf}(i + 1))\)&lt;/span&gt;ï¼Œå› ä¸ºä»ç¬¬äºŒä¸ªé‡å¤çš„ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸€ç›´åˆ°ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; æ˜¯ä¸äº§ç”Ÿè´¡çŒ®çš„ã€‚è¿™æ ·çš„ &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt; ä¸€å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\left\lceil\dfrac{\frac{Z_{i + 1}}{i} + 1}{2}\right\rceil\)&lt;/span&gt; ä¸ªã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¶æ•°æ—¶ï¼Œä¸éš¾å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(F(C) = F(S)\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(F((AB)^k)\)&lt;/span&gt; å¿…ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚è¿™æ ·çš„ &lt;span class=&#34;math inline&#34;&gt;\(C\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\left\lfloor\dfrac{\frac{Z_{i + 1}}{i} + 1}{2}\right\rfloor\)&lt;/span&gt; ä¸ªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥ä¸‹æ¥è€ƒè™‘åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ã€‚å…¶å® &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¹Ÿå°±æ˜¯ä¸€ä¸ªé•¿åº¦å°äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å‰ç¼€ã€‚æ‰€ä»¥å¤§åŠ›åˆ†ç±»ä¸€æ³¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¥‡æ•°æ—¶åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; çš„æ•°é‡å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\le j&amp;lt; i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(F(\mathrm{pre}(j))\le F(\mathrm{suf}(i + 1))\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ä¸ªæ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¶æ•°æ—¶åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; çš„æ•°é‡å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\le j &amp;lt; i\)&lt;/span&gt; ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(F(\mathrm{pre}(j))\le F(S)\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ä¸ªæ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ†åˆ«ç”¨ä¹˜æ³•åŸç†åˆå¹¶å³å¯ã€‚ç„¶åè‡³äºä¸Šé¢æåˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œå¯ä»¥é¢„å…ˆå¤„ç†å‡ºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(F(\mathrm{suf}(j))\)&lt;/span&gt;ï¼Œç„¶åè¾¹æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å°±è¾¹è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(F(\mathrm{pre}(j))\)&lt;/span&gt; äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;implementation-1&#34;&gt;Implementation&lt;/h3&gt;
&lt;p&gt;å¯¹äºæŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºå¥‡æ•°æ—¶åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; çš„æ•°é‡ï¼Œè¿™é‡Œä½¿ç”¨æ ‘çŠ¶æ•°ç»„ä»¥å‡å°‘ç¼–å†™éš¾åº¦ã€‚æ ‘çŠ¶æ•°ç»„å¸¦æ¥çš„å¸¸æ•°å¾ˆå°ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚&lt;/p&gt;
&lt;div class=&#34;sourceCode&#34; id=&#34;cb2&#34;&gt;&lt;pre class=&#34;sourceCode cpp&#34;&gt;&lt;code class=&#34;sourceCode cpp&#34;&gt;&lt;span id=&#34;cb2-1&#34;&gt;&lt;a href=&#34;#cb2-1&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-2&#34;&gt;&lt;a href=&#34;#cb2-2&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#include &lt;/span&gt;&lt;span class=&#34;im&#34;&gt;&amp;lt;cstring&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-3&#34;&gt;&lt;a href=&#34;#cb2-3&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define FOR&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;lt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;++i)&lt;/span&gt;
&lt;span id=&#34;cb2-4&#34;&gt;&lt;a href=&#34;#cb2-4&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define DEC&lt;/span&gt;(i,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;i&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;gt;=&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;b;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;--i)&lt;/span&gt;
&lt;span id=&#34;cb2-5&#34;&gt;&lt;a href=&#34;#cb2-5&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define clr&lt;/span&gt;(a)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;memset(a,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kw&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;a)&lt;/span&gt;
&lt;span id=&#34;cb2-6&#34;&gt;&lt;a href=&#34;#cb2-6&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-7&#34;&gt;&lt;a href=&#34;#cb2-7&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;at&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; maxn = (&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&#34;dv&#34;&gt;20&lt;/span&gt;) + &lt;span class=&#34;dv&#34;&gt;5&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-8&#34;&gt;&lt;a href=&#34;#cb2-8&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;long&lt;/span&gt; ll;&lt;/span&gt;
&lt;span id=&#34;cb2-9&#34;&gt;&lt;a href=&#34;#cb2-9&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-10&#34;&gt;&lt;a href=&#34;#cb2-10&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;char&lt;/span&gt; s[maxn];&lt;/span&gt;
&lt;span id=&#34;cb2-11&#34;&gt;&lt;a href=&#34;#cb2-11&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; z[maxn], n, fsuf[maxn], buc[&lt;span class=&#34;dv&#34;&gt;26&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-12&#34;&gt;&lt;a href=&#34;#cb2-12&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-13&#34;&gt;&lt;a href=&#34;#cb2-13&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;kw&#34;&gt;inline&lt;/span&gt; &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; min(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; b) {&lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; a &amp;lt; b ? a : b;}&lt;/span&gt;
&lt;span id=&#34;cb2-14&#34;&gt;&lt;a href=&#34;#cb2-14&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-15&#34;&gt;&lt;a href=&#34;#cb2-15&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;pp&#34;&gt;#define lowbit&lt;/span&gt;(x)&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;(x&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;&amp;amp;&lt;span class=&#34;pp&#34;&gt; &lt;/span&gt;-x)&lt;/span&gt;
&lt;span id=&#34;cb2-16&#34;&gt;&lt;a href=&#34;#cb2-16&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-17&#34;&gt;&lt;a href=&#34;#cb2-17&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; t[&lt;span class=&#34;dv&#34;&gt;27&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-18&#34;&gt;&lt;a href=&#34;#cb2-18&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-19&#34;&gt;&lt;a href=&#34;#cb2-19&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;void&lt;/span&gt; add(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb2-20&#34;&gt;&lt;a href=&#34;#cb2-20&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-21&#34;&gt;&lt;a href=&#34;#cb2-21&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; x &amp;lt;= &lt;span class=&#34;dv&#34;&gt;26&lt;/span&gt;; x += lowbit(x))&lt;/span&gt;
&lt;span id=&#34;cb2-22&#34;&gt;&lt;a href=&#34;#cb2-22&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ++t[x];&lt;/span&gt;
&lt;span id=&#34;cb2-23&#34;&gt;&lt;a href=&#34;#cb2-23&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-24&#34;&gt;&lt;a href=&#34;#cb2-24&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-25&#34;&gt;&lt;a href=&#34;#cb2-25&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-26&#34;&gt;&lt;a href=&#34;#cb2-26&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; query(&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; x)&lt;/span&gt;
&lt;span id=&#34;cb2-27&#34;&gt;&lt;a href=&#34;#cb2-27&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-28&#34;&gt;&lt;a href=&#34;#cb2-28&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; ret = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-29&#34;&gt;&lt;a href=&#34;#cb2-29&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (; x; x -= lowbit(x))&lt;/span&gt;
&lt;span id=&#34;cb2-30&#34;&gt;&lt;a href=&#34;#cb2-30&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ret += t[x];&lt;/span&gt;
&lt;span id=&#34;cb2-31&#34;&gt;&lt;a href=&#34;#cb2-31&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; ret;&lt;/span&gt;
&lt;span id=&#34;cb2-32&#34;&gt;&lt;a href=&#34;#cb2-32&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;
&lt;span id=&#34;cb2-33&#34;&gt;&lt;a href=&#34;#cb2-33&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-34&#34;&gt;&lt;a href=&#34;#cb2-34&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; main()&lt;/span&gt;
&lt;span id=&#34;cb2-35&#34;&gt;&lt;a href=&#34;#cb2-35&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;{&lt;/span&gt;
&lt;span id=&#34;cb2-36&#34;&gt;&lt;a href=&#34;#cb2-36&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; T;&lt;/span&gt;
&lt;span id=&#34;cb2-37&#34;&gt;&lt;a href=&#34;#cb2-37&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%d&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, &amp;amp;T);&lt;/span&gt;
&lt;span id=&#34;cb2-38&#34;&gt;&lt;a href=&#34;#cb2-38&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (T--)&lt;/span&gt;
&lt;span id=&#34;cb2-39&#34;&gt;&lt;a href=&#34;#cb2-39&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    {&lt;/span&gt;
&lt;span id=&#34;cb2-40&#34;&gt;&lt;a href=&#34;#cb2-40&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        scanf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-41&#34;&gt;&lt;a href=&#34;#cb2-41&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        n = strlen(s + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-42&#34;&gt;&lt;a href=&#34;#cb2-42&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        clr(z), clr(fsuf), clr(buc);&lt;/span&gt;
&lt;span id=&#34;cb2-43&#34;&gt;&lt;a href=&#34;#cb2-43&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        z[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] = n;&lt;/span&gt;
&lt;span id=&#34;cb2-44&#34;&gt;&lt;a href=&#34;#cb2-44&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;cf&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;dv&#34;&gt;2&lt;/span&gt;, l = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;, r = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;; i &amp;lt;= n; ++i)&lt;/span&gt;
&lt;span id=&#34;cb2-45&#34;&gt;&lt;a href=&#34;#cb2-45&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb2-46&#34;&gt;&lt;a href=&#34;#cb2-46&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i &amp;lt;= r) z[i] = min(z[i - l + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], r - i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-47&#34;&gt;&lt;a href=&#34;#cb2-47&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;while&lt;/span&gt; (i + z[i] &amp;lt;= n &amp;amp;&amp;amp; s[i + z[i]] == s[z[i] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;]) ++z[i];&lt;/span&gt;
&lt;span id=&#34;cb2-48&#34;&gt;&lt;a href=&#34;#cb2-48&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (i + z[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; &amp;gt; r) l = i, r = i + z[i] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-49&#34;&gt;&lt;a href=&#34;#cb2-49&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb2-50&#34;&gt;&lt;a href=&#34;#cb2-50&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;co&#34;&gt;//è®¡ç®— z æ•°ç»„&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-51&#34;&gt;&lt;a href=&#34;#cb2-51&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        DEC(i, n, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb2-52&#34;&gt;&lt;a href=&#34;#cb2-52&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb2-53&#34;&gt;&lt;a href=&#34;#cb2-53&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ++buc[s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-54&#34;&gt;&lt;a href=&#34;#cb2-54&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;if&lt;/span&gt; (buc[s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;] &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) fsuf[i] = fsuf[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-55&#34;&gt;&lt;a href=&#34;#cb2-55&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;cf&#34;&gt;else&lt;/span&gt; fsuf[i] = fsuf[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-56&#34;&gt;&lt;a href=&#34;#cb2-56&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb2-57&#34;&gt;&lt;a href=&#34;#cb2-57&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;co&#34;&gt;//å¤„ç†å‡ºæ‰€æœ‰åç¼€çš„ F å€¼&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-58&#34;&gt;&lt;a href=&#34;#cb2-58&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        clr(buc), clr(t);&lt;/span&gt;
&lt;span id=&#34;cb2-59&#34;&gt;&lt;a href=&#34;#cb2-59&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; f = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//å½“å‰å‰ç¼€çš„ f å€¼&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-60&#34;&gt;&lt;a href=&#34;#cb2-60&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        ll ans = &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-61&#34;&gt;&lt;a href=&#34;#cb2-61&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        FOR(i, &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, n - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;
&lt;span id=&#34;cb2-62&#34;&gt;&lt;a href=&#34;#cb2-62&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        {&lt;/span&gt;
&lt;span id=&#34;cb2-63&#34;&gt;&lt;a href=&#34;#cb2-63&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ++buc[s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;];&lt;/span&gt;
&lt;span id=&#34;cb2-64&#34;&gt;&lt;a href=&#34;#cb2-64&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            f += ((buc[s[i] - &lt;span class=&#34;ch&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;] &amp;amp; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) ? &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt; : -&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-65&#34;&gt;&lt;a href=&#34;#cb2-65&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; totk = min(z[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;], n - i - &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) / i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-66&#34;&gt;&lt;a href=&#34;#cb2-66&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;dt&#34;&gt;int&lt;/span&gt; tot0 = totk &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;, tot1 = (totk + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) &amp;gt;&amp;gt; &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;;&lt;span class=&#34;co&#34;&gt;//k ä¸ºå¶æ•°/å¥‡æ•°çš„æ•°é‡&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-67&#34;&gt;&lt;a href=&#34;#cb2-67&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            ans += &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * tot0 * query(fsuf[&lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;) + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;bu&#34;&gt;ll&lt;/span&gt; * tot1 * query(fsuf[i + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;] + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-68&#34;&gt;&lt;a href=&#34;#cb2-68&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            add(f + &lt;span class=&#34;dv&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;
&lt;span id=&#34;cb2-69&#34;&gt;&lt;a href=&#34;#cb2-69&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;            &lt;span class=&#34;co&#34;&gt;//æ ‘çŠ¶æ•°ç»„ä¼ è¿›å»çš„è¦å…¨éƒ¨åŠ  1 æ˜¯å› ä¸ºä¼šæœ‰ 0 çš„è´¡çŒ®&lt;/span&gt;&lt;/span&gt;
&lt;span id=&#34;cb2-70&#34;&gt;&lt;a href=&#34;#cb2-70&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        }&lt;/span&gt;
&lt;span id=&#34;cb2-71&#34;&gt;&lt;a href=&#34;#cb2-71&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;        printf(&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;%lld\n&lt;/span&gt;&lt;span class=&#34;st&#34;&gt;&amp;quot;&lt;/span&gt;, ans);&lt;/span&gt;
&lt;span id=&#34;cb2-72&#34;&gt;&lt;a href=&#34;#cb2-72&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    }&lt;/span&gt;
&lt;span id=&#34;cb2-73&#34;&gt;&lt;a href=&#34;#cb2-73&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;    &lt;span class=&#34;cf&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;dv&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;
&lt;span id=&#34;cb2-74&#34;&gt;&lt;a href=&#34;#cb2-74&#34; aria-hidden=&#34;true&#34;&gt;&lt;/a&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;t3-ç§»çƒæ¸¸æˆ&#34;&gt;T3 ç§»çƒæ¸¸æˆ&lt;/h2&gt;
&lt;p&gt;NOIP è€ƒäº†æ„é€ /jkã€‚ä»Šå¤©è¡¥é¢˜ã€‚ç¬¬ä¸€æ¬¡åšè¿™ç§éš¾åº¦çš„æ„é€ é¢˜ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&#34;description-1&#34;&gt;Description&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n + 1\)&lt;/span&gt; ä¸ªæŸ±å­ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªæŸ±å­æœ‰æ‰“ä¹±æ’çš„ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ç§é¢œè‰²çš„çƒï¼Œæ¯ä¸ªæŸ±å­ä¸Šé¢æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªï¼Œæ„é€ å‡ºä¸€ç§æ­¥æ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(820000\)&lt;/span&gt; å†…çš„æ–¹æ¡ˆä½¿å¾—æ¯ä¸ªæŸ±å­ä¸Šé¢œè‰²ç›¸åŒã€‚ æ¯æ¬¡æ“ä½œåªèƒ½ä¸ºæ‹¿æŸæŸ±å­æœ€é¡¶ç«¯çš„ä¸€ä¸ªçƒæ”¾åˆ°å¦ä¸€ä¸ªæŸ±å­çš„æœ€é¡¶ç«¯ï¼Œå¹¶ä¸”å§‹ç»ˆä¿æŒä¸€ä¸ªæŸ±å­ä¸Šçƒä¸ªæ•°ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ³•ä¸€&#34;&gt;æ³•ä¸€&lt;/h3&gt;
&lt;h2 id=&#34;t4-å¾®ä¿¡æ­¥æ•°&#34;&gt;T4 å¾®ä¿¡æ­¥æ•°&lt;/h2&gt;
&lt;p&gt;æˆ‘éƒ½ä¸æ•¢ç›¸ä¿¡è¿™æ˜¯ NOIP é¢˜ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;description-2&#34;&gt;Description&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ç»´ç©ºé—´çš„åœºåœ°ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»´åæ ‡é™åˆ¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([1, w_i]\)&lt;/span&gt; ä¸­ã€‚æŸäººè·‘æ­¥ï¼Œåœ¨æ¥ä¸‹æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(\prod w_i\)&lt;/span&gt; å¤©ä¸­æ¯å¤©ä»ä¸€ä¸ªä¸åŒåæ ‡å‡ºå‘ï¼ŒæŒ‰ç…§å¦‚ä¸‹è§„åˆ™è·‘æ­¥ï¼š&lt;/p&gt;
&lt;p&gt;ä¸€å…± &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ­¥ï¼Œæ¯æ­¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\((c_i, d_i)\)&lt;/span&gt; æè¿°ï¼Œè¡¨ç¤ºåœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; ç»´ç§»åŠ¨ &lt;span class=&#34;math inline&#34;&gt;\(d_i\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(d_i\in\{-1, 1\}\)&lt;/span&gt;ï¼‰ï¼Œé‡å¤å¦‚ä¸Šè·¯çº¿ç›´åˆ°èµ°å‡ºåœºåœ°ã€‚&lt;/p&gt;
&lt;p&gt;é—®è¿™äº›å¤©å†…èµ°äº†å¤šå°‘æ­¥ï¼Œç­”æ¡ˆå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(10^9 + 7\)&lt;/span&gt; å–æ¨¡ï¼Œè‹¥å­˜åœ¨æŸä¸€å¤©ä¼šåœ¨åœºå†…å¾ªç¯ï¼Œè¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le n\le 5\times 10^5\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le 10\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\le w_i\le 10^9\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d_i\in\{-1, 1\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;solution-1&#34;&gt;Solution&lt;/h3&gt;
</description>
        </item>
        
    </channel>
</rss>
